const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/secp256k1-70TK6PpF.js","assets/index-Ckbf-WCj.js","assets/index-BfvoeTJA.css","assets/invoiceUtils-BYOTLLE2.js","assets/gamepad-2-BME8yo3l.js","assets/shield-check-CMZRv0V2.js","assets/file-text-B04ZfDju.js","assets/embedded-wallet-CDUjZTH1.js","assets/if-defined-DFz-Y_HY.js","assets/index-1EFbdFNN.js","assets/index-yfATfQzd.js","assets/ref-D78ZKhjG.js","assets/index-BietiQsM.js","assets/index-B6Rr8y-F.js","assets/index-Bb7ByViM.js","assets/index-D_MyTzl1.js","assets/index-B36XA3qm.js","assets/index-DmOflX7Z.js","assets/index-B-uy3gIJ.js","assets/email-BGgvX3q3.js","assets/index-Bf5g4euS.js","assets/socials-CSe6500F.js","assets/index-Bxh15HFY.js","assets/ConstantsUtil-Dmg8YACJ.js","assets/index-D4QoZKCu.js","assets/index-CWIXh20i.js","assets/index-GvPwNKWJ.js","assets/index-BK8-EMlm.js","assets/swaps-zLcQnVP9.js","assets/index-W2EE_eBX.js","assets/index-CfVoBFuj.js","assets/index-BFL55M7c.js","assets/send-BHskZs48.js","assets/index-DUNSfsSz.js","assets/index-CGHgP9-4.js","assets/receive-B2EiuSey.js","assets/index-RFMGL8U5.js","assets/onramp-qXNy1jep.js","assets/index-VGnEfFR5.js","assets/index-BspEHBcO.js","assets/index-CrQyRZHZ.js","assets/transactions-CygGkv1G.js","assets/index-HLzbdd1G.js","assets/index-Cpxi2SpK.js","assets/index-BW1vbIA1.js","assets/index-NaQbG-4d.js","assets/index-DiZxqC-v.js","assets/w3m-modal-C2Qgs_c_.js","assets/index-DTjvFzP0.js"])))=>i.map(i=>d[i]);
var iT=Object.defineProperty;var q0=r=>{throw TypeError(r)};var oT=(r,e,t)=>e in r?iT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var $=(r,e,t)=>oT(r,typeof e!="symbol"?e+"":e,t),Cm=(r,e,t)=>e.has(r)||q0("Cannot "+t);var y=(r,e,t)=>(Cm(r,e,"read from private field"),t?t.call(r):e.get(r)),M=(r,e,t)=>e.has(r)?q0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),_=(r,e,t,n)=>(Cm(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),W=(r,e,t)=>(Cm(r,e,"access private method"),t);var Ku=(r,e,t,n)=>({set _(s){_(r,e,s,t)},get _(){return y(r,e,n)}});import{c as LC,p as Ig,q as $C,_ as dn,t as Bs,r as we,R as aT,b as cT,u as lT,j as N,v as uT,w as _m,x as V0,y as Nm,m as Go,z as dT,T as hT,k as fT,D as Rf,W as Df,g as Im,h as W0,I as G0,L as kf,S as pT,A as gT,s as sn,F as mT,X as yT}from"./index-Ckbf-WCj.js";import{e as Wy,g as wT}from"./invoiceUtils-BYOTLLE2.js";import{G as Sm,C as K0}from"./gamepad-2-BME8yo3l.js";import{S as J0}from"./shield-check-CMZRv0V2.js";import{F as bT}from"./file-text-B04ZfDju.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ET=LC("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vT=LC("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),AT=Symbol(),Pb=Symbol(),Ju="a",Nd="w";let CT=(r,e)=>new Proxy(r,e);const Gy=Object.getPrototypeOf,Ky=new WeakMap,MC=r=>r&&(Ky.has(r)?Ky.get(r):Gy(r)===Object.prototype||Gy(r)===Array.prototype),Lp=r=>typeof r=="object"&&r!==null,_T=r=>{if(Array.isArray(r))return Array.from(r);const e=Object.getOwnPropertyDescriptors(r);return Object.values(e).forEach(t=>{t.configurable=!0}),Object.create(Gy(r),e)},Ob=r=>r[Pb]||r,FC=(r,e,t,n)=>{if(!MC(r))return r;let s=n&&n.get(r);if(!s){const c=Ob(r);s=(l=>Object.values(Object.getOwnPropertyDescriptors(l)).some(u=>!u.configurable&&!u.writable))(c)?[c,_T(c)]:[c],n==null||n.set(r,s)}const[i,o]=s;let a=t&&t.get(i);return a&&a[1].f===!!o||(a=((c,l)=>{const u={f:l};let d=!1;const h=(g,p)=>{if(!d){let m=u[Ju].get(c);if(m||(m={},u[Ju].set(c,m)),g===Nd)m[Nd]=!0;else{let w=m[g];w||(w=new Set,m[g]=w),w.add(p)}}},f={get:(g,p)=>p===Pb?c:(h("k",p),FC(Reflect.get(g,p),u[Ju],u.c,u.t)),has:(g,p)=>p===AT?(d=!0,u[Ju].delete(c),!0):(h("h",p),Reflect.has(g,p)),getOwnPropertyDescriptor:(g,p)=>(h("o",p),Reflect.getOwnPropertyDescriptor(g,p)),ownKeys:g=>(h(Nd),Reflect.ownKeys(g))};return l&&(f.set=f.deleteProperty=()=>!1),[f,u]})(i,!!o),a[1].p=CT(o||i,a[0]),t&&t.set(i,a)),a[1][Ju]=e,a[1].c=t,a[1].t=n,a[1].p},jC=(r,e,t,n,s=Object.is)=>{if(s(r,e))return!1;if(!Lp(r)||!Lp(e))return!0;const i=t.get(Ob(r));if(!i)return!0;if(n){const a=n.get(r);if(a&&a.n===e)return a.g;n.set(r,{n:e,g:!1})}let o=null;try{for(const a of i.h||[])if(o=Reflect.has(r,a)!==Reflect.has(e,a),o)return o;if(i[Nd]===!0){if(o=((a,c)=>{const l=Reflect.ownKeys(a),u=Reflect.ownKeys(c);return l.length!==u.length||l.some((d,h)=>d!==u[h])})(r,e),o)return o}else for(const a of i.o||[])if(o=!!Reflect.getOwnPropertyDescriptor(r,a)!=!!Reflect.getOwnPropertyDescriptor(e,a),o)return o;for(const a of i.k||[])if(o=jC(r[a],e[a],t,n,s),o)return o;return o===null&&(o=!0),o}finally{n&&n.set(r,{n:e,g:o})}},NT=r=>MC(r)&&r[Pb]||null,Y0=(r,e=!0)=>{Ky.set(r,e)},IT=(r,e,t)=>{const n=[],s=new WeakSet,i=(o,a)=>{if(s.has(o))return;Lp(o)&&s.add(o);const c=Lp(o)&&e.get(Ob(o));if(c){var l,u;if((l=c.h)==null||l.forEach(h=>{const f=`:has(${String(h)})`;n.push(a?[...a,f]:[f])}),c[Nd]===!0){const h=":ownKeys";n.push(a?[...a,h]:[h])}else{var d;(d=c.o)==null||d.forEach(h=>{const f=`:hasOwn(${String(h)})`;n.push(a?[...a,f]:[f])})}(u=c.k)==null||u.forEach(h=>{!("value"in(Object.getOwnPropertyDescriptor(o,h)||{}))||i(o[h],a?[...a,h]:[h])})}else a&&n.push(a)};return i(r),n},$p={},xm=r=>typeof r=="object"&&r!==null,oo=new WeakMap,gd=new WeakSet,ST=(r=Object.is,e=(l,u)=>new Proxy(l,u),t=l=>xm(l)&&!gd.has(l)&&(Array.isArray(l)||!(Symbol.iterator in l))&&!(l instanceof WeakMap)&&!(l instanceof WeakSet)&&!(l instanceof Error)&&!(l instanceof Number)&&!(l instanceof Date)&&!(l instanceof String)&&!(l instanceof RegExp)&&!(l instanceof ArrayBuffer),n=l=>{switch(l.status){case"fulfilled":return l.value;case"rejected":throw l.reason;default:throw l}},s=new WeakMap,i=(l,u,d=n)=>{const h=s.get(l);if((h==null?void 0:h[0])===u)return h[1];const f=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l));return Y0(f,!0),s.set(l,[u,f]),Reflect.ownKeys(l).forEach(g=>{if(Object.getOwnPropertyDescriptor(f,g))return;const p=Reflect.get(l,g),{enumerable:m}=Reflect.getOwnPropertyDescriptor(l,g),w={value:p,enumerable:m,configurable:!0};if(gd.has(p))Y0(p,!1);else if(p instanceof Promise)delete w.value,w.get=()=>d(p);else if(oo.has(p)){const[A,v]=oo.get(p);w.value=i(A,v(),d)}Object.defineProperty(f,g,w)}),Object.preventExtensions(f)},o=new WeakMap,a=[1,1],c=l=>{if(!xm(l))throw new Error("object required");const u=o.get(l);if(u)return u;let d=a[0];const h=new Set,f=(S,H=++a[0])=>{d!==H&&(d=H,h.forEach(L=>L(S,H)))};let g=a[1];const p=(S=++a[1])=>(g!==S&&!h.size&&(g=S,w.forEach(([H])=>{const L=H[1](S);L>d&&(d=L)})),d),m=S=>(H,L)=>{const j=[...H];j[1]=[S,...j[1]],f(j,L)},w=new Map,A=(S,H)=>{if(($p?"production":void 0)!=="production"&&w.has(S))throw new Error("prop listener already exists");if(h.size){const L=H[3](m(S));w.set(S,[H,L])}else w.set(S,[H])},v=S=>{var H;const L=w.get(S);L&&(w.delete(S),(H=L[1])==null||H.call(L))},I=S=>(h.add(S),h.size===1&&w.forEach(([L,j],Q)=>{if(($p?"production":void 0)!=="production"&&j)throw new Error("remove already exists");const z=L[3](m(Q));w.set(Q,[L,z])}),()=>{h.delete(S),h.size===0&&w.forEach(([L,j],Q)=>{j&&(j(),w.set(Q,[L]))})}),T=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l)),D=e(T,{deleteProperty(S,H){const L=Reflect.get(S,H);v(H);const j=Reflect.deleteProperty(S,H);return j&&f(["delete",[H],L]),j},set(S,H,L,j){const Q=Reflect.has(S,H),z=Reflect.get(S,H,j);if(Q&&(r(z,L)||o.has(L)&&r(z,o.get(L))))return!0;v(H),xm(L)&&(L=NT(L)||L);let b=L;if(L instanceof Promise)L.then(E=>{L.status="fulfilled",L.value=E,f(["resolve",[H],E])}).catch(E=>{L.status="rejected",L.reason=E,f(["reject",[H],E])});else{!oo.has(L)&&t(L)&&(b=c(L));const E=!gd.has(b)&&oo.get(b);E&&A(H,E)}return Reflect.set(S,H,b,j),f(["set",[H],L,z]),!0}});o.set(l,D);const U=[T,p,i,I];return oo.set(D,U),Reflect.ownKeys(l).forEach(S=>{const H=Object.getOwnPropertyDescriptor(l,S);"value"in H&&(D[S]=l[S],delete H.value,delete H.writable),Object.defineProperty(T,S,H)}),D})=>[c,oo,gd,r,e,t,n,s,i,o,a],[xT]=ST();function xt(r={}){return xT(r)}function Nr(r,e,t){const n=oo.get(r);($p?"production":void 0)!=="production"&&!n&&console.warn("Please use proxy object");let s;const i=[],o=n[3];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function ec(r,e){const t=oo.get(r);($p?"production":void 0)!=="production"&&!t&&console.warn("Please use proxy object");const[n,s,i]=t;return i(n,s(),e)}function tc(r){return gd.add(r),r}function tn(r,e,t,n){let s=r[e];return Nr(r,()=>{const i=r[e];Object.is(s,i)||t(s=i)})}function TT(r){const e=xt({data:Array.from([]),has(t){return this.data.some(n=>n[0]===t)},set(t,n){const s=this.data.find(i=>i[0]===t);return s?s[1]=n:this.data.push([t,n]),this},get(t){var n;return(n=this.data.find(s=>s[0]===t))==null?void 0:n[1]},delete(t){const n=this.data.findIndex(s=>s[0]===t);return n===-1?!1:(this.data.splice(n,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return new Map(this.data)},forEach(t){this.data.forEach(n=>{t(n[1],n[0],this)})},keys(){return this.data.map(t=>t[0]).values()},values(){return this.data.map(t=>t[1]).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(e,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(e),e}const HC={caipNetworkIdToNumber(r){return r?Number(r.split(":")[1]):void 0},parseEvmChainId(r){return typeof r=="string"?this.caipNetworkIdToNumber(r):r},getNetworksByNamespace(r,e){return(r==null?void 0:r.filter(t=>t.chainNamespace===e))||[]},getFirstNetworkByNamespace(r,e){return this.getNetworksByNamespace(r,e)[0]}};var PT=20,OT=1,ku=1e6,RT=1e6,DT=-7,kT=21,UT=!1,ef="[big.js] ",gc=ef+"Invalid ",Sg=gc+"decimal places",BT=gc+"rounding mode",zC=ef+"Division by zero",st={},zs=void 0,LT=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function qC(){function r(e){var t=this;if(!(t instanceof r))return e===zs?qC():new r(e);if(e instanceof r)t.s=e.s,t.e=e.e,t.c=e.c.slice();else{if(typeof e!="string"){if(r.strict===!0&&typeof e!="bigint")throw TypeError(gc+"value");e=e===0&&1/e<0?"-0":String(e)}$T(t,e)}t.constructor=r}return r.prototype=st,r.DP=PT,r.RM=OT,r.NE=DT,r.PE=kT,r.strict=UT,r.roundDown=0,r.roundHalfUp=1,r.roundHalfEven=2,r.roundUp=3,r}function $T(r,e){var t,n,s;if(!LT.test(e))throw Error(gc+"number");for(r.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(t=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(t<0&&(t=n),t+=+e.slice(n+1),e=e.substring(0,n)):t<0&&(t=e.length),s=e.length,n=0;n<s&&e.charAt(n)=="0";)++n;if(n==s)r.c=[r.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(r.e=t-n-1,r.c=[],t=0;n<=s;)r.c[t++]=+e.charAt(n++)}return r}function mc(r,e,t,n){var s=r.c;if(t===zs&&(t=r.constructor.RM),t!==0&&t!==1&&t!==2&&t!==3)throw Error(BT);if(e<1)n=t===3&&(n||!!s[0])||e===0&&(t===1&&s[0]>=5||t===2&&(s[0]>5||s[0]===5&&(n||s[1]!==zs))),s.length=1,n?(r.e=r.e-e+1,s[0]=1):s[0]=r.e=0;else if(e<s.length){if(n=t===1&&s[e]>=5||t===2&&(s[e]>5||s[e]===5&&(n||s[e+1]!==zs||s[e-1]&1))||t===3&&(n||!!s[0]),s.length=e,n){for(;++s[--e]>9;)if(s[e]=0,e===0){++r.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return r}function yc(r,e,t){var n=r.e,s=r.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)s="0"+s;s="0."+s}else if(n>0)if(++n>i)for(n-=i;n--;)s+="0";else n<i&&(s=s.slice(0,n)+"."+s.slice(n));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return r.s<0&&t?"-"+s:s}st.abs=function(){var r=new this.constructor(this);return r.s=1,r};st.cmp=function(r){var e,t=this,n=t.c,s=(r=new t.constructor(r)).c,i=t.s,o=r.s,a=t.e,c=r.e;if(!n[0]||!s[0])return n[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=n.length)<(c=s.length)?a:c,i=-1;++i<o;)if(n[i]!=s[i])return n[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};st.div=function(r){var e=this,t=e.constructor,n=e.c,s=(r=new t(r)).c,i=e.s==r.s?1:-1,o=t.DP;if(o!==~~o||o<0||o>ku)throw Error(Sg);if(!s[0])throw Error(zC);if(!n[0])return r.s=i,r.c=[r.e=0],r;var a,c,l,u,d,h=s.slice(),f=a=s.length,g=n.length,p=n.slice(0,a),m=p.length,w=r,A=w.c=[],v=0,I=o+(w.e=e.e-r.e)+1;for(w.s=i,i=I<0?0:I,h.unshift(0);m++<a;)p.push(0);do{for(l=0;l<10;l++){if(a!=(m=p.length))u=a>m?1:-1;else for(d=-1,u=0;++d<a;)if(s[d]!=p[d]){u=s[d]>p[d]?1:-1;break}if(u<0){for(c=m==a?s:h;m;){if(p[--m]<c[m]){for(d=m;d&&!p[--d];)p[d]=9;--p[d],p[m]+=10}p[m]-=c[m]}for(;!p[0];)p.shift()}else break}A[v++]=u?l:++l,p[0]&&u?p[m]=n[f]||0:p=[n[f]]}while((f++<g||p[0]!==zs)&&i--);return!A[0]&&v!=1&&(A.shift(),w.e--,I--),v>I&&mc(w,I,t.RM,p[0]!==zs),w};st.eq=function(r){return this.cmp(r)===0};st.gt=function(r){return this.cmp(r)>0};st.gte=function(r){return this.cmp(r)>-1};st.lt=function(r){return this.cmp(r)<0};st.lte=function(r){return this.cmp(r)<1};st.minus=st.sub=function(r){var e,t,n,s,i=this,o=i.constructor,a=i.s,c=(r=new o(r)).s;if(a!=c)return r.s=-c,i.plus(r);var l=i.c.slice(),u=i.e,d=r.c,h=r.e;if(!l[0]||!d[0])return d[0]?r.s=-c:l[0]?r=new o(i):r.s=1,r;if(a=u-h){for((s=a<0)?(a=-a,n=l):(h=u,n=d),n.reverse(),c=a;c--;)n.push(0);n.reverse()}else for(t=((s=l.length<d.length)?l:d).length,a=c=0;c<t;c++)if(l[c]!=d[c]){s=l[c]<d[c];break}if(s&&(n=l,l=d,d=n,r.s=-r.s),(c=(t=d.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;t>a;){if(l[--t]<d[t]){for(e=t;e&&!l[--e];)l[e]=9;--l[e],l[t]+=10}l[t]-=d[t]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--h;return l[0]||(r.s=1,l=[h=0]),r.c=l,r.e=h,r};st.mod=function(r){var e,t=this,n=t.constructor,s=t.s,i=(r=new n(r)).s;if(!r.c[0])throw Error(zC);return t.s=r.s=1,e=r.cmp(t)==1,t.s=s,r.s=i,e?new n(t):(s=n.DP,i=n.RM,n.DP=n.RM=0,t=t.div(r),n.DP=s,n.RM=i,this.minus(t.times(r)))};st.neg=function(){var r=new this.constructor(this);return r.s=-r.s,r};st.plus=st.add=function(r){var e,t,n,s=this,i=s.constructor;if(r=new i(r),s.s!=r.s)return r.s=-r.s,s.minus(r);var o=s.e,a=s.c,c=r.e,l=r.c;if(!a[0]||!l[0])return l[0]||(a[0]?r=new i(s):r.s=s.s),r;if(a=a.slice(),e=o-c){for(e>0?(c=o,n=l):(e=-e,n=a),n.reverse();e--;)n.push(0);n.reverse()}for(a.length-l.length<0&&(n=l,l=a,a=n),e=l.length,t=0;e;a[e]%=10)t=(a[--e]=a[e]+l[e]+t)/10|0;for(t&&(a.unshift(t),++c),e=a.length;a[--e]===0;)a.pop();return r.c=a,r.e=c,r};st.pow=function(r){var e=this,t=new e.constructor("1"),n=t,s=r<0;if(r!==~~r||r<-1e6||r>RT)throw Error(gc+"exponent");for(s&&(r=-r);r&1&&(n=n.times(e)),r>>=1,!!r;)e=e.times(e);return s?t.div(n):n};st.prec=function(r,e){if(r!==~~r||r<1||r>ku)throw Error(gc+"precision");return mc(new this.constructor(this),r,e)};st.round=function(r,e){if(r===zs)r=0;else if(r!==~~r||r<-1e6||r>ku)throw Error(Sg);return mc(new this.constructor(this),r+this.e+1,e)};st.sqrt=function(){var r,e,t,n=this,s=n.constructor,i=n.s,o=n.e,a=new s("0.5");if(!n.c[0])return new s(n);if(i<0)throw Error(ef+"No square root");i=Math.sqrt(+yc(n,!0,!0)),i===0||i===1/0?(e=n.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),r=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):r=new s(i+""),o=r.e+(s.DP+=4);do t=r,r=a.times(t.plus(n.div(t)));while(t.c.slice(0,o).join("")!==r.c.slice(0,o).join(""));return mc(r,(s.DP-=4)+r.e+1,s.RM)};st.times=st.mul=function(r){var e,t=this,n=t.constructor,s=t.c,i=(r=new n(r)).c,o=s.length,a=i.length,c=t.e,l=r.e;if(r.s=t.s==r.s?1:-1,!s[0]||!i[0])return r.c=[r.e=0],r;for(r.e=c+l,o<a&&(e=s,s=i,i=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+i[c]*s[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++r.e:e.shift(),c=e.length;!e[--c];)e.pop();return r.c=e,r};st.toExponential=function(r,e){var t=this,n=t.c[0];if(r!==zs){if(r!==~~r||r<0||r>ku)throw Error(Sg);for(t=mc(new t.constructor(t),++r,e);t.c.length<r;)t.c.push(0)}return yc(t,!0,!!n)};st.toFixed=function(r,e){var t=this,n=t.c[0];if(r!==zs){if(r!==~~r||r<0||r>ku)throw Error(Sg);for(t=mc(new t.constructor(t),r+t.e+1,e),r=r+t.e+1;t.c.length<r;)t.c.push(0)}return yc(t,!1,!!n)};st[Symbol.for("nodejs.util.inspect.custom")]=st.toJSON=st.toString=function(){var r=this,e=r.constructor;return yc(r,r.e<=e.NE||r.e>=e.PE,!!r.c[0])};st.toNumber=function(){var r=+yc(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(r.toString()))throw Error(ef+"Imprecise conversion");return r};st.toPrecision=function(r,e){var t=this,n=t.constructor,s=t.c[0];if(r!==zs){if(r!==~~r||r<1||r>ku)throw Error(gc+"precision");for(t=mc(new n(t),r,e);t.c.length<r;)t.c.push(0)}return yc(t,r<=t.e||t.e<=n.NE||t.e>=n.PE,!!s)};st.valueOf=function(){var r=this,e=r.constructor;if(e.strict===!0)throw Error(ef+"valueOf disallowed");return yc(r,r.e<=e.NE||r.e>=e.PE,!0)};var Yu=qC();const MT={bigNumber(r){return r?new Yu(r):new Yu(0)},multiply(r,e){if(r===void 0||e===void 0)return new Yu(0);const t=new Yu(r),n=new Yu(e);return t.times(n)},formatNumberToLocalString(r,e=2){return r===void 0?"0.00":typeof r=="number"?r.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e}):parseFloat(r).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e})},parseLocalStringToNumber(r){return r===void 0?0:parseFloat(r.replace(/,/gu,""))}},FT=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],jT=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],HT=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}];var Q0={};const ee={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof Q0<"u"?Q0.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org"},zT={getERC20Abi:r=>ee.USDT_CONTRACT_ADDRESSES.includes(r)?HT:FT,getSwapAbi:()=>jT},li={validateCaipAddress(r){var e;if(((e=r.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return r},parseCaipAddress(r){const e=r.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${r}`);const[t,n,s]=e;if(!t||!n||!s)throw new Error(`Invalid CAIP-10 address: ${r}`);return{chainNamespace:t,chainId:n,address:s}},parseCaipNetworkId(r){const e=r.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${r}`);const[t,n]=e;if(!t||!n)throw new Error(`Invalid CAIP-2 network id: ${r}`);return{chainNamespace:t,chainId:n}}},De={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types"};function Tm(r){if(!r)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${r}:connected_connector_id`}const xe={setItem(r,e){md()&&e!==void 0&&localStorage.setItem(r,e)},getItem(r){if(md())return localStorage.getItem(r)||void 0},removeItem(r){md()&&localStorage.removeItem(r)},clear(){md()&&localStorage.clear()}};function md(){return typeof window<"u"&&typeof localStorage<"u"}function Pi(r,e){return e==="light"?{"--w3m-accent":(r==null?void 0:r["--w3m-accent"])||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":(r==null?void 0:r["--w3m-accent"])||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}var Z0={};const Pm=(typeof process<"u"&&typeof Z0<"u"?Z0.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",bK=[{label:"Coinbase",name:"coinbase",feeRange:"1-2%",url:"",supportedChains:["eip155"]},{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],EK="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",hr={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:Pm,SECURE_SITE_DASHBOARD:`${Pm}/dashboard`,SECURE_SITE_FAVICON:`${Pm}/images/favicon.png`,RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],WC_COINBASE_PAY_SDK_CHAINS:["ethereum","arbitrum","polygon","berachain","avalanche-c-chain","optimism","celo","base"],WC_COINBASE_PAY_SDK_FALLBACK_CHAIN:"ethereum",WC_COINBASE_PAY_SDK_CHAIN_NAME_MAP:{Ethereum:"ethereum","Arbitrum One":"arbitrum",Polygon:"polygon",Berachain:"berachain",Avalanche:"avalanche-c-chain","OP Mainnet":"optimism",Celo:"celo",Base:"base"},WC_COINBASE_ONRAMP_APP_ID:"bf18c88d-495a-463b-b249-0b9d3656cf5e",SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:["eip155","solana"],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:["eip155"],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:["eip155","solana"],ACTIVITY_ENABLED_CHAIN_NAMESPACES:["eip155"],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in a new browser tab"},SEND_SUPPORTED_NAMESPACES:["eip155","solana"],DEFAULT_FEATURES:{swaps:!0,onramp:!0,receive:!0,send:!0,email:!0,emailShowWallets:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],history:!0,analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1},DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"}},ie={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5},isCacheExpired(r,e){return Date.now()-r>e},getActiveNetworkProps(){const r=ie.getActiveNamespace(),e=ie.getActiveCaipNetworkId(),t=e?e.split(":")[1]:void 0,n=t?isNaN(Number(t))?t:Number(t):void 0;return{namespace:r,caipNetworkId:e,chainId:n}},setWalletConnectDeepLink({name:r,href:e}){try{xe.setItem(De.DEEPLINK_CHOICE,JSON.stringify({href:e,name:r}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const r=xe.getItem(De.DEEPLINK_CHOICE);if(r)return JSON.parse(r)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{xe.removeItem(De.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(r){try{xe.setItem(De.ACTIVE_NAMESPACE,r)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(r){try{xe.setItem(De.ACTIVE_CAIP_NETWORK_ID,r),ie.setActiveNamespace(r.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return xe.getItem(De.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{xe.removeItem(De.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(r){try{const e=Tm(r);xe.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(r){try{const e=ie.getRecentWallets();e.find(n=>n.id===r.id)||(e.unshift(r),e.length>2&&e.pop(),xe.setItem(De.RECENT_WALLETS,JSON.stringify(e)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const r=xe.getItem(De.RECENT_WALLETS);return r?JSON.parse(r):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(r,e){try{const t=Tm(r);xe.setItem(t,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return xe.getItem(De.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(r){if(r)try{const e=Tm(r);return xe.getItem(e)}catch{console.info("Unable to get connected connector id in namespace ",r)}},setConnectedSocialProvider(r){try{xe.setItem(De.CONNECTED_SOCIAL,r)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return xe.getItem(De.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{xe.removeItem(De.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return xe.getItem(De.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){var t;const r=xe.getItem(De.ACTIVE_CAIP_NETWORK_ID);return(t=r==null?void 0:r.split(":"))==null?void 0:t[1]},setConnectionStatus(r){try{xe.setItem(De.CONNECTION_STATUS,r)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return xe.getItem(De.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const r=xe.getItem(De.CONNECTED_NAMESPACES);return r!=null&&r.length?r.split(","):[]}catch{return[]}},setConnectedNamespaces(r){try{const e=Array.from(new Set(r));xe.setItem(De.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(r){try{const e=ie.getConnectedNamespaces();e.includes(r)||(e.push(r),ie.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(r){try{const e=ie.getConnectedNamespaces(),t=e.indexOf(r);t>-1&&(e.splice(t,1),ie.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return xe.getItem(De.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(r){try{xe.setItem(De.TELEGRAM_SOCIAL_PROVIDER,r)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{xe.removeItem(De.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let r={};try{const e=xe.getItem(De.PORTFOLIO_CACHE);r=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return r},removeAddressFromBalanceCache(r){try{const e=ie.getBalanceCache();xe.setItem(De.PORTFOLIO_CACHE,JSON.stringify({...e,[r]:void 0}))}catch{console.info("Unable to remove address from balance cache",r)}},getBalanceCacheForCaipAddress(r){try{const t=ie.getBalanceCache()[r];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.portfolio))return t.balance;ie.removeAddressFromBalanceCache(r)}catch{console.info("Unable to get balance cache for address",r)}},updateBalanceCache(r){try{const e=ie.getBalanceCache();e[r.caipAddress]=r,xe.setItem(De.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",r)}},getNativeBalanceCache(){let r={};try{const e=xe.getItem(De.NATIVE_BALANCE_CACHE);r=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return r},removeAddressFromNativeBalanceCache(r){try{const e=ie.getBalanceCache();xe.setItem(De.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[r]:void 0}))}catch{console.info("Unable to remove address from balance cache",r)}},getNativeBalanceCacheForCaipAddress(r){try{const t=ie.getNativeBalanceCache()[r];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.nativeBalance))return t;console.info("Discarding cache for address",r),ie.removeAddressFromBalanceCache(r)}catch{console.info("Unable to get balance cache for address",r)}},updateNativeBalanceCache(r){try{const e=ie.getNativeBalanceCache();e[r.caipAddress]=r,xe.setItem(De.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",r)}},getEnsCache(){let r={};try{const e=xe.getItem(De.ENS_CACHE);r=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return r},getEnsFromCacheForAddress(r){try{const t=ie.getEnsCache()[r];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.ens))return t.ens;ie.removeEnsFromCache(r)}catch{console.info("Unable to get ens name from cache",r)}},updateEnsCache(r){try{const e=ie.getEnsCache();e[r.address]=r,xe.setItem(De.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",r)}},removeEnsFromCache(r){try{const e=ie.getEnsCache();xe.setItem(De.ENS_CACHE,JSON.stringify({...e,[r]:void 0}))}catch{console.info("Unable to remove ens name from cache",r)}},getIdentityCache(){let r={};try{const e=xe.getItem(De.IDENTITY_CACHE);r=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return r},getIdentityFromCacheForAddress(r){try{const t=ie.getIdentityCache()[r];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.identity))return t.identity;ie.removeIdentityFromCache(r)}catch{console.info("Unable to get identity from cache",r)}},updateIdentityCache(r){try{const e=ie.getIdentityCache();e[r.address]={identity:r.identity,timestamp:r.timestamp},xe.setItem(De.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",r)}},removeIdentityFromCache(r){try{const e=ie.getIdentityCache();xe.setItem(De.IDENTITY_CACHE,JSON.stringify({...e,[r]:void 0}))}catch{console.info("Unable to remove identity from cache",r)}},clearAddressCache(){try{xe.removeItem(De.PORTFOLIO_CACHE),xe.removeItem(De.NATIVE_BALANCE_CACHE),xe.removeItem(De.ENS_CACHE),xe.removeItem(De.IDENTITY_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(r){try{xe.setItem(De.PREFERRED_ACCOUNT_TYPES,JSON.stringify(r))}catch{console.info("Unable to set preferred account types",r)}},getPreferredAccountTypes(){try{const r=xe.getItem(De.PREFERRED_ACCOUNT_TYPES);return JSON.parse(r)}catch{console.info("Unable to get preferred account types")}}},ve={isMobile(){var r;return this.isClient()?!!((r=window==null?void 0:window.matchMedia("(pointer:coarse)"))!=null&&r.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(r,e=""){return r==null?void 0:r.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const r=window==null?void 0:window.navigator.userAgent.toLowerCase();return ve.isMobile()&&r.includes("android")},isIos(){if(!this.isMobile())return!1;const r=window==null?void 0:window.navigator.userAgent.toLowerCase();return r.includes("iphone")||r.includes("ipad")},isSafari(){return this.isClient()?(window==null?void 0:window.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(r){return r?r-Date.now()<=hr.TEN_SEC_MS:!0},isAllowedRetry(r,e=hr.ONE_SEC_MS){return Date.now()-r>=e},copyToClopboard(r){navigator.clipboard.writeText(r)},isIframe(){try{return(window==null?void 0:window.self)!==(window==null?void 0:window.top)}catch{return!1}},getPairingExpiry(){return Date.now()+hr.FOUR_MINUTES_MS},getNetworkId(r){return r==null?void 0:r.split(":")[1]},getPlainAddress(r){return r==null?void 0:r.split(":")[2]},async wait(r){return new Promise(e=>{setTimeout(e,r)})},debounce(r,e=500){let t;return(...n)=>{function s(){r(...n)}t&&clearTimeout(t),t=setTimeout(s,e)}},isHttpUrl(r){return r.startsWith("http://")||r.startsWith("https://")},formatNativeUrl(r,e){if(ve.isHttpUrl(r))return this.formatUniversalUrl(r,e);let t=r;t.includes("://")||(t=r.replaceAll("/","").replaceAll(":",""),t=`${t}://`),t.endsWith("/")||(t=`${t}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const n=encodeURIComponent(e);return{redirect:`${t}wc?uri=${n}`,href:t}},formatUniversalUrl(r,e){if(!ve.isHttpUrl(r))return this.formatNativeUrl(r,e);let t=r;t.endsWith("/")||(t=`${t}/`);const n=encodeURIComponent(e);return{redirect:`${t}wc?uri=${n}`,href:t}},getOpenTargetForPlatform(r){return r==="popupWindow"?r:this.isTelegram()?ie.getTelegramSocialProvider()?"_top":"_blank":r},openHref(r,e,t){window==null||window.open(r,this.getOpenTargetForPlatform(e),t||"noreferrer noopener")},returnOpenHref(r,e,t){return window==null?void 0:window.open(r,this.getOpenTargetForPlatform(e),t||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){var t,n,s;if(typeof window>"u")return!1;const r=(n=(t=window.matchMedia)==null?void 0:t.call(window,"(display-mode: standalone)"))==null?void 0:n.matches,e=(s=window==null?void 0:window.navigator)==null?void 0:s.standalone;return!!(r||e)},async preloadImage(r){const e=new Promise((t,n)=>{const s=new Image;s.onload=t,s.onerror=n,s.crossOrigin="anonymous",s.src=r});return Promise.race([e,ve.wait(2e3)])},formatBalance(r,e){let t="0.000";if(typeof r=="string"){const n=Number(r);if(n){const s=Math.floor(n*1e3)/1e3;s&&(t=s.toString())}}return`${t}${e?` ${e}`:""}`},formatBalance2(r,e){var n;let t;if(r==="0")t="0";else if(typeof r=="string"){const s=Number(r);s&&(t=(n=s.toString().match(/^-?\d+(?:\.\d{0,3})?/u))==null?void 0:n[0])}return{value:t??"0",rest:t==="0"?"000":"",symbol:e}},getApiUrl(){return ee.W3M_API_URL},getBlockchainApiUrl(){return ee.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return ee.PULSE_API_URL},getUUID(){return crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})},parseError(r){var e,t;return typeof r=="string"?r:typeof((t=(e=r==null?void 0:r.issues)==null?void 0:e[0])==null?void 0:t.message)=="string"?r.issues[0].message:r instanceof Error?r.message:"Unknown error"},sortRequestedNetworks(r,e=[]){const t={};return e&&r&&(r.forEach((n,s)=>{t[n]=s}),e.sort((n,s)=>{const i=t[n.id],o=t[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(r){let e=0;for(const t of r)e+=t.value??0;return e},formatTokenBalance(r){const e=r.toFixed(2),[t,n]=e.split(".");return{dollars:t,pennies:n}},isAddress(r,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(r)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(r)||/^(?:0x)?[0-9A-F]{40}$/iu.test(r))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(r);default:return!1}},uniqueBy(r,e){const t=new Set;return r.filter(n=>{const s=n[e];return t.has(s)?!1:(t.add(s),!0)})},generateSdkVersion(r,e,t){const s=r.length===0?hr.ADAPTER_TYPES.UNIVERSAL:r.map(i=>i.adapterType).join(",");return`${e}-${s}-${t}`},createAccount(r,e,t,n,s){return{namespace:r,address:e,type:t,publicKey:n,path:s}},isCaipAddress(r){if(typeof r!="string")return!1;const e=r.split(":"),t=e[0];return e.filter(Boolean).length===3&&t in ee.CHAIN_NAME_MAP},isMac(){const r=window==null?void 0:window.navigator.userAgent.toLowerCase();return r.includes("macintosh")&&!r.includes("safari")},formatTelegramSocialLoginUrl(r){const e=`--${encodeURIComponent(window==null?void 0:window.location.href)}`,t="state=";if(new URL(r).host==="auth.magic.link"){const s="provider_authorization_url=",i=r.substring(r.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),t,e);return r.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(r,t,e)},injectIntoUrl(r,e,t){const n=r.indexOf(e);if(n===-1)throw new Error(`${e} parameter not found in the URL: ${r}`);const s=r.indexOf("&",n),i=e.length,o=s!==-1?s:r.length,a=r.substring(0,n+i),c=r.substring(n+i,o),l=r.substring(s),u=c+t;return a+u+l}};async function Qu(...r){const e=await fetch(...r);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class xg{constructor({baseUrl:e,clientId:t}){this.baseUrl=e,this.clientId=t}async get({headers:e,signal:t,cache:n,...s}){const i=this.createUrl(s);return(await Qu(i,{method:"GET",headers:e,signal:t,cache:n})).json()}async getBlob({headers:e,signal:t,...n}){const s=this.createUrl(n);return(await Qu(s,{method:"GET",headers:e,signal:t})).blob()}async post({body:e,headers:t,signal:n,...s}){const i=this.createUrl(s);return(await Qu(i,{method:"POST",headers:t,body:e?JSON.stringify(e):void 0,signal:n})).json()}async put({body:e,headers:t,signal:n,...s}){const i=this.createUrl(s);return(await Qu(i,{method:"PUT",headers:t,body:e?JSON.stringify(e):void 0,signal:n})).json()}async delete({body:e,headers:t,signal:n,...s}){const i=this.createUrl(s);return(await Qu(i,{method:"DELETE",headers:t,body:e?JSON.stringify(e):void 0,signal:n})).json()}createUrl({path:e,params:t}){const n=new URL(e,this.baseUrl);return t&&Object.entries(t).forEach(([s,i])=>{i&&n.searchParams.append(s,i)}),this.clientId&&n.searchParams.append("clientId",this.clientId),n}}const qT={handleSolanaDeeplinkRedirect(r){if(x.state.activeChain===ee.CHAIN.SOLANA){const e=window.location.href,t=encodeURIComponent(e);if(r==="Phantom"&&!("phantom"in window)){const n=e.startsWith("https")?"https":"http",s=e.split("/")[2],i=encodeURIComponent(`${n}://${s}`);window.location.href=`https://phantom.app/ul/browse/${t}?ref=${i}`}r==="Coinbase Wallet"&&!("coinbaseSolana"in window)&&(window.location.href=`https://go.cb-w.com/dapp?cb_url=${t}`)}}},on=xt({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),as={state:on,subscribeNetworkImages(r){return Nr(on.networkImages,()=>r(on.networkImages))},subscribeKey(r,e){return tn(on,r,e)},subscribe(r){return Nr(on,()=>r(on))},setWalletImage(r,e){on.walletImages[r]=e},setNetworkImage(r,e){on.networkImages[r]=e},setChainImage(r,e){on.chainImages[r]=e},setConnectorImage(r,e){on.connectorImages={...on.connectorImages,[r]:e}},setTokenImage(r,e){on.tokenImages[r]=e},setCurrencyImage(r,e){on.currencyImages[r]=e}},VT={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:""},Om=xt({networkImagePromises:{}}),VC={async fetchWalletImage(r){if(r)return await Ee._fetchWalletImage(r),this.getWalletImageById(r)},async fetchNetworkImage(r){if(!r)return;const e=this.getNetworkImageById(r);return e||(Om.networkImagePromises[r]||(Om.networkImagePromises[r]=Ee._fetchNetworkImage(r)),await Om.networkImagePromises[r],this.getNetworkImageById(r))},getWalletImageById(r){if(r)return as.state.walletImages[r]},getWalletImage(r){if(r!=null&&r.image_url)return r==null?void 0:r.image_url;if(r!=null&&r.image_id)return as.state.walletImages[r.image_id]},getNetworkImage(r){var e,t,n;if((e=r==null?void 0:r.assets)!=null&&e.imageUrl)return(t=r==null?void 0:r.assets)==null?void 0:t.imageUrl;if((n=r==null?void 0:r.assets)!=null&&n.imageId)return as.state.networkImages[r.assets.imageId]},getNetworkImageById(r){if(r)return as.state.networkImages[r]},getConnectorImage(r){if(r!=null&&r.imageUrl)return r.imageUrl;if(r!=null&&r.imageId)return as.state.connectorImages[r.imageId]},getChainImage(r){return as.state.networkImages[VT[r]]}},WT={getFeatureValue(r,e){const t=e==null?void 0:e[r];return t===void 0?hr.DEFAULT_FEATURES[r]:t},filterSocialsByPlatform(r){if(!r||!r.length)return r;if(ve.isTelegram()){if(ve.isIos())return r.filter(e=>e!=="google");if(ve.isMac())return r.filter(e=>e!=="x");if(ve.isAndroid())return r.filter(e=>!["facebook","x"].includes(e))}return r}},be=xt({features:hr.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:{solana:"eoa",bip122:"payment",polkadot:"eoa",eip155:"smartAccount"},enableNetworkSwitch:!0}),G={state:be,subscribeKey(r,e){return tn(be,r,e)},setOptions(r){Object.assign(be,r)},setFeatures(r){if(!r)return;be.features||(be.features=hr.DEFAULT_FEATURES);const e={...be.features,...r};be.features=e,be.features.socials&&(be.features.socials=WT.filterSocialsByPlatform(be.features.socials))},setProjectId(r){be.projectId=r},setCustomRpcUrls(r){be.customRpcUrls=r},setAllWallets(r){be.allWallets=r},setIncludeWalletIds(r){be.includeWalletIds=r},setExcludeWalletIds(r){be.excludeWalletIds=r},setFeaturedWalletIds(r){be.featuredWalletIds=r},setTokens(r){be.tokens=r},setTermsConditionsUrl(r){be.termsConditionsUrl=r},setPrivacyPolicyUrl(r){be.privacyPolicyUrl=r},setCustomWallets(r){be.customWallets=r},setIsSiweEnabled(r){be.isSiweEnabled=r},setIsUniversalProvider(r){be.isUniversalProvider=r},setSdkVersion(r){be.sdkVersion=r},setMetadata(r){be.metadata=r},setDisableAppend(r){be.disableAppend=r},setEIP6963Enabled(r){be.enableEIP6963=r},setDebug(r){be.debug=r},setEnableWalletConnect(r){be.enableWalletConnect=r},setEnableWalletGuide(r){be.enableWalletGuide=r},setEnableAuthLogger(r){be.enableAuthLogger=r},setEnableWallets(r){be.enableWallets=r},setHasMultipleAddresses(r){be.hasMultipleAddresses=r},setSIWX(r){be.siwx=r},setConnectMethodsOrder(r){be.features={...be.features,connectMethodsOrder:r}},setWalletFeaturesOrder(r){be.features={...be.features,walletFeaturesOrder:r}},setSocialsOrder(r){be.features={...be.features,socials:r}},setCollapseWallets(r){be.features={...be.features,collapseWallets:r}},setEnableEmbedded(r){be.enableEmbedded=r},setAllowUnsupportedChain(r){be.allowUnsupportedChain=r},setManualWCControl(r){be.manualWCControl=r},setEnableNetworkSwitch(r){be.enableNetworkSwitch=r},setDefaultAccountTypes(r={}){Object.entries(r).forEach(([e,t])=>{t&&(be.defaultAccountTypes[e]=t)})},setUniversalProviderConfigOverride(r){be.universalProviderConfigOverride=r},getUniversalProviderConfigOverride(){return be.universalProviderConfigOverride},getSnapshot(){return ec(be)}},Ji=xt({message:"",variant:"info",open:!1}),Si={state:Ji,subscribeKey(r,e){return tn(Ji,r,e)},open(r,e){const{debug:t}=G.state,{shortMessage:n,longMessage:s}=r;t&&(Ji.message=n,Ji.variant=e,Ji.open=!0),s&&console.error(typeof s=="function"?s():s)},close(){Ji.open=!1,Ji.message="",Ji.variant="info"}},GT=ve.getAnalyticsUrl(),KT=new xg({baseUrl:GT,clientId:null}),JT=["MODAL_CREATED"],ti=xt({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),At={state:ti,subscribe(r){return Nr(ti,()=>r(ti))},getSdkProperties(){const{projectId:r,sdkType:e,sdkVersion:t}=G.state;return{projectId:r,st:e,sv:t||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(r){try{const e=de.state.address;if(JT.includes(r.data.event)||typeof window>"u")return;await KT.post({path:"/e",params:At.getSdkProperties(),body:{eventId:ve.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:r.timestamp,props:{...r.data,address:e}}}),ti.reportedErrors.FORBIDDEN=!1}catch(e){e instanceof Error&&e.cause instanceof Response&&e.cause.status===ee.HTTP_STATUS_CODES.FORBIDDEN&&!ti.reportedErrors.FORBIDDEN&&(Si.open({shortMessage:"Invalid App Configuration",longMessage:`Origin ${md()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),ti.reportedErrors.FORBIDDEN=!0)}},sendEvent(r){var e;ti.timestamp=Date.now(),ti.data=r,(e=G.state.features)!=null&&e.analytics&&At._sendAnalyticsEvent(ti)}},YT=["1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79","fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa","a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393"],QT=ve.getApiUrl(),an=new xg({baseUrl:QT,clientId:null}),ZT=40,X0=4,XT=20,Te=xt({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),Ee={state:Te,subscribeKey(r,e){return tn(Te,r,e)},_getSdkProperties(){const{projectId:r,sdkType:e,sdkVersion:t}=G.state;return{projectId:r,st:e||"appkit",sv:t||"html-wagmi-4.2.2"}},_filterOutExtensions(r){return G.state.isUniversalProvider?r.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):r},async _fetchWalletImage(r){const e=`${an.baseUrl}/getWalletImage/${r}`,t=await an.getBlob({path:e,params:Ee._getSdkProperties()});as.setWalletImage(r,URL.createObjectURL(t))},async _fetchNetworkImage(r){const e=`${an.baseUrl}/public/getAssetImage/${r}`,t=await an.getBlob({path:e,params:Ee._getSdkProperties()});as.setNetworkImage(r,URL.createObjectURL(t))},async _fetchConnectorImage(r){const e=`${an.baseUrl}/public/getAssetImage/${r}`,t=await an.getBlob({path:e,params:Ee._getSdkProperties()});as.setConnectorImage(r,URL.createObjectURL(t))},async _fetchCurrencyImage(r){const e=`${an.baseUrl}/public/getCurrencyImage/${r}`,t=await an.getBlob({path:e,params:Ee._getSdkProperties()});as.setCurrencyImage(r,URL.createObjectURL(t))},async _fetchTokenImage(r){const e=`${an.baseUrl}/public/getTokenImage/${r}`,t=await an.getBlob({path:e,params:Ee._getSdkProperties()});as.setTokenImage(r,URL.createObjectURL(t))},async fetchAllowedOrigins(){try{const{allowedOrigins:r}=await an.get({path:"/projects/v1/origins",params:Ee._getSdkProperties()});return r}catch{return[]}},async fetchNetworkImages(){const r=x.getAllRequestedCaipNetworks(),e=r==null?void 0:r.map(({assets:t})=>t==null?void 0:t.imageId).filter(Boolean).filter(t=>!VC.getNetworkImageById(t));e&&await Promise.allSettled(e.map(t=>Ee._fetchNetworkImage(t)))},async fetchConnectorImages(){const{connectors:r}=Ne.state,e=r.map(({imageId:t})=>t).filter(Boolean);await Promise.allSettled(e.map(t=>Ee._fetchConnectorImage(t)))},async fetchCurrencyImages(r=[]){await Promise.allSettled(r.map(e=>Ee._fetchCurrencyImage(e)))},async fetchTokenImages(r=[]){await Promise.allSettled(r.map(e=>Ee._fetchTokenImage(e)))},async fetchWallets(r){var n,s;const e=r.exclude??[];return Ee._getSdkProperties().sv.startsWith("html-core-")&&e.push(...YT),await an.get({path:"/getWallets",params:{...Ee._getSdkProperties(),...r,page:String(r.page),entries:String(r.entries),include:(n=r.include)==null?void 0:n.join(","),exclude:(s=r.exclude)==null?void 0:s.join(",")}})},async fetchFeaturedWallets(){const{featuredWalletIds:r}=G.state;if(r!=null&&r.length){const e={...Ee._getSdkProperties(),page:1,entries:(r==null?void 0:r.length)??X0,include:r},{data:t}=await Ee.fetchWallets(e);t.sort((s,i)=>r.indexOf(s.id)-r.indexOf(i.id));const n=t.map(s=>s.image_id).filter(Boolean);await Promise.allSettled(n.map(s=>Ee._fetchWalletImage(s))),Te.featured=t,Te.allFeatured=t}},async fetchRecommendedWallets(){try{Te.isFetchingRecommendedWallets=!0;const{includeWalletIds:r,excludeWalletIds:e,featuredWalletIds:t}=G.state,n=[...e??[],...t??[]].filter(Boolean),s=x.getRequestedCaipNetworkIds().join(","),i={page:1,entries:X0,include:r,exclude:n,chains:s},{data:o,count:a}=await Ee.fetchWallets(i),c=ie.getRecentWallets(),l=o.map(d=>d.image_id).filter(Boolean),u=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(d=>Ee._fetchWalletImage(d))),Te.recommended=o,Te.allRecommended=o,Te.count=a??0}catch{}finally{Te.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:r}){const{includeWalletIds:e,excludeWalletIds:t,featuredWalletIds:n}=G.state,s=x.getRequestedCaipNetworkIds().join(","),i=[...Te.recommended.map(({id:u})=>u),...t??[],...n??[]].filter(Boolean),o={page:r,entries:ZT,include:e,exclude:i,chains:s},{data:a,count:c}=await Ee.fetchWallets(o),l=a.slice(0,XT).map(u=>u.image_id).filter(Boolean);await Promise.allSettled(l.map(u=>Ee._fetchWalletImage(u))),Te.wallets=ve.uniqueBy([...Te.wallets,...Ee._filterOutExtensions(a)],"id"),Te.count=c>Te.count?c:Te.count,Te.page=r},async initializeExcludedWallets({ids:r}){const e=x.getRequestedCaipNetworkIds().join(","),t={page:1,entries:r.length,include:r,chains:e},{data:n}=await Ee.fetchWallets(t);n&&n.forEach(s=>{Te.excludedWallets.push({rdns:s.rdns,name:s.name})})},async searchWallet({search:r,badge:e}){const{includeWalletIds:t,excludeWalletIds:n}=G.state,s=x.getRequestedCaipNetworkIds().join(",");Te.search=[];const i={page:1,entries:100,search:r==null?void 0:r.trim(),badge_type:e,include:t,exclude:n,chains:s},{data:o}=await Ee.fetchWallets(i);At.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:r??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>Ee._fetchWalletImage(c)),ve.wait(300)]),Te.search=Ee._filterOutExtensions(o)},initPromise(r,e){const t=Te.promises[r];return t||(Te.promises[r]=e())},prefetch({fetchConnectorImages:r=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:t=!0,fetchNetworkImages:n=!0}={}){const s=[r&&Ee.initPromise("connectorImages",Ee.fetchConnectorImages),e&&Ee.initPromise("featuredWallets",Ee.fetchFeaturedWallets),t&&Ee.initPromise("recommendedWallets",Ee.fetchRecommendedWallets),n&&Ee.initPromise("networkImages",Ee.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(s)},prefetchAnalyticsConfig(){var r;(r=G.state.features)!=null&&r.analytics&&Ee.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:r}=await an.get({path:"/getAnalyticsConfig",params:Ee._getSdkProperties()});G.setFeatures({analytics:r})}catch{G.setFeatures({analytics:!1})}},filterByNamespaces(r){if(!(r!=null&&r.length)){Te.featured=Te.allFeatured,Te.recommended=Te.allRecommended;return}const e=x.getRequestedCaipNetworkIds().join(",");Te.featured=Te.allFeatured.filter(t=>{var n;return(n=t.chains)==null?void 0:n.some(s=>e.includes(s))}),Te.recommended=Te.allRecommended.filter(t=>{var n;return(n=t.chains)==null?void 0:n.some(s=>e.includes(s))}),Te.filteredWallets=Te.wallets.filter(t=>{var n;return(n=t.chains)==null?void 0:n.some(s=>e.includes(s))})},clearFilterByNamespaces(){Te.filteredWallets=[]},setFilterByNamespace(r){if(!r){Te.featured=Te.allFeatured,Te.recommended=Te.allRecommended;return}const e=x.getRequestedCaipNetworkIds().join(",");Te.featured=Te.allFeatured.filter(t=>{var n;return(n=t.chains)==null?void 0:n.some(s=>e.includes(s))}),Te.recommended=Te.allRecommended.filter(t=>{var n;return(n=t.chains)==null?void 0:n.some(s=>e.includes(s))}),Te.filteredWallets=Te.wallets.filter(t=>{var n;return(n=t.chains)==null?void 0:n.some(s=>e.includes(s))})}},Ze=xt({view:"Connect",history:["Connect"],transactionStack:[]}),et={state:Ze,subscribeKey(r,e){return tn(Ze,r,e)},pushTransactionStack(r){Ze.transactionStack.push(r)},popTransactionStack(r){var t,n;const e=Ze.transactionStack.pop();if(e)if(r)this.goBack(),(t=e==null?void 0:e.onCancel)==null||t.call(e);else{if(e.goBack)this.goBack();else if(e.replace){const i=Ze.history.indexOf("ConnectingSiwe");i>0?this.goBackToIndex(i-1):(Bt.close(!0),Ze.history=[])}else e.view&&this.reset(e.view);(n=e==null?void 0:e.onSuccess)==null||n.call(e)}},push(r,e){r!==Ze.view&&(Ze.view=r,Ze.history.push(r),Ze.data=e)},reset(r,e){Ze.view=r,Ze.history=[r],Ze.data=e},replace(r,e){Ze.history.at(-1)===r||(Ze.view=r,Ze.history[Ze.history.length-1]=r,Ze.data=e)},goBack(){var e;const r=!x.state.activeCaipAddress&&this.state.view==="ConnectingFarcaster";if(Ze.history.length>1&&!Ze.history.includes("UnsupportedChain")){Ze.history.pop();const[t]=Ze.history.slice(-1);t&&(Ze.view=t)}else Bt.close();(e=Ze.data)!=null&&e.wallet&&(Ze.data.wallet=void 0),setTimeout(()=>{var t,n,s;if(r){de.setFarcasterUrl(void 0,x.state.activeChain);const i=Ne.getAuthConnector();(t=i==null?void 0:i.provider)==null||t.reload();const o=ec(G.state);(s=(n=i==null?void 0:i.provider)==null?void 0:n.syncDappData)==null||s.call(n,{metadata:o.metadata,sdkVersion:o.sdkVersion,projectId:o.projectId,sdkType:o.sdkType})}},100)},goBackToIndex(r){if(Ze.history.length>1){Ze.history=Ze.history.slice(0,r+1);const[e]=Ze.history.slice(-1);e&&(Ze.view=e)}}},ri=xt({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),Cr={state:ri,subscribe(r){return Nr(ri,()=>r(ri))},setThemeMode(r){ri.themeMode=r;try{const e=Ne.getAuthConnector();if(e){const t=Cr.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:r,themeVariables:t,w3mThemeVariables:Pi(t,r)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(r){ri.themeVariables={...ri.themeVariables,...r};try{const e=Ne.getAuthConnector();if(e){const t=Cr.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:t,w3mThemeVariables:Pi(ri.themeVariables,ri.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return ec(ri)}},WC={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},Ve=xt({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:{...WC},filterByNamespaceMap:{eip155:!0,solana:!0,polkadot:!0,bip122:!0,cosmos:!0}}),Ne={state:Ve,subscribe(r){return Nr(Ve,()=>{r(Ve)})},subscribeKey(r,e){return tn(Ve,r,e)},initialize(r){r.forEach(e=>{const t=ie.getConnectedConnectorId(e);t&&this.setConnectorId(t,e)})},setActiveConnector(r){r&&(Ve.activeConnector=tc(r))},setConnectors(r){r.filter(s=>!Ve.allConnectors.some(i=>i.id===s.id&&this.getConnectorName(i.name)===this.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&Ve.allConnectors.push(tc(s))});const t=this.getEnabledNamespaces(),n=this.getEnabledConnectors(t);Ve.connectors=this.mergeMultiChainConnectors(n)},filterByNamespaces(r){Object.keys(Ve.filterByNamespaceMap).forEach(e=>{Ve.filterByNamespaceMap[e]=!1}),r.forEach(e=>{Ve.filterByNamespaceMap[e]=!0}),this.updateConnectorsForEnabledNamespaces()},filterByNamespace(r,e){Ve.filterByNamespaceMap[r]=e,this.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const r=this.getEnabledNamespaces(),e=this.getEnabledConnectors(r),t=this.areAllNamespacesEnabled();Ve.connectors=this.mergeMultiChainConnectors(e),t?Ee.clearFilterByNamespaces():Ee.filterByNamespaces(r)},getEnabledNamespaces(){return Object.entries(Ve.filterByNamespaceMap).filter(([r,e])=>e).map(([r])=>r)},getEnabledConnectors(r){return Ve.allConnectors.filter(e=>r.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(Ve.filterByNamespaceMap).every(r=>r)},mergeMultiChainConnectors(r){const e=this.generateConnectorMapByName(r),t=[];return e.forEach(n=>{const s=n[0],i=(s==null?void 0:s.id)===ee.CONNECTOR_ID.AUTH;n.length>1&&s?t.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...n],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:(s==null?void 0:s.id)||""}):s&&t.push(s)}),t},generateConnectorMapByName(r){const e=new Map;return r.forEach(t=>{const{name:n}=t,s=this.getConnectorName(n);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===t.chain)||i.push(t),e.set(s,i)}),e},getConnectorName(r){return r&&({"Trust Wallet":"Trust"}[r]||r)},getUniqueConnectorsByName(r){const e=[];return r.forEach(t=>{e.find(n=>n.chain===t.chain)||e.push(t)}),e},addConnector(r){var e,t,n;if(r.id===ee.CONNECTOR_ID.AUTH){const s=r,i=ec(G.state),o=Cr.getSnapshot().themeMode,a=Cr.getSnapshot().themeVariables;(t=(e=s==null?void 0:s.provider)==null?void 0:e.syncDappData)==null||t.call(e,{metadata:i.metadata,sdkVersion:i.sdkVersion,projectId:i.projectId,sdkType:i.sdkType}),(n=s==null?void 0:s.provider)==null||n.syncTheme({themeMode:o,themeVariables:a,w3mThemeVariables:Pi(a,o)}),this.setConnectors([r])}else this.setConnectors([r])},getAuthConnector(r){var n;const e=r||x.state.activeChain,t=Ve.connectors.find(s=>s.id===ee.CONNECTOR_ID.AUTH);if(t)return(n=t==null?void 0:t.connectors)!=null&&n.length?t.connectors.find(i=>i.chain===e):t},getAnnouncedConnectorRdns(){return Ve.connectors.filter(r=>r.type==="ANNOUNCED").map(r=>{var e;return(e=r.info)==null?void 0:e.rdns})},getConnectorById(r){return Ve.allConnectors.find(e=>e.id===r)},getConnector(r,e){return Ve.allConnectors.filter(n=>n.chain===x.state.activeChain).find(n=>{var s;return n.explorerId===r||((s=n.info)==null?void 0:s.rdns)===e})},syncIfAuthConnector(r){var i,o;if(r.id!=="ID_AUTH")return;const e=r,t=ec(G.state),n=Cr.getSnapshot().themeMode,s=Cr.getSnapshot().themeVariables;(o=(i=e==null?void 0:e.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:t.metadata,sdkVersion:t.sdkVersion,sdkType:t.sdkType,projectId:t.projectId}),e.provider.syncTheme({themeMode:n,themeVariables:s,w3mThemeVariables:Pi(s,n)})},getConnectorsByNamespace(r){const e=Ve.allConnectors.filter(t=>t.chain===r);return this.mergeMultiChainConnectors(e)},selectWalletConnector(r){const e=Ne.getConnector(r.id,r.rdns);x.state.activeChain===ee.CHAIN.SOLANA&&qT.handleSolanaDeeplinkRedirect((e==null?void 0:e.name)||r.name||""),e?et.push("ConnectingExternal",{connector:e}):et.push("ConnectingWalletConnect",{wallet:r})},getConnectors(r){return r?this.getConnectorsByNamespace(r):this.mergeMultiChainConnectors(Ve.allConnectors)},setFilterByNamespace(r){Ve.filterByNamespace=r,Ve.connectors=this.getConnectors(r),Ee.setFilterByNamespace(r)},setConnectorId(r,e){r&&(Ve.activeConnectorIds={...Ve.activeConnectorIds,[e]:r},ie.setConnectedConnectorId(e,r))},removeConnectorId(r){Ve.activeConnectorIds={...Ve.activeConnectorIds,[r]:void 0},ie.deleteConnectedConnectorId(r)},getConnectorId(r){if(r)return Ve.activeConnectorIds[r]},isConnected(r){return r?!!Ve.activeConnectorIds[r]:Object.values(Ve.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){Ve.activeConnectorIds={...WC}}};function Uf(r,e){return Ne.getConnectorId(r)===e}function eP(r){const e=Array.from(x.state.chains.keys());let t=[];return r?(t.push([r,x.state.chains.get(r)]),Uf(r,ee.CONNECTOR_ID.WALLET_CONNECT)?e.forEach(n=>{n!==r&&Uf(n,ee.CONNECTOR_ID.WALLET_CONNECT)&&t.push([n,x.state.chains.get(n)])}):Uf(r,ee.CONNECTOR_ID.AUTH)&&e.forEach(n=>{n!==r&&Uf(n,ee.CONNECTOR_ID.AUTH)&&t.push([n,x.state.chains.get(n)])})):t=Array.from(x.state.chains.entries()),t}var Rb={exports:{}},hl=typeof Reflect=="object"?Reflect:null,eE=hl&&typeof hl.apply=="function"?hl.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},fp;hl&&typeof hl.ownKeys=="function"?fp=hl.ownKeys:Object.getOwnPropertySymbols?fp=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:fp=function(e){return Object.getOwnPropertyNames(e)};function tP(r){console&&console.warn&&console.warn(r)}var GC=Number.isNaN||function(e){return e!==e};function lt(){lt.init.call(this)}Rb.exports=lt;Rb.exports.once=iP;lt.EventEmitter=lt;lt.prototype._events=void 0;lt.prototype._eventsCount=0;lt.prototype._maxListeners=void 0;var tE=10;function Tg(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(lt,"defaultMaxListeners",{enumerable:!0,get:function(){return tE},set:function(r){if(typeof r!="number"||r<0||GC(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");tE=r}});lt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};lt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||GC(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function KC(r){return r._maxListeners===void 0?lt.defaultMaxListeners:r._maxListeners}lt.prototype.getMaxListeners=function(){return KC(this)};lt.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var s=e==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=i[e];if(c===void 0)return!1;if(typeof c=="function")eE(c,this,t);else for(var l=c.length,u=XC(c,l),n=0;n<l;++n)eE(u[n],this,t);return!0};function JC(r,e,t,n){var s,i,o;if(Tg(t),i=r._events,i===void 0?(i=r._events=Object.create(null),r._eventsCount=0):(i.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),i=r._events),o=i[e]),o===void 0)o=i[e]=t,++r._eventsCount;else if(typeof o=="function"?o=i[e]=n?[t,o]:[o,t]:n?o.unshift(t):o.push(t),s=KC(r),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=o.length,tP(a)}return r}lt.prototype.addListener=function(e,t){return JC(this,e,t,!1)};lt.prototype.on=lt.prototype.addListener;lt.prototype.prependListener=function(e,t){return JC(this,e,t,!0)};function rP(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function YC(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},s=rP.bind(n);return s.listener=t,n.wrapFn=s,s}lt.prototype.once=function(e,t){return Tg(t),this.on(e,YC(this,e,t)),this};lt.prototype.prependOnceListener=function(e,t){return Tg(t),this.prependListener(e,YC(this,e,t)),this};lt.prototype.removeListener=function(e,t){var n,s,i,o,a;if(Tg(t),s=this._events,s===void 0)return this;if(n=s[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;i===0?n.shift():nP(n,i),n.length===1&&(s[e]=n[0]),s.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};lt.prototype.off=lt.prototype.removeListener;lt.prototype.removeAllListeners=function(e){var t,n,s;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var i=Object.keys(n),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this};function QC(r,e,t){var n=r._events;if(n===void 0)return[];var s=n[e];return s===void 0?[]:typeof s=="function"?t?[s.listener||s]:[s]:t?sP(s):XC(s,s.length)}lt.prototype.listeners=function(e){return QC(this,e,!0)};lt.prototype.rawListeners=function(e){return QC(this,e,!1)};lt.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):ZC.call(r,e)};lt.prototype.listenerCount=ZC;function ZC(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}lt.prototype.eventNames=function(){return this._eventsCount>0?fp(this._events):[]};function XC(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function nP(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function sP(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function iP(r,e){return new Promise(function(t,n){function s(o){r.removeListener(e,i),n(o)}function i(){typeof r.removeListener=="function"&&r.removeListener("error",s),t([].slice.call(arguments))}e_(r,e,i,{once:!0}),e!=="error"&&oP(r,s,{once:!0})})}function oP(r,e,t){typeof r.on=="function"&&e_(r,"error",e,t)}function e_(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function s(i){n.once&&r.removeEventListener(e,s),t(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var jn=Rb.exports;const Db=Ig(jn);var X={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Jy=function(r,e){return Jy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},Jy(r,e)};function aP(r,e){Jy(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Yy=function(){return Yy=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Yy.apply(this,arguments)};function cP(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function lP(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function uP(r,e){return function(t,n){e(t,n,r)}}function dP(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function hP(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}function fP(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,s=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){t.label=l[1];break}if(l[0]===6&&t.label<i[1]){t.label=i[1],i=l;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(l);break}i[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(u){l=[6,u],s=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function pP(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function gP(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Qy(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function t_(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i}function mP(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(t_(arguments[e]));return r}function yP(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),s=0,e=0;e<t;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function Md(r){return this instanceof Md?(this.v=r,this):new Md(r)}function wP(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){n[h]&&(s[h]=function(f){return new Promise(function(g,p){i.push([h,f,g,p])>1||a(h,f)})})}function a(h,f){try{c(n[h](f))}catch(g){d(i[0][3],g)}}function c(h){h.value instanceof Md?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function bP(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:Md(r[s](o)),done:s==="return"}:i?i(o):o}:i}}function EP(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Qy=="function"?Qy(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(a,c){o=r[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function vP(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function AP(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function CP(r){return r&&r.__esModule?r:{default:r}}function _P(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function NP(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const IP=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Yy},__asyncDelegator:bP,__asyncGenerator:wP,__asyncValues:EP,__await:Md,__awaiter:hP,__classPrivateFieldGet:_P,__classPrivateFieldSet:NP,__createBinding:pP,__decorate:lP,__exportStar:gP,__extends:aP,__generator:fP,__importDefault:CP,__importStar:AP,__makeTemplateObject:vP,__metadata:dP,__param:uP,__read:t_,__rest:cP,__spread:mP,__spreadArrays:yP,__values:Qy},Symbol.toStringTag,{value:"Module"})),Pg=$C(IP);var Rm={},Zu={},rE;function SP(){if(rE)return Zu;rE=1,Object.defineProperty(Zu,"__esModule",{value:!0}),Zu.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return Zu.delay=r,Zu}var Ko={},Dm={},Jo={},nE;function xP(){return nE||(nE=1,Object.defineProperty(Jo,"__esModule",{value:!0}),Jo.ONE_THOUSAND=Jo.ONE_HUNDRED=void 0,Jo.ONE_HUNDRED=100,Jo.ONE_THOUSAND=1e3),Jo}var km={},sE;function TP(){return sE||(sE=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(km)),km}var iE;function r_(){return iE||(iE=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Pg;e.__exportStar(xP(),r),e.__exportStar(TP(),r)}(Dm)),Dm}var oE;function PP(){if(oE)return Ko;oE=1,Object.defineProperty(Ko,"__esModule",{value:!0}),Ko.fromMiliseconds=Ko.toMiliseconds=void 0;const r=r_();function e(n){return n*r.ONE_THOUSAND}Ko.toMiliseconds=e;function t(n){return Math.floor(n/r.ONE_THOUSAND)}return Ko.fromMiliseconds=t,Ko}var aE;function OP(){return aE||(aE=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Pg;e.__exportStar(SP(),r),e.__exportStar(PP(),r)}(Rm)),Rm}var Sc={},cE;function RP(){if(cE)return Sc;cE=1,Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const n=this.get(t);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const s=Date.now()-n.started;this.timestamps.set(t,{started:n.started,elapsed:s})}get(t){const n=this.timestamps.get(t);if(typeof n>"u")throw new Error(`No timestamp found for label: ${t}`);return n}elapsed(t){const n=this.get(t);return n.elapsed||Date.now()-n.started}}return Sc.Watch=r,Sc.default=r,Sc}var Um={},Xu={},lE;function DP(){if(lE)return Xu;lE=1,Object.defineProperty(Xu,"__esModule",{value:!0}),Xu.IWatch=void 0;class r{}return Xu.IWatch=r,Xu}var uE;function kP(){return uE||(uE=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Pg.__exportStar(DP(),r)}(Um)),Um}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Pg;e.__exportStar(OP(),r),e.__exportStar(RP(),r),e.__exportStar(kP(),r),e.__exportStar(r_(),r)})(X);class wc{}let UP=class extends wc{constructor(e){super()}};const dE=X.FIVE_SECONDS,Uu={pulse:"heartbeat_pulse"};let BP=class n_ extends UP{constructor(e){super(e),this.events=new jn.EventEmitter,this.interval=dE,this.interval=(e==null?void 0:e.interval)||dE}static async init(e){const t=new n_(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),X.toMiliseconds(this.interval))}pulse(){this.events.emit(Uu.pulse)}};const LP=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,$P=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,MP=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function FP(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){jP(r);return}return e}function jP(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function Bf(r,e={}){if(typeof r!="string")return r;if(r[0]==='"'&&r[r.length-1]==='"'&&r.indexOf("\\")===-1)return r.slice(1,-1);const t=r.trim();if(t.length<=9)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!MP.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(LP.test(r)||$P.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,FP)}return JSON.parse(r)}catch(n){if(e.strict)throw n;return r}}function HP(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function Kt(r,...e){try{return HP(r(...e))}catch(t){return Promise.reject(t)}}function zP(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function qP(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function pp(r){if(zP(r))return String(r);if(qP(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return pp(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Zy="base64:";function VP(r){return typeof r=="string"?r:Zy+KP(r)}function WP(r){return typeof r!="string"||!r.startsWith(Zy)?r:GP(r.slice(Zy.length))}function GP(r){return globalThis.Buffer?Buffer.from(r,"base64"):Uint8Array.from(globalThis.atob(r),e=>e.codePointAt(0))}function KP(r){return globalThis.Buffer?Buffer.from(r).toString("base64"):globalThis.btoa(String.fromCodePoint(...r))}function Vr(r){var e;return r&&((e=r.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function JP(...r){return Vr(r.join(":"))}function Lf(r){return r=Vr(r),r?r+":":""}function YP(r,e){if(e===void 0)return!0;let t=0,n=r.indexOf(":");for(;n>-1;)t++,n=r.indexOf(":",n+1);return t<=e}function QP(r,e){return e?r.startsWith(e)&&r[r.length-1]!=="$":r[r.length-1]!=="$"}const ZP="memory",XP=()=>{const r=new Map;return{name:ZP,getInstance:()=>r,hasItem(e){return r.has(e)},getItem(e){return r.get(e)??null},getItemRaw(e){return r.get(e)??null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return[...r.keys()]},clear(){r.clear()},dispose(){r.clear()}}};function eO(r={}){const e={mounts:{"":r.driver||XP()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},n=(l,u)=>e.mountpoints.filter(d=>d.startsWith(l)||u&&l.startsWith(d)).map(d=>({relativeBase:l.length>d.length?l.slice(d.length):void 0,mountpoint:d,driver:e.mounts[d]})),s=(l,u)=>{if(e.watching){u=Vr(u);for(const d of e.watchListeners)d(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await hE(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,d)=>{const h=new Map,f=g=>{let p=h.get(g.base);return p||(p={driver:g.driver,base:g.base,items:[]},h.set(g.base,p)),p};for(const g of l){const p=typeof g=="string",m=Vr(p?g:g.key),w=p?void 0:g.value,A=p||!g.options?u:{...u,...g.options},v=t(m);f(v).items.push({key:m,value:w,relativeKey:v.relativeKey,options:A})}return Promise.all([...h.values()].map(g=>d(g))).then(g=>g.flat())},c={hasItem(l,u={}){l=Vr(l);const{relativeKey:d,driver:h}=t(l);return Kt(h.hasItem,d,u)},getItem(l,u={}){l=Vr(l);const{relativeKey:d,driver:h}=t(l);return Kt(h.getItem,d,u).then(f=>Bf(f))},getItems(l,u={}){return a(l,u,d=>d.driver.getItems?Kt(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),u).then(h=>h.map(f=>({key:JP(d.base,f.key),value:Bf(f.value)}))):Promise.all(d.items.map(h=>Kt(d.driver.getItem,h.relativeKey,h.options).then(f=>({key:h.key,value:Bf(f)})))))},getItemRaw(l,u={}){l=Vr(l);const{relativeKey:d,driver:h}=t(l);return h.getItemRaw?Kt(h.getItemRaw,d,u):Kt(h.getItem,d,u).then(f=>WP(f))},async setItem(l,u,d={}){if(u===void 0)return c.removeItem(l);l=Vr(l);const{relativeKey:h,driver:f}=t(l);f.setItem&&(await Kt(f.setItem,h,pp(u),d),f.watch||s("update",l))},async setItems(l,u){await a(l,u,async d=>{if(d.driver.setItems)return Kt(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:pp(h.value),options:h.options})),u);d.driver.setItem&&await Promise.all(d.items.map(h=>Kt(d.driver.setItem,h.relativeKey,pp(h.value),h.options)))})},async setItemRaw(l,u,d={}){if(u===void 0)return c.removeItem(l,d);l=Vr(l);const{relativeKey:h,driver:f}=t(l);if(f.setItemRaw)await Kt(f.setItemRaw,h,u,d);else if(f.setItem)await Kt(f.setItem,h,VP(u),d);else return;f.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=Vr(l);const{relativeKey:d,driver:h}=t(l);h.removeItem&&(await Kt(h.removeItem,d,u),(u.removeMeta||u.removeMata)&&await Kt(h.removeItem,d+"$",u),h.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=Vr(l);const{relativeKey:d,driver:h}=t(l),f=Object.create(null);if(h.getMeta&&Object.assign(f,await Kt(h.getMeta,d,u)),!u.nativeOnly){const g=await Kt(h.getItem,d+"$",u).then(p=>Bf(p));g&&typeof g=="object"&&(typeof g.atime=="string"&&(g.atime=new Date(g.atime)),typeof g.mtime=="string"&&(g.mtime=new Date(g.mtime)),Object.assign(f,g))}return f},setMeta(l,u,d={}){return this.setItem(l+"$",u,d)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){var m;l=Lf(l);const d=n(l,!0);let h=[];const f=[];let g=!0;for(const w of d){(m=w.driver.flags)!=null&&m.maxDepth||(g=!1);const A=await Kt(w.driver.getKeys,w.relativeBase,u);for(const v of A){const I=w.mountpoint+Vr(v);h.some(T=>I.startsWith(T))||f.push(I)}h=[w.mountpoint,...h.filter(v=>!v.startsWith(w.mountpoint))]}const p=u.maxDepth!==void 0&&!g;return f.filter(w=>(!p||YP(w,u.maxDepth))&&QP(w,l))},async clear(l,u={}){l=Lf(l),await Promise.all(n(l,!1).map(async d=>{if(d.driver.clear)return Kt(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(h.map(f=>d.driver.removeItem(f,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>fE(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=Lf(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((d,h)=>h.length-d.length)),e.mounts[l]=u,e.watching&&Promise.resolve(hE(u,s,l)).then(d=>{e.unwatch[l]=d}).catch(console.error),c},async unmount(l,u=!0){var d,h;l=Lf(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&((h=(d=e.unwatch)[l])==null||h.call(d),delete e.unwatch[l]),u&&await fE(e.mounts[l]),e.mountpoints=e.mountpoints.filter(f=>f!==l),delete e.mounts[l])},getMount(l=""){l=Vr(l)+":";const u=t(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=Vr(l),n(l,u.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,d={})=>c.setItem(l,u,d),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function hE(r,e,t){return r.watch?r.watch((n,s)=>e(n,t+s)):()=>{}}async function fE(r){typeof r.dispose=="function"&&await Kt(r.dispose)}function bc(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function s_(r,e){let t;const n=()=>{if(t)return t;const s=indexedDB.open(r);return s.onupgradeneeded=()=>s.result.createObjectStore(e),t=bc(s),t.then(i=>{i.onclose=()=>t=void 0},()=>{}),t};return(s,i)=>n().then(o=>i(o.transaction(e,s).objectStore(e)))}let Bm;function tf(){return Bm||(Bm=s_("keyval-store","keyval")),Bm}function pE(r,e=tf()){return e("readonly",t=>bc(t.get(r)))}function tO(r,e,t=tf()){return t("readwrite",n=>(n.put(e,r),bc(n.transaction)))}function rO(r,e=tf()){return e("readwrite",t=>(t.delete(r),bc(t.transaction)))}function nO(r=tf()){return r("readwrite",e=>(e.clear(),bc(e.transaction)))}function sO(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},bc(r.transaction)}function iO(r=tf()){return r("readonly",e=>{if(e.getAllKeys)return bc(e.getAllKeys());const t=[];return sO(e,n=>t.push(n.key)).then(()=>t)})}const oO=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),aO=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=r.replace(e,'$1"$2n"$3');return JSON.parse(t,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function rc(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return aO(r)}catch{return r}}function $i(r){return typeof r=="string"?r:oO(r)||""}const cO="idb-keyval";var lO=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=s=>e+s;let n;return r.dbName&&r.storeName&&(n=s_(r.dbName,r.storeName)),{name:cO,options:r,async hasItem(s){return!(typeof await pE(t(s),n)>"u")},async getItem(s){return await pE(t(s),n)??null},setItem(s,i){return tO(t(s),i,n)},removeItem(s){return rO(t(s),n)},getKeys(){return iO(n)},clear(){return nO(n)}}};const uO="WALLET_CONNECT_V2_INDEXED_DB",dO="keyvaluestorage";let hO=class{constructor(){this.indexedDb=eO({driver:lO({dbName:uO,storeName:dO})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,$i(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Lm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},gp={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,n){this[t]=String(n)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Lm<"u"&&Lm.localStorage?gp.exports=Lm.localStorage:typeof window<"u"&&window.localStorage?gp.exports=window.localStorage:gp.exports=new e})();function fO(r){var e;return[r[0],rc((e=r[1])!=null?e:"")]}let pO=class{constructor(){this.localStorage=gp.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(fO)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return rc(t)}async setItem(e,t){this.localStorage.setItem(e,$i(t))}async removeItem(e){this.localStorage.removeItem(e)}};const gO="wc_storage_version",gE=1,mO=async(r,e,t)=>{const n=gO,s=await e.getItem(n);if(s&&s>=gE){t(e);return}const i=await r.getKeys();if(!i.length){t(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await r.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(n,gE),t(e),yO(r,o)},yO=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};let wO=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new pO;this.storage=e;try{const t=new hO;mO(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};function bO(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}var EO=vO;function vO(r,e,t){var n=t&&t.stringify||bO,s=1;if(typeof r=="object"&&r!==null){var i=e.length+s;if(i===1)return r;var o=new Array(i);o[0]=n(r);for(var a=1;a<i;a++)o[a]=n(e[a]);return o.join(" ")}if(typeof r!="string")return r;var c=e.length;if(c===0)return r;for(var l="",u=1-s,d=-1,h=r&&r.length||0,f=0;f<h;){if(r.charCodeAt(f)===37&&f+1<h){switch(d=d>-1?d:0,r.charCodeAt(f+1)){case 100:case 102:if(u>=c||e[u]==null)break;d<f&&(l+=r.slice(d,f)),l+=Number(e[u]),d=f+2,f++;break;case 105:if(u>=c||e[u]==null)break;d<f&&(l+=r.slice(d,f)),l+=Math.floor(Number(e[u])),d=f+2,f++;break;case 79:case 111:case 106:if(u>=c||e[u]===void 0)break;d<f&&(l+=r.slice(d,f));var g=typeof e[u];if(g==="string"){l+="'"+e[u]+"'",d=f+2,f++;break}if(g==="function"){l+=e[u].name||"<anonymous>",d=f+2,f++;break}l+=n(e[u]),d=f+2,f++;break;case 115:if(u>=c)break;d<f&&(l+=r.slice(d,f)),l+=String(e[u]),d=f+2,f++;break;case 37:d<f&&(l+=r.slice(d,f)),l+="%",d=f+2,f++,u--;break}++u}++f}return d===-1?r:(d<h&&(l+=r.slice(d)),l)}const mE=EO;var Qc=qs;const Fd=OO().console||{},AO={mapHttpRequest:$f,mapHttpResponse:$f,wrapRequestSerializer:$m,wrapResponseSerializer:$m,wrapErrorSerializer:$m,req:$f,res:$f,err:SO};function CO(r,e){return Array.isArray(r)?r.filter(function(n){return n!=="!stdSerializers.err"}):r===!0?Object.keys(e):!1}function qs(r){r=r||{},r.browser=r.browser||{};const e=r.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=r.browser.write||Fd;r.browser.write&&(r.browser.asObject=!0);const n=r.serializers||{},s=CO(r.browser.serialize,n);let i=r.browser.serialize;Array.isArray(r.browser.serialize)&&r.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);const o=["error","fatal","warn","info","debug","trace"];typeof t=="function"&&(t.error=t.fatal=t.warn=t.info=t.debug=t.trace=t),r.enabled===!1&&(r.level="silent");const a=r.level||"info",c=Object.create(t);c.log||(c.log=jd),Object.defineProperty(c,"levelVal",{get:u}),Object.defineProperty(c,"level",{get:d,set:h});const l={transmit:e,serialize:s,asObject:r.browser.asObject,levels:o,timestamp:xO(r)};c.levels=qs.levels,c.level=a,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=jd,c.serializers=n,c._serialize=s,c._stdErrSerialize=i,c.child=f,e&&(c._logEvent=Xy());function u(){return this.level==="silent"?1/0:this.levels.values[this.level]}function d(){return this._level}function h(g){if(g!=="silent"&&!this.levels.values[g])throw Error("unknown level "+g);this._level=g,xc(l,c,"error","log"),xc(l,c,"fatal","error"),xc(l,c,"warn","error"),xc(l,c,"info","log"),xc(l,c,"debug","log"),xc(l,c,"trace","log")}function f(g,p){if(!g)throw new Error("missing bindings for child Pino");p=p||{},s&&g.serializers&&(p.serializers=g.serializers);const m=p.serializers;if(s&&m){var w=Object.assign({},n,m),A=r.browser.serialize===!0?Object.keys(w):s;delete g.serializers,Og([g],A,w,this._stdErrSerialize)}function v(I){this._childLevel=(I._childLevel|0)+1,this.error=Tc(I,g,"error"),this.fatal=Tc(I,g,"fatal"),this.warn=Tc(I,g,"warn"),this.info=Tc(I,g,"info"),this.debug=Tc(I,g,"debug"),this.trace=Tc(I,g,"trace"),w&&(this.serializers=w,this._serialize=A),e&&(this._logEvent=Xy([].concat(I._logEvent.bindings,g)))}return v.prototype=this,new v(this)}return c}qs.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};qs.stdSerializers=AO;qs.stdTimeFunctions=Object.assign({},{nullTime:i_,epochTime:o_,unixTime:TO,isoTime:PO});function xc(r,e,t,n){const s=Object.getPrototypeOf(e);e[t]=e.levelVal>e.levels.values[t]?jd:s[t]?s[t]:Fd[t]||Fd[n]||jd,_O(r,e,t)}function _O(r,e,t){!r.transmit&&e[t]===jd||(e[t]=function(n){return function(){const i=r.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Fd?Fd:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];if(r.serialize&&!r.asObject&&Og(o,this._serialize,this.serializers,this._stdErrSerialize),r.asObject?n.call(a,NO(this,t,o,i)):n.apply(a,o),r.transmit){const l=r.transmit.level||e.level,u=qs.levels.values[l],d=qs.levels.values[t];if(d<u)return;IO(this,{ts:i,methodLevel:t,methodValue:d,transmitValue:qs.levels.values[r.transmit.level||e.level],send:r.transmit.send,val:e.levelVal},o)}}}(e[t]))}function NO(r,e,t,n){r._serialize&&Og(t,r._serialize,r.serializers,r._stdErrSerialize);const s=t.slice();let i=s[0];const o={};n&&(o.time=n),o.level=qs.levels.values[e];let a=(r._childLevel|0)+1;if(a<1&&(a=1),i!==null&&typeof i=="object"){for(;a--&&typeof s[0]=="object";)Object.assign(o,s.shift());i=s.length?mE(s.shift(),s):void 0}else typeof i=="string"&&(i=mE(s.shift(),s));return i!==void 0&&(o.msg=i),o}function Og(r,e,t,n){for(const s in r)if(n&&r[s]instanceof Error)r[s]=qs.stdSerializers.err(r[s]);else if(typeof r[s]=="object"&&!Array.isArray(r[s]))for(const i in r[s])e&&e.indexOf(i)>-1&&i in t&&(r[s][i]=t[i](r[s][i]))}function Tc(r,e,t){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var s=1;s<n.length;s++)n[s]=arguments[s-1];return r[t].apply(this,n)}}function IO(r,e,t){const n=e.send,s=e.ts,i=e.methodLevel,o=e.methodValue,a=e.val,c=r._logEvent.bindings;Og(t,r._serialize||Object.keys(r.serializers),r.serializers,r._stdErrSerialize===void 0?!0:r._stdErrSerialize),r._logEvent.ts=s,r._logEvent.messages=t.filter(function(l){return c.indexOf(l)===-1}),r._logEvent.level.label=i,r._logEvent.level.value=o,n(i,r._logEvent,a),r._logEvent=Xy(c)}function Xy(r){return{ts:0,messages:[],bindings:r||[],level:{label:"",value:0}}}function SO(r){const e={type:r.constructor.name,msg:r.message,stack:r.stack};for(const t in r)e[t]===void 0&&(e[t]=r[t]);return e}function xO(r){return typeof r.timestamp=="function"?r.timestamp:r.timestamp===!1?i_:o_}function $f(){return{}}function $m(r){return r}function jd(){}function i_(){return!1}function o_(){return Date.now()}function TO(){return Math.round(Date.now()/1e3)}function PO(){return new Date(Date.now()).toISOString()}function OO(){function r(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return r(self)||r(window)||r(this)||{}}}const rf=Ig(Qc),RO={level:"info"},nf="custom_context",kb=1e3*1024;let DO=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},yE=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new DO(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}},a_=class{constructor(e,t=kb){this.level=e??"error",this.levelValue=Qc.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new yE(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===Qc.levels.values.error?console.error(e):t===Qc.levels.values.warn?console.warn(e):t===Qc.levels.values.debug?console.debug(e):t===Qc.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append($i({timestamp:new Date().toISOString(),log:e}));const t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new yE(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push($i({extraMetadata:e})),new Blob(t,{type:"application/json"})}},kO=class{constructor(e,t=kb){this.baseChunkLogger=new a_(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=t,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}},UO=class{constructor(e,t=kb){this.baseChunkLogger=new a_(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var BO=Object.defineProperty,LO=Object.defineProperties,$O=Object.getOwnPropertyDescriptors,wE=Object.getOwnPropertySymbols,MO=Object.prototype.hasOwnProperty,FO=Object.prototype.propertyIsEnumerable,bE=(r,e,t)=>e in r?BO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Mp=(r,e)=>{for(var t in e||(e={}))MO.call(e,t)&&bE(r,t,e[t]);if(wE)for(var t of wE(e))FO.call(e,t)&&bE(r,t,e[t]);return r},Fp=(r,e)=>LO(r,$O(e));function Bu(r){return Fp(Mp({},r),{level:(r==null?void 0:r.level)||RO.level})}function jO(r,e=nf){return r[e]||""}function HO(r,e,t=nf){return r[t]=e,r}function rn(r,e=nf){let t="";return typeof r.bindings>"u"?t=jO(r,e):t=r.bindings().context||"",t}function zO(r,e,t=nf){const n=rn(r,t);return n.trim()?`${n}/${e}`:e}function Sr(r,e,t=nf){const n=zO(r,e,t),s=r.child({context:n});return HO(s,n,t)}function qO(r){var e,t;const n=new kO((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:rf(Fp(Mp({},r.opts),{level:"trace",browser:Fp(Mp({},(t=r.opts)==null?void 0:t.browser),{write:s=>n.write(s)})})),chunkLoggerController:n}}function VO(r){var e;const t=new UO((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:rf(Fp(Mp({},r.opts),{level:"trace"}),t),chunkLoggerController:t}}function Ub(r){return typeof r.loggerOverride<"u"&&typeof r.loggerOverride!="string"?{logger:r.loggerOverride,chunkLoggerController:null}:typeof window<"u"?qO(r):VO(r)}var WO=Object.defineProperty,GO=(r,e,t)=>e in r?WO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,EE=(r,e,t)=>GO(r,typeof e!="symbol"?e+"":e,t);let KO=class extends wc{constructor(e){super(),this.opts=e,EE(this,"protocol","wc"),EE(this,"version",2)}};var JO=Object.defineProperty,YO=(r,e,t)=>e in r?JO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,QO=(r,e,t)=>YO(r,e+"",t);let ZO=class extends wc{constructor(e,t){super(),this.core=e,this.logger=t,QO(this,"records",new Map)}},XO=class{constructor(e,t){this.logger=e,this.core=t}},e2=class extends wc{constructor(e,t){super(),this.relayer=e,this.logger=t}},t2=class extends wc{constructor(e){super()}},r2=class{constructor(e,t,n,s){this.core=e,this.logger=t,this.name=n}},n2=class extends wc{constructor(e,t){super(),this.relayer=e,this.logger=t}},s2=class extends wc{constructor(e,t){super(),this.core=e,this.logger=t}},i2=class{constructor(e,t,n){this.core=e,this.logger=t,this.store=n}},o2=class{constructor(e,t){this.projectId=e,this.logger=t}},a2=class{constructor(e,t,n){this.core=e,this.logger=t,this.telemetryEnabled=n}};var c2=Object.defineProperty,l2=(r,e,t)=>e in r?c2(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,vE=(r,e,t)=>l2(r,typeof e!="symbol"?e+"":e,t);let u2=class{constructor(e){this.opts=e,vE(this,"protocol","wc"),vE(this,"version",2)}},d2=class{constructor(e){this.client=e}};function h2(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function c_(r,...e){if(!h2(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function AE(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function f2(r,e){c_(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Pc=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Mm=r=>new DataView(r.buffer,r.byteOffset,r.byteLength);function p2(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function l_(r){return typeof r=="string"&&(r=p2(r)),c_(r),r}let g2=class{clone(){return this._cloneInto()}};function m2(r){const e=n=>r().update(l_(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function u_(r=32){if(Pc&&typeof Pc.getRandomValues=="function")return Pc.getRandomValues(new Uint8Array(r));if(Pc&&typeof Pc.randomBytes=="function")return Pc.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}function y2(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}let w2=class extends g2{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Mm(this.buffer)}update(e){AE(this);const{view:t,buffer:n,blockLen:s}=this;e=l_(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Mm(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){AE(this),f2(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)t[d]=0;y2(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Mm(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}};const Mf=BigInt(2**32-1),ew=BigInt(32);function d_(r,e=!1){return e?{h:Number(r&Mf),l:Number(r>>ew&Mf)}:{h:Number(r>>ew&Mf)|0,l:Number(r&Mf)|0}}function b2(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=d_(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const E2=(r,e)=>BigInt(r>>>0)<<ew|BigInt(e>>>0),v2=(r,e,t)=>r>>>t,A2=(r,e,t)=>r<<32-t|e>>>t,C2=(r,e,t)=>r>>>t|e<<32-t,_2=(r,e,t)=>r<<32-t|e>>>t,N2=(r,e,t)=>r<<64-t|e>>>t-32,I2=(r,e,t)=>r>>>t-32|e<<64-t,S2=(r,e)=>e,x2=(r,e)=>r,T2=(r,e,t)=>r<<t|e>>>32-t,P2=(r,e,t)=>e<<t|r>>>32-t,O2=(r,e,t)=>e<<t-32|r>>>64-t,R2=(r,e,t)=>r<<t-32|e>>>64-t;function D2(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const k2=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),U2=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,B2=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),L2=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,$2=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),M2=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,ke={fromBig:d_,split:b2,toBig:E2,shrSH:v2,shrSL:A2,rotrSH:C2,rotrSL:_2,rotrBH:N2,rotrBL:I2,rotr32H:S2,rotr32L:x2,rotlSH:T2,rotlSL:P2,rotlBH:O2,rotlBL:R2,add:D2,add3L:k2,add3H:U2,add4L:B2,add4H:L2,add5H:M2,add5L:$2},[F2,j2]=ke.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Yi=new Uint32Array(80),Qi=new Uint32Array(80);let H2=class extends w2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:g,Hh:p,Hl:m}=this;return[e,t,n,s,i,o,a,c,l,u,d,h,f,g,p,m]}set(e,t,n,s,i,o,a,c,l,u,d,h,f,g,p,m){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=g|0,this.Hh=p|0,this.Hl=m|0}process(e,t){for(let v=0;v<16;v++,t+=4)Yi[v]=e.getUint32(t),Qi[v]=e.getUint32(t+=4);for(let v=16;v<80;v++){const I=Yi[v-15]|0,T=Qi[v-15]|0,P=ke.rotrSH(I,T,1)^ke.rotrSH(I,T,8)^ke.shrSH(I,T,7),D=ke.rotrSL(I,T,1)^ke.rotrSL(I,T,8)^ke.shrSL(I,T,7),U=Yi[v-2]|0,S=Qi[v-2]|0,H=ke.rotrSH(U,S,19)^ke.rotrBH(U,S,61)^ke.shrSH(U,S,6),L=ke.rotrSL(U,S,19)^ke.rotrBL(U,S,61)^ke.shrSL(U,S,6),j=ke.add4L(D,L,Qi[v-7],Qi[v-16]),Q=ke.add4H(j,P,H,Yi[v-7],Yi[v-16]);Yi[v]=Q|0,Qi[v]=j|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:g,Gh:p,Gl:m,Hh:w,Hl:A}=this;for(let v=0;v<80;v++){const I=ke.rotrSH(d,h,14)^ke.rotrSH(d,h,18)^ke.rotrBH(d,h,41),T=ke.rotrSL(d,h,14)^ke.rotrSL(d,h,18)^ke.rotrBL(d,h,41),P=d&f^~d&p,D=h&g^~h&m,U=ke.add5L(A,T,D,j2[v],Qi[v]),S=ke.add5H(U,w,I,P,F2[v],Yi[v]),H=U|0,L=ke.rotrSH(n,s,28)^ke.rotrBH(n,s,34)^ke.rotrBH(n,s,39),j=ke.rotrSL(n,s,28)^ke.rotrBL(n,s,34)^ke.rotrBL(n,s,39),Q=n&i^n&a^i&a,z=s&o^s&c^o&c;w=p|0,A=m|0,p=f|0,m=g|0,f=d|0,g=h|0,{h:d,l:h}=ke.add(l|0,u|0,S|0,H|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const b=ke.add3L(H,j,z);n=ke.add3H(b,S,L,Q),s=b|0}({h:n,l:s}=ke.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=ke.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=ke.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=ke.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=ke.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:g}=ke.add(this.Fh|0,this.Fl|0,f|0,g|0),{h:p,l:m}=ke.add(this.Gh|0,this.Gl|0,p|0,m|0),{h:w,l:A}=ke.add(this.Hh|0,this.Hl|0,w|0,A|0),this.set(n,s,i,o,a,c,l,u,d,h,f,g,p,m,w,A)}roundClean(){Yi.fill(0),Qi.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const z2=m2(()=>new H2);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Bb=BigInt(0),h_=BigInt(1),q2=BigInt(2);function Lb(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function $b(r){if(!Lb(r))throw new Error("Uint8Array expected")}function Fm(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const V2=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Mb(r){$b(r);let e="";for(let t=0;t<r.length;t++)e+=V2[r[t]];return e}function f_(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?Bb:BigInt("0x"+r)}const ni={_0:48,_9:57,A:65,F:70,a:97,f:102};function CE(r){if(r>=ni._0&&r<=ni._9)return r-ni._0;if(r>=ni.A&&r<=ni.F)return r-(ni.A-10);if(r>=ni.a&&r<=ni.f)return r-(ni.a-10)}function p_(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=CE(r.charCodeAt(i)),a=CE(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function W2(r){return f_(Mb(r))}function mp(r){return $b(r),f_(Mb(Uint8Array.from(r).reverse()))}function g_(r,e){return p_(r.toString(16).padStart(e*2,"0"))}function tw(r,e){return g_(r,e).reverse()}function si(r,e,t){let n;if(typeof e=="string")try{n=p_(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(Lb(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function _E(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];$b(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}const jm=r=>typeof r=="bigint"&&Bb<=r;function G2(r,e,t){return jm(r)&&jm(e)&&jm(t)&&e<=r&&r<t}function ed(r,e,t,n){if(!G2(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function K2(r){let e;for(e=0;r>Bb;r>>=h_,e+=1);return e}const J2=r=>(q2<<BigInt(r-1))-h_,Y2={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Lb(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Fb(r,e,t={}){const n=(s,i,o)=>{const a=Y2[i];if(typeof a!="function")throw new Error("invalid validator function");const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}function NE(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}const er=BigInt(0),kt=BigInt(1),aa=BigInt(2),Q2=BigInt(3),rw=BigInt(4),IE=BigInt(5),SE=BigInt(8);function Vt(r,e){const t=r%e;return t>=er?t:e+t}function Z2(r,e,t){if(e<er)throw new Error("invalid exponent, negatives unsupported");if(t<=er)throw new Error("invalid modulus");if(t===kt)return er;let n=kt;for(;e>er;)e&kt&&(n=n*r%t),r=r*r%t,e>>=kt;return n}function bs(r,e,t){let n=r;for(;e-- >er;)n*=n,n%=t;return n}function xE(r,e){if(r===er)throw new Error("invert: expected non-zero number");if(e<=er)throw new Error("invert: expected positive modulus, got "+e);let t=Vt(r,e),n=e,s=er,i=kt;for(;t!==er;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==kt)throw new Error("invert: does not exist");return Vt(s,e)}function X2(r){const e=(r-kt)/aa;let t,n,s;for(t=r-kt,n=0;t%aa===er;t/=aa,n++);for(s=aa;s<r&&Z2(s,e,r)!==r-kt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(r+kt)/rw;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(t+kt)/aa;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,l=o.pow(o.mul(o.ONE,s),t),u=o.pow(a,i),d=o.pow(a,t);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let g=o.sqr(d);h<c&&!o.eql(g,o.ONE);h++)g=o.sqr(g);const f=o.pow(l,kt<<BigInt(c-h-1));l=o.sqr(f),u=o.mul(u,f),d=o.mul(d,l),c=h}return u}}function eR(r){if(r%rw===Q2){const e=(r+kt)/rw;return function(t,n){const s=t.pow(n,e);if(!t.eql(t.sqr(s),n))throw new Error("Cannot find square root");return s}}if(r%SE===IE){const e=(r-IE)/SE;return function(t,n){const s=t.mul(n,aa),i=t.pow(s,e),o=t.mul(n,i),a=t.mul(t.mul(o,aa),i),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return X2(r)}const tR=(r,e)=>(Vt(r,e)&kt)===kt,rR=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function nR(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=rR.reduce((n,s)=>(n[s]="function",n),e);return Fb(r,t)}function sR(r,e,t){if(t<er)throw new Error("invalid exponent, negatives unsupported");if(t===er)return r.ONE;if(t===kt)return e;let n=r.ONE,s=e;for(;t>er;)t&kt&&(n=r.mul(n,s)),s=r.sqr(s),t>>=kt;return n}function iR(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function m_(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function y_(r,e,t=!1,n={}){if(r<=er)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:i}=m_(r,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:s,BYTES:i,MASK:J2(s),ZERO:er,ONE:kt,create:c=>Vt(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return er<=c&&c<r},is0:c=>c===er,isOdd:c=>(c&kt)===kt,neg:c=>Vt(-c,r),eql:(c,l)=>c===l,sqr:c=>Vt(c*c,r),add:(c,l)=>Vt(c+l,r),sub:(c,l)=>Vt(c-l,r),mul:(c,l)=>Vt(c*l,r),pow:(c,l)=>sR(a,c,l),div:(c,l)=>Vt(c*xE(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>xE(c,r),sqrt:n.sqrt||(c=>(o||(o=eR(r)),o(a,c))),invertBatch:c=>iR(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?tw(c,i):g_(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?mp(c):W2(c)}});return Object.freeze(a)}const TE=BigInt(0),Ff=BigInt(1);function Hm(r,e){const t=e.negate();return r?t:e}function w_(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function zm(r,e){w_(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function oR(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function aR(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const qm=new WeakMap,b_=new WeakMap;function Vm(r){return b_.get(r)||1}function cR(r,e){return{constTimeNegate:Hm,hasPrecomputes(t){return Vm(t)!==1},unsafeLadder(t,n,s=r.ZERO){let i=t;for(;n>TE;)n&Ff&&(s=s.add(i)),i=i.double(),n>>=Ff;return s},precomputeWindow(t,n){const{windows:s,windowSize:i}=zm(n,e),o=[];let a=t,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,s){const{windows:i,windowSize:o}=zm(t,e);let a=r.ZERO,c=r.BASE;const l=BigInt(2**t-1),u=2**t,d=BigInt(t);for(let h=0;h<i;h++){const f=h*o;let g=Number(s&l);s>>=d,g>o&&(g-=u,s+=Ff);const p=f,m=f+Math.abs(g)-1,w=h%2!==0,A=g<0;g===0?c=c.add(Hm(w,n[p])):a=a.add(Hm(A,n[m]))}return{p:a,f:c}},wNAFUnsafe(t,n,s,i=r.ZERO){const{windows:o,windowSize:a}=zm(t,e),c=BigInt(2**t-1),l=2**t,u=BigInt(t);for(let d=0;d<o;d++){const h=d*a;if(s===TE)break;let f=Number(s&c);if(s>>=u,f>a&&(f-=l,s+=Ff),f===0)continue;let g=n[h+Math.abs(f)-1];f<0&&(g=g.negate()),i=i.add(g)}return i},getPrecomputes(t,n,s){let i=qm.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&qm.set(n,s(i))),i},wNAFCached(t,n,s){const i=Vm(t);return this.wNAF(i,this.getPrecomputes(i,t,s),n)},wNAFCachedUnsafe(t,n,s,i){const o=Vm(t);return o===1?this.unsafeLadder(t,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),n,i)},setWindowSize(t,n){w_(n,e),b_.set(t,n),qm.delete(t)}}}function lR(r,e,t,n){if(oR(t,r),aR(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=r.ZERO,i=K2(BigInt(t.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let f=0;f<n.length;f++){const g=n[f],p=Number(g>>BigInt(d)&BigInt(a));c[p]=c[p].add(t[f])}let h=s;for(let f=c.length-1,g=s;f>0;f--)g=g.add(c[f]),h=h.add(g);if(u=u.add(h),d!==0)for(let f=0;f<o;f++)u=u.double()}return u}function uR(r){return nR(r.Fp),Fb(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...m_(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}const Gn=BigInt(0),jr=BigInt(1),jf=BigInt(2),dR=BigInt(8),hR={zip215:!0};function fR(r){const e=uR(r);return Fb(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function pR(r){const e=fR(r),{Fp:t,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=jf<<BigInt(a*8)-jr,u=t.create,d=y_(e.n,e.nBitLength),h=e.uvRatio||((b,E)=>{try{return{isValid:!0,value:t.sqrt(b*t.inv(E))}}catch{return{isValid:!1,value:Gn}}}),f=e.adjustScalarBytes||(b=>b),g=e.domain||((b,E,O)=>{if(Fm("phflag",O),E.length||O)throw new Error("Contexts/pre-hash are not supported");return b});function p(b,E){ed("coordinate "+b,E,Gn,l)}function m(b){if(!(b instanceof v))throw new Error("ExtendedPoint expected")}const w=NE((b,E)=>{const{ex:O,ey:B,ez:k}=b,F=b.is0();E==null&&(E=F?dR:t.inv(k));const K=u(O*E),Z=u(B*E),se=u(k*E);if(F)return{x:Gn,y:jr};if(se!==jr)throw new Error("invZ was invalid");return{x:K,y:Z}}),A=NE(b=>{const{a:E,d:O}=e;if(b.is0())throw new Error("bad point: ZERO");const{ex:B,ey:k,ez:F,et:K}=b,Z=u(B*B),se=u(k*k),J=u(F*F),ge=u(J*J),_e=u(Z*E),$e=u(J*u(_e+se)),Oe=u(ge+u(O*u(Z*se)));if($e!==Oe)throw new Error("bad point: equation left != right (1)");const Ie=u(B*k),Ct=u(F*K);if(Ie!==Ct)throw new Error("bad point: equation left != right (2)");return!0});class v{constructor(E,O,B,k){this.ex=E,this.ey=O,this.ez=B,this.et=k,p("x",E),p("y",O),p("z",B),p("t",k),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(E){if(E instanceof v)throw new Error("extended point not allowed");const{x:O,y:B}=E||{};return p("x",O),p("y",B),new v(O,B,jr,u(O*B))}static normalizeZ(E){const O=t.invertBatch(E.map(B=>B.ez));return E.map((B,k)=>B.toAffine(O[k])).map(v.fromAffine)}static msm(E,O){return lR(v,d,E,O)}_setWindowSize(E){P.setWindowSize(this,E)}assertValidity(){A(this)}equals(E){m(E);const{ex:O,ey:B,ez:k}=this,{ex:F,ey:K,ez:Z}=E,se=u(O*Z),J=u(F*k),ge=u(B*Z),_e=u(K*k);return se===J&&ge===_e}is0(){return this.equals(v.ZERO)}negate(){return new v(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:E}=e,{ex:O,ey:B,ez:k}=this,F=u(O*O),K=u(B*B),Z=u(jf*u(k*k)),se=u(E*F),J=O+B,ge=u(u(J*J)-F-K),_e=se+K,$e=_e-Z,Oe=se-K,Ie=u(ge*$e),Ct=u(_e*Oe),Tt=u(ge*Oe),Et=u($e*_e);return new v(Ie,Ct,Et,Tt)}add(E){m(E);const{a:O,d:B}=e,{ex:k,ey:F,ez:K,et:Z}=this,{ex:se,ey:J,ez:ge,et:_e}=E;if(O===BigInt(-1)){const If=u((F-k)*(J+se)),fm=u((F+k)*(J-se)),Sf=u(fm-If);if(Sf===Gn)return this.double();const pm=u(K*jf*_e),gm=u(Z*jf*ge),xf=gm+pm,Nc=fm+If,mm=gm-pm,ym=u(xf*Sf),Tf=u(Nc*mm),Gu=u(xf*mm),qn=u(Sf*Nc);return new v(ym,Tf,qn,Gu)}const $e=u(k*se),Oe=u(F*J),Ie=u(Z*B*_e),Ct=u(K*ge),Tt=u((k+F)*(se+J)-$e-Oe),Et=Ct-Ie,it=Ct+Ie,ut=u(Oe-O*$e),xr=u(Tt*Et),Wu=u(it*ut),Nf=u(Tt*ut),hm=u(Et*it);return new v(xr,Wu,hm,Nf)}subtract(E){return this.add(E.negate())}wNAF(E){return P.wNAFCached(this,E,v.normalizeZ)}multiply(E){const O=E;ed("scalar",O,jr,n);const{p:B,f:k}=this.wNAF(O);return v.normalizeZ([B,k])[0]}multiplyUnsafe(E,O=v.ZERO){const B=E;return ed("scalar",B,Gn,n),B===Gn?T:this.is0()||B===jr?this:P.wNAFCachedUnsafe(this,B,v.normalizeZ,O)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return P.unsafeLadder(this,n).is0()}toAffine(E){return w(this,E)}clearCofactor(){const{h:E}=e;return E===jr?this:this.multiplyUnsafe(E)}static fromHex(E,O=!1){const{d:B,a:k}=e,F=t.BYTES;E=si("pointHex",E,F),Fm("zip215",O);const K=E.slice(),Z=E[F-1];K[F-1]=Z&-129;const se=mp(K),J=O?l:t.ORDER;ed("pointHex.y",se,Gn,J);const ge=u(se*se),_e=u(ge-jr),$e=u(B*ge-k);let{isValid:Oe,value:Ie}=h(_e,$e);if(!Oe)throw new Error("Point.fromHex: invalid y coordinate");const Ct=(Ie&jr)===jr,Tt=(Z&128)!==0;if(!O&&Ie===Gn&&Tt)throw new Error("Point.fromHex: x=0 and x_0=1");return Tt!==Ct&&(Ie=u(-Ie)),v.fromAffine({x:Ie,y:se})}static fromPrivateKey(E){return S(E).point}toRawBytes(){const{x:E,y:O}=this.toAffine(),B=tw(O,t.BYTES);return B[B.length-1]|=E&jr?128:0,B}toHex(){return Mb(this.toRawBytes())}}v.BASE=new v(e.Gx,e.Gy,jr,u(e.Gx*e.Gy)),v.ZERO=new v(Gn,jr,jr,Gn);const{BASE:I,ZERO:T}=v,P=cR(v,a*8);function D(b){return Vt(b,n)}function U(b){return D(mp(b))}function S(b){const E=t.BYTES;b=si("private key",b,E);const O=si("hashed private key",i(b),2*E),B=f(O.slice(0,E)),k=O.slice(E,2*E),F=U(B),K=I.multiply(F),Z=K.toRawBytes();return{head:B,prefix:k,scalar:F,point:K,pointBytes:Z}}function H(b){return S(b).pointBytes}function L(b=new Uint8Array,...E){const O=_E(...E);return U(i(g(O,si("context",b),!!s)))}function j(b,E,O={}){b=si("message",b),s&&(b=s(b));const{prefix:B,scalar:k,pointBytes:F}=S(E),K=L(O.context,B,b),Z=I.multiply(K).toRawBytes(),se=L(O.context,Z,F,b),J=D(K+se*k);ed("signature.s",J,Gn,n);const ge=_E(Z,tw(J,t.BYTES));return si("result",ge,t.BYTES*2)}const Q=hR;function z(b,E,O,B=Q){const{context:k,zip215:F}=B,K=t.BYTES;b=si("signature",b,2*K),E=si("message",E),O=si("publicKey",O,K),F!==void 0&&Fm("zip215",F),s&&(E=s(E));const Z=mp(b.slice(K,2*K));let se,J,ge;try{se=v.fromHex(O,F),J=v.fromHex(b.slice(0,K),F),ge=I.multiplyUnsafe(Z)}catch{return!1}if(!F&&se.isSmallOrder())return!1;const _e=L(k,J.toRawBytes(),se.toRawBytes(),E);return J.add(se.multiplyUnsafe(_e)).subtract(ge).clearCofactor().equals(v.ZERO)}return I._setWindowSize(8),{CURVE:e,getPublicKey:H,sign:j,verify:z,ExtendedPoint:v,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>o(t.BYTES),precompute(b=8,E=v.BASE){return E._setWindowSize(b),E.multiply(BigInt(3)),E}}}}BigInt(0),BigInt(1);const jb=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),PE=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const gR=BigInt(1),OE=BigInt(2);BigInt(3);const mR=BigInt(5),yR=BigInt(8);function wR(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=jb,o=r*r%i*r%i,a=bs(o,OE,i)*o%i,c=bs(a,gR,i)*r%i,l=bs(c,mR,i)*c%i,u=bs(l,e,i)*l%i,d=bs(u,t,i)*u%i,h=bs(d,n,i)*d%i,f=bs(h,s,i)*h%i,g=bs(f,s,i)*h%i,p=bs(g,e,i)*l%i;return{pow_p_5_8:bs(p,OE,i)*r%i,b2:o}}function bR(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function ER(r,e){const t=jb,n=Vt(e*e*e,t),s=Vt(n*n*e,t),i=wR(r*s).pow_p_5_8;let o=Vt(r*n*i,t);const a=Vt(e*o*o,t),c=o,l=Vt(o*PE,t),u=a===r,d=a===Vt(-r,t),h=a===Vt(-r*PE,t);return u&&(o=c),(d||h)&&(o=l),tR(o,t)&&(o=Vt(-o,t)),{isValid:u||d,value:o}}const vR=y_(jb,void 0,!0),AR={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:vR,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:yR,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:z2,randomBytes:u_,adjustScalarBytes:bR,uvRatio:ER},E_=pR(AR),CR="EdDSA",_R="JWT",jp=".",Rg="base64url",v_="utf8",A_="utf8",NR=":",IR="did",SR="key",RE="base58btc",xR="z",TR="K36",PR=32;function Hb(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function C_(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Hb(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function __(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=C_(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return Hb(t)}function OR(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var p=0,m=0,w=0,A=g.length;w!==A&&g[w]===0;)w++,p++;for(var v=(A-w)*u+1>>>0,I=new Uint8Array(v);w!==A;){for(var T=g[w],P=0,D=v-1;(T!==0||P<m)&&D!==-1;D--,P++)T+=256*I[D]>>>0,I[D]=T%a>>>0,T=T/a>>>0;if(T!==0)throw new Error("Non-zero carry");m=P,w++}for(var U=v-m;U!==v&&I[U]===0;)U++;for(var S=c.repeat(p);U<v;++U)S+=r.charAt(I[U]);return S}function h(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var p=0;if(g[p]!==" "){for(var m=0,w=0;g[p]===c;)m++,p++;for(var A=(g.length-p)*l+1>>>0,v=new Uint8Array(A);g[p];){var I=t[g.charCodeAt(p)];if(I===255)return;for(var T=0,P=A-1;(I!==0||T<w)&&P!==-1;P--,T++)I+=a*v[P]>>>0,v[P]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");w=T,p++}if(g[p]!==" "){for(var D=A-w;D!==A&&v[D]===0;)D++;for(var U=new Uint8Array(m+(A-D)),S=m;D!==A;)U[S++]=v[D++];return U}}}function f(g){var p=h(g);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var RR=OR,DR=RR;const N_=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},kR=r=>new TextEncoder().encode(r),UR=r=>new TextDecoder().decode(r);let BR=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},LR=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return I_(this,e)}},$R=class{constructor(e){this.decoders=e}or(e){return I_(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const I_=(r,e)=>new $R({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});let MR=class{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new BR(e,t,n),this.decoder=new LR(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Dg=({name:r,prefix:e,encode:t,decode:n})=>new MR(r,e,t,n),sf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=DR(t,e);return Dg({prefix:r,name:e,encode:n,decode:i=>N_(s(i))})},FR=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[r[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|d,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},jR=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},mr=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Dg({prefix:e,name:r,encode(s){return jR(s,n,t)},decode(s){return FR(s,n,t,r)}}),HR=Dg({prefix:"\0",name:"identity",encode:r=>UR(r),decode:r=>kR(r)});var zR=Object.freeze({__proto__:null,identity:HR});const qR=mr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var VR=Object.freeze({__proto__:null,base2:qR});const WR=mr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var GR=Object.freeze({__proto__:null,base8:WR});const KR=sf({prefix:"9",name:"base10",alphabet:"0123456789"});var JR=Object.freeze({__proto__:null,base10:KR});const YR=mr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),QR=mr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ZR=Object.freeze({__proto__:null,base16:YR,base16upper:QR});const XR=mr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),eD=mr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),tD=mr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),rD=mr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),nD=mr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),sD=mr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),iD=mr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),oD=mr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),aD=mr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var cD=Object.freeze({__proto__:null,base32:XR,base32upper:eD,base32pad:tD,base32padupper:rD,base32hex:nD,base32hexupper:sD,base32hexpad:iD,base32hexpadupper:oD,base32z:aD});const lD=sf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),uD=sf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var dD=Object.freeze({__proto__:null,base36:lD,base36upper:uD});const hD=sf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),fD=sf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var pD=Object.freeze({__proto__:null,base58btc:hD,base58flickr:fD});const gD=mr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),mD=mr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),yD=mr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),wD=mr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var bD=Object.freeze({__proto__:null,base64:gD,base64pad:mD,base64url:yD,base64urlpad:wD});const S_=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),ED=S_.reduce((r,e,t)=>(r[t]=e,r),[]),vD=S_.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function AD(r){return r.reduce((e,t)=>(e+=ED[t],e),"")}function CD(r){const e=[];for(const t of r){const n=vD[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const _D=Dg({prefix:"🚀",name:"base256emoji",encode:AD,decode:CD});var ND=Object.freeze({__proto__:null,base256emoji:_D}),ID=x_,DE=128,SD=-128,xD=Math.pow(2,31);function x_(r,e,t){e=e||[],t=t||0;for(var n=t;r>=xD;)e[t++]=r&255|DE,r/=128;for(;r&SD;)e[t++]=r&255|DE,r>>>=7;return e[t]=r|0,x_.bytes=t-n+1,e}var TD=nw,PD=128,kE=127;function nw(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw nw.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&kE)<<s:(o&kE)*Math.pow(2,s),s+=7}while(o>=PD);return nw.bytes=i-n,t}var OD=Math.pow(2,7),RD=Math.pow(2,14),DD=Math.pow(2,21),kD=Math.pow(2,28),UD=Math.pow(2,35),BD=Math.pow(2,42),LD=Math.pow(2,49),$D=Math.pow(2,56),MD=Math.pow(2,63),FD=function(r){return r<OD?1:r<RD?2:r<DD?3:r<kD?4:r<UD?5:r<BD?6:r<LD?7:r<$D?8:r<MD?9:10},jD={encode:ID,decode:TD,encodingLength:FD},T_=jD;const UE=(r,e,t=0)=>(T_.encode(r,e,t),e),BE=r=>T_.encodingLength(r),sw=(r,e)=>{const t=e.byteLength,n=BE(r),s=n+BE(t),i=new Uint8Array(s+t);return UE(r,i,0),UE(t,i,n),i.set(e,s),new HD(r,t,e,i)};let HD=class{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}};const P_=({name:r,code:e,encode:t})=>new zD(r,e,t);let zD=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?sw(this.code,t):t.then(n=>sw(this.code,n))}else throw Error("Unknown type, must be binary type")}};const O_=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),qD=P_({name:"sha2-256",code:18,encode:O_("SHA-256")}),VD=P_({name:"sha2-512",code:19,encode:O_("SHA-512")});var WD=Object.freeze({__proto__:null,sha256:qD,sha512:VD});const R_=0,GD="identity",D_=N_,KD=r=>sw(R_,D_(r)),JD={code:R_,name:GD,encode:D_,digest:KD};var YD=Object.freeze({__proto__:null,identity:JD});new TextEncoder,new TextDecoder;const LE={...zR,...VR,...GR,...JR,...ZR,...cD,...dD,...pD,...bD,...ND};({...WD,...YD});function k_(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const $E=k_("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Wm=k_("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=C_(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),U_={utf8:$E,"utf-8":$E,hex:LE.base16,latin1:Wm,ascii:Wm,binary:Wm,...LE};function kg(r,e="utf8"){const t=U_[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function Lu(r,e="utf8"){const t=U_[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Hb(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function ME(r){return rc(kg(Lu(r,Rg),v_))}function Hp(r){return kg(Lu($i(r),v_),Rg)}function B_(r){const e=Lu(TR,RE),t=xR+kg(__([e,r]),RE);return[IR,SR,t].join(NR)}function QD(r){return kg(r,Rg)}function ZD(r){return Lu(r,Rg)}function XD(r){return Lu([Hp(r.header),Hp(r.payload)].join(jp),A_)}function ek(r){return[Hp(r.header),Hp(r.payload),QD(r.signature)].join(jp)}function iw(r){const e=r.split(jp),t=ME(e[0]),n=ME(e[1]),s=ZD(e[2]),i=Lu(e.slice(0,2).join(jp),A_);return{header:t,payload:n,signature:s,data:i}}function FE(r=u_(PR)){const e=E_.getPublicKey(r);return{secretKey:__([r,e]),publicKey:e}}async function tk(r,e,t,n,s=X.fromMiliseconds(Date.now())){const i={alg:CR,typ:_R},o=B_(n.publicKey),a=s+t,c={iss:o,sub:r,aud:e,iat:s,exp:a},l=XD({header:i,payload:c}),u=E_.sign(l,n.secretKey.slice(0,32));return ek({header:i,payload:c,signature:u})}var jE=function(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))},rk=function(){function r(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"}return r}(),nk=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r}(),sk=function(){function r(e,t,n,s){this.name=e,this.version=t,this.os=n,this.bot=s,this.type="bot-device"}return r}(),ik=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),ok=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),ak=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,ck=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,HE=3,lk=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",ak]],zE=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function uk(r){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new ok:typeof navigator<"u"?hk(navigator.userAgent):pk()}function dk(r){return r!==""&&lk.reduce(function(e,t){var n=t[0],s=t[1];if(e)return e;var i=s.exec(r);return!!i&&[n,i]},!1)}function hk(r){var e=dk(r);if(!e)return null;var t=e[0],n=e[1];if(t==="searchbot")return new ik;var s=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);s?s.length<HE&&(s=jE(jE([],s,!0),gk(HE-s.length),!0)):s=[];var i=s.join("."),o=fk(r),a=ck.exec(r);return a&&a[1]?new sk(t,i,o,a[1]):new rk(t,i,o)}function fk(r){for(var e=0,t=zE.length;e<t;e++){var n=zE[e],s=n[0],i=n[1],o=i.exec(r);if(o)return s}return null}function pk(){var r=typeof process<"u"&&process.version;return r?new nk(process.version.slice(1)):null}function gk(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var wt={};Object.defineProperty(wt,"__esModule",{value:!0});wt.getLocalStorage=wt.getLocalStorageOrThrow=wt.getCrypto=wt.getCryptoOrThrow=L_=wt.getLocation=wt.getLocationOrThrow=zb=wt.getNavigator=wt.getNavigatorOrThrow=of=wt.getDocument=wt.getDocumentOrThrow=wt.getFromWindowOrThrow=wt.getFromWindow=void 0;function Ec(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}wt.getFromWindow=Ec;function $u(r){const e=Ec(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}wt.getFromWindowOrThrow=$u;function mk(){return $u("document")}wt.getDocumentOrThrow=mk;function yk(){return Ec("document")}var of=wt.getDocument=yk;function wk(){return $u("navigator")}wt.getNavigatorOrThrow=wk;function bk(){return Ec("navigator")}var zb=wt.getNavigator=bk;function Ek(){return $u("location")}wt.getLocationOrThrow=Ek;function vk(){return Ec("location")}var L_=wt.getLocation=vk;function Ak(){return $u("crypto")}wt.getCryptoOrThrow=Ak;function Ck(){return Ec("crypto")}wt.getCrypto=Ck;function _k(){return $u("localStorage")}wt.getLocalStorageOrThrow=_k;function Nk(){return Ec("localStorage")}wt.getLocalStorage=Nk;var qb={};Object.defineProperty(qb,"__esModule",{value:!0});var $_=qb.getWindowMetadata=void 0;const qE=wt;function Ik(){let r,e;try{r=qE.getDocumentOrThrow(),e=qE.getLocationOrThrow()}catch{return null}function t(){const d=r.getElementsByTagName("link"),h=[];for(let f=0;f<d.length;f++){const g=d[f],p=g.getAttribute("rel");if(p&&p.toLowerCase().indexOf("icon")>-1){const m=g.getAttribute("href");if(m)if(m.toLowerCase().indexOf("https:")===-1&&m.toLowerCase().indexOf("http:")===-1&&m.indexOf("//")!==0){let w=e.protocol+"//"+e.host;if(m.indexOf("/")===0)w+=m;else{const A=e.pathname.split("/");A.pop();const v=A.join("/");w+=v+"/"+m}h.push(w)}else if(m.indexOf("//")===0){const w=e.protocol+m;h.push(w)}else h.push(m)}}return h}function n(...d){const h=r.getElementsByTagName("meta");for(let f=0;f<h.length;f++){const g=h[f],p=["itemprop","property","name"].map(m=>g.getAttribute(m)).filter(m=>m?d.includes(m):!1);if(p.length&&p){const m=g.getAttribute("content");if(m)return m}}return""}function s(){let d=n("name","og:site_name","og:title","twitter:title");return d||(d=r.title),d}function i(){return n("description","og:description","twitter:description","keywords")}const o=s(),a=i(),c=e.origin,l=t();return{description:a,url:c,icons:l,name:o}}$_=qb.getWindowMetadata=Ik;function Hd(r,{strict:e=!0}={}){return!r||typeof r!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(r):r.startsWith("0x")}function VE(r){return Hd(r,{strict:!1})?Math.ceil((r.length-2)/2):r.length}const M_="2.23.2";let td={getDocsUrl:({docsBaseUrl:r,docsPath:e="",docsSlug:t})=>e?`${r??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${M_}`},Ug=class ow extends Error{constructor(e,t={}){var a;const n=(()=>{var c;return t.cause instanceof ow?t.cause.details:(c=t.cause)!=null&&c.message?t.cause.message:t.details})(),s=t.cause instanceof ow&&t.cause.docsPath||t.docsPath,i=(a=td.getDocsUrl)==null?void 0:a.call(td,{...t,docsPath:s}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...n?[`Details: ${n}`]:[],...td.version?[`Version: ${td.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=M_}walk(e){return F_(this,e)}};function F_(r,e){return e!=null&&e(r)?r:r&&typeof r=="object"&&"cause"in r&&r.cause!==void 0?F_(r.cause,e):e?null:r}let j_=class extends Ug{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}};function Mu(r,{dir:e,size:t=32}={}){return typeof r=="string"?Sk(r,{dir:e,size:t}):xk(r,{dir:e,size:t})}function Sk(r,{dir:e,size:t=32}={}){if(t===null)return r;const n=r.replace("0x","");if(n.length>t*2)throw new j_({size:Math.ceil(n.length/2),targetSize:t,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function xk(r,{dir:e,size:t=32}={}){if(t===null)return r;if(r.length>t)throw new j_({size:r.length,targetSize:t,type:"bytes"});const n=new Uint8Array(t);for(let s=0;s<t;s++){const i=e==="right";n[i?s:t-s-1]=r[i?s:r.length-s-1]}return n}let Tk=class extends Ug{constructor({max:e,min:t,signed:n,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}},Pk=class extends Ug{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function Fu(r,{size:e}){if(VE(r)>e)throw new Pk({givenSize:VE(r),maxSize:e})}function aw(r,e={}){const{signed:t}=e;e.size&&Fu(r,{size:e.size});const n=BigInt(r);if(!t)return n;const s=(r.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return n<=i?n:n-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function Ok(r,e={}){return Number(aw(r,e))}const Rk=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function cw(r,e={}){return typeof r=="number"||typeof r=="bigint"?z_(r,e):typeof r=="string"?Uk(r,e):typeof r=="boolean"?Dk(r,e):H_(r,e)}function Dk(r,e={}){const t=`0x${Number(r)}`;return typeof e.size=="number"?(Fu(t,{size:e.size}),Mu(t,{size:e.size})):t}function H_(r,e={}){let t="";for(let s=0;s<r.length;s++)t+=Rk[r[s]];const n=`0x${t}`;return typeof e.size=="number"?(Fu(n,{size:e.size}),Mu(n,{dir:"right",size:e.size})):n}function z_(r,e={}){const{signed:t,size:n}=e,s=BigInt(r);let i;n?t?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof r=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&t?-i-1n:0;if(i&&s>i||s<o){const c=typeof r=="bigint"?"n":"";throw new Tk({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:t,size:n,value:`${r}${c}`})}const a=`0x${(t&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?Mu(a,{size:n}):a}const kk=new TextEncoder;function Uk(r,e={}){const t=kk.encode(r);return H_(t,e)}const Bk=new TextEncoder;function Lk(r,e={}){return typeof r=="number"||typeof r=="bigint"?Mk(r,e):typeof r=="boolean"?$k(r,e):Hd(r)?q_(r,e):V_(r,e)}function $k(r,e={}){const t=new Uint8Array(1);return t[0]=Number(r),typeof e.size=="number"?(Fu(t,{size:e.size}),Mu(t,{size:e.size})):t}const ii={zero:48,nine:57,A:65,F:70,a:97,f:102};function WE(r){if(r>=ii.zero&&r<=ii.nine)return r-ii.zero;if(r>=ii.A&&r<=ii.F)return r-(ii.A-10);if(r>=ii.a&&r<=ii.f)return r-(ii.a-10)}function q_(r,e={}){let t=r;e.size&&(Fu(t,{size:e.size}),t=Mu(t,{dir:"right",size:e.size}));let n=t.slice(2);n.length%2&&(n=`0${n}`);const s=n.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=WE(n.charCodeAt(a++)),l=WE(n.charCodeAt(a++));if(c===void 0||l===void 0)throw new Ug(`Invalid byte sequence ("${n[a-2]}${n[a-1]}" in "${n}").`);i[o]=c*16+l}return i}function Mk(r,e){const t=z_(r,e);return q_(t)}function V_(r,e={}){const t=Bk.encode(r);return typeof e.size=="number"?(Fu(t,{size:e.size}),Mu(t,{dir:"right",size:e.size})):t}function zp(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function Fk(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Bg(r,...e){if(!Fk(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function tJ(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");zp(r.outputLen),zp(r.blockLen)}function GE(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function jk(r,e){Bg(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Hf=BigInt(2**32-1),KE=BigInt(32);function Hk(r,e=!1){return e?{h:Number(r&Hf),l:Number(r>>KE&Hf)}:{h:Number(r>>KE&Hf)|0,l:Number(r&Hf)|0}}function zk(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=Hk(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const qk=(r,e,t)=>r<<t|e>>>32-t,Vk=(r,e,t)=>e<<t|r>>>32-t,Wk=(r,e,t)=>e<<t-32|r>>>64-t,Gk=(r,e,t)=>r<<t-32|e>>>64-t,Oc=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Kk(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function rJ(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function nJ(r,e){return r<<32-e|r>>>e}const JE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Jk(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function YE(r){for(let e=0;e<r.length;e++)r[e]=Jk(r[e])}function Yk(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function W_(r){return typeof r=="string"&&(r=Yk(r)),Bg(r),r}function sJ(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];Bg(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}let Qk=class{clone(){return this._cloneInto()}};function Zk(r){const e=n=>r().update(W_(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function oJ(r=32){if(Oc&&typeof Oc.getRandomValues=="function")return Oc.getRandomValues(new Uint8Array(r));if(Oc&&typeof Oc.randomBytes=="function")return Oc.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}const G_=[],K_=[],J_=[],Xk=BigInt(0),rd=BigInt(1),e3=BigInt(2),t3=BigInt(7),r3=BigInt(256),n3=BigInt(113);for(let r=0,e=rd,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],G_.push(2*(5*n+t)),K_.push((r+1)*(r+2)/2%64);let s=Xk;for(let i=0;i<7;i++)e=(e<<rd^(e>>t3)*n3)%r3,e&e3&&(s^=rd<<(rd<<BigInt(i))-rd);J_.push(s)}const[s3,i3]=zk(J_,!0),QE=(r,e,t)=>t>32?Wk(r,e,t):qk(r,e,t),ZE=(r,e,t)=>t>32?Gk(r,e,t):Vk(r,e,t);function o3(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],d=QE(l,u,1)^t[a],h=ZE(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)r[o+f]^=d,r[o+f+1]^=h}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=K_[o],c=QE(s,i,a),l=ZE(s,i,a),u=G_[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=s3[n],r[1]^=i3[n]}t.fill(0)}let a3=class Y_ extends Qk{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,zp(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Kk(this.state)}keccak(){JE||YE(this.state32),o3(this.state32,this.rounds),JE||YE(this.state32),this.posOut=0,this.pos=0}update(e){GE(this);const{blockLen:t,state:n}=this;e=W_(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,t&128&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){GE(this,!1),Bg(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return zp(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(jk(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Y_(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const c3=(r,e,t)=>Zk(()=>new a3(e,r,t)),l3=c3(1,136,256/8);function Q_(r,e){const t=e||"hex",n=l3(Hd(r,{strict:!1})?Lk(r):r);return t==="bytes"?n:cw(n)}let u3=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}};const Gm=new u3(8192);function d3(r,e){if(Gm.has(`${r}.${e}`))return Gm.get(`${r}.${e}`);const t=r.substring(2).toLowerCase(),n=Q_(V_(t),"bytes"),s=t.split("");for(let o=0;o<40;o+=2)n[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(n[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return Gm.set(`${r}.${e}`,i),i}function h3(r){const e=Q_(`0x${r.substring(4)}`).substring(26);return d3(`0x${e}`)}async function f3({hash:r,signature:e}){const t=Hd(r)?r:cw(r),{secp256k1:n}=await dn(async()=>{const{secp256k1:o}=await import("./secp256k1-70TK6PpF.js");return{secp256k1:o}},__vite__mapDeps([0,1,2,3,4,5,6]));return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:d,yParity:h}=e,f=Number(h??d),g=XE(f);return new n.Signature(aw(l),aw(u)).addRecoveryBit(g)}const o=Hd(e)?e:cw(e),a=Ok(`0x${o.slice(130)}`),c=XE(a);return n.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(t.substring(2)).toHex(!1)}`}function XE(r){if(r===0||r===1)return r;if(r===27)return 0;if(r===28)return 1;throw new Error("Invalid yParityOrV value")}async function p3({hash:r,signature:e}){return h3(await f3({hash:r,signature:e}))}function g3(r){if(r.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<r.length;l++){const u=r.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}const t=r.length,n=r.charAt(0),s=Math.log(t)/Math.log(256),i=Math.log(256)/Math.log(t);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0;const f=l.length;for(;h!==f&&l[h]===0;)h++,u++;const g=(f-h)*i+1>>>0,p=new Uint8Array(g);for(;h!==f;){let A=l[h],v=0;for(let I=g-1;(A!==0||v<d)&&I!==-1;I--,v++)A+=256*p[I]>>>0,p[I]=A%t>>>0,A=A/t>>>0;if(A!==0)throw new Error("Non-zero carry");d=v,h++}let m=g-d;for(;m!==g&&p[m]===0;)m++;let w=n.repeat(u);for(;m<g;++m)w+=r.charAt(p[m]);return w}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===n;)d++,u++;const f=(l.length-u)*s+1>>>0,g=new Uint8Array(f);for(;u<l.length;){const A=l.charCodeAt(u);if(A>255)return;let v=e[A];if(v===255)return;let I=0;for(let T=f-1;(v!==0||I<h)&&T!==-1;T--,I++)v+=t*g[T]>>>0,g[T]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");h=I,u++}let p=f-h;for(;p!==f&&g[p]===0;)p++;const m=new Uint8Array(d+(f-p));let w=d;for(;p!==f;)m[w++]=g[p++];return m}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+t+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var m3="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Z_=g3(m3);function X_(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function Id(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=X_(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return t}function y3(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var p=0,m=0,w=0,A=g.length;w!==A&&g[w]===0;)w++,p++;for(var v=(A-w)*u+1>>>0,I=new Uint8Array(v);w!==A;){for(var T=g[w],P=0,D=v-1;(T!==0||P<m)&&D!==-1;D--,P++)T+=256*I[D]>>>0,I[D]=T%a>>>0,T=T/a>>>0;if(T!==0)throw new Error("Non-zero carry");m=P,w++}for(var U=v-m;U!==v&&I[U]===0;)U++;for(var S=c.repeat(p);U<v;++U)S+=r.charAt(I[U]);return S}function h(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var p=0;if(g[p]!==" "){for(var m=0,w=0;g[p]===c;)m++,p++;for(var A=(g.length-p)*l+1>>>0,v=new Uint8Array(A);g[p];){var I=t[g.charCodeAt(p)];if(I===255)return;for(var T=0,P=A-1;(I!==0||T<w)&&P!==-1;P--,T++)I+=a*v[P]>>>0,v[P]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");w=T,p++}if(g[p]!==" "){for(var D=A-w;D!==A&&v[D]===0;)D++;for(var U=new Uint8Array(m+(A-D)),S=m;D!==A;)U[S++]=v[D++];return U}}}function f(g){var p=h(g);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var w3=y3,b3=w3;const E3=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},v3=r=>new TextEncoder().encode(r),A3=r=>new TextDecoder().decode(r);class C3{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class _3{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return eN(this,e)}}class N3{constructor(e){this.decoders=e}or(e){return eN(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const eN=(r,e)=>new N3({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class I3{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new C3(e,t,n),this.decoder=new _3(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Lg=({name:r,prefix:e,encode:t,decode:n})=>new I3(r,e,t,n),af=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=b3(t,e);return Lg({prefix:r,name:e,encode:n,decode:i=>E3(s(i))})},S3=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[r[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|d,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},x3=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},yr=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Lg({prefix:e,name:r,encode(s){return x3(s,n,t)},decode(s){return S3(s,n,t,r)}}),T3=Lg({prefix:"\0",name:"identity",encode:r=>A3(r),decode:r=>v3(r)}),P3=Object.freeze(Object.defineProperty({__proto__:null,identity:T3},Symbol.toStringTag,{value:"Module"})),O3=yr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),R3=Object.freeze(Object.defineProperty({__proto__:null,base2:O3},Symbol.toStringTag,{value:"Module"})),D3=yr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),k3=Object.freeze(Object.defineProperty({__proto__:null,base8:D3},Symbol.toStringTag,{value:"Module"})),U3=af({prefix:"9",name:"base10",alphabet:"0123456789"}),B3=Object.freeze(Object.defineProperty({__proto__:null,base10:U3},Symbol.toStringTag,{value:"Module"})),L3=yr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),$3=yr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),M3=Object.freeze(Object.defineProperty({__proto__:null,base16:L3,base16upper:$3},Symbol.toStringTag,{value:"Module"})),F3=yr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),j3=yr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),H3=yr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),z3=yr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),q3=yr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),V3=yr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),W3=yr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),G3=yr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),K3=yr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),J3=Object.freeze(Object.defineProperty({__proto__:null,base32:F3,base32hex:q3,base32hexpad:W3,base32hexpadupper:G3,base32hexupper:V3,base32pad:H3,base32padupper:z3,base32upper:j3,base32z:K3},Symbol.toStringTag,{value:"Module"})),Y3=af({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Q3=af({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Z3=Object.freeze(Object.defineProperty({__proto__:null,base36:Y3,base36upper:Q3},Symbol.toStringTag,{value:"Module"})),X3=af({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),eU=af({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),tU=Object.freeze(Object.defineProperty({__proto__:null,base58btc:X3,base58flickr:eU},Symbol.toStringTag,{value:"Module"})),rU=yr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),nU=yr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),sU=yr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),iU=yr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),oU=Object.freeze(Object.defineProperty({__proto__:null,base64:rU,base64pad:nU,base64url:sU,base64urlpad:iU},Symbol.toStringTag,{value:"Module"})),tN=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),aU=tN.reduce((r,e,t)=>(r[t]=e,r),[]),cU=tN.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function lU(r){return r.reduce((e,t)=>(e+=aU[t],e),"")}function uU(r){const e=[];for(const t of r){const n=cU[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const dU=Lg({prefix:"🚀",name:"base256emoji",encode:lU,decode:uU}),hU=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:dU},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const ev={...P3,...R3,...k3,...B3,...M3,...J3,...Z3,...tU,...oU,...hU};function rN(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const tv=rN("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Km=rN("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=X_(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),nN={utf8:tv,"utf-8":tv,hex:ev.base16,latin1:Km,ascii:Km,binary:Km,...ev};function Fn(r,e="utf8"){const t=nN[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}function Zr(r,e="utf8"){const t=nN[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}const fU={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var pU={};const gU=":";function fl(r){const[e,t]=r.split(gU);return{namespace:e,reference:t}}function sN(r,e){return r.includes(":")?[r]:e.chains||[]}var mU=Object.defineProperty,yU=Object.defineProperties,wU=Object.getOwnPropertyDescriptors,rv=Object.getOwnPropertySymbols,bU=Object.prototype.hasOwnProperty,EU=Object.prototype.propertyIsEnumerable,nv=(r,e,t)=>e in r?mU(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,sv=(r,e)=>{for(var t in e||(e={}))bU.call(e,t)&&nv(r,t,e[t]);if(rv)for(var t of rv(e))EU.call(e,t)&&nv(r,t,e[t]);return r},vU=(r,e)=>yU(r,wU(e));const AU="ReactNative",vn={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},CU="js";function qp(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function qo(){return!of()&&!!zb()&&navigator.product===AU}function _U(){return qo()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function NU(){return qo()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function cf(){return!qp()&&!!zb()&&!!of()}function lf(){return qo()?vn.reactNative:qp()?vn.node:cf()?vn.browser:vn.unknown}function iv(){var r;try{return qo()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(r=global.Application)==null?void 0:r.applicationId:void 0}catch{return}}function IU(r,e){const t=new URLSearchParams(r);for(const n of Object.keys(e).sort())if(e.hasOwnProperty(n)){const s=e[n];s!==void 0&&t.set(n,s)}return t.toString()}function SU(r){var e,t;const n=iN();try{return r!=null&&r.url&&n.url&&r.url!==n.url&&(console.warn(`The configured WalletConnect 'metadata.url':${r.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),r.url=n.url),(e=r==null?void 0:r.icons)!=null&&e.length&&r.icons.length>0&&(r.icons=r.icons.filter(s=>s!=="")),vU(sv(sv({},n),r),{url:(r==null?void 0:r.url)||n.url,name:(r==null?void 0:r.name)||n.name,description:(r==null?void 0:r.description)||n.description,icons:(t=r==null?void 0:r.icons)!=null&&t.length&&r.icons.length>0?r.icons:n.icons})}catch(s){return console.warn("Error populating app metadata",s),r||n}}function iN(){return $_()||{name:"",description:"",url:"",icons:[""]}}function xU(){if(lf()===vn.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:n}=global.Platform;return[t,n].join("-")}const r=uk();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function TU(){var r;const e=lf();return e===vn.browser?[e,((r=L_())==null?void 0:r.host)||"unknown"].join(":"):e}function oN(r,e,t){const n=xU(),s=TU();return[[r,e].join("-"),[CU,t].join("-"),n,s].join("/")}function PU({protocol:r,version:e,relayUrl:t,sdkVersion:n,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=t.split("?"),u=oN(r,e,n),d={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=IU(l[1]||"",d);return l[0]+"?"+h}function ma(r,e){return r.filter(t=>e.includes(t)).length===r.length}function lw(r){return Object.fromEntries(r.entries())}function uw(r){return new Map(Object.entries(r))}function na(r=X.FIVE_MINUTES,e){const t=X.toMiliseconds(r||X.FIVE_MINUTES);let n,s,i,o;return{resolve:a=>{i&&n&&(clearTimeout(i),n(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},t),n=a,s=c})}}function Po(r,e,t){return new Promise(async(n,s)=>{const i=setTimeout(()=>s(new Error(t)),e);try{const o=await r;n(o)}catch(o){s(o)}clearTimeout(i)})}function aN(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function OU(r){return aN("topic",r)}function RU(r){return aN("id",r)}function cN(r){const[e,t]=r.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")n.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))n.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return n}function qt(r,e){return X.fromMiliseconds(Date.now()+X.toMiliseconds(r))}function ao(r){return Date.now()>=X.toMiliseconds(r)}function Xe(r,e){return`${r}${e?`:${e}`:""}`}function yp(r=[],e=[]){return[...new Set([...r,...e])]}async function DU({id:r,topic:e,wcDeepLink:t}){var n;try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=kU(i,r,e),a=lf();if(a===vn.browser){if(!((n=of())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}UU(o)}else a===vn.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function kU(r,e,t){const n=`requestId=${e}&sessionTopic=${t}`;r.endsWith("/")&&(r=r.slice(0,-1));let s=`${r}`;if(r.startsWith("https://t.me")){const i=r.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${MU(n,!0)}`}else s=`${s}/wc?${n}`;return s}function UU(r){let e="_self";$U()?e="_top":(LU()||r.startsWith("https://")||r.startsWith("http://"))&&(e="_blank"),window.open(r,e,"noreferrer noopener")}async function BU(r,e){let t="";try{if(cf()&&(t=localStorage.getItem(e),t))return t;t=await r.getItem(e)}catch(n){console.error(n)}return t}function ov(r,e){if(!r.includes(e))return null;const t=r.split(/([&,?,=])/),n=t.indexOf(e);return t[n+2]}function av(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}function Vb(){return typeof process<"u"&&pU.IS_VITEST==="true"}function LU(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function $U(){try{return window.self!==window.top}catch{return!1}}function MU(r,e=!1){const t=Buffer.from(r).toString("base64");return e?t.replace(/[=]/g,""):t}function lN(r){return Buffer.from(r,"base64").toString("utf-8")}function FU(r){return new Promise(e=>setTimeout(e,r))}function zd(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function jU(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function uf(r,...e){if(!jU(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Wb(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");zd(r.outputLen),zd(r.blockLen)}function uu(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function uN(r,e){uf(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const zf=BigInt(2**32-1),cv=BigInt(32);function HU(r,e=!1){return e?{h:Number(r&zf),l:Number(r>>cv&zf)}:{h:Number(r>>cv&zf)|0,l:Number(r&zf)|0}}function zU(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=HU(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const qU=(r,e,t)=>r<<t|e>>>32-t,VU=(r,e,t)=>e<<t|r>>>32-t,WU=(r,e,t)=>e<<t-32|r>>>64-t,GU=(r,e,t)=>r<<t-32|e>>>64-t,Rc=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function KU(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function Jm(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Es(r,e){return r<<32-e|r>>>e}const lv=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function JU(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function uv(r){for(let e=0;e<r.length;e++)r[e]=JU(r[e])}function YU(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function du(r){return typeof r=="string"&&(r=YU(r)),uf(r),r}function QU(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];uf(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}let Gb=class{clone(){return this._cloneInto()}};function dN(r){const e=n=>r().update(du(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function ju(r=32){if(Rc&&typeof Rc.getRandomValues=="function")return Rc.getRandomValues(new Uint8Array(r));if(Rc&&typeof Rc.randomBytes=="function")return Rc.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}const hN=[],fN=[],pN=[],ZU=BigInt(0),nd=BigInt(1),XU=BigInt(2),e5=BigInt(7),t5=BigInt(256),r5=BigInt(113);for(let r=0,e=nd,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],hN.push(2*(5*n+t)),fN.push((r+1)*(r+2)/2%64);let s=ZU;for(let i=0;i<7;i++)e=(e<<nd^(e>>e5)*r5)%t5,e&XU&&(s^=nd<<(nd<<BigInt(i))-nd);pN.push(s)}const[n5,s5]=zU(pN,!0),dv=(r,e,t)=>t>32?WU(r,e,t):qU(r,e,t),hv=(r,e,t)=>t>32?GU(r,e,t):VU(r,e,t);function i5(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],d=dv(l,u,1)^t[a],h=hv(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)r[o+f]^=d,r[o+f+1]^=h}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=fN[o],c=dv(s,i,a),l=hv(s,i,a),u=hN[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=n5[n],r[1]^=s5[n]}t.fill(0)}let o5=class gN extends Gb{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,zd(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=KU(this.state)}keccak(){lv||uv(this.state32),i5(this.state32,this.rounds),lv||uv(this.state32),this.posOut=0,this.pos=0}update(e){uu(this);const{blockLen:t,state:n}=this;e=du(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,t&128&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){uu(this,!1),uf(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return zd(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(uN(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new gN(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const a5=(r,e,t)=>dN(()=>new o5(e,r,t)),c5=a5(1,136,256/8),l5="https://rpc.walletconnect.org/v1";function mN(r){const e=`Ethereum Signed Message:
${r.length}`,t=new TextEncoder().encode(e+r);return"0x"+Buffer.from(c5(t)).toString("hex")}async function u5(r,e,t,n,s,i){switch(t.t){case"eip191":return await d5(r,e,t.s);case"eip1271":return await h5(r,e,t.s,n,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}async function d5(r,e,t){return(await p3({hash:mN(e),signature:t})).toLowerCase()===r.toLowerCase()}async function h5(r,e,t,n,s,i){const o=fl(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l="0000000000000000000000000000000000000000000000000000000000000041",u=t.substring(2),d=mN(e).substring(2),h=a+d+c+l+u,f=await fetch(`${i||l5}/?chainId=${n}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:f5(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:h},"latest"]})}),{result:g}=await f.json();return g?g.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function f5(){return Date.now()+Math.floor(Math.random()*1e3)}function p5(r){const e=atob(r),t=new Uint8Array(e.length);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);const n=t[0];if(n===0)throw new Error("No signatures found");const s=1+n*64;if(t.length<s)throw new Error("Transaction data too short for claimed signature count");if(t.length<100)throw new Error("Transaction too short");const i=Buffer.from(r,"base64").slice(1,65);return Z_.encode(i)}var g5=Object.defineProperty,m5=Object.defineProperties,y5=Object.getOwnPropertyDescriptors,fv=Object.getOwnPropertySymbols,w5=Object.prototype.hasOwnProperty,b5=Object.prototype.propertyIsEnumerable,pv=(r,e,t)=>e in r?g5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,E5=(r,e)=>{for(var t in e||(e={}))w5.call(e,t)&&pv(r,t,e[t]);if(fv)for(var t of fv(e))b5.call(e,t)&&pv(r,t,e[t]);return r},v5=(r,e)=>m5(r,y5(e));const A5="did:pkh:",Kb=r=>r==null?void 0:r.split(":"),C5=r=>{const e=r&&Kb(r);if(e)return r.includes(A5)?e[3]:e[1]},dw=r=>{const e=r&&Kb(r);if(e)return e[2]+":"+e[3]},Vp=r=>{const e=r&&Kb(r);if(e)return e.pop()};async function gv(r){const{cacao:e,projectId:t}=r,{s:n,p:s}=e,i=yN(s,s.iss),o=Vp(s.iss);return await u5(o,i,n,dw(s.iss),t)}const yN=(r,e)=>{const t=`${r.domain} wants you to sign in with your Ethereum account:`,n=Vp(e);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=r.statement||void 0;const i=`URI: ${r.aud||r.uri}`,o=`Version: ${r.version}`,a=`Chain ID: ${C5(e)}`,c=`Nonce: ${r.nonce}`,l=`Issued At: ${r.iat}`,u=r.exp?`Expiration Time: ${r.exp}`:void 0,d=r.nbf?`Not Before: ${r.nbf}`:void 0,h=r.requestId?`Request ID: ${r.requestId}`:void 0,f=r.resources?`Resources:${r.resources.map(p=>`
- ${p}`).join("")}`:void 0,g=wp(r.resources);if(g){const p=qd(g);s=R5(s,p)}return[t,n,"",s,"",i,o,a,c,l,u,d,h,f].filter(p=>p!=null).join(`
`)};function _5(r){return Buffer.from(JSON.stringify(r)).toString("base64")}function N5(r){return JSON.parse(Buffer.from(r,"base64").toString("utf-8"))}function nc(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const e=Object.keys(r.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const n=r.att[t];if(Array.isArray(n))throw new Error(`Resource must be an object: ${t}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(n).forEach(s=>{const i=n[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function I5(r,e,t,n={}){return t==null||t.sort((s,i)=>s.localeCompare(i)),{att:{[r]:S5(e,t,n)}}}function S5(r,e,t={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const n=e.map(s=>({[`${r}/${s}`]:[t]}));return Object.assign({},...n)}function wN(r){return nc(r),`urn:recap:${_5(r).replace(/=/g,"")}`}function qd(r){const e=N5(r.replace("urn:recap:",""));return nc(e),e}function x5(r,e,t){const n=I5(r,e,t);return wN(n)}function T5(r){return r&&r.includes("urn:recap:")}function P5(r,e){const t=qd(r),n=qd(e),s=O5(t,n);return wN(s)}function O5(r,e){nc(r),nc(e);const t=Object.keys(r.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),n={att:{}};return t.forEach(s=>{var i,o;Object.keys(((i=r.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;n.att[s]=v5(E5({},n.att[s]),{[a]:((c=r.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),n}function R5(r="",e){nc(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(t))return r;const n=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));const l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});const u=Object.keys(l).map(d=>(s++,`(${s}) '${d}': '${l[d].join("', '")}' for '${a}'.`));n.push(u.join(", ").replace(".,","."))});const i=n.join(" "),o=`${t}${i}`;return`${r?r+" ":""}${o}`}function mv(r){var e;const t=qd(r);nc(t);const n=(e=t.att)==null?void 0:e.eip155;return n?Object.keys(n).map(s=>s.split("/")[1]):[]}function yv(r){const e=qd(r);nc(e);const t=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&t.push(s[0].chains)})}),[...new Set(t.flat())]}function wp(r){if(!r)return;const e=r==null?void 0:r[r.length-1];return T5(e)?e:void 0}function Ym(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function bN(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function bn(r,...e){if(!bN(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function wv(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function D5(r,e){bn(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function bv(r){if(typeof r!="boolean")throw new Error(`boolean expected, not ${r}`)}const Ro=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),k5=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),U5=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!U5)throw new Error("Non little-endian hardware is not supported");function B5(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function hw(r){if(typeof r=="string")r=B5(r);else if(bN(r))r=fw(r);else throw new Error("Uint8Array expected, got "+typeof r);return r}function L5(r,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(r,e)}function $5(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}const M5=(r,e)=>{function t(n,...s){if(bn(n),r.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");r.varSizeNonce?bn(l):bn(l,r.nonceLength)}const i=r.tagLength;i&&s[1]!==void 0&&bn(s[1]);const o=e(n,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");bn(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,bn(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(bn(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(t,r),t};function Ev(r,e,t=!0){if(e===void 0)return new Uint8Array(r);if(e.length!==r)throw new Error("invalid output length, expected "+r+", got: "+e.length);if(t&&!F5(e))throw new Error("invalid output, must be aligned");return e}function vv(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i);r.setUint32(e+4,o,n),r.setUint32(e+0,a,n)}function F5(r){return r.byteOffset%4===0}function fw(r){return Uint8Array.from(r)}function hu(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}const EN=r=>Uint8Array.from(r.split("").map(e=>e.charCodeAt(0))),j5=EN("expand 16-byte k"),H5=EN("expand 32-byte k"),z5=Ro(j5),q5=Ro(H5);function We(r,e){return r<<e|r>>>32-e}function pw(r){return r.byteOffset%4===0}const qf=64,V5=16,vN=2**32-1,Av=new Uint32Array;function W5(r,e,t,n,s,i,o,a){const c=s.length,l=new Uint8Array(qf),u=Ro(l),d=pw(s)&&pw(i),h=d?Ro(s):Av,f=d?Ro(i):Av;for(let g=0;g<c;o++){if(r(e,t,n,u,o,a),o>=vN)throw new Error("arx: counter overflow");const p=Math.min(qf,c-g);if(d&&p===qf){const m=g/4;if(g%4!==0)throw new Error("arx: invalid block position");for(let w=0,A;w<V5;w++)A=m+w,f[A]=h[A]^u[w];g+=qf;continue}for(let m=0,w;m<p;m++)w=g+m,i[w]=s[w]^l[m];g+=p}}function G5(r,e){const{allowShortKeys:t,extendNonceFn:n,counterLength:s,counterRight:i,rounds:o}=L5({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof r!="function")throw new Error("core must be a function");return Ym(s),Ym(o),bv(i),bv(t),(a,c,l,u,d=0)=>{bn(a),bn(c),bn(l);const h=l.length;if(u===void 0&&(u=new Uint8Array(h)),bn(u),Ym(d),d<0||d>=vN)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const f=[];let g=a.length,p,m;if(g===32)f.push(p=fw(a)),m=q5;else if(g===16&&t)p=new Uint8Array(32),p.set(a),p.set(a,16),m=z5,f.push(p);else throw new Error(`arx: invalid 32-byte key, got length=${g}`);pw(c)||f.push(c=fw(c));const w=Ro(p);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(m,w,Ro(c.subarray(0,16)),w),c=c.subarray(16)}const A=16-s;if(A!==c.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){const I=new Uint8Array(12);I.set(c,i?0:12-c.length),c=I,f.push(c)}const v=Ro(c);return W5(r,m,w,v,l,u,d,o),hu(...f),u}}const sr=(r,e)=>r[e++]&255|(r[e++]&255)<<8;class K5{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=hw(e),bn(e,32);const t=sr(e,0),n=sr(e,2),s=sr(e,4),i=sr(e,6),o=sr(e,8),a=sr(e,10),c=sr(e,12),l=sr(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=sr(e,16+2*u)}process(e,t,n=!1){const s=n?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],f=o[6],g=o[7],p=o[8],m=o[9],w=sr(e,t+0),A=sr(e,t+2),v=sr(e,t+4),I=sr(e,t+6),T=sr(e,t+8),P=sr(e,t+10),D=sr(e,t+12),U=sr(e,t+14);let S=i[0]+(w&8191),H=i[1]+((w>>>13|A<<3)&8191),L=i[2]+((A>>>10|v<<6)&8191),j=i[3]+((v>>>7|I<<9)&8191),Q=i[4]+((I>>>4|T<<12)&8191),z=i[5]+(T>>>1&8191),b=i[6]+((T>>>14|P<<2)&8191),E=i[7]+((P>>>11|D<<5)&8191),O=i[8]+((D>>>8|U<<8)&8191),B=i[9]+(U>>>5|s),k=0,F=k+S*a+H*(5*m)+L*(5*p)+j*(5*g)+Q*(5*f);k=F>>>13,F&=8191,F+=z*(5*h)+b*(5*d)+E*(5*u)+O*(5*l)+B*(5*c),k+=F>>>13,F&=8191;let K=k+S*c+H*a+L*(5*m)+j*(5*p)+Q*(5*g);k=K>>>13,K&=8191,K+=z*(5*f)+b*(5*h)+E*(5*d)+O*(5*u)+B*(5*l),k+=K>>>13,K&=8191;let Z=k+S*l+H*c+L*a+j*(5*m)+Q*(5*p);k=Z>>>13,Z&=8191,Z+=z*(5*g)+b*(5*f)+E*(5*h)+O*(5*d)+B*(5*u),k+=Z>>>13,Z&=8191;let se=k+S*u+H*l+L*c+j*a+Q*(5*m);k=se>>>13,se&=8191,se+=z*(5*p)+b*(5*g)+E*(5*f)+O*(5*h)+B*(5*d),k+=se>>>13,se&=8191;let J=k+S*d+H*u+L*l+j*c+Q*a;k=J>>>13,J&=8191,J+=z*(5*m)+b*(5*p)+E*(5*g)+O*(5*f)+B*(5*h),k+=J>>>13,J&=8191;let ge=k+S*h+H*d+L*u+j*l+Q*c;k=ge>>>13,ge&=8191,ge+=z*a+b*(5*m)+E*(5*p)+O*(5*g)+B*(5*f),k+=ge>>>13,ge&=8191;let _e=k+S*f+H*h+L*d+j*u+Q*l;k=_e>>>13,_e&=8191,_e+=z*c+b*a+E*(5*m)+O*(5*p)+B*(5*g),k+=_e>>>13,_e&=8191;let $e=k+S*g+H*f+L*h+j*d+Q*u;k=$e>>>13,$e&=8191,$e+=z*l+b*c+E*a+O*(5*m)+B*(5*p),k+=$e>>>13,$e&=8191;let Oe=k+S*p+H*g+L*f+j*h+Q*d;k=Oe>>>13,Oe&=8191,Oe+=z*u+b*l+E*c+O*a+B*(5*m),k+=Oe>>>13,Oe&=8191;let Ie=k+S*m+H*p+L*g+j*f+Q*h;k=Ie>>>13,Ie&=8191,Ie+=z*d+b*u+E*l+O*c+B*a,k+=Ie>>>13,Ie&=8191,k=(k<<2)+k|0,k=k+F|0,F=k&8191,k=k>>>13,K+=k,i[0]=F,i[1]=K,i[2]=Z,i[3]=se,i[4]=J,i[5]=ge,i[6]=_e,i[7]=$e,i[8]=Oe,i[9]=Ie}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,n[0]=e[0]+5,s=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+s,s=n[a]>>>13,n[a]&=8191;n[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)n[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+t[a]|0)+(o>>>16)|0,e[a]=o&65535;hu(n)}update(e){wv(this);const{buffer:t,blockLen:n}=this;e=hw(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o===n){for(;n<=s-i;i+=n)this.process(e,i);continue}t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){hu(this.h,this.r,this.buffer,this.pad)}digestInto(e){wv(this),D5(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:s}=this;if(s){for(t[s++]=1;s<16;s++)t[s]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}function J5(r){const e=(n,s)=>r(s).update(hw(n)).digest(),t=r(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>r(n),e}const Y5=J5(r=>new K5(r));function Q5(r,e,t,n,s,i=20){let o=r[0],a=r[1],c=r[2],l=r[3],u=e[0],d=e[1],h=e[2],f=e[3],g=e[4],p=e[5],m=e[6],w=e[7],A=s,v=t[0],I=t[1],T=t[2],P=o,D=a,U=c,S=l,H=u,L=d,j=h,Q=f,z=g,b=p,E=m,O=w,B=A,k=v,F=I,K=T;for(let se=0;se<i;se+=2)P=P+H|0,B=We(B^P,16),z=z+B|0,H=We(H^z,12),P=P+H|0,B=We(B^P,8),z=z+B|0,H=We(H^z,7),D=D+L|0,k=We(k^D,16),b=b+k|0,L=We(L^b,12),D=D+L|0,k=We(k^D,8),b=b+k|0,L=We(L^b,7),U=U+j|0,F=We(F^U,16),E=E+F|0,j=We(j^E,12),U=U+j|0,F=We(F^U,8),E=E+F|0,j=We(j^E,7),S=S+Q|0,K=We(K^S,16),O=O+K|0,Q=We(Q^O,12),S=S+Q|0,K=We(K^S,8),O=O+K|0,Q=We(Q^O,7),P=P+L|0,K=We(K^P,16),E=E+K|0,L=We(L^E,12),P=P+L|0,K=We(K^P,8),E=E+K|0,L=We(L^E,7),D=D+j|0,B=We(B^D,16),O=O+B|0,j=We(j^O,12),D=D+j|0,B=We(B^D,8),O=O+B|0,j=We(j^O,7),U=U+Q|0,k=We(k^U,16),z=z+k|0,Q=We(Q^z,12),U=U+Q|0,k=We(k^U,8),z=z+k|0,Q=We(Q^z,7),S=S+H|0,F=We(F^S,16),b=b+F|0,H=We(H^b,12),S=S+H|0,F=We(F^S,8),b=b+F|0,H=We(H^b,7);let Z=0;n[Z++]=o+P|0,n[Z++]=a+D|0,n[Z++]=c+U|0,n[Z++]=l+S|0,n[Z++]=u+H|0,n[Z++]=d+L|0,n[Z++]=h+j|0,n[Z++]=f+Q|0,n[Z++]=g+z|0,n[Z++]=p+b|0,n[Z++]=m+E|0,n[Z++]=w+O|0,n[Z++]=A+B|0,n[Z++]=v+k|0,n[Z++]=I+F|0,n[Z++]=T+K|0}const Z5=G5(Q5,{counterRight:!1,counterLength:4,allowShortKeys:!1}),X5=new Uint8Array(16),Cv=(r,e)=>{r.update(e);const t=e.length%16;t&&r.update(X5.subarray(t))},e8=new Uint8Array(32);function _v(r,e,t,n,s){const i=r(e,t,e8),o=Y5.create(i);s&&Cv(o,s),Cv(o,n);const a=new Uint8Array(16),c=k5(a);vv(c,0,BigInt(s?s.length:0),!0),vv(c,8,BigInt(n.length),!0),o.update(a);const l=o.digest();return hu(i,a),l}const t8=r=>(e,t,n)=>({encrypt(s,i){const o=s.length;i=Ev(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);r(e,t,a,a,1);const c=_v(r,e,t,a,n);return i.set(c,o),hu(c),i},decrypt(s,i){i=Ev(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=_v(r,e,t,o,n);if(!$5(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),r(e,t,i,i,1),hu(c),i}}),AN=M5({blockSize:64,nonceLength:12,tagLength:16},t8(Z5));let CN=class extends Gb{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Wb(e);const n=du(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return uu(this),this.iHash.update(e),this}digestInto(e){uu(this),uf(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const $g=(r,e,t)=>new CN(r,e).update(t).digest();$g.create=(r,e)=>new CN(r,e);function r8(r,e,t){return Wb(r),t===void 0&&(t=new Uint8Array(r.outputLen)),$g(r,du(t),du(e))}const Qm=new Uint8Array([0]),Nv=new Uint8Array;function n8(r,e,t,n=32){if(Wb(r),zd(n),n>255*r.outputLen)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(n/r.outputLen);t===void 0&&(t=Nv);const i=new Uint8Array(s*r.outputLen),o=$g.create(r,e),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let l=0;l<s;l++)Qm[0]=l+1,a.update(l===0?Nv:c).update(t).update(Qm).digestInto(c),i.set(c,r.outputLen*l),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),Qm.fill(0),i.slice(0,n)}const s8=(r,e,t,n,s)=>n8(r,r8(r,e,t),n,s);function i8(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}function o8(r,e,t){return r&e^~r&t}function a8(r,e,t){return r&e^r&t^e&t}let c8=class extends Gb{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Jm(this.buffer)}update(e){uu(this);const{view:t,buffer:n,blockLen:s}=this;e=du(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Jm(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){uu(this),uN(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)t[d]=0;i8(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Jm(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}};const l8=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Zi=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Xi=new Uint32Array(64);class u8 extends c8{constructor(){super(64,32,8,!1),this.A=Zi[0]|0,this.B=Zi[1]|0,this.C=Zi[2]|0,this.D=Zi[3]|0,this.E=Zi[4]|0,this.F=Zi[5]|0,this.G=Zi[6]|0,this.H=Zi[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let d=0;d<16;d++,t+=4)Xi[d]=e.getUint32(t,!1);for(let d=16;d<64;d++){const h=Xi[d-15],f=Xi[d-2],g=Es(h,7)^Es(h,18)^h>>>3,p=Es(f,17)^Es(f,19)^f>>>10;Xi[d]=p+Xi[d-7]+g+Xi[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=Es(a,6)^Es(a,11)^Es(a,25),f=u+h+o8(a,c,l)+l8[d]+Xi[d]|0,g=(Es(n,2)^Es(n,13)^Es(n,22))+a8(n,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=n,n=f+g|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){Xi.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const df=dN(()=>new u8);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Mg=BigInt(0),Fg=BigInt(1),d8=BigInt(2);function sc(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function hf(r){if(!sc(r))throw new Error("Uint8Array expected")}function fu(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const h8=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function pu(r){hf(r);let e="";for(let t=0;t<r.length;t++)e+=h8[r[t]];return e}function il(r){const e=r.toString(16);return e.length&1?"0"+e:e}function Jb(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?Mg:BigInt("0x"+r)}const oi={_0:48,_9:57,A:65,F:70,a:97,f:102};function Iv(r){if(r>=oi._0&&r<=oi._9)return r-oi._0;if(r>=oi.A&&r<=oi.F)return r-(oi.A-10);if(r>=oi.a&&r<=oi.f)return r-(oi.a-10)}function gu(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=Iv(r.charCodeAt(i)),a=Iv(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function qa(r){return Jb(pu(r))}function Vd(r){return hf(r),Jb(pu(Uint8Array.from(r).reverse()))}function mu(r,e){return gu(r.toString(16).padStart(e*2,"0"))}function jg(r,e){return mu(r,e).reverse()}function f8(r){return gu(il(r))}function wn(r,e,t){let n;if(typeof e=="string")try{n=gu(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(sc(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function Wd(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];hf(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}function p8(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}function g8(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}const Zm=r=>typeof r=="bigint"&&Mg<=r;function Hg(r,e,t){return Zm(r)&&Zm(e)&&Zm(t)&&e<=r&&r<t}function ki(r,e,t,n){if(!Hg(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function _N(r){let e;for(e=0;r>Mg;r>>=Fg,e+=1);return e}function m8(r,e){return r>>BigInt(e)&Fg}function y8(r,e,t){return r|(t?Fg:Mg)<<BigInt(e)}const Yb=r=>(d8<<BigInt(r-1))-Fg,Xm=r=>new Uint8Array(r),Sv=r=>Uint8Array.from(r);function NN(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=Xm(r),s=Xm(r),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...u)=>t(s,n,...u),c=(u=Xm())=>{s=a(Sv([0]),u),n=a(),u.length!==0&&(s=a(Sv([1]),u),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const d=[];for(;u<e;){n=a();const h=n.slice();d.push(h),u+=n.length}return Wd(...d)};return(u,d)=>{o(),c(u);let h;for(;!(h=d(l()));)c();return o(),h}}const w8={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||sc(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Hu(r,e,t={}){const n=(s,i,o)=>{const a=w8[i];if(typeof a!="function")throw new Error("invalid validator function");const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}const b8=()=>{throw new Error("not implemented")};function gw(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}var E8=Object.freeze({__proto__:null,isBytes:sc,abytes:hf,abool:fu,bytesToHex:pu,numberToHexUnpadded:il,hexToNumber:Jb,hexToBytes:gu,bytesToNumberBE:qa,bytesToNumberLE:Vd,numberToBytesBE:mu,numberToBytesLE:jg,numberToVarBytesBE:f8,ensureBytes:wn,concatBytes:Wd,equalBytes:p8,utf8ToBytes:g8,inRange:Hg,aInRange:ki,bitLen:_N,bitGet:m8,bitSet:y8,bitMask:Yb,createHmacDrbg:NN,validateObject:Hu,notImplemented:b8,memoized:gw});const tr=BigInt(0),Ut=BigInt(1),ca=BigInt(2),v8=BigInt(3),mw=BigInt(4),xv=BigInt(5),Tv=BigInt(8);function Jr(r,e){const t=r%e;return t>=tr?t:e+t}function IN(r,e,t){if(e<tr)throw new Error("invalid exponent, negatives unsupported");if(t<=tr)throw new Error("invalid modulus");if(t===Ut)return tr;let n=Ut;for(;e>tr;)e&Ut&&(n=n*r%t),r=r*r%t,e>>=Ut;return n}function Qn(r,e,t){let n=r;for(;e-- >tr;)n*=n,n%=t;return n}function yw(r,e){if(r===tr)throw new Error("invert: expected non-zero number");if(e<=tr)throw new Error("invert: expected positive modulus, got "+e);let t=Jr(r,e),n=e,s=tr,i=Ut;for(;t!==tr;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==Ut)throw new Error("invert: does not exist");return Jr(s,e)}function A8(r){const e=(r-Ut)/ca;let t,n,s;for(t=r-Ut,n=0;t%ca===tr;t/=ca,n++);for(s=ca;s<r&&IN(s,e,r)!==r-Ut;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(r+Ut)/mw;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(t+Ut)/ca;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,l=o.pow(o.mul(o.ONE,s),t),u=o.pow(a,i),d=o.pow(a,t);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let g=o.sqr(d);h<c&&!o.eql(g,o.ONE);h++)g=o.sqr(g);const f=o.pow(l,Ut<<BigInt(c-h-1));l=o.sqr(f),u=o.mul(u,f),d=o.mul(d,l),c=h}return u}}function C8(r){if(r%mw===v8){const e=(r+Ut)/mw;return function(t,n){const s=t.pow(n,e);if(!t.eql(t.sqr(s),n))throw new Error("Cannot find square root");return s}}if(r%Tv===xv){const e=(r-xv)/Tv;return function(t,n){const s=t.mul(n,ca),i=t.pow(s,e),o=t.mul(n,i),a=t.mul(t.mul(o,ca),i),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return A8(r)}const _8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function N8(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=_8.reduce((n,s)=>(n[s]="function",n),e);return Hu(r,t)}function I8(r,e,t){if(t<tr)throw new Error("invalid exponent, negatives unsupported");if(t===tr)return r.ONE;if(t===Ut)return e;let n=r.ONE,s=e;for(;t>tr;)t&Ut&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Ut;return n}function S8(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function SN(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function xN(r,e,t=!1,n={}){if(r<=tr)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:i}=SN(r,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:s,BYTES:i,MASK:Yb(s),ZERO:tr,ONE:Ut,create:c=>Jr(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return tr<=c&&c<r},is0:c=>c===tr,isOdd:c=>(c&Ut)===Ut,neg:c=>Jr(-c,r),eql:(c,l)=>c===l,sqr:c=>Jr(c*c,r),add:(c,l)=>Jr(c+l,r),sub:(c,l)=>Jr(c-l,r),mul:(c,l)=>Jr(c*l,r),pow:(c,l)=>I8(a,c,l),div:(c,l)=>Jr(c*yw(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>yw(c,r),sqrt:n.sqrt||(c=>(o||(o=C8(r)),o(a,c))),invertBatch:c=>S8(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?jg(c,i):mu(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?Vd(c):qa(c)}});return Object.freeze(a)}function TN(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function PN(r){const e=TN(r);return e+Math.ceil(e/2)}function x8(r,e,t=!1){const n=r.length,s=TN(e),i=PN(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=t?Vd(r):qa(r),a=Jr(o,e-Ut)+Ut;return t?jg(a,s):mu(a,s)}const Pv=BigInt(0),Vf=BigInt(1);function ey(r,e){const t=e.negate();return r?t:e}function ON(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function ty(r,e){ON(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function T8(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function P8(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const ry=new WeakMap,RN=new WeakMap;function ny(r){return RN.get(r)||1}function O8(r,e){return{constTimeNegate:ey,hasPrecomputes(t){return ny(t)!==1},unsafeLadder(t,n,s=r.ZERO){let i=t;for(;n>Pv;)n&Vf&&(s=s.add(i)),i=i.double(),n>>=Vf;return s},precomputeWindow(t,n){const{windows:s,windowSize:i}=ty(n,e),o=[];let a=t,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,s){const{windows:i,windowSize:o}=ty(t,e);let a=r.ZERO,c=r.BASE;const l=BigInt(2**t-1),u=2**t,d=BigInt(t);for(let h=0;h<i;h++){const f=h*o;let g=Number(s&l);s>>=d,g>o&&(g-=u,s+=Vf);const p=f,m=f+Math.abs(g)-1,w=h%2!==0,A=g<0;g===0?c=c.add(ey(w,n[p])):a=a.add(ey(A,n[m]))}return{p:a,f:c}},wNAFUnsafe(t,n,s,i=r.ZERO){const{windows:o,windowSize:a}=ty(t,e),c=BigInt(2**t-1),l=2**t,u=BigInt(t);for(let d=0;d<o;d++){const h=d*a;if(s===Pv)break;let f=Number(s&c);if(s>>=u,f>a&&(f-=l,s+=Vf),f===0)continue;let g=n[h+Math.abs(f)-1];f<0&&(g=g.negate()),i=i.add(g)}return i},getPrecomputes(t,n,s){let i=ry.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&ry.set(n,s(i))),i},wNAFCached(t,n,s){const i=ny(t);return this.wNAF(i,this.getPrecomputes(i,t,s),n)},wNAFCachedUnsafe(t,n,s,i){const o=ny(t);return o===1?this.unsafeLadder(t,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),n,i)},setWindowSize(t,n){ON(n,e),RN.set(t,n),ry.delete(t)}}}function R8(r,e,t,n){if(T8(t,r),P8(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=r.ZERO,i=_N(BigInt(t.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let f=0;f<n.length;f++){const g=n[f],p=Number(g>>BigInt(d)&BigInt(a));c[p]=c[p].add(t[f])}let h=s;for(let f=c.length-1,g=s;f>0;f--)g=g.add(c[f]),h=h.add(g);if(u=u.add(h),d!==0)for(let f=0;f<o;f++)u=u.double()}return u}function DN(r){return N8(r.Fp),Hu(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...SN(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Dc=BigInt(0),sy=BigInt(1);function D8(r){return Hu(r,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...r})}function k8(r){const e=D8(r),{P:t}=e,n=A=>Jr(A,t),s=e.montgomeryBits,i=Math.ceil(s/8),o=e.nByteLength,a=e.adjustScalarBytes||(A=>A),c=e.powPminus2||(A=>IN(A,t-BigInt(2),t));function l(A,v,I){const T=n(A*(v-I));return v=n(v-T),I=n(I+T),[v,I]}const u=(e.a-BigInt(2))/BigInt(4);function d(A,v){ki("u",A,Dc,t),ki("scalar",v,Dc,t);const I=v,T=A;let P=sy,D=Dc,U=A,S=sy,H=Dc,L;for(let Q=BigInt(s-1);Q>=Dc;Q--){const z=I>>Q&sy;H^=z,L=l(H,P,U),P=L[0],U=L[1],L=l(H,D,S),D=L[0],S=L[1],H=z;const b=P+D,E=n(b*b),O=P-D,B=n(O*O),k=E-B,F=U+S,K=U-S,Z=n(K*b),se=n(F*O),J=Z+se,ge=Z-se;U=n(J*J),S=n(T*n(ge*ge)),P=n(E*B),D=n(k*(E+n(u*k)))}L=l(H,P,U),P=L[0],U=L[1],L=l(H,D,S),D=L[0],S=L[1];const j=c(D);return n(P*j)}function h(A){return jg(n(A),i)}function f(A){const v=wn("u coordinate",A,i);return o===32&&(v[31]&=127),Vd(v)}function g(A){const v=wn("scalar",A),I=v.length;if(I!==i&&I!==o){let T=""+i+" or "+o;throw new Error("invalid scalar, expected "+T+" bytes, got "+I)}return Vd(a(v))}function p(A,v){const I=f(v),T=g(A),P=d(I,T);if(P===Dc)throw new Error("invalid private or public key received");return h(P)}const m=h(e.Gu);function w(A){return p(A,m)}return{scalarMult:p,scalarMultBase:w,getSharedSecret:(A,v)=>p(A,v),getPublicKey:A=>w(A),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:m}}const ww=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const U8=BigInt(1),Ov=BigInt(2),B8=BigInt(3),L8=BigInt(5);BigInt(8);function $8(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=ww,o=r*r%i*r%i,a=Qn(o,Ov,i)*o%i,c=Qn(a,U8,i)*r%i,l=Qn(c,L8,i)*c%i,u=Qn(l,e,i)*l%i,d=Qn(u,t,i)*u%i,h=Qn(d,n,i)*d%i,f=Qn(h,s,i)*h%i,g=Qn(f,s,i)*h%i,p=Qn(g,e,i)*l%i;return{pow_p_5_8:Qn(p,Ov,i)*r%i,b2:o}}function M8(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}const bw=k8({P:ww,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:r=>{const e=ww,{pow_p_5_8:t,b2:n}=$8(r);return Jr(Qn(t,B8,e)*n,e)},adjustScalarBytes:M8,randomBytes:ju});function Rv(r){r.lowS!==void 0&&fu("lowS",r.lowS),r.prehash!==void 0&&fu("prehash",r.prehash)}function F8(r){const e=DN(r);Hu(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:j8,hexToBytes:H8}=E8;class z8 extends Error{constructor(e=""){super(e)}}const pi={Err:z8,_tlv:{encode:(r,e)=>{const{Err:t}=pi;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const n=e.length/2,s=il(n);if(s.length/2&128)throw new t("tlv.encode: long form length too big");const i=n>127?il(s.length/2|128):"";return il(r)+i+s+e},decode(r,e){const{Err:t}=pi;let n=0;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[n++]!==r)throw new t("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new t("tlv.decode(long): indefinite length not supported");if(c>4)throw new t("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new t("tlv.decode: length bytes not complete");if(l[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new t("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(r){const{Err:e}=pi;if(r<xi)throw new e("integer: negative integers are not allowed");let t=il(r);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(r){const{Err:e}=pi;if(r[0]&128)throw new e("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return j8(r)}},toSig(r){const{Err:e,_int:t,_tlv:n}=pi,s=typeof r=="string"?H8(r):r;hf(s);const{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(l)}},hexFromSig(r){const{_tlv:e,_int:t}=pi,n=e.encode(2,t.encode(r.r)),s=e.encode(2,t.encode(r.s)),i=n+s;return e.encode(48,i)}},xi=BigInt(0),Yt=BigInt(1);BigInt(2);const Dv=BigInt(3);BigInt(4);function q8(r){const e=F8(r),{Fp:t}=e,n=xN(e.n,e.nBitLength),s=e.toBytes||((p,m,w)=>{const A=m.toAffine();return Wd(Uint8Array.from([4]),t.toBytes(A.x),t.toBytes(A.y))}),i=e.fromBytes||(p=>{const m=p.subarray(1),w=t.fromBytes(m.subarray(0,t.BYTES)),A=t.fromBytes(m.subarray(t.BYTES,2*t.BYTES));return{x:w,y:A}});function o(p){const{a:m,b:w}=e,A=t.sqr(p),v=t.mul(A,p);return t.add(t.add(v,t.mul(p,m)),w)}if(!t.eql(t.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(p){return Hg(p,Yt,e.n)}function c(p){const{allowedPrivateKeyLengths:m,nByteLength:w,wrapPrivateKey:A,n:v}=e;if(m&&typeof p!="bigint"){if(sc(p)&&(p=pu(p)),typeof p!="string"||!m.includes(p.length))throw new Error("invalid private key");p=p.padStart(w*2,"0")}let I;try{I=typeof p=="bigint"?p:qa(wn("private key",p,w))}catch{throw new Error("invalid private key, expected hex or "+w+" bytes, got "+typeof p)}return A&&(I=Jr(I,v)),ki("private key",I,Yt,v),I}function l(p){if(!(p instanceof h))throw new Error("ProjectivePoint expected")}const u=gw((p,m)=>{const{px:w,py:A,pz:v}=p;if(t.eql(v,t.ONE))return{x:w,y:A};const I=p.is0();m==null&&(m=I?t.ONE:t.inv(v));const T=t.mul(w,m),P=t.mul(A,m),D=t.mul(v,m);if(I)return{x:t.ZERO,y:t.ZERO};if(!t.eql(D,t.ONE))throw new Error("invZ was invalid");return{x:T,y:P}}),d=gw(p=>{if(p.is0()){if(e.allowInfinityPoint&&!t.is0(p.py))return;throw new Error("bad point: ZERO")}const{x:m,y:w}=p.toAffine();if(!t.isValid(m)||!t.isValid(w))throw new Error("bad point: x or y not FE");const A=t.sqr(w),v=o(m);if(!t.eql(A,v))throw new Error("bad point: equation left != right");if(!p.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class h{constructor(m,w,A){if(this.px=m,this.py=w,this.pz=A,m==null||!t.isValid(m))throw new Error("x required");if(w==null||!t.isValid(w))throw new Error("y required");if(A==null||!t.isValid(A))throw new Error("z required");Object.freeze(this)}static fromAffine(m){const{x:w,y:A}=m||{};if(!m||!t.isValid(w)||!t.isValid(A))throw new Error("invalid affine point");if(m instanceof h)throw new Error("projective point not allowed");const v=I=>t.eql(I,t.ZERO);return v(w)&&v(A)?h.ZERO:new h(w,A,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(m){const w=t.invertBatch(m.map(A=>A.pz));return m.map((A,v)=>A.toAffine(w[v])).map(h.fromAffine)}static fromHex(m){const w=h.fromAffine(i(wn("pointHex",m)));return w.assertValidity(),w}static fromPrivateKey(m){return h.BASE.multiply(c(m))}static msm(m,w){return R8(h,n,m,w)}_setWindowSize(m){g.setWindowSize(this,m)}assertValidity(){d(this)}hasEvenY(){const{y:m}=this.toAffine();if(t.isOdd)return!t.isOdd(m);throw new Error("Field doesn't support isOdd")}equals(m){l(m);const{px:w,py:A,pz:v}=this,{px:I,py:T,pz:P}=m,D=t.eql(t.mul(w,P),t.mul(I,v)),U=t.eql(t.mul(A,P),t.mul(T,v));return D&&U}negate(){return new h(this.px,t.neg(this.py),this.pz)}double(){const{a:m,b:w}=e,A=t.mul(w,Dv),{px:v,py:I,pz:T}=this;let P=t.ZERO,D=t.ZERO,U=t.ZERO,S=t.mul(v,v),H=t.mul(I,I),L=t.mul(T,T),j=t.mul(v,I);return j=t.add(j,j),U=t.mul(v,T),U=t.add(U,U),P=t.mul(m,U),D=t.mul(A,L),D=t.add(P,D),P=t.sub(H,D),D=t.add(H,D),D=t.mul(P,D),P=t.mul(j,P),U=t.mul(A,U),L=t.mul(m,L),j=t.sub(S,L),j=t.mul(m,j),j=t.add(j,U),U=t.add(S,S),S=t.add(U,S),S=t.add(S,L),S=t.mul(S,j),D=t.add(D,S),L=t.mul(I,T),L=t.add(L,L),S=t.mul(L,j),P=t.sub(P,S),U=t.mul(L,H),U=t.add(U,U),U=t.add(U,U),new h(P,D,U)}add(m){l(m);const{px:w,py:A,pz:v}=this,{px:I,py:T,pz:P}=m;let D=t.ZERO,U=t.ZERO,S=t.ZERO;const H=e.a,L=t.mul(e.b,Dv);let j=t.mul(w,I),Q=t.mul(A,T),z=t.mul(v,P),b=t.add(w,A),E=t.add(I,T);b=t.mul(b,E),E=t.add(j,Q),b=t.sub(b,E),E=t.add(w,v);let O=t.add(I,P);return E=t.mul(E,O),O=t.add(j,z),E=t.sub(E,O),O=t.add(A,v),D=t.add(T,P),O=t.mul(O,D),D=t.add(Q,z),O=t.sub(O,D),S=t.mul(H,E),D=t.mul(L,z),S=t.add(D,S),D=t.sub(Q,S),S=t.add(Q,S),U=t.mul(D,S),Q=t.add(j,j),Q=t.add(Q,j),z=t.mul(H,z),E=t.mul(L,E),Q=t.add(Q,z),z=t.sub(j,z),z=t.mul(H,z),E=t.add(E,z),j=t.mul(Q,E),U=t.add(U,j),j=t.mul(O,E),D=t.mul(b,D),D=t.sub(D,j),j=t.mul(b,Q),S=t.mul(O,S),S=t.add(S,j),new h(D,U,S)}subtract(m){return this.add(m.negate())}is0(){return this.equals(h.ZERO)}wNAF(m){return g.wNAFCached(this,m,h.normalizeZ)}multiplyUnsafe(m){const{endo:w,n:A}=e;ki("scalar",m,xi,A);const v=h.ZERO;if(m===xi)return v;if(this.is0()||m===Yt)return this;if(!w||g.hasPrecomputes(this))return g.wNAFCachedUnsafe(this,m,h.normalizeZ);let{k1neg:I,k1:T,k2neg:P,k2:D}=w.splitScalar(m),U=v,S=v,H=this;for(;T>xi||D>xi;)T&Yt&&(U=U.add(H)),D&Yt&&(S=S.add(H)),H=H.double(),T>>=Yt,D>>=Yt;return I&&(U=U.negate()),P&&(S=S.negate()),S=new h(t.mul(S.px,w.beta),S.py,S.pz),U.add(S)}multiply(m){const{endo:w,n:A}=e;ki("scalar",m,Yt,A);let v,I;if(w){const{k1neg:T,k1:P,k2neg:D,k2:U}=w.splitScalar(m);let{p:S,f:H}=this.wNAF(P),{p:L,f:j}=this.wNAF(U);S=g.constTimeNegate(T,S),L=g.constTimeNegate(D,L),L=new h(t.mul(L.px,w.beta),L.py,L.pz),v=S.add(L),I=H.add(j)}else{const{p:T,f:P}=this.wNAF(m);v=T,I=P}return h.normalizeZ([v,I])[0]}multiplyAndAddUnsafe(m,w,A){const v=h.BASE,I=(P,D)=>D===xi||D===Yt||!P.equals(v)?P.multiplyUnsafe(D):P.multiply(D),T=I(this,w).add(I(m,A));return T.is0()?void 0:T}toAffine(m){return u(this,m)}isTorsionFree(){const{h:m,isTorsionFree:w}=e;if(m===Yt)return!0;if(w)return w(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:m,clearCofactor:w}=e;return m===Yt?this:w?w(h,this):this.multiplyUnsafe(e.h)}toRawBytes(m=!0){return fu("isCompressed",m),this.assertValidity(),s(h,this,m)}toHex(m=!0){return fu("isCompressed",m),pu(this.toRawBytes(m))}}h.BASE=new h(e.Gx,e.Gy,t.ONE),h.ZERO=new h(t.ZERO,t.ONE,t.ZERO);const f=e.nBitLength,g=O8(h,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function V8(r){const e=DN(r);return Hu(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function W8(r){const e=V8(r),{Fp:t,n}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o(z){return Jr(z,n)}function a(z){return yw(z,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:d}=q8({...e,toBytes(z,b,E){const O=b.toAffine(),B=t.toBytes(O.x),k=Wd;return fu("isCompressed",E),E?k(Uint8Array.from([b.hasEvenY()?2:3]),B):k(Uint8Array.from([4]),B,t.toBytes(O.y))},fromBytes(z){const b=z.length,E=z[0],O=z.subarray(1);if(b===s&&(E===2||E===3)){const B=qa(O);if(!Hg(B,Yt,t.ORDER))throw new Error("Point is not on curve");const k=u(B);let F;try{F=t.sqrt(k)}catch(Z){const se=Z instanceof Error?": "+Z.message:"";throw new Error("Point is not on curve"+se)}const K=(F&Yt)===Yt;return(E&1)===1!==K&&(F=t.neg(F)),{x:B,y:F}}else if(b===i&&E===4){const B=t.fromBytes(O.subarray(0,t.BYTES)),k=t.fromBytes(O.subarray(t.BYTES,2*t.BYTES));return{x:B,y:k}}else{const B=s,k=i;throw new Error("invalid Point, expected length of "+B+", or uncompressed "+k+", got "+b)}}}),h=z=>pu(mu(z,e.nByteLength));function f(z){const b=n>>Yt;return z>b}function g(z){return f(z)?o(-z):z}const p=(z,b,E)=>qa(z.slice(b,E));class m{constructor(b,E,O){this.r=b,this.s=E,this.recovery=O,this.assertValidity()}static fromCompact(b){const E=e.nByteLength;return b=wn("compactSignature",b,E*2),new m(p(b,0,E),p(b,E,2*E))}static fromDER(b){const{r:E,s:O}=pi.toSig(wn("DER",b));return new m(E,O)}assertValidity(){ki("r",this.r,Yt,n),ki("s",this.s,Yt,n)}addRecoveryBit(b){return new m(this.r,this.s,b)}recoverPublicKey(b){const{r:E,s:O,recovery:B}=this,k=P(wn("msgHash",b));if(B==null||![0,1,2,3].includes(B))throw new Error("recovery id invalid");const F=B===2||B===3?E+e.n:E;if(F>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const K=B&1?"03":"02",Z=c.fromHex(K+h(F)),se=a(F),J=o(-k*se),ge=o(O*se),_e=c.BASE.multiplyAndAddUnsafe(Z,J,ge);if(!_e)throw new Error("point at infinify");return _e.assertValidity(),_e}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return gu(this.toDERHex())}toDERHex(){return pi.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return gu(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const w={isValidPrivateKey(z){try{return l(z),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const z=PN(e.n);return x8(e.randomBytes(z),e.n)},precompute(z=8,b=c.BASE){return b._setWindowSize(z),b.multiply(BigInt(3)),b}};function A(z,b=!0){return c.fromPrivateKey(z).toRawBytes(b)}function v(z){const b=sc(z),E=typeof z=="string",O=(b||E)&&z.length;return b?O===s||O===i:E?O===2*s||O===2*i:z instanceof c}function I(z,b,E=!0){if(v(z))throw new Error("first arg must be private key");if(!v(b))throw new Error("second arg must be public key");return c.fromHex(b).multiply(l(z)).toRawBytes(E)}const T=e.bits2int||function(z){if(z.length>8192)throw new Error("input is too large");const b=qa(z),E=z.length*8-e.nBitLength;return E>0?b>>BigInt(E):b},P=e.bits2int_modN||function(z){return o(T(z))},D=Yb(e.nBitLength);function U(z){return ki("num < 2^"+e.nBitLength,z,xi,D),mu(z,e.nByteLength)}function S(z,b,E=H){if(["recovered","canonical"].some(Oe=>Oe in E))throw new Error("sign() legacy options not supported");const{hash:O,randomBytes:B}=e;let{lowS:k,prehash:F,extraEntropy:K}=E;k==null&&(k=!0),z=wn("msgHash",z),Rv(E),F&&(z=wn("prehashed msgHash",O(z)));const Z=P(z),se=l(b),J=[U(se),U(Z)];if(K!=null&&K!==!1){const Oe=K===!0?B(t.BYTES):K;J.push(wn("extraEntropy",Oe))}const ge=Wd(...J),_e=Z;function $e(Oe){const Ie=T(Oe);if(!d(Ie))return;const Ct=a(Ie),Tt=c.BASE.multiply(Ie).toAffine(),Et=o(Tt.x);if(Et===xi)return;const it=o(Ct*o(_e+Et*se));if(it===xi)return;let ut=(Tt.x===Et?0:2)|Number(Tt.y&Yt),xr=it;return k&&f(it)&&(xr=g(it),ut^=1),new m(Et,xr,ut)}return{seed:ge,k2sig:$e}}const H={lowS:e.lowS,prehash:!1},L={lowS:e.lowS,prehash:!1};function j(z,b,E=H){const{seed:O,k2sig:B}=S(z,b,E),k=e;return NN(k.hash.outputLen,k.nByteLength,k.hmac)(O,B)}c.BASE._setWindowSize(8);function Q(z,b,E,O=L){var it;const B=z;b=wn("msgHash",b),E=wn("publicKey",E);const{lowS:k,prehash:F,format:K}=O;if(Rv(O),"strict"in O)throw new Error("options.strict was renamed to lowS");if(K!==void 0&&K!=="compact"&&K!=="der")throw new Error("format must be compact or der");const Z=typeof B=="string"||sc(B),se=!Z&&!K&&typeof B=="object"&&B!==null&&typeof B.r=="bigint"&&typeof B.s=="bigint";if(!Z&&!se)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let J,ge;try{if(se&&(J=new m(B.r,B.s)),Z){try{K!=="compact"&&(J=m.fromDER(B))}catch(ut){if(!(ut instanceof pi.Err))throw ut}!J&&K!=="der"&&(J=m.fromCompact(B))}ge=c.fromHex(E)}catch{return!1}if(!J||k&&J.hasHighS())return!1;F&&(b=e.hash(b));const{r:_e,s:$e}=J,Oe=P(b),Ie=a($e),Ct=o(Oe*Ie),Tt=o(_e*Ie),Et=(it=c.BASE.multiplyAndAddUnsafe(ge,Ct,Tt))==null?void 0:it.toAffine();return Et?o(Et.x)===_e:!1}return{CURVE:e,getPublicKey:A,getSharedSecret:I,sign:j,verify:Q,ProjectivePoint:c,Signature:m,utils:w}}function G8(r){return{hash:r,hmac:(e,...t)=>$g(r,e,QU(...t)),randomBytes:ju}}function K8(r,e){const t=n=>W8({...r,...G8(n)});return{...t(e),create:t}}const kN=xN(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),J8=kN.create(BigInt("-3")),Y8=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Q8=K8({a:J8,b:Y8,Fp:kN,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},df),UN="base10",$r="base16",us="base64pad",lo="base64url",ff="utf8",BN=0,Ui=1,pf=2,Z8=0,kv=1,Sd=12,Qb=32;function X8(){const r=bw.utils.randomPrivateKey(),e=bw.getPublicKey(r);return{privateKey:Zr(r,$r),publicKey:Zr(e,$r)}}function Ew(){const r=ju(Qb);return Zr(r,$r)}function eB(r,e){const t=bw.getSharedSecret(Fn(r,$r),Fn(e,$r)),n=s8(df,t,void 0,void 0,Qb);return Zr(n,$r)}function bp(r){const e=df(Fn(r,$r));return Zr(e,$r)}function Ls(r){const e=df(Fn(r,ff));return Zr(e,$r)}function LN(r){return Fn(`${r}`,UN)}function ic(r){return Number(Zr(r,UN))}function $N(r){return r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function MN(r){const e=r.replace(/-/g,"+").replace(/_/g,"/"),t=(4-e.length%4)%4;return e+"=".repeat(t)}function tB(r){const e=LN(typeof r.type<"u"?r.type:BN);if(ic(e)===Ui&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?Fn(r.senderPublicKey,$r):void 0,n=typeof r.iv<"u"?Fn(r.iv,$r):ju(Sd),s=Fn(r.symKey,$r),i=AN(s,n).encrypt(Fn(r.message,ff)),o=FN({type:e,sealed:i,iv:n,senderPublicKey:t});return r.encoding===lo?$N(o):o}function rB(r){const e=Fn(r.symKey,$r),{sealed:t,iv:n}=Gd({encoded:r.encoded,encoding:r.encoding}),s=AN(e,n).decrypt(t);if(s===null)throw new Error("Failed to decrypt");return Zr(s,ff)}function nB(r,e){const t=LN(pf),n=ju(Sd),s=Fn(r,ff),i=FN({type:t,sealed:s,iv:n});return e===lo?$N(i):i}function sB(r,e){const{sealed:t}=Gd({encoded:r,encoding:e});return Zr(t,ff)}function FN(r){if(ic(r.type)===pf)return Zr(Id([r.type,r.sealed]),us);if(ic(r.type)===Ui){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Zr(Id([r.type,r.senderPublicKey,r.iv,r.sealed]),us)}return Zr(Id([r.type,r.iv,r.sealed]),us)}function Gd(r){const e=(r.encoding||us)===lo?MN(r.encoded):r.encoded,t=Fn(e,us),n=t.slice(Z8,kv),s=kv;if(ic(n)===Ui){const c=s+Qb,l=c+Sd,u=t.slice(s,c),d=t.slice(c,l),h=t.slice(l);return{type:n,sealed:h,iv:d,senderPublicKey:u}}if(ic(n)===pf){const c=t.slice(s),l=ju(Sd);return{type:n,sealed:c,iv:l}}const i=s+Sd,o=t.slice(s,i),a=t.slice(i);return{type:n,sealed:a,iv:o}}function iB(r,e){const t=Gd({encoded:r,encoding:e==null?void 0:e.encoding});return jN({type:ic(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?Zr(t.senderPublicKey,$r):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function jN(r){const e=(r==null?void 0:r.type)||BN;if(e===Ui){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function Uv(r){return r.type===Ui&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function Bv(r){return r.type===pf}function oB(r){const e=Buffer.from(r.x,"base64"),t=Buffer.from(r.y,"base64");return Id([new Uint8Array([4]),e,t])}function aB(r,e){const[t,n,s]=r.split("."),i=Buffer.from(MN(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${t}.${n}`,l=df(c),u=oB(e);if(!Q8.verify(Id([o,a]),l,u))throw new Error("Invalid signature");return iw(r).payload}const cB="irn";function Wp(r){return(r==null?void 0:r.relay)||{protocol:cB}}function yd(r){const e=fU[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}function lB(r,e="-"){const t={},n="relay"+e;return Object.keys(r).forEach(s=>{if(s.startsWith(n)){const i=s.replace(n,""),o=r[s];t[i]=o}}),t}function Lv(r){if(!r.includes("wc:")){const l=lN(r);l!=null&&l.includes("wc:")&&(r=l)}r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,n=r.substring(0,e),s=r.substring(e+1,t).split("@"),i=typeof t<"u"?r.substring(t):"",o=new URLSearchParams(i),a={};o.forEach((l,u)=>{a[u]=l});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:uB(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:lB(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function uB(r){return r.startsWith("//")?r.substring(2):r}function dB(r,e="-"){const t="relay",n={};return Object.keys(r).forEach(s=>{const i=s,o=t+e+i;r[i]&&(n[o]=r[i])}),n}function $v(r){const e=new URLSearchParams,t=dB(r.relay);Object.keys(t).sort().forEach(s=>{e.set(s,t[s])}),e.set("symKey",r.symKey),r.expiryTimestamp&&e.set("expiryTimestamp",r.expiryTimestamp.toString()),r.methods&&e.set("methods",r.methods.join(","));const n=e.toString();return`${r.protocol}:${r.topic}@${r.version}?${n}`}function Wf(r,e,t){return`${r}?wc_ev=${t}&topic=${e}`}function zu(r){const e=[];return r.forEach(t=>{const[n,s]=t.split(":");e.push(`${n}:${s}`)}),e}function hB(r){const e=[];return Object.values(r).forEach(t=>{e.push(...zu(t.accounts))}),e}function fB(r,e){const t=[];return Object.values(r).forEach(n=>{zu(n.accounts).includes(e)&&t.push(...n.methods)}),t}function pB(r,e){const t=[];return Object.values(r).forEach(n=>{zu(n.accounts).includes(e)&&t.push(...n.events)}),t}function Zb(r){return r.includes(":")}function wd(r){return Zb(r)?r.split(":")[0]:r}function gB(r){const e={};return r==null||r.forEach(t=>{var n;const[s,i]=t.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(t),(n=e[s].chains)==null||n.push(`${s}:${i}`)}),e}function Mv(r,e){e=e.map(n=>n.replace("did:pkh:",""));const t=gB(e);for(const[n,s]of Object.entries(t))s.methods?s.methods=yp(s.methods,r):s.methods=r,s.events=["chainChanged","accountsChanged"];return t}const mB={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},yB={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function te(r,e){const{message:t,code:n}=yB[r];return{message:e?`${t} ${e}`:t,code:n}}function at(r,e){const{message:t,code:n}=mB[r];return{message:e?`${t} ${e}`:t,code:n}}function Do(r,e){return!!Array.isArray(r)}function Kd(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function lr(r){return typeof r>"u"}function Ft(r,e){return e&&lr(r)?!0:typeof r=="string"&&!!r.trim().length}function Xb(r,e){return e&&lr(r)?!0:typeof r=="number"&&!isNaN(r)}function wB(r,e){const{requiredNamespaces:t}=e,n=Object.keys(r.namespaces),s=Object.keys(t);let i=!0;return ma(s,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:l}=r.namespaces[o],u=zu(a),d=t[o];(!ma(sN(o,d),u)||!ma(d.methods,c)||!ma(d.events,l))&&(i=!1)}),i):!1}function Gp(r){return Ft(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function bB(r){if(Ft(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Gp(t)}}return!1}function EB(r){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(Ft(r,!1)){if(e(r))return!0;const t=lN(r);return e(t)}}catch{}return!1}function vB(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function AB(r){return r==null?void 0:r.topic}function CB(r,e){let t=null;return Ft(r==null?void 0:r.publicKey,!1)||(t=te("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Fv(r){let e=!0;return Do(r)?r.length&&(e=r.every(t=>Ft(t,!1))):e=!1,e}function _B(r,e,t){let n=null;return Do(e)&&e.length?e.forEach(s=>{n||Gp(s)||(n=at("UNSUPPORTED_CHAINS",`${t}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):Gp(r)||(n=at("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function NB(r,e,t){let n=null;return Object.entries(r).forEach(([s,i])=>{if(n)return;const o=_B(s,sN(s,i),`${e} ${t}`);o&&(n=o)}),n}function IB(r,e){let t=null;return Do(r)?r.forEach(n=>{t||bB(n)||(t=at("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):t=at("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function SB(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=IB(n==null?void 0:n.accounts,`${e} namespace`);s&&(t=s)}),t}function xB(r,e){let t=null;return Fv(r==null?void 0:r.methods)?Fv(r==null?void 0:r.events)||(t=at("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=at("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function HN(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=xB(n,`${e}, namespace`);s&&(t=s)}),t}function TB(r,e,t){let n=null;if(r&&Kd(r)){const s=HN(r,e);s&&(n=s);const i=NB(r,e,t);i&&(n=i)}else n=te("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return n}function iy(r,e){let t=null;if(r&&Kd(r)){const n=HN(r,e);n&&(t=n);const s=SB(r,e);s&&(t=s)}else t=te("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function zN(r){return Ft(r.protocol,!0)}function PB(r,e){let t=!1;return r?r&&Do(r)&&r.length&&r.forEach(n=>{t=zN(n)}):t=!0,t}function OB(r){return typeof r=="number"}function Wr(r){return typeof r<"u"&&typeof r!==null}function RB(r){return!(!r||typeof r!="object"||!r.code||!Xb(r.code,!1)||!r.message||!Ft(r.message,!1))}function DB(r){return!(lr(r)||!Ft(r.method,!1))}function kB(r){return!(lr(r)||lr(r.result)&&lr(r.error)||!Xb(r.id,!1)||!Ft(r.jsonrpc,!1))}function UB(r){return!(lr(r)||!Ft(r.name,!1))}function jv(r,e){return!(!Gp(e)||!hB(r).includes(e))}function BB(r,e,t){return Ft(t,!1)?fB(r,e).includes(t):!1}function LB(r,e,t){return Ft(t,!1)?pB(r,e).includes(t):!1}function Hv(r,e,t){let n=null;const s=$B(r),i=MB(e),o=Object.keys(s),a=Object.keys(i),c=zv(Object.keys(r)),l=zv(Object.keys(e)),u=c.filter(d=>!l.includes(d));return u.length&&(n=te("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),ma(o,a)||(n=te("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||n)return;const h=zu(e[d].accounts);h.includes(d)||(n=te("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{n||(ma(s[d].methods,i[d].methods)?ma(s[d].events,i[d].events)||(n=te("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${d}`)):n=te("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${d}`))}),n}function $B(r){const e={};return Object.keys(r).forEach(t=>{var n;t.includes(":")?e[t]=r[t]:(n=r[t].chains)==null||n.forEach(s=>{e[s]={methods:r[t].methods,events:r[t].events}})}),e}function zv(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function MB(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const n=zu(r[t].accounts);n==null||n.forEach(s=>{e[s]={accounts:r[t].accounts.filter(i=>i.includes(`${s}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function FB(r,e){return Xb(r,!1)&&r<=e.max&&r>=e.min}function qv(){const r=lf();return new Promise(e=>{switch(r){case vn.browser:e(jB());break;case vn.reactNative:e(HB());break;case vn.node:e(zB());break;default:e(!0)}})}function jB(){return cf()&&(navigator==null?void 0:navigator.onLine)}async function HB(){if(qo()&&typeof global<"u"&&global!=null&&global.NetInfo){const r=await(global==null?void 0:global.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function zB(){return!0}function qB(r){switch(lf()){case vn.browser:VB(r);break;case vn.reactNative:WB(r);break}}function VB(r){!qo()&&cf()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function WB(r){qo()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>r(e==null?void 0:e.isConnected)))}const oy={};class sd{static get(e){return oy[e]}static set(e,t){oy[e]=t}static delete(e){delete oy[e]}}const GB="PARSE_ERROR",KB="INVALID_REQUEST",JB="METHOD_NOT_FOUND",YB="INVALID_PARAMS",qN="INTERNAL_ERROR",e0="SERVER_ERROR",QB=[-32700,-32600,-32601,-32602,-32603],xd={[GB]:{code:-32700,message:"Parse error"},[KB]:{code:-32600,message:"Invalid Request"},[JB]:{code:-32601,message:"Method not found"},[YB]:{code:-32602,message:"Invalid params"},[qN]:{code:-32603,message:"Internal error"},[e0]:{code:-32e3,message:"Server error"}},VN=e0;function ZB(r){return QB.includes(r)}function Vv(r){return Object.keys(xd).includes(r)?xd[r]:xd[VN]}function XB(r){const e=Object.values(xd).find(t=>t.code===r);return e||xd[VN]}function WN(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}var GN={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var vw=function(r,e){return vw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},vw(r,e)};function eL(r,e){vw(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Aw=function(){return Aw=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Aw.apply(this,arguments)};function tL(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function rL(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function nL(r,e){return function(t,n){e(t,n,r)}}function sL(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function iL(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}function oL(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,s=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){t.label=l[1];break}if(l[0]===6&&t.label<i[1]){t.label=i[1],i=l;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(l);break}i[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(u){l=[6,u],s=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function aL(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function cL(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Cw(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function KN(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i}function lL(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(KN(arguments[e]));return r}function uL(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),s=0,e=0;e<t;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function Jd(r){return this instanceof Jd?(this.v=r,this):new Jd(r)}function dL(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){n[h]&&(s[h]=function(f){return new Promise(function(g,p){i.push([h,f,g,p])>1||a(h,f)})})}function a(h,f){try{c(n[h](f))}catch(g){d(i[0][3],g)}}function c(h){h.value instanceof Jd?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function hL(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:Jd(r[s](o)),done:s==="return"}:i?i(o):o}:i}}function fL(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Cw=="function"?Cw(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(a,c){o=r[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function pL(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function gL(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function mL(r){return r&&r.__esModule?r:{default:r}}function yL(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function wL(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const bL=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Aw},__asyncDelegator:hL,__asyncGenerator:dL,__asyncValues:fL,__await:Jd,__awaiter:iL,__classPrivateFieldGet:yL,__classPrivateFieldSet:wL,__createBinding:aL,__decorate:rL,__exportStar:cL,__extends:eL,__generator:oL,__importDefault:mL,__importStar:gL,__makeTemplateObject:pL,__metadata:sL,__param:nL,__read:KN,__rest:tL,__spread:lL,__spreadArrays:uL,__values:Cw},Symbol.toStringTag,{value:"Module"})),EL=$C(bL);var ai={},Wv;function vL(){if(Wv)return ai;Wv=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.isBrowserCryptoAvailable=ai.getSubtleCrypto=ai.getBrowerCrypto=void 0;function r(){return(Bs===null||Bs===void 0?void 0:Bs.crypto)||(Bs===null||Bs===void 0?void 0:Bs.msCrypto)||{}}ai.getBrowerCrypto=r;function e(){const n=r();return n.subtle||n.webkitSubtle}ai.getSubtleCrypto=e;function t(){return!!r()&&!!e()}return ai.isBrowserCryptoAvailable=t,ai}var ci={},Gv;function AL(){if(Gv)return ci;Gv=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.isBrowser=ci.isNode=ci.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ci.isReactNative=r;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ci.isNode=e;function t(){return!r()&&!e()}return ci.isBrowser=t,ci}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=EL;e.__exportStar(vL(),r),e.__exportStar(AL(),r)})(GN);function Ns(r=3){const e=Date.now()*Math.pow(10,r),t=Math.floor(Math.random()*Math.pow(10,r));return e+t}function ya(r=6){return BigInt(Ns(r))}function Oo(r,e,t){return{id:t||Ns(),jsonrpc:"2.0",method:r,params:e}}function zg(r,e){return{id:r,jsonrpc:"2.0",result:e}}function qg(r,e,t){return{id:r,jsonrpc:"2.0",error:CL(e)}}function CL(r,e){return typeof r>"u"?Vv(qN):(typeof r=="string"&&(r=Object.assign(Object.assign({},Vv(e0)),{message:r})),ZB(r.code)&&(r=XB(r.code)),r)}let _L=class{},NL=class extends _L{constructor(){super()}},IL=class extends NL{constructor(e){super()}};const SL="^https?:",xL="^wss?:";function TL(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function JN(r,e){const t=TL(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function Kv(r){return JN(r,SL)}function Jv(r){return JN(r,xL)}function PL(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function YN(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function t0(r){return YN(r)&&"method"in r}function Vg(r){return YN(r)&&(Is(r)||$n(r))}function Is(r){return"result"in r}function $n(r){return"error"in r}let Hn=class extends IL{constructor(e){super(e),this.events=new jn.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Oo(e.method,e.params||[],e.id||ya().toString()),t)}async requestStrict(e,t){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{$n(i)?s(i.error):n(i.result)});try{await this.connection.send(e,t)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Vg(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const OL=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),RL=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Yv=r=>r.split("?")[0],Qv=10,DL=OL();let kL=class{constructor(e){if(this.url=e,this.events=new jn.EventEmitter,this.registering=!1,!Jv(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send($i(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!Jv(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,n)=>{const s=GN.isReactNative()?void 0:{rejectUnauthorized:!PL(e)},i=new DL(e,[],s);RL()?i.onerror=o=>{const a=o;n(this.emitError(a.error))}:i.on("error",o=>{n(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),t(i)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?rc(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),s=n.message||n.toString(),i=qg(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return WN(e,Yv(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Qv&&this.events.setMaxListeners(Qv)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Yv(this.url)}`));return this.events.emit("register_error",t),t}};var UL={};const QN="wc",ZN=2,_w="core",Ks=`${QN}@2:${_w}:`,BL={logger:"error"},LL={database:":memory:"},$L="crypto",Zv="client_ed25519_seed",ML=X.ONE_DAY,FL="keychain",jL="0.3",HL="messages",zL="0.3",Xv=X.SIX_HOURS,qL="publisher",XN="irn",VL="error",eI="wss://relay.walletconnect.org",WL="relayer",Zt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},GL="_subscription",Nn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},KL=.1,Nw="2.19.2",vt={link_mode:"link_mode",relay:"relay"},Ep={inbound:"inbound",outbound:"outbound"},JL="0.3",YL="WALLETCONNECT_CLIENT_ID",eA="WALLETCONNECT_LINK_MODE_APPS",hn={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},QL="subscription",ZL="0.3",XL="pairing",e$="0.3",id={wc_pairingDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:X.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:X.ONE_DAY,prompt:!1,tag:0},res:{ttl:X.ONE_DAY,prompt:!1,tag:0}}},la={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Kn={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},t$="history",r$="0.3",n$="expirer",On={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},s$="0.3",i$="verify-api",o$="https://verify.walletconnect.com",tI="https://verify.walletconnect.org",Td=tI,a$=`${Td}/v3`,c$=[o$,tI],l$="echo",u$="https://echo.walletconnect.com",_s={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},ui={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Jn={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Yo={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Qo={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},od={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},d$=.1,h$="event-client",f$=86400,p$="https://pulse.walletconnect.org/batch";function g$(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var p=0,m=0,w=0,A=g.length;w!==A&&g[w]===0;)w++,p++;for(var v=(A-w)*u+1>>>0,I=new Uint8Array(v);w!==A;){for(var T=g[w],P=0,D=v-1;(T!==0||P<m)&&D!==-1;D--,P++)T+=256*I[D]>>>0,I[D]=T%a>>>0,T=T/a>>>0;if(T!==0)throw new Error("Non-zero carry");m=P,w++}for(var U=v-m;U!==v&&I[U]===0;)U++;for(var S=c.repeat(p);U<v;++U)S+=r.charAt(I[U]);return S}function h(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var p=0;if(g[p]!==" "){for(var m=0,w=0;g[p]===c;)m++,p++;for(var A=(g.length-p)*l+1>>>0,v=new Uint8Array(A);g[p];){var I=t[g.charCodeAt(p)];if(I===255)return;for(var T=0,P=A-1;(I!==0||T<w)&&P!==-1;P--,T++)I+=a*v[P]>>>0,v[P]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");w=T,p++}if(g[p]!==" "){for(var D=A-w;D!==A&&v[D]===0;)D++;for(var U=new Uint8Array(m+(A-D)),S=m;D!==A;)U[S++]=v[D++];return U}}}function f(g){var p=h(g);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var m$=g$,y$=m$;const rI=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},w$=r=>new TextEncoder().encode(r),b$=r=>new TextDecoder().decode(r);class E${constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class v${constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return nI(this,e)}}class A${constructor(e){this.decoders=e}or(e){return nI(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const nI=(r,e)=>new A$({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class C${constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new E$(e,t,n),this.decoder=new v$(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Wg=({name:r,prefix:e,encode:t,decode:n})=>new C$(r,e,t,n),gf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=y$(t,e);return Wg({prefix:r,name:e,encode:n,decode:i=>rI(s(i))})},_$=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[r[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|d,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},N$=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},wr=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Wg({prefix:e,name:r,encode(s){return N$(s,n,t)},decode(s){return _$(s,n,t,r)}}),I$=Wg({prefix:"\0",name:"identity",encode:r=>b$(r),decode:r=>w$(r)});var S$=Object.freeze({__proto__:null,identity:I$});const x$=wr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var T$=Object.freeze({__proto__:null,base2:x$});const P$=wr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var O$=Object.freeze({__proto__:null,base8:P$});const R$=gf({prefix:"9",name:"base10",alphabet:"0123456789"});var D$=Object.freeze({__proto__:null,base10:R$});const k$=wr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),U$=wr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var B$=Object.freeze({__proto__:null,base16:k$,base16upper:U$});const L$=wr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),$$=wr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),M$=wr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),F$=wr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),j$=wr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),H$=wr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),z$=wr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),q$=wr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),V$=wr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var W$=Object.freeze({__proto__:null,base32:L$,base32upper:$$,base32pad:M$,base32padupper:F$,base32hex:j$,base32hexupper:H$,base32hexpad:z$,base32hexpadupper:q$,base32z:V$});const G$=gf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),K$=gf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var J$=Object.freeze({__proto__:null,base36:G$,base36upper:K$});const Y$=gf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Q$=gf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Z$=Object.freeze({__proto__:null,base58btc:Y$,base58flickr:Q$});const X$=wr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),e4=wr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),t4=wr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),r4=wr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var n4=Object.freeze({__proto__:null,base64:X$,base64pad:e4,base64url:t4,base64urlpad:r4});const sI=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),s4=sI.reduce((r,e,t)=>(r[t]=e,r),[]),i4=sI.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function o4(r){return r.reduce((e,t)=>(e+=s4[t],e),"")}function a4(r){const e=[];for(const t of r){const n=i4[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const c4=Wg({prefix:"🚀",name:"base256emoji",encode:o4,decode:a4});var l4=Object.freeze({__proto__:null,base256emoji:c4}),u4=iI,tA=128,d4=-128,h4=Math.pow(2,31);function iI(r,e,t){e=e||[],t=t||0;for(var n=t;r>=h4;)e[t++]=r&255|tA,r/=128;for(;r&d4;)e[t++]=r&255|tA,r>>>=7;return e[t]=r|0,iI.bytes=t-n+1,e}var f4=Iw,p4=128,rA=127;function Iw(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw Iw.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&rA)<<s:(o&rA)*Math.pow(2,s),s+=7}while(o>=p4);return Iw.bytes=i-n,t}var g4=Math.pow(2,7),m4=Math.pow(2,14),y4=Math.pow(2,21),w4=Math.pow(2,28),b4=Math.pow(2,35),E4=Math.pow(2,42),v4=Math.pow(2,49),A4=Math.pow(2,56),C4=Math.pow(2,63),_4=function(r){return r<g4?1:r<m4?2:r<y4?3:r<w4?4:r<b4?5:r<E4?6:r<v4?7:r<A4?8:r<C4?9:10},N4={encode:u4,decode:f4,encodingLength:_4},oI=N4;const nA=(r,e,t=0)=>(oI.encode(r,e,t),e),sA=r=>oI.encodingLength(r),Sw=(r,e)=>{const t=e.byteLength,n=sA(r),s=n+sA(t),i=new Uint8Array(s+t);return nA(r,i,0),nA(t,i,n),i.set(e,s),new I4(r,t,e,i)};class I4{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const aI=({name:r,code:e,encode:t})=>new S4(r,e,t);class S4{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Sw(this.code,t):t.then(n=>Sw(this.code,n))}else throw Error("Unknown type, must be binary type")}}const cI=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),x4=aI({name:"sha2-256",code:18,encode:cI("SHA-256")}),T4=aI({name:"sha2-512",code:19,encode:cI("SHA-512")});var P4=Object.freeze({__proto__:null,sha256:x4,sha512:T4});const lI=0,O4="identity",uI=rI,R4=r=>Sw(lI,uI(r)),D4={code:lI,name:O4,encode:uI,digest:R4};var k4=Object.freeze({__proto__:null,identity:D4});new TextEncoder,new TextDecoder;const iA={...S$,...T$,...O$,...D$,...B$,...W$,...J$,...Z$,...n4,...l4};({...P4,...k4});function U4(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function dI(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const oA=dI("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),ay=dI("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=U4(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),B4={utf8:oA,"utf-8":oA,hex:iA.base16,latin1:ay,ascii:ay,binary:ay,...iA};function L4(r,e="utf8"){const t=B4[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}var $4=Object.defineProperty,M4=(r,e,t)=>e in r?$4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,vs=(r,e,t)=>M4(r,typeof e!="symbol"?e+"":e,t);class F4{constructor(e,t){this.core=e,this.logger=t,vs(this,"keychain",new Map),vs(this,"name",FL),vs(this,"version",jL),vs(this,"initialized",!1),vs(this,"storagePrefix",Ks),vs(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),vs(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),vs(this,"set",async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()}),vs(this,"get",n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:i}=te("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(i)}return s}),vs(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=Sr(t,this.name)}get context(){return rn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,lw(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?uw(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var j4=Object.defineProperty,H4=(r,e,t)=>e in r?j4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ir=(r,e,t)=>H4(r,typeof e!="symbol"?e+"":e,t);class z4{constructor(e,t,n){this.core=e,this.logger=t,ir(this,"name",$L),ir(this,"keychain"),ir(this,"randomSessionIdentifier",Ew()),ir(this,"initialized",!1),ir(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),ir(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),ir(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=FE(s);return B_(i.publicKey)}),ir(this,"generateKeyPair",()=>{this.isInitialized();const s=X8();return this.setPrivateKey(s.publicKey,s.privateKey)}),ir(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=FE(i),a=this.randomSessionIdentifier;return await tk(a,s,ML,o)}),ir(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=eB(a,i);return this.setSymKey(c,o)}),ir(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||bp(s);return await this.keychain.set(o,s),o}),ir(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),ir(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),ir(this,"encode",async(s,i,o)=>{this.isInitialized();const a=jN(o),c=$i(i);if(Bv(a))return nB(c,o==null?void 0:o.encoding);if(Uv(a)){const h=a.senderPublicKey,f=a.receiverPublicKey;s=await this.generateSharedKey(h,f)}const l=this.getSymKey(s),{type:u,senderPublicKey:d}=a;return tB({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o==null?void 0:o.encoding})}),ir(this,"decode",async(s,i,o)=>{this.isInitialized();const a=iB(i,o);if(Bv(a)){const c=sB(i,o==null?void 0:o.encoding);return rc(c)}if(Uv(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=rB({symKey:c,encoded:i,encoding:o==null?void 0:o.encoding});return rc(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),ir(this,"getPayloadType",(s,i=us)=>{const o=Gd({encoded:s,encoding:i});return ic(o.type)}),ir(this,"getPayloadSenderPublicKey",(s,i=us)=>{const o=Gd({encoded:s,encoding:i});return o.senderPublicKey?Zr(o.senderPublicKey,$r):void 0}),this.core=e,this.logger=Sr(t,this.name),this.keychain=n||new F4(this.core,this.logger)}get context(){return rn(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Zv)}catch{e=Ew(),await this.keychain.set(Zv,e)}return L4(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var q4=Object.defineProperty,V4=Object.defineProperties,W4=Object.getOwnPropertyDescriptors,aA=Object.getOwnPropertySymbols,G4=Object.prototype.hasOwnProperty,K4=Object.prototype.propertyIsEnumerable,xw=(r,e,t)=>e in r?q4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,J4=(r,e)=>{for(var t in e||(e={}))G4.call(e,t)&&xw(r,t,e[t]);if(aA)for(var t of aA(e))K4.call(e,t)&&xw(r,t,e[t]);return r},Y4=(r,e)=>V4(r,W4(e)),cn=(r,e,t)=>xw(r,typeof e!="symbol"?e+"":e,t);class Q4 extends XO{constructor(e,t){super(e,t),this.logger=e,this.core=t,cn(this,"messages",new Map),cn(this,"messagesWithoutClientAck",new Map),cn(this,"name",HL),cn(this,"version",zL),cn(this,"initialized",!1),cn(this,"storagePrefix",Ks),cn(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),cn(this,"set",async(n,s,i)=>{this.isInitialized();const o=Ls(s);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(n,a),i===Ep.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,Y4(J4({},c),{[o]:s}))}return await this.persist(),o}),cn(this,"get",n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s}),cn(this,"getWithoutAck",n=>{this.isInitialized();const s={};for(const i of n){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),cn(this,"has",(n,s)=>{this.isInitialized();const i=this.get(n),o=Ls(s);return typeof i[o]<"u"}),cn(this,"ack",async(n,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(n);if(typeof i>"u")return;const o=Ls(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,i),await this.persist()}),cn(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=Sr(e,this.name),this.core=t}get context(){return rn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,lw(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,lw(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?uw(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?uw(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Z4=Object.defineProperty,X4=Object.defineProperties,eM=Object.getOwnPropertyDescriptors,cA=Object.getOwnPropertySymbols,tM=Object.prototype.hasOwnProperty,rM=Object.prototype.propertyIsEnumerable,Tw=(r,e,t)=>e in r?Z4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Gf=(r,e)=>{for(var t in e||(e={}))tM.call(e,t)&&Tw(r,t,e[t]);if(cA)for(var t of cA(e))rM.call(e,t)&&Tw(r,t,e[t]);return r},cy=(r,e)=>X4(r,eM(e)),Yn=(r,e,t)=>Tw(r,typeof e!="symbol"?e+"":e,t);class nM extends e2{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Yn(this,"events",new jn.EventEmitter),Yn(this,"name",qL),Yn(this,"queue",new Map),Yn(this,"publishTimeout",X.toMiliseconds(X.ONE_MINUTE)),Yn(this,"initialPublishTimeout",X.toMiliseconds(X.ONE_SECOND*15)),Yn(this,"needsTransportRestart",!1),Yn(this,"publish",async(n,s,i)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:i}});const a=(i==null?void 0:i.ttl)||Xv,c=Wp(i),l=(i==null?void 0:i.prompt)||!1,u=(i==null?void 0:i.tag)||0,d=(i==null?void 0:i.id)||ya().toString(),h={topic:n,message:s,opts:{ttl:a,relay:c,prompt:l,tag:u,id:d,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}},f=`Failed to publish payload, please try again. id:${d} tag:${u}`;try{const g=new Promise(async p=>{const m=({id:A})=>{h.opts.id===A&&(this.removeRequestFromQueue(A),this.relayer.events.removeListener(Zt.publish,m),p(h))};this.relayer.events.on(Zt.publish,m);const w=Po(new Promise((A,v)=>{this.rpcPublish({topic:n,message:s,ttl:a,prompt:l,tag:u,id:d,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}).then(A).catch(I=>{this.logger.warn(I,I==null?void 0:I.message),v(I)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${d} tag:${u}`);try{await w,this.events.removeListener(Zt.publish,m)}catch(A){this.queue.set(d,cy(Gf({},h),{attempt:1})),this.logger.warn(A,A==null?void 0:A.message)}});this.logger.trace({type:"method",method:"publish",params:{id:d,topic:n,message:s,opts:i}}),await Po(g,this.publishTimeout,f)}catch(g){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(g),(o=i==null?void 0:i.internal)!=null&&o.throwOnFailedPublish)throw g}finally{this.queue.delete(d)}}),Yn(this,"on",(n,s)=>{this.events.on(n,s)}),Yn(this,"once",(n,s)=>{this.events.once(n,s)}),Yn(this,"off",(n,s)=>{this.events.off(n,s)}),Yn(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.relayer=e,this.logger=Sr(t,this.name),this.registerEventListeners()}get context(){return rn(this.logger)}async rpcPublish(e){var t,n,s,i;const{topic:o,message:a,ttl:c=Xv,prompt:l,tag:u,id:d,attestation:h,tvf:f}=e,g={method:yd(Wp().protocol).publish,params:Gf({topic:o,message:a,ttl:c,prompt:l,tag:u,attestation:h},f),id:d};lr((t=g.params)==null?void 0:t.prompt)&&((n=g.params)==null||delete n.prompt),lr((s=g.params)==null?void 0:s.tag)&&((i=g.params)==null||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:g});const p=await this.relayer.request(g);return this.relayer.events.emit(Zt.publish,e),this.logger.debug("Successfully Published Payload"),p}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{const n=e.attempt+1;this.queue.set(t,cy(Gf({},e),{attempt:n}));const{topic:s,message:i,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${n}`),await this.rpcPublish(cy(Gf({},e),{topic:s,message:i,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Uu.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Zt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Zt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var sM=Object.defineProperty,iM=(r,e,t)=>e in r?sM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,kc=(r,e,t)=>iM(r,typeof e!="symbol"?e+"":e,t);class oM{constructor(){kc(this,"map",new Map),kc(this,"set",(e,t)=>{const n=this.get(e);this.exists(e,t)||this.map.set(e,[...n,t])}),kc(this,"get",e=>this.map.get(e)||[]),kc(this,"exists",(e,t)=>this.get(e).includes(t)),kc(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,t))return;const s=n.filter(i=>i!==t);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),kc(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var aM=Object.defineProperty,cM=Object.defineProperties,lM=Object.getOwnPropertyDescriptors,lA=Object.getOwnPropertySymbols,uM=Object.prototype.hasOwnProperty,dM=Object.prototype.propertyIsEnumerable,Pw=(r,e,t)=>e in r?aM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ad=(r,e)=>{for(var t in e||(e={}))uM.call(e,t)&&Pw(r,t,e[t]);if(lA)for(var t of lA(e))dM.call(e,t)&&Pw(r,t,e[t]);return r},ly=(r,e)=>cM(r,lM(e)),dt=(r,e,t)=>Pw(r,typeof e!="symbol"?e+"":e,t);class hM extends n2{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,dt(this,"subscriptions",new Map),dt(this,"topicMap",new oM),dt(this,"events",new jn.EventEmitter),dt(this,"name",QL),dt(this,"version",ZL),dt(this,"pending",new Map),dt(this,"cached",[]),dt(this,"initialized",!1),dt(this,"storagePrefix",Ks),dt(this,"subscribeTimeout",X.toMiliseconds(X.ONE_MINUTE)),dt(this,"initialSubscribeTimeout",X.toMiliseconds(X.ONE_SECOND*15)),dt(this,"clientId"),dt(this,"batchSubscribeTopicsLimit",500),dt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),dt(this,"subscribe",async(n,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const i=Wp(s),o={topic:n,relay:i,transportType:s==null?void 0:s.transportType};this.pending.set(n,o);const a=await this.rpcSubscribe(n,i,s);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}})),a}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}}),dt(this,"unsubscribe",async(n,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)}),dt(this,"isSubscribed",n=>new Promise(s=>{s(this.topicMap.topics.includes(n))})),dt(this,"isKnownTopic",n=>new Promise(s=>{s(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(i=>i.topic===n))})),dt(this,"on",(n,s)=>{this.events.on(n,s)}),dt(this,"once",(n,s)=>{this.events.once(n,s)}),dt(this,"off",(n,s)=>{this.events.off(n,s)}),dt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),dt(this,"start",async()=>{await this.onConnect()}),dt(this,"stop",async()=>{await this.onDisconnect()}),dt(this,"restart",async()=>{await this.restore(),await this.onRestart()}),dt(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(s=>{n.push(s)}),await this.batchSubscribe(n)}),dt(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Uu.pulse,async()=>{await this.checkPending()}),this.events.on(hn.created,async n=>{const s=hn.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()}),this.events.on(hn.deleted,async n=>{const s=hn.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()})}),this.relayer=e,this.logger=Sr(t,this.name),this.clientId=""}get context(){return rn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let n=!1;try{n=this.getSubscription(e).topic===t}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const n=this.topicMap.get(e);await Promise.all(n.map(async s=>await this.unsubscribeById(e,s,t)))}async unsubscribeById(e,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}});try{const s=Wp(n);await this.restartToComplete({topic:e,id:t,relay:s}),await this.rpcUnsubscribe(e,t,s);const i=at("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,t,n){var s;(!n||(n==null?void 0:n.transportType)===vt.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});const i={method:yd(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const o=(s=n==null?void 0:n.internal)==null?void 0:s.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if((n==null?void 0:n.transportType)===vt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch(u=>this.logger.warn(u))},X.toMiliseconds(X.ONE_SECOND)),a;const c=new Promise(async u=>{const d=h=>{h.topic===e&&(this.events.removeListener(hn.created,d),u(h.id))};this.events.on(hn.created,d);try{const h=await Po(new Promise((f,g)=>{this.relayer.request(i).catch(p=>{this.logger.warn(p,p==null?void 0:p.message),g(p)}).then(f)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(hn.created,d),u(h)}catch{}}),l=await Po(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!l&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return l?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Zt.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,n={method:yd(t.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Po(new Promise(s=>{this.relayer.request(n).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Zt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,n={method:yd(t.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let s;try{s=await await Po(new Promise((i,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Zt.connection_stalled)}return s}rpcUnsubscribe(e,t,n){const s={method:yd(n.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,t){this.setSubscription(e,ly(ad({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,ad({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,ad({},t)),this.topicMap.set(t.topic,e),this.events.emit(hn.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:n}=te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(hn.deleted,ly(ad({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(hn.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<t;n++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(hn.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async t=>ly(ad({},t),{id:await this.getSubscriptionId(t.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await FU(X.toMiliseconds(X.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Ls(e+await this.getClientId())}}var fM=Object.defineProperty,uA=Object.getOwnPropertySymbols,pM=Object.prototype.hasOwnProperty,gM=Object.prototype.propertyIsEnumerable,Ow=(r,e,t)=>e in r?fM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,dA=(r,e)=>{for(var t in e||(e={}))pM.call(e,t)&&Ow(r,t,e[t]);if(uA)for(var t of uA(e))gM.call(e,t)&&Ow(r,t,e[t]);return r},Ge=(r,e,t)=>Ow(r,typeof e!="symbol"?e+"":e,t);class mM extends t2{constructor(e){super(e),Ge(this,"protocol","wc"),Ge(this,"version",2),Ge(this,"core"),Ge(this,"logger"),Ge(this,"events",new jn.EventEmitter),Ge(this,"provider"),Ge(this,"messages"),Ge(this,"subscriber"),Ge(this,"publisher"),Ge(this,"name",WL),Ge(this,"transportExplicitlyClosed",!1),Ge(this,"initialized",!1),Ge(this,"connectionAttemptInProgress",!1),Ge(this,"relayUrl"),Ge(this,"projectId"),Ge(this,"packageName"),Ge(this,"bundleId"),Ge(this,"hasExperiencedNetworkDisruption",!1),Ge(this,"pingTimeout"),Ge(this,"heartBeatTimeout",X.toMiliseconds(X.THIRTY_SECONDS+X.FIVE_SECONDS)),Ge(this,"reconnectTimeout"),Ge(this,"connectPromise"),Ge(this,"reconnectInProgress",!1),Ge(this,"requestsInFlight",[]),Ge(this,"connectTimeout",X.toMiliseconds(X.ONE_SECOND*15)),Ge(this,"request",async t=>{var n,s;this.logger.debug("Publishing Request Payload");const i=t.id||ya().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:t.method,topic:(n=t.params)==null?void 0:n.topic},"relayer.request - publishing...");const o=`${i}:${((s=t.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(t);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),Ge(this,"resetPingTimeout",()=>{qp()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,n,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),Ge(this,"onPayloadHandler",t=>{this.onProviderPayload(t),this.resetPingTimeout()}),Ge(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit(Zt.connect)}),Ge(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()}),Ge(this,"onProviderErrorHandler",t=>{this.logger.fatal(`Fatal socket error: ${t.message}`),this.events.emit(Zt.error,t),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Ge(this,"registerProviderListeners",()=>{this.provider.on(Nn.payload,this.onPayloadHandler),this.provider.on(Nn.connect,this.onConnectHandler),this.provider.on(Nn.disconnect,this.onDisconnectHandler),this.provider.on(Nn.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Sr(e.logger,this.name):rf(Bu({level:e.logger||VL})),this.messages=new Q4(this.logger,e.core),this.subscriber=new hM(this,this.logger),this.publisher=new nM(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||eI,this.projectId=e.projectId,_U()?this.packageName=iv():NU()&&(this.bundleId=iv()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e==null?void 0:e.message)}}get context(){return rn(this.logger)}get connected(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,t,n){this.isInitialized(),await this.publisher.publish(e,t,n),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:vt.relay},Ep.outbound)}async subscribe(e,t){var n,s,i;this.isInitialized(),(!(t!=null&&t.transportType)||(t==null?void 0:t.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((n=t==null?void 0:t.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(s=t==null?void 0:t.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(hn.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(hn.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(e,dA({internal:{throwOnFailedPublish:o}},t)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Po(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,n)=>{await this.connect(e).then(t).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await qv())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((n,s)=>n.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(const n of t)try{await this.onMessageEvent(n)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:n}=e;if(!t.sessionExists){const s=qt(X.FIVE_MINUTES),i={topic:n,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,i)}this.events.emit(Zt.message,e),await this.recordMessageEvent(e,Ep.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(n,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Nn.disconnect,i),await Po(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(Nn.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{a(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Nn.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Nn.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const s=n;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(n=>setTimeout(n,X.toMiliseconds(t*1))),t++}}startPingTimeout(){var e,t,n,s,i;if(qp())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Hn(new kL(PU({sdkVersion:Nw,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){const{topic:n,message:s}=e;await this.messages.set(n,s,t)}async shouldIgnoreMessageEvent(e){const{topic:t,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;const s=this.messages.has(t,n);return s&&this.logger.warn(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),t0(e)){if(!e.method.endsWith(GL))return;const t=e.params,{topic:n,message:s,publishedAt:i,attestation:o}=t.data,a={topic:n,message:s,publishedAt:i,transportType:vt.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(dA({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Vg(e)&&this.events.emit(Zt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,Ep.inbound),this.events.emit(Zt.message,e))}async acknowledgePayload(e){const t=zg(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Nn.payload,this.onPayloadHandler),this.provider.off(Nn.connect,this.onConnectHandler),this.provider.off(Nn.disconnect,this.onDisconnectHandler),this.provider.off(Nn.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await qv();qB(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(n=>this.logger.error(n,n==null?void 0:n.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(Zt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},X.toMiliseconds(KL)))))}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function yM(){}function hA(r){if(!r||typeof r!="object")return!1;const e=Object.getPrototypeOf(r);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(r)==="[object Object]":!1}function fA(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function pA(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const wM="[object RegExp]",bM="[object String]",EM="[object Number]",vM="[object Boolean]",gA="[object Arguments]",AM="[object Symbol]",CM="[object Date]",_M="[object Map]",NM="[object Set]",IM="[object Array]",SM="[object Function]",xM="[object ArrayBuffer]",uy="[object Object]",TM="[object Error]",PM="[object DataView]",OM="[object Uint8Array]",RM="[object Uint8ClampedArray]",DM="[object Uint16Array]",kM="[object Uint32Array]",UM="[object BigUint64Array]",BM="[object Int8Array]",LM="[object Int16Array]",$M="[object Int32Array]",MM="[object BigInt64Array]",FM="[object Float32Array]",jM="[object Float64Array]";function HM(r,e){return r===e||Number.isNaN(r)&&Number.isNaN(e)}function zM(r,e,t){return bd(r,e,void 0,void 0,void 0,void 0,t)}function bd(r,e,t,n,s,i,o){const a=o(r,e,t,n,s,i);if(a!==void 0)return a;if(typeof r==typeof e)switch(typeof r){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return r===e;case"number":return r===e||Object.is(r,e);case"function":return r===e;case"object":return Pd(r,e,i,o)}return Pd(r,e,i,o)}function Pd(r,e,t,n){if(Object.is(r,e))return!0;let s=pA(r),i=pA(e);if(s===gA&&(s=uy),i===gA&&(i=uy),s!==i)return!1;switch(s){case bM:return r.toString()===e.toString();case EM:{const c=r.valueOf(),l=e.valueOf();return HM(c,l)}case vM:case CM:case AM:return Object.is(r.valueOf(),e.valueOf());case wM:return r.source===e.source&&r.flags===e.flags;case SM:return r===e}t=t??new Map;const o=t.get(r),a=t.get(e);if(o!=null&&a!=null)return o===e;t.set(r,e),t.set(e,r);try{switch(s){case _M:{if(r.size!==e.size)return!1;for(const[c,l]of r.entries())if(!e.has(c)||!bd(l,e.get(c),c,r,e,t,n))return!1;return!0}case NM:{if(r.size!==e.size)return!1;const c=Array.from(r.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const d=c[u],h=l.findIndex(f=>bd(d,f,void 0,r,e,t,n));if(h===-1)return!1;l.splice(h,1)}return!0}case IM:case OM:case RM:case DM:case kM:case UM:case BM:case LM:case $M:case MM:case FM:case jM:{if(typeof Buffer<"u"&&Buffer.isBuffer(r)!==Buffer.isBuffer(e)||r.length!==e.length)return!1;for(let c=0;c<r.length;c++)if(!bd(r[c],e[c],c,r,e,t,n))return!1;return!0}case xM:return r.byteLength!==e.byteLength?!1:Pd(new Uint8Array(r),new Uint8Array(e),t,n);case PM:return r.byteLength!==e.byteLength||r.byteOffset!==e.byteOffset?!1:Pd(new Uint8Array(r),new Uint8Array(e),t,n);case TM:return r.name===e.name&&r.message===e.message;case uy:{if(!(Pd(r.constructor,e.constructor,t,n)||hA(r)&&hA(e)))return!1;const c=[...Object.keys(r),...fA(r)],l=[...Object.keys(e),...fA(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const d=c[u],h=r[d];if(!Object.hasOwn(e,d))return!1;const f=e[d];if(!bd(h,f,d,r,e,t,n))return!1}return!0}default:return!1}}finally{t.delete(r),t.delete(e)}}function qM(r,e){return zM(r,e,yM)}var VM=Object.defineProperty,mA=Object.getOwnPropertySymbols,WM=Object.prototype.hasOwnProperty,GM=Object.prototype.propertyIsEnumerable,Rw=(r,e,t)=>e in r?VM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,yA=(r,e)=>{for(var t in e||(e={}))WM.call(e,t)&&Rw(r,t,e[t]);if(mA)for(var t of mA(e))GM.call(e,t)&&Rw(r,t,e[t]);return r},Hr=(r,e,t)=>Rw(r,typeof e!="symbol"?e+"":e,t);class vc extends r2{constructor(e,t,n,s=Ks,i=void 0){super(e,t,n,s),this.core=e,this.logger=t,this.name=n,Hr(this,"map",new Map),Hr(this,"version",JL),Hr(this,"cached",[]),Hr(this,"initialized",!1),Hr(this,"getKey"),Hr(this,"storagePrefix",Ks),Hr(this,"recentlyDeleted",[]),Hr(this,"recentlyDeletedLimit",200),Hr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!lr(o)?this.map.set(this.getKey(o),o):vB(o)?this.map.set(o.id,o):AB(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Hr(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Hr(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Hr(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>qM(a[c],o[c]))):this.values)),Hr(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=yA(yA({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Hr(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Sr(t,this.name),this.storagePrefix=s,this.getKey=i}get context(){return rn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:s}=te("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:n}=te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var KM=Object.defineProperty,JM=(r,e,t)=>e in r?KM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Fe=(r,e,t)=>JM(r,typeof e!="symbol"?e+"":e,t);class YM{constructor(e,t){this.core=e,this.logger=t,Fe(this,"name",XL),Fe(this,"version",e$),Fe(this,"events",new Db),Fe(this,"pairings"),Fe(this,"initialized",!1),Fe(this,"storagePrefix",Ks),Fe(this,"ignoredPayloadTypes",[Ui]),Fe(this,"registeredMethods",[]),Fe(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),Fe(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),Fe(this,"create",async n=>{this.isInitialized();const s=Ew(),i=await this.core.crypto.setSymKey(s),o=qt(X.FIVE_MINUTES),a={protocol:XN},c={topic:i,expiry:o,relay:a,active:!1,methods:n==null?void 0:n.methods},l=$v({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:n==null?void 0:n.methods});return this.events.emit(la.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:n==null?void 0:n.transportType}),{topic:i,uri:l}}),Fe(this,"pair",async n=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:n==null?void 0:n.uri,trace:[_s.pairing_started]}});this.isValidPair(n,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=Lv(n.uri);s.props.properties.topic=i,s.addTrace(_s.pairing_uri_validation_success),s.addTrace(_s.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(_s.existing_pairing),u.active)throw s.setError(ui.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(_s.pairing_not_expired)}const d=c||qt(X.FIVE_MINUTES),h={topic:i,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(i,d),await this.pairings.set(i,h),s.addTrace(_s.store_new_pairing),n.activatePairing&&await this.activate({topic:i}),this.events.emit(la.create,h),s.addTrace(_s.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(_s.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(ui.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(f){throw s.setError(ui.subscribe_pairing_topic_failure),f}return s.addTrace(_s.subscribe_pairing_topic_success),h}),Fe(this,"activate",async({topic:n})=>{this.isInitialized();const s=qt(X.FIVE_MINUTES);this.core.expirer.set(n,s),await this.pairings.update(n,{active:!0,expiry:s})}),Fe(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=n;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=na();this.events.once(Xe("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),Fe(this,"updateExpiry",async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})}),Fe(this,"updateMetadata",async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})}),Fe(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),Fe(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",at("USER_DISCONNECTED")),await this.deletePairing(s))}),Fe(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(s);return $v({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),Fe(this,"sendRequest",async(n,s,i)=>{const o=Oo(s,i),a=await this.core.crypto.encode(n,o),c=id[s].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),Fe(this,"sendResult",async(n,s,i)=>{const o=zg(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=id[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),Fe(this,"sendError",async(n,s,i)=>{const o=qg(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=id[c]?id[c].res:id.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),Fe(this,"deletePairing",async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,at("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])}),Fe(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(s=>ao(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))}),Fe(this,"onRelayEventRequest",async n=>{const{topic:s,payload:i}=n;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),Fe(this,"onRelayEventResponse",async n=>{const{topic:s,payload:i}=n,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),Fe(this,"onPairingPingRequest",async(n,s)=>{const{id:i}=s;try{this.isValidPing({topic:n}),await this.sendResult(i,n,!0),this.events.emit(la.ping,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),Fe(this,"onPairingPingResponse",(n,s)=>{const{id:i}=s;setTimeout(()=>{Is(s)?this.events.emit(Xe("pairing_ping",i),{}):$n(s)&&this.events.emit(Xe("pairing_ping",i),{error:s.error})},500)}),Fe(this,"onPairingDeleteRequest",async(n,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(la.delete,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),Fe(this,"onUnknownRpcMethodRequest",async(n,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=at("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,n,a),this.logger.error(a)}catch(a){await this.sendError(i,n,a),this.logger.error(a)}}),Fe(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(at("WC_METHOD_UNSUPPORTED",n))}),Fe(this,"isValidPair",(n,s)=>{var i;if(!Wr(n)){const{message:a}=te("MISSING_OR_INVALID",`pair() params: ${n}`);throw s.setError(ui.malformed_pairing_uri),new Error(a)}if(!EB(n.uri)){const{message:a}=te("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw s.setError(ui.malformed_pairing_uri),new Error(a)}const o=Lv(n==null?void 0:n.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=te("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(ui.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=te("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(ui.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&X.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(ui.pairing_expired);const{message:a}=te("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),Fe(this,"isValidPing",async n=>{if(!Wr(n)){const{message:i}=te("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),Fe(this,"isValidDisconnect",async n=>{if(!Wr(n)){const{message:i}=te("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),Fe(this,"isValidPairingTopic",async n=>{if(!Ft(n,!1)){const{message:s}=te("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=te("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(ao(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=te("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}}),this.core=e,this.logger=Sr(t,this.name),this.pairings=new vc(this.core,this.logger,this.name,this.storagePrefix)}get context(){return rn(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Zt.message,async e=>{const{topic:t,message:n,transportType:s}=e;if(this.pairings.keys.includes(t)&&s!==vt.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const i=await this.core.crypto.decode(t,n);t0(i)?(this.core.history.set(t,i),await this.onRelayEventRequest({topic:t,payload:i})):Vg(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:t,payload:i}),this.core.history.delete(t,i.id)),await this.core.relayer.messages.ack(t,n)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(On.expired,async e=>{const{topic:t}=cN(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(la.expire,{topic:t}))})}}var QM=Object.defineProperty,ZM=(r,e,t)=>e in r?QM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,or=(r,e,t)=>ZM(r,typeof e!="symbol"?e+"":e,t);class XM extends ZO{constructor(e,t){super(e,t),this.core=e,this.logger=t,or(this,"records",new Map),or(this,"events",new jn.EventEmitter),or(this,"name",t$),or(this,"version",r$),or(this,"cached",[]),or(this,"initialized",!1),or(this,"storagePrefix",Ks),or(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),or(this,"set",(n,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:i,expiry:qt(X.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Kn.created,o)}),or(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=$n(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.persist(),this.events.emit(Kn.updated,s))}),or(this,"get",async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s))),or(this,"delete",(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===n){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(Kn.deleted,i)}}),this.persist()}),or(this,"exists",async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1)),or(this,"on",(n,s)=>{this.events.on(n,s)}),or(this,"once",(n,s)=>{this.events.once(n,s)}),or(this,"off",(n,s)=>{this.events.off(n,s)}),or(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Sr(t,this.name)}get context(){return rn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:Oo(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:n}=te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Kn.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Kn.created,e=>{const t=Kn.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Kn.updated,e=>{const t=Kn.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Kn.deleted,e=>{const t=Kn.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(Uu.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{X.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(Kn.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var e6=Object.defineProperty,t6=(r,e,t)=>e in r?e6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,br=(r,e,t)=>t6(r,typeof e!="symbol"?e+"":e,t);class r6 extends s2{constructor(e,t){super(e,t),this.core=e,this.logger=t,br(this,"expirations",new Map),br(this,"events",new jn.EventEmitter),br(this,"name",n$),br(this,"version",s$),br(this,"cached",[]),br(this,"initialized",!1),br(this,"storagePrefix",Ks),br(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),br(this,"has",n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}}),br(this,"set",(n,s)=>{this.isInitialized();const i=this.formatTarget(n),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(On.created,{target:i,expiration:o})}),br(this,"get",n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)}),br(this,"del",n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(On.deleted,{target:s,expiration:i})}}),br(this,"on",(n,s)=>{this.events.on(n,s)}),br(this,"once",(n,s)=>{this.events.once(n,s)}),br(this,"off",(n,s)=>{this.events.off(n,s)}),br(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Sr(t,this.name)}get context(){return rn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return OU(e);if(typeof e=="number")return RU(e);const{message:t}=te("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(On.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:n}=te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return t}checkExpiry(e,t){const{expiry:n}=t;X.toMiliseconds(n)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(On.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Uu.pulse,()=>this.checkExpirations()),this.events.on(On.created,e=>{const t=On.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(On.expired,e=>{const t=On.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(On.deleted,e=>{const t=On.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var n6=Object.defineProperty,s6=(r,e,t)=>e in r?n6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Mt=(r,e,t)=>s6(r,typeof e!="symbol"?e+"":e,t);class i6 extends i2{constructor(e,t,n){super(e,t,n),this.core=e,this.logger=t,this.store=n,Mt(this,"name",i$),Mt(this,"abortController"),Mt(this,"isDevEnv"),Mt(this,"verifyUrlV3",a$),Mt(this,"storagePrefix",Ks),Mt(this,"version",ZN),Mt(this,"publicKey"),Mt(this,"fetchPromise"),Mt(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&X.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),Mt(this,"register",async s=>{if(!cf()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=of(),u=this.startAbortTimer(X.ONE_SECOND*5),d=await new Promise((h,f)=>{const g=()=>{window.removeEventListener("message",m),l.body.removeChild(p),f("attestation aborted")};this.abortController.signal.addEventListener("abort",g);const p=l.createElement("iframe");p.src=c,p.style.display="none",p.addEventListener("error",g,{signal:this.abortController.signal});const m=w=>{if(w.data&&typeof w.data=="string")try{const A=JSON.parse(w.data);if(A.type==="verify_attestation"){if(iw(A.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(p),this.abortController.signal.removeEventListener("abort",g),window.removeEventListener("message",m),h(A.attestation===null?"":A.attestation)}}catch(A){this.logger.warn(A)}};l.body.appendChild(p),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",d),d}catch(l){this.logger.warn(l)}return""}),Mt(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(iw(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,c)}),Mt(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(X.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),Mt(this,"getVerifyUrl",s=>{let i=s||Td;return c$.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${Td}`),i=Td),i}),Mt(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(X.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),Mt(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),Mt(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),Mt(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),Mt(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),Mt(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),Mt(this,"validateAttestation",(s,i)=>{const o=aB(s,i.publicKey),a={hasExpired:X.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Sr(t,this.name),this.abortController=new AbortController,this.isDevEnv=Vb(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return rn(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),X.toMiliseconds(e))}}var o6=Object.defineProperty,a6=(r,e,t)=>e in r?o6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,wA=(r,e,t)=>a6(r,typeof e!="symbol"?e+"":e,t);class c6 extends o2{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,wA(this,"context",l$),wA(this,"registerDeviceToken",async n=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=n,c=`${u$}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=Sr(t,this.context)}}var l6=Object.defineProperty,bA=Object.getOwnPropertySymbols,u6=Object.prototype.hasOwnProperty,d6=Object.prototype.propertyIsEnumerable,Dw=(r,e,t)=>e in r?l6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,cd=(r,e)=>{for(var t in e||(e={}))u6.call(e,t)&&Dw(r,t,e[t]);if(bA)for(var t of bA(e))d6.call(e,t)&&Dw(r,t,e[t]);return r},Wt=(r,e,t)=>Dw(r,typeof e!="symbol"?e+"":e,t);class h6 extends a2{constructor(e,t,n=!0){super(e,t,n),this.core=e,this.logger=t,Wt(this,"context",h$),Wt(this,"storagePrefix",Ks),Wt(this,"storageVersion",d$),Wt(this,"events",new Map),Wt(this,"shouldPersist",!1),Wt(this,"init",async()=>{if(!Vb())try{const s={eventId:av(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:oN(this.core.relayer.protocol,this.core.relayer.version,Nw)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),Wt(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=av(),u=this.core.projectId||"",d=Date.now(),h=cd({eventId:l,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),Wt(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return cd(cd({},a),this.setMethods(a.eventId))}),Wt(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),Wt(this,"setEventListeners",()=>{this.core.heartbeat.on(Uu.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{X.fromMiliseconds(Date.now())-X.fromMiliseconds(s.timestamp)>f$&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),Wt(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),Wt(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),Wt(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),Wt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Wt(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,cd(cd({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),Wt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),Wt(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${p$}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Nw}${i}`,{method:"POST",body:JSON.stringify(s)})}),Wt(this,"getAppDomain",()=>iN().url),this.logger=Sr(t,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var f6=Object.defineProperty,EA=Object.getOwnPropertySymbols,p6=Object.prototype.hasOwnProperty,g6=Object.prototype.propertyIsEnumerable,kw=(r,e,t)=>e in r?f6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,vA=(r,e)=>{for(var t in e||(e={}))p6.call(e,t)&&kw(r,t,e[t]);if(EA)for(var t of EA(e))g6.call(e,t)&&kw(r,t,e[t]);return r},gt=(r,e,t)=>kw(r,typeof e!="symbol"?e+"":e,t);let m6=class hI extends KO{constructor(e){var t;super(e),gt(this,"protocol",QN),gt(this,"version",ZN),gt(this,"name",_w),gt(this,"relayUrl"),gt(this,"projectId"),gt(this,"customStoragePrefix"),gt(this,"events",new jn.EventEmitter),gt(this,"logger"),gt(this,"heartbeat"),gt(this,"relayer"),gt(this,"crypto"),gt(this,"storage"),gt(this,"history"),gt(this,"expirer"),gt(this,"pairing"),gt(this,"verify"),gt(this,"echoClient"),gt(this,"linkModeSupportedApps"),gt(this,"eventClient"),gt(this,"initialized",!1),gt(this,"logChunkController"),gt(this,"on",(a,c)=>this.events.on(a,c)),gt(this,"once",(a,c)=>this.events.once(a,c)),gt(this,"off",(a,c)=>this.events.off(a,c)),gt(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),gt(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:vt.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const n=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||eI,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=Bu({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:BL.logger,name:_w}),{logger:i,chunkLoggerController:o}=Ub({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Sr(i,this.name),this.heartbeat=new BP,this.crypto=new z4(this,this.logger,e==null?void 0:e.keychain),this.history=new XM(this,this.logger),this.expirer=new r6(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new wO(vA(vA({},LL),e==null?void 0:e.storageOptions)),this.relayer=new mM({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new YM(this,this.logger),this.verify=new i6(this,this.logger,this.storage),this.echoClient=new c6(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new h6(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const t=new hI(e);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(YL,n),t}get context(){return rn(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(eA,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(eA)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,n=`${t}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[t]}catch(t){console.warn("Failed to get global WalletConnect core",t);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((t=e.opts)==null?void 0:t.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&UL.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const y6=m6,fI="wc",pI=2,gI="client",r0=`${fI}@${pI}:${gI}:`,dy={name:gI,logger:"error"},AA="WALLETCONNECT_DEEPLINK_CHOICE",w6="proposal",CA="Proposal expired",b6="session",Uc=X.SEVEN_DAYS,E6="engine",Gt={wc_sessionPropose:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1104},res:{ttl:X.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1106},res:{ttl:X.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1112},res:{ttl:X.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1114},res:{ttl:X.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:X.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:X.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1119}}},hy={min:X.FIVE_MINUTES,max:X.SEVEN_DAYS},As={idle:"IDLE",active:"ACTIVE"},_A={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},v6="request",A6=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],C6="wc",_6="auth",N6="authKeys",I6="pairingTopics",S6="requests",Gg=`${C6}@${1.5}:${_6}:`,vp=`${Gg}:PUB_KEY`;var x6=Object.defineProperty,T6=Object.defineProperties,P6=Object.getOwnPropertyDescriptors,NA=Object.getOwnPropertySymbols,O6=Object.prototype.hasOwnProperty,R6=Object.prototype.propertyIsEnumerable,Uw=(r,e,t)=>e in r?x6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ht=(r,e)=>{for(var t in e||(e={}))O6.call(e,t)&&Uw(r,t,e[t]);if(NA)for(var t of NA(e))R6.call(e,t)&&Uw(r,t,e[t]);return r},Pr=(r,e)=>T6(r,P6(e)),V=(r,e,t)=>Uw(r,typeof e!="symbol"?e+"":e,t);class D6 extends d2{constructor(e){super(e),V(this,"name",E6),V(this,"events",new Db),V(this,"initialized",!1),V(this,"requestQueue",{state:As.idle,queue:[]}),V(this,"sessionRequestQueue",{state:As.idle,queue:[]}),V(this,"requestQueueDelay",X.ONE_SECOND),V(this,"expectedPairingMethodMap",new Map),V(this,"recentlyDeletedMap",new Map),V(this,"recentlyDeletedLimit",200),V(this,"relayMessageCache",[]),V(this,"pendingSessions",new Map),V(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Gt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay)))}),V(this,"connect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=Pr(ht({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=n;let u=s,d,h=!1;try{if(u){const P=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=P.active}}catch(P){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),P}if(!u||!h){const{topic:P,uri:D}=await this.client.core.pairing.create();u=P,d=D}if(!u){const{message:P}=te("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(P)}const f=await this.client.core.crypto.generateKeyPair(),g=Gt.wc_sessionPropose.req.ttl||X.FIVE_MINUTES,p=qt(g),m=Pr(ht(ht({requiredNamespaces:i,optionalNamespaces:o,relays:l??[{protocol:XN}],proposer:{publicKey:f,metadata:this.client.metadata},expiryTimestamp:p,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:Ns()}),w=Xe("session_connect",m.id),{reject:A,resolve:v,done:I}=na(g,CA),T=({id:P})=>{P===m.id&&(this.client.events.off("proposal_expire",T),this.pendingSessions.delete(m.id),this.events.emit(w,{error:{message:CA,code:0}}))};return this.client.events.on("proposal_expire",T),this.events.once(w,({error:P,session:D})=>{this.client.events.off("proposal_expire",T),P?A(P):D&&v(D)}),await this.sendRequest({topic:u,method:"wc_sessionPropose",params:m,throwOnFailedPublish:!0,clientRpcId:m.id}),await this.setProposal(m.id,m),{uri:d,approval:I}}),V(this,"pair",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(n){throw this.client.logger.error("pair() failed"),n}}),V(this,"approve",async t=>{var n,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=t==null?void 0:t.id)==null?void 0:n.toString(),trace:[Jn.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(S){throw o.setError(Yo.no_internet_connection),S}try{await this.isValidProposalId(t==null?void 0:t.id)}catch(S){throw this.client.logger.error(`approve() -> proposal.get(${t==null?void 0:t.id}) failed`),o.setError(Yo.proposal_not_found),S}try{await this.isValidApprove(t)}catch(S){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Yo.session_approve_namespace_validation_failure),S}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=t,f=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:g,proposer:p,requiredNamespaces:m,optionalNamespaces:w}=f;let A=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:g});A||(A=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:Jn.session_approve_started,properties:{topic:g,trace:[Jn.session_approve_started,Jn.session_namespaces_validation_success]}}));const v=await this.client.core.crypto.generateKeyPair(),I=p.publicKey,T=await this.client.core.crypto.generateSharedKey(v,I),P=ht(ht(ht({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:v,metadata:this.client.metadata},expiry:qt(Uc)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),D=vt.relay;A.addTrace(Jn.subscribing_session_topic);try{await this.client.core.relayer.subscribe(T,{transportType:D})}catch(S){throw A.setError(Yo.subscribe_session_topic_failure),S}A.addTrace(Jn.subscribe_session_topic_success);const U=Pr(ht({},P),{topic:T,requiredNamespaces:m,optionalNamespaces:w,pairingTopic:g,acknowledged:!1,self:P.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:v,transportType:vt.relay});await this.client.session.set(T,U),A.addTrace(Jn.store_session);try{A.addTrace(Jn.publishing_session_settle),await this.sendRequest({topic:T,method:"wc_sessionSettle",params:P,throwOnFailedPublish:!0}).catch(S=>{throw A==null||A.setError(Yo.session_settle_publish_failure),S}),A.addTrace(Jn.session_settle_publish_success),A.addTrace(Jn.publishing_session_approve),await this.sendResult({id:a,topic:g,result:{relay:{protocol:c??"irn"},responderPublicKey:v},throwOnFailedPublish:!0}).catch(S=>{throw A==null||A.setError(Yo.session_approve_publish_failure),S}),A.addTrace(Jn.session_approve_publish_success)}catch(S){throw this.client.logger.error(S),this.client.session.delete(T,at("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(T),S}return this.client.core.eventClient.deleteEvent({eventId:A.eventId}),await this.client.core.pairing.updateMetadata({topic:g,metadata:p.metadata}),await this.client.proposal.delete(a,at("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:g}),await this.setExpiry(T,qt(Uc)),{topic:T,acknowledged:()=>Promise.resolve(this.client.session.get(T))}}),V(this,"reject",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:s}=t;let i;try{i=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}i&&(await this.sendError({id:n,topic:i,error:s,rpcOpts:Gt.wc_sessionPropose.reject}),await this.client.proposal.delete(n,at("USER_DISCONNECTED")))}),V(this,"update",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:n,namespaces:s}=t,{done:i,resolve:o,reject:a}=na(),c=Ns(),l=ya().toString(),u=this.client.session.get(n).namespaces;return this.events.once(Xe("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(n,{namespaces:s}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(n,{namespaces:u}),a(d)}),{acknowledged:i}}),V(this,"extend",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=t,s=Ns(),{done:i,resolve:o,reject:a}=na();return this.events.once(Xe("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,qt(Uc)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),V(this,"request",async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(w){throw this.client.logger.error("request() -> isValidRequest() failed"),w}const{chainId:n,request:s,topic:i,expiry:o=Gt.wc_sessionRequest.req.ttl}=t,a=this.client.session.get(i);(a==null?void 0:a.transportType)===vt.relay&&await this.confirmOnlineStateOrThrow();const c=Ns(),l=ya().toString(),{done:u,resolve:d,reject:h}=na(o,"Request expired. Please try again.");this.events.once(Xe("session_request",c),({error:w,result:A})=>{w?h(w):d(A)});const f="wc_sessionRequest",g=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(g)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:{request:Pr(ht({},s),{expiryTimestamp:qt(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:g}).catch(w=>h(w)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),await u();const p={request:Pr(ht({},s),{expiryTimestamp:qt(o)}),chainId:n},m=this.shouldSetTVF(f,p);return await Promise.all([new Promise(async w=>{await this.sendRequest(ht({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:p,expiry:o,throwOnFailedPublish:!0},m&&{tvf:this.getTVFParams(c,p)})).catch(A=>h(A)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),w()}),new Promise(async w=>{var A;if(!((A=a.sessionConfig)!=null&&A.disableDeepLink)){const v=await BU(this.client.core.storage,AA);await DU({id:c,topic:i,wcDeepLink:v})}w()}),u()]).then(w=>w[2])}),V(this,"respond",async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:s}=t,{id:i}=s,o=this.client.session.get(n);o.transportType===vt.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Is(s)?await this.sendResult({id:i,topic:n,result:s.result,throwOnFailedPublish:!0,appLink:a}):$n(s)&&await this.sendError({id:i,topic:n,error:s.error,appLink:a}),this.cleanupAfterResponse(t)}),V(this,"ping",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:n}=t;if(this.client.session.keys.includes(n)){const s=Ns(),i=ya().toString(),{done:o,resolve:a,reject:c}=na();this.events.once(Xe("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),V(this,"emit",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:n,event:s,chainId:i}=t,o=ya().toString(),a=Ns();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),V(this,"disconnect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:n}=t;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:at("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:s}=te("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(s)}}),V(this,"find",t=>(this.isInitialized(),this.client.session.getAll().filter(n=>wB(n,t)))),V(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),V(this,"authenticate",async(t,n)=>{var s;this.isInitialized(),this.isValidAuthenticate(t);const i=n&&this.client.core.linkModeSupportedApps.includes(n)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?vt.link_mode:vt.relay;o===vt.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:h,exp:f,nbf:g,methods:p=[],expiry:m}=t,w=[...t.resources||[]],{topic:A,uri:v}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:A,uri:v}});const I=await this.client.core.crypto.generateKeyPair(),T=bp(I);if(await Promise.all([this.client.auth.authKeys.set(vp,{responseTopic:T,publicKey:I}),this.client.auth.pairingTopics.set(T,{topic:T,pairingTopic:A})]),await this.client.core.relayer.subscribe(T,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${A}`),p.length>0){const{namespace:k}=fl(a[0]);let F=x5(k,"request",p);wp(w)&&(F=P5(F,w.pop())),w.push(F)}const P=m&&m>Gt.wc_sessionAuthenticate.req.ttl?m:Gt.wc_sessionAuthenticate.req.ttl,D={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:f,nbf:g,resources:w},requester:{publicKey:I,metadata:this.client.metadata},expiryTimestamp:qt(P)},U={eip155:{chains:a,methods:[...new Set(["personal_sign",...p])],events:["chainChanged","accountsChanged"]}},S={requiredNamespaces:{},optionalNamespaces:U,relays:[{protocol:"irn"}],pairingTopic:A,proposer:{publicKey:I,metadata:this.client.metadata},expiryTimestamp:qt(Gt.wc_sessionPropose.req.ttl),id:Ns()},{done:H,resolve:L,reject:j}=na(P,"Request expired"),Q=Ns(),z=Xe("session_connect",S.id),b=Xe("session_request",Q),E=async({error:k,session:F})=>{this.events.off(b,O),k?j(k):F&&L({session:F})},O=async k=>{var F,K,Z;if(await this.deletePendingAuthRequest(Q,{message:"fulfilled",code:0}),k.error){const Ie=at("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return k.error.code===Ie.code?void 0:(this.events.off(z,E),j(k.error.message))}await this.deleteProposal(S.id),this.events.off(z,E);const{cacaos:se,responder:J}=k.result,ge=[],_e=[];for(const Ie of se){await gv({cacao:Ie,projectId:this.client.core.projectId})||(this.client.logger.error(Ie,"Signature verification failed"),j(at("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:Ct}=Ie,Tt=wp(Ct.resources),Et=[dw(Ct.iss)],it=Vp(Ct.iss);if(Tt){const ut=mv(Tt),xr=yv(Tt);ge.push(...ut),Et.push(...xr)}for(const ut of Et)_e.push(`${ut}:${it}`)}const $e=await this.client.core.crypto.generateSharedKey(I,J.publicKey);let Oe;ge.length>0&&(Oe={topic:$e,acknowledged:!0,self:{publicKey:I,metadata:this.client.metadata},peer:J,controller:J.publicKey,expiry:qt(Uc),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:A,namespaces:Mv([...new Set(ge)],[...new Set(_e)]),transportType:o},await this.client.core.relayer.subscribe($e,{transportType:o}),await this.client.session.set($e,Oe),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:J.metadata}),Oe=this.client.session.get($e)),(F=this.client.metadata.redirect)!=null&&F.linkMode&&(K=J.metadata.redirect)!=null&&K.linkMode&&(Z=J.metadata.redirect)!=null&&Z.universal&&n&&(this.client.core.addLinkModeSupportedApp(J.metadata.redirect.universal),this.client.session.update($e,{transportType:vt.link_mode})),L({auths:se,session:Oe})};this.events.once(z,E),this.events.once(b,O);let B;try{if(i){const k=Oo("wc_sessionAuthenticate",D,Q);this.client.core.history.set(A,k);const F=await this.client.core.crypto.encode("",k,{type:pf,encoding:lo});B=Wf(n,A,F)}else await Promise.all([this.sendRequest({topic:A,method:"wc_sessionAuthenticate",params:D,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:Q}),this.sendRequest({topic:A,method:"wc_sessionPropose",params:S,expiry:Gt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:S.id})])}catch(k){throw this.events.off(z,E),this.events.off(b,O),k}return await this.setProposal(S.id,S),await this.setAuthRequest(Q,{request:Pr(ht({},D),{verifyContext:{}}),pairingTopic:A,transportType:o}),{uri:B??v,response:H}}),V(this,"approveSessionAuthenticate",async t=>{const{id:n,auths:s}=t,i=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[Qo.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw i.setError(od.no_internet_connection),m}const o=this.getPendingAuthRequest(n);if(!o)throw i.setError(od.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||vt.relay;a===vt.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=bp(c),d={type:Ui,receiverPublicKey:c,senderPublicKey:l},h=[],f=[];for(const m of s){if(!await gv({cacao:m,projectId:this.client.core.projectId})){i.setError(od.invalid_cacao);const T=at("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:u,error:T,encodeOpts:d}),new Error(T.message)}i.addTrace(Qo.cacaos_verified);const{p:w}=m,A=wp(w.resources),v=[dw(w.iss)],I=Vp(w.iss);if(A){const T=mv(A),P=yv(A);h.push(...T),v.push(...P)}for(const T of v)f.push(`${T}:${I}`)}const g=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(Qo.create_authenticated_session_topic);let p;if((h==null?void 0:h.length)>0){p={topic:g,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:qt(Uc),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:Mv([...new Set(h)],[...new Set(f)]),transportType:a},i.addTrace(Qo.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(g,{transportType:a})}catch(m){throw i.setError(od.subscribe_authenticated_session_topic_failure),m}i.addTrace(Qo.subscribe_authenticated_session_topic_success),await this.client.session.set(g,p),i.addTrace(Qo.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Qo.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:n,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw i.setError(od.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:p}}),V(this,"rejectSessionAuthenticate",async t=>{this.isInitialized();const{id:n,reason:s}=t,i=this.getPendingAuthRequest(n);if(!i)throw new Error(`Could not find pending auth request with id ${n}`);i.transportType===vt.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=bp(o),l={type:Ui,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:s,encodeOpts:l,rpcOpts:Gt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.client.proposal.delete(n,at("USER_DISCONNECTED"))}),V(this,"formatAuthMessage",t=>{this.isInitialized();const{request:n,iss:s}=t;return yN(n,s)}),V(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)}),V(this,"cleanupDuplicatePairings",async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===t.peer.metadata.url&&i.topic&&i.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),V(this,"deleteSession",async t=>{var n;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=t,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,at("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(AA).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===s&&this.deletePendingSessionRequest(l.id,at("USER_DISCONNECTED"))}),s===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=As.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),V(this,"deleteProposal",async(t,n)=>{if(n)try{const s=this.client.proposal.get(t),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(Yo.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,at("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")}),V(this,"deletePendingSessionRequest",async(t,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==t),s&&(this.sessionRequestQueue.state=As.idle,this.client.events.emit("session_request_expire",{id:t}))}),V(this,"deletePendingAuthRequest",async(t,n,s=!1)=>{await Promise.all([this.client.auth.requests.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)])}),V(this,"setExpiry",async(t,n)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,n),await this.client.session.update(t,{expiry:n}))}),V(this,"setProposal",async(t,n)=>{this.client.core.expirer.set(t,qt(Gt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,n)}),V(this,"setAuthRequest",async(t,n)=>{const{request:s,pairingTopic:i,transportType:o=vt.relay}=n;this.client.core.expirer.set(t,s.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:t,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),V(this,"setPendingSessionRequest",async t=>{const{id:n,topic:s,params:i,verifyContext:o}=t,a=i.request.expiryTimestamp||qt(Gt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:s,params:i,verifyContext:o})}),V(this,"sendRequest",async t=>{const{topic:n,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d}=t,h=Oo(s,i,c);let f;const g=!!u;try{const w=g?lo:us;f=await this.client.core.crypto.encode(n,h,{encoding:w})}catch(w){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),w}let p;if(A6.includes(s)){const w=Ls(JSON.stringify(h)),A=Ls(f);p=await this.client.core.verify.register({id:A,decryptedId:w})}const m=Gt[s].req;if(m.attestation=p,o&&(m.ttl=o),a&&(m.id=a),this.client.core.history.set(n,h),g){const w=Wf(u,n,f);await global.Linking.openURL(w,this.client.name)}else{const w=Gt[s].req;o&&(w.ttl=o),a&&(w.id=a),w.tvf=Pr(ht({},d),{correlationId:h.id}),l?(w.internal=Pr(ht({},w.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,f,w)):this.client.core.relayer.publish(n,f,w).catch(A=>this.client.logger.error(A))}return h.id}),V(this,"sendResult",async t=>{const{id:n,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=t,l=zg(n,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const g=d?lo:us;u=await this.client.core.crypto.encode(s,l,Pr(ht({},a||{}),{encoding:g}))}catch(g){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),g}let h,f;try{h=await this.client.core.history.get(s,n);const g=h.request;try{this.shouldSetTVF(g.method,g.params)&&(f=this.getTVFParams(n,g.params,i))}catch(p){this.client.logger.warn("sendResult() -> getTVFParams() failed",p)}}catch(g){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${n}) failed`),g}if(d){const g=Wf(c,s,u);await global.Linking.openURL(g,this.client.name)}else{const g=h.request.method,p=Gt[g].res;p.tvf=Pr(ht({},f),{correlationId:n}),o?(p.internal=Pr(ht({},p.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,p)):this.client.core.relayer.publish(s,u,p).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(l)}),V(this,"sendError",async t=>{const{id:n,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=t,l=qg(n,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const f=d?lo:us;u=await this.client.core.crypto.encode(s,l,Pr(ht({},o||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),f}let h;try{h=await this.client.core.history.get(s,n)}catch(f){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),f}if(d){const f=Wf(c,s,u);await global.Linking.openURL(f,this.client.name)}else{const f=h.request.method,g=a||Gt[f].res;this.client.core.relayer.publish(s,u,g)}await this.client.core.history.resolve(l)}),V(this,"cleanup",async()=>{const t=[],n=[];this.client.session.getAll().forEach(s=>{let i=!1;ao(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&t.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{ao(s.expiryTimestamp)&&n.push(s.id)}),await Promise.all([...t.map(s=>this.deleteSession({topic:s})),...n.map(s=>this.deleteProposal(s))])}),V(this,"onProviderMessageEvent",async t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):await this.onRelayMessage(t)}),V(this,"onRelayEventRequest",async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()}),V(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===As.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=As.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=As.idle}),V(this,"processRequest",async t=>{const{topic:n,payload:s,attestation:i,transportType:o,encryptedId:a}=t,c=s.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,s);case"wc_sessionPing":return await this.onSessionPingRequest(n,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),V(this,"onRelayEventResponse",async t=>{const{topic:n,payload:s,transportType:i}=t,o=(await this.client.core.history.get(n,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),V(this,"onRelayEventUnknownPayload",t=>{const{topic:n}=t,{message:s}=te("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),V(this,"shouldIgnorePairingRequest",t=>{const{topic:n,requestMethod:s}=t,i=this.expectedPairingMethodMap.get(n);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),V(this,"onSessionProposeRequest",async t=>{const{topic:n,payload:s,attestation:i,encryptedId:o}=t,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l==null||l.setError(ui.proposal_listener_not_found)),this.isValidConnect(ht({},s.params));const u=a.expiryTimestamp||qt(Gt.wc_sessionPropose.req.ttl),d=ht({id:c,pairingTopic:n,expiryTimestamp:u},a);await this.setProposal(c,d);const h=await this.getVerifyContext({attestationId:i,hash:Ls(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});l==null||l.addTrace(_s.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(l){await this.sendError({id:c,topic:n,error:l,rpcOpts:Gt.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),V(this,"onSessionProposeResponse",async(t,n,s)=>{const{id:i}=n;if(Is(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:t,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:t})}else if($n(n)){await this.client.proposal.delete(i,at("USER_DISCONNECTED"));const o=Xe("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),V(this,"onSessionSettleRequest",async(t,n)=>{const{id:s,params:i}=n;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=n.params,f=[...this.pendingSessions.values()].find(m=>m.sessionTopic===t);if(!f)return this.client.logger.error(`Pending session not found for topic ${t}`);const g=this.client.proposal.get(f.proposalId),p=Pr(ht(ht(ht({topic:t,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:f.pairingTopic,requiredNamespaces:g.requiredNamespaces,optionalNamespaces:g.optionalNamespaces,controller:a.publicKey,self:{publicKey:f.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:vt.relay});await this.client.session.set(p.topic,p),await this.setExpiry(p.topic,p.expiry),await this.client.core.pairing.updateMetadata({topic:f.pairingTopic,metadata:p.peer.metadata}),this.client.events.emit("session_connect",{session:p}),this.events.emit(Xe("session_connect",f.proposalId),{session:p}),this.pendingSessions.delete(f.proposalId),this.deleteProposal(f.proposalId,!1),this.cleanupDuplicatePairings(p),await this.sendResult({id:n.id,topic:t,result:!0,throwOnFailedPublish:!0})}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),V(this,"onSessionSettleResponse",async(t,n)=>{const{id:s}=n;Is(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Xe("session_approve",s),{})):$n(n)&&(await this.client.session.delete(t,at("USER_DISCONNECTED")),this.events.emit(Xe("session_approve",s),{error:n.error}))}),V(this,"onSessionUpdateRequest",async(t,n)=>{const{params:s,id:i}=n;try{const o=`${t}_session_update`,a=sd.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:t,error:at("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(ht({topic:t},s));try{sd.set(o,i),await this.client.session.update(t,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0})}catch(c){throw sd.delete(o),c}this.client.events.emit("session_update",{id:i,topic:t,params:s})}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),V(this,"isRequestOutOfSync",(t,n)=>n.toString().slice(0,-3)<t.toString().slice(0,-3)),V(this,"onSessionUpdateResponse",(t,n)=>{const{id:s}=n,i=Xe("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Is(n)?this.events.emit(Xe("session_update",s),{}):$n(n)&&this.events.emit(Xe("session_update",s),{error:n.error})}),V(this,"onSessionExtendRequest",async(t,n)=>{const{id:s}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,qt(Uc)),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),V(this,"onSessionExtendResponse",(t,n)=>{const{id:s}=n,i=Xe("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Is(n)?this.events.emit(Xe("session_extend",s),{}):$n(n)&&this.events.emit(Xe("session_extend",s),{error:n.error})}),V(this,"onSessionPingRequest",async(t,n)=>{const{id:s}=n;try{this.isValidPing({topic:t}),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),V(this,"onSessionPingResponse",(t,n)=>{const{id:s}=n,i=Xe("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Is(n)?this.events.emit(Xe("session_ping",s),{}):$n(n)&&this.events.emit(Xe("session_ping",s),{error:n.error})},500)}),V(this,"onSessionDeleteRequest",async(t,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),Promise.all([new Promise(i=>{this.client.core.relayer.once(Zt.publish,async()=>{i(await this.deleteSession({topic:t,id:s}))})}),this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:at("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),V(this,"onSessionRequest",async t=>{var n,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=t,{id:d,params:h}=a;try{await this.isValidRequest(ht({topic:o},h));const f=this.client.session.get(o),g=await this.getVerifyContext({attestationId:c,hash:Ls(JSON.stringify(Oo("wc_sessionRequest",h,d))),encryptedId:l,metadata:f.peer.metadata,transportType:u}),p={id:d,topic:o,params:h,verifyContext:g};await this.setPendingSessionRequest(p),u===vt.link_mode&&(n=f.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((s=f.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(p):(this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue())}catch(f){await this.sendError({id:d,topic:o,error:f}),this.client.logger.error(f)}}),V(this,"onSessionRequestResponse",(t,n)=>{const{id:s}=n,i=Xe("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Is(n)?this.events.emit(Xe("session_request",s),{result:n.result}):$n(n)&&this.events.emit(Xe("session_request",s),{error:n.error})}),V(this,"onSessionEventRequest",async(t,n)=>{const{id:s,params:i}=n;try{const o=`${t}_session_event_${i.event.name}`,a=sd.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(ht({topic:t},i)),this.client.events.emit("session_event",{id:s,topic:t,params:i}),sd.set(o,s)}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),V(this,"onSessionAuthenticateResponse",(t,n)=>{const{id:s}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:n}),Is(n)?this.events.emit(Xe("session_request",s),{result:n.result}):$n(n)&&this.events.emit(Xe("session_request",s),{error:n.error})}),V(this,"onSessionAuthenticateRequest",async t=>{var n;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=t;try{const{requester:l,authPayload:u,expiryTimestamp:d}=i.params,h=await this.getVerifyContext({attestationId:o,hash:Ls(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),f={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:f,pairingTopic:s,transportType:c}),c===vt.link_mode&&(n=l.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),f={type:Ui,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:f,rpcOpts:Gt.wc_sessionAuthenticate.autoReject,appLink:h})}}),V(this,"addSessionRequestToSessionRequestQueue",t=>{this.sessionRequestQueue.queue.push(t)}),V(this,"cleanupAfterResponse",t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=As.idle,this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay))}),V(this,"cleanupPendingSentRequestsForTopic",({topic:t,error:n})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===t&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=Xe("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(Xe("session_request",i.request.id),{error:n})})}),V(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===As.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=As.active,this.emitSessionRequest(t)}catch(n){this.client.logger.error(n)}}),V(this,"emitSessionRequest",t=>{this.client.events.emit("session_request",t)}),V(this,"onPairingCreated",t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===t.topic);n&&this.onSessionProposeRequest({topic:t.topic,payload:Oo("wc_sessionPropose",Pr(ht({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id)})}),V(this,"isValidConnect",async t=>{if(!Wr(t)){const{message:l}=te("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(l)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=t;if(lr(n)||await this.isValidPairingTopic(n),!PB(c)){const{message:l}=te("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!lr(s)&&Kd(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!lr(i)&&Kd(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),lr(o)||this.validateSessionProps(o,"sessionProperties"),!lr(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u)))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),V(this,"validateNamespaces",(t,n)=>{const s=TB(t,"connect()",n);if(s)throw new Error(s.message)}),V(this,"isValidApprove",async t=>{if(!Wr(t))throw new Error(te("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=t;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),l=iy(s,"approve()");if(l)throw new Error(l.message);const u=Hv(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!Ft(i,!0)){const{message:d}=te("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(lr(o)||this.validateSessionProps(o,"sessionProperties"),!lr(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(h=>d.has(h)))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),V(this,"isValidReject",async t=>{if(!Wr(t)){const{message:i}=te("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(i)}const{id:n,reason:s}=t;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!RB(s)){const{message:i}=te("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),V(this,"isValidSessionSettleRequest",t=>{if(!Wr(t)){const{message:l}=te("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(l)}const{relay:n,controller:s,namespaces:i,expiry:o}=t;if(!zN(n)){const{message:l}=te("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=CB(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=iy(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(ao(o)){const{message:l}=te("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),V(this,"isValidUpdate",async t=>{if(!Wr(t)){const{message:c}=te("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(c)}const{topic:n,namespaces:s}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const i=this.client.session.get(n),o=iy(s,"update()");if(o)throw new Error(o.message);const a=Hv(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),V(this,"isValidExtend",async t=>{if(!Wr(t)){const{message:s}=te("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(s)}const{topic:n}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),V(this,"isValidRequest",async t=>{if(!Wr(t)){const{message:c}=te("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(c)}const{topic:n,request:s,chainId:i,expiry:o}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!jv(a,i)){const{message:c}=te("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!DB(s)){const{message:c}=te("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!BB(a,i,s.method)){const{message:c}=te("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!FB(o,hy)){const{message:c}=te("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${hy.min} and ${hy.max}`);throw new Error(c)}}),V(this,"isValidRespond",async t=>{var n;if(!Wr(t)){const{message:o}=te("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(o)}const{topic:s,response:i}=t;try{await this.isValidSessionTopic(s)}catch(o){throw(n=t==null?void 0:t.response)!=null&&n.id&&this.cleanupAfterResponse(t),o}if(!kB(i)){const{message:o}=te("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),V(this,"isValidPing",async t=>{if(!Wr(t)){const{message:s}=te("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),V(this,"isValidEmit",async t=>{if(!Wr(t)){const{message:a}=te("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(a)}const{topic:n,event:s,chainId:i}=t;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!jv(o,i)){const{message:a}=te("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!UB(s)){const{message:a}=te("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!LB(o,i,s.name)){const{message:a}=te("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),V(this,"isValidDisconnect",async t=>{if(!Wr(t)){const{message:s}=te("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),V(this,"isValidAuthenticate",t=>{const{chains:n,uri:s,domain:i,nonce:o}=t;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!Ft(s,!1))throw new Error("uri is required parameter");if(!Ft(i,!1))throw new Error("domain is required parameter");if(!Ft(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>fl(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=fl(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),V(this,"getVerifyContext",async t=>{const{attestationId:n,hash:s,encryptedId:i,metadata:o,transportType:a}=t,c={verified:{verifyUrl:o.verifyUrl||Td,validation:"UNKNOWN",origin:o.url||""}};try{if(a===vt.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:n,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),V(this,"validateSessionProps",(t,n)=>{Object.values(t).forEach((s,i)=>{if(s==null){const{message:o}=te("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${s} for key ${Object.keys(t)[i]}`);throw new Error(o)}})}),V(this,"getPendingAuthRequest",t=>{const n=this.client.auth.requests.get(t);return typeof n=="object"?n:void 0}),V(this,"addToRecentlyDeleted",(t,n)=>{if(this.recentlyDeletedMap.set(t,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),V(this,"checkRecentlyDeleted",t=>{const n=this.recentlyDeletedMap.get(t);if(n){const{message:s}=te("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${t}`);throw new Error(s)}}),V(this,"isLinkModeEnabled",(t,n)=>{var s,i,o,a,c,l,u,d,h;return!t||n!==vt.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=t==null?void 0:t.redirect)==null?void 0:u.universal)!==void 0&&((d=t==null?void 0:t.redirect)==null?void 0:d.universal)!==""&&((h=t==null?void 0:t.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),V(this,"getAppLinkIfEnabled",(t,n)=>{var s;return this.isLinkModeEnabled(t,n)?(s=t==null?void 0:t.redirect)==null?void 0:s.universal:void 0}),V(this,"handleLinkModeMessage",({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const n=ov(t,"topic")||"",s=decodeURIComponent(ov(t,"wc_ev")||""),i=this.client.session.keys.includes(n);i&&this.client.session.update(n,{transportType:vt.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:s,sessionExists:i})}),V(this,"registerLinkModeListeners",async()=>{var t;if(Vb()||qo()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await n.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),V(this,"shouldSetTVF",(t,n)=>{if(!n||t!=="wc_sessionRequest")return!1;const{request:s}=n;return Object.keys(_A).includes(s.method)}),V(this,"getTVFParams",(t,n,s)=>{var i,o;try{const a=n.request.method,c=this.extractTxHashesFromResult(a,s);return Pr(ht({correlationId:t,rpcMethods:[a],chainId:n.chainId},this.isValidContractData(n.request.params)&&{contractAddresses:[(o=(i=n.request.params)==null?void 0:i[0])==null?void 0:o.to]}),{txHashes:c})}catch(a){this.client.logger.warn("Error getting TVF params",a)}return{}}),V(this,"isValidContractData",t=>{var n;if(!t)return!1;try{const s=(t==null?void 0:t.data)||((n=t==null?void 0:t[0])==null?void 0:n.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),V(this,"extractTxHashesFromResult",(t,n)=>{try{const s=_A[t];if(typeof n=="string")return[n];const i=n[s.key];if(Do(i))return t==="solana_signAllTransactions"?i.map(o=>p5(o)):i;if(typeof i=="string")return[i]}catch(s){this.client.logger.warn("Error extracting tx hashes from result",s)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,s]of Object.entries(t))for(const i of s)try{await this.onProviderMessageEvent({topic:n,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Zt.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:t,message:n,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(vp)?this.client.auth.authKeys.get(vp):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(t,n,{receiverPublicKey:o,encoding:i===vt.link_mode?lo:us});t0(a)?(this.client.core.history.set(t,a),await this.onRelayEventRequest({topic:t,payload:a,attestation:s,transportType:i,encryptedId:Ls(n)})):Vg(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a,transportType:i}),this.client.core.history.delete(t,a.id)):await this.onRelayEventUnknownPayload({topic:t,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(t,n)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(On.expired,async e=>{const{topic:t,id:n}=cN(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,te("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,te("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(la.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(la.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!Ft(e,!1)){const{message:t}=te("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=te("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(ao(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=te("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Ft(e,!1)){const{message:t}=te("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=te("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(ao(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=te("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=te("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Ft(e,!1)){const{message:t}=te("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=te("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!OB(e)){const{message:t}=te("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=te("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(ao(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=te("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class k6 extends vc{constructor(e,t){super(e,t,w6,r0),this.core=e,this.logger=t}}let U6=class extends vc{constructor(e,t){super(e,t,b6,r0),this.core=e,this.logger=t}};class B6 extends vc{constructor(e,t){super(e,t,v6,r0,n=>n.id),this.core=e,this.logger=t}}class L6 extends vc{constructor(e,t){super(e,t,N6,Gg,()=>vp),this.core=e,this.logger=t}}class $6 extends vc{constructor(e,t){super(e,t,I6,Gg),this.core=e,this.logger=t}}class M6 extends vc{constructor(e,t){super(e,t,S6,Gg,n=>n.id),this.core=e,this.logger=t}}var F6=Object.defineProperty,j6=(r,e,t)=>e in r?F6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,fy=(r,e,t)=>j6(r,typeof e!="symbol"?e+"":e,t);class H6{constructor(e,t){this.core=e,this.logger=t,fy(this,"authKeys"),fy(this,"pairingTopics"),fy(this,"requests"),this.authKeys=new L6(this.core,this.logger),this.pairingTopics=new $6(this.core,this.logger),this.requests=new M6(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var z6=Object.defineProperty,q6=(r,e,t)=>e in r?z6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,je=(r,e,t)=>q6(r,typeof e!="symbol"?e+"":e,t);let V6=class mI extends u2{constructor(e){super(e),je(this,"protocol",fI),je(this,"version",pI),je(this,"name",dy.name),je(this,"metadata"),je(this,"core"),je(this,"logger"),je(this,"events",new jn.EventEmitter),je(this,"engine"),je(this,"session"),je(this,"proposal"),je(this,"pendingRequest"),je(this,"auth"),je(this,"signConfig"),je(this,"on",(n,s)=>this.events.on(n,s)),je(this,"once",(n,s)=>this.events.once(n,s)),je(this,"off",(n,s)=>this.events.off(n,s)),je(this,"removeListener",(n,s)=>this.events.removeListener(n,s)),je(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),je(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"update",async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"request",async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"find",n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),je(this,"authenticate",async(n,s)=>{try{return await this.engine.authenticate(n,s)}catch(i){throw this.logger.error(i.message),i}}),je(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||dy.name,this.metadata=SU(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:rf(Bu({level:(e==null?void 0:e.logger)||dy.logger}));this.core=(e==null?void 0:e.core)||new y6(e),this.logger=Sr(t,this.name),this.session=new U6(this.core,this.logger),this.proposal=new k6(this.core,this.logger),this.pendingRequest=new B6(this.core,this.logger),this.engine=new D6(this),this.auth=new H6(this.core,this.logger)}static async init(e){const t=new mI(e);return await t.initialize(),t}get context(){return rn(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},X.toMiliseconds(X.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Bw={exports:{}};(function(r,e){var t=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Bs<"u"&&Bs,n=function(){function i(){this.fetch=!1,this.DOMException=t.DOMException}return i.prototype=t,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof Bs<"u"&&Bs||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(b){return b&&DataView.prototype.isPrototypeOf(b)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(b){return b&&u.indexOf(Object.prototype.toString.call(b))>-1};function h(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(b)||b==="")throw new TypeError('Invalid character in header field name: "'+b+'"');return b.toLowerCase()}function f(b){return typeof b!="string"&&(b=String(b)),b}function g(b){var E={next:function(){var O=b.shift();return{done:O===void 0,value:O}}};return c.iterable&&(E[Symbol.iterator]=function(){return E}),E}function p(b){this.map={},b instanceof p?b.forEach(function(E,O){this.append(O,E)},this):Array.isArray(b)?b.forEach(function(E){if(E.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+E.length);this.append(E[0],E[1])},this):b&&Object.getOwnPropertyNames(b).forEach(function(E){this.append(E,b[E])},this)}p.prototype.append=function(b,E){b=h(b),E=f(E);var O=this.map[b];this.map[b]=O?O+", "+E:E},p.prototype.delete=function(b){delete this.map[h(b)]},p.prototype.get=function(b){return b=h(b),this.has(b)?this.map[b]:null},p.prototype.has=function(b){return this.map.hasOwnProperty(h(b))},p.prototype.set=function(b,E){this.map[h(b)]=f(E)},p.prototype.forEach=function(b,E){for(var O in this.map)this.map.hasOwnProperty(O)&&b.call(E,this.map[O],O,this)},p.prototype.keys=function(){var b=[];return this.forEach(function(E,O){b.push(O)}),g(b)},p.prototype.values=function(){var b=[];return this.forEach(function(E){b.push(E)}),g(b)},p.prototype.entries=function(){var b=[];return this.forEach(function(E,O){b.push([O,E])}),g(b)},c.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function m(b){if(!b._noBody){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}}function w(b){return new Promise(function(E,O){b.onload=function(){E(b.result)},b.onerror=function(){O(b.error)}})}function A(b){var E=new FileReader,O=w(E);return E.readAsArrayBuffer(b),O}function v(b){var E=new FileReader,O=w(E),B=/charset=([A-Za-z0-9_-]+)/.exec(b.type),k=B?B[1]:"utf-8";return E.readAsText(b,k),O}function I(b){for(var E=new Uint8Array(b),O=new Array(E.length),B=0;B<E.length;B++)O[B]=String.fromCharCode(E[B]);return O.join("")}function T(b){if(b.slice)return b.slice(0);var E=new Uint8Array(b.byteLength);return E.set(new Uint8Array(b)),E.buffer}function P(){return this.bodyUsed=!1,this._initBody=function(b){this.bodyUsed=this.bodyUsed,this._bodyInit=b,b?typeof b=="string"?this._bodyText=b:c.blob&&Blob.prototype.isPrototypeOf(b)?this._bodyBlob=b:c.formData&&FormData.prototype.isPrototypeOf(b)?this._bodyFormData=b:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)?this._bodyText=b.toString():c.arrayBuffer&&c.blob&&l(b)?(this._bodyArrayBuffer=T(b.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(b)||d(b))?this._bodyArrayBuffer=T(b):this._bodyText=b=Object.prototype.toString.call(b):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof b=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var b=m(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var b=m(this);return b||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(A);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var b=m(this);if(b)return b;if(this._bodyBlob)return v(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(I(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(H)}),this.json=function(){return this.text().then(JSON.parse)},this}var D=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function U(b){var E=b.toUpperCase();return D.indexOf(E)>-1?E:b}function S(b,E){if(!(this instanceof S))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');E=E||{};var O=E.body;if(b instanceof S){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,E.headers||(this.headers=new p(b.headers)),this.method=b.method,this.mode=b.mode,this.signal=b.signal,!O&&b._bodyInit!=null&&(O=b._bodyInit,b.bodyUsed=!0)}else this.url=String(b);if(this.credentials=E.credentials||this.credentials||"same-origin",(E.headers||!this.headers)&&(this.headers=new p(E.headers)),this.method=U(E.method||this.method||"GET"),this.mode=E.mode||this.mode||null,this.signal=E.signal||this.signal||function(){if("AbortController"in a){var F=new AbortController;return F.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&O)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(O),(this.method==="GET"||this.method==="HEAD")&&(E.cache==="no-store"||E.cache==="no-cache")){var B=/([?&])_=[^&]*/;if(B.test(this.url))this.url=this.url.replace(B,"$1_="+new Date().getTime());else{var k=/\?/;this.url+=(k.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})};function H(b){var E=new FormData;return b.trim().split("&").forEach(function(O){if(O){var B=O.split("="),k=B.shift().replace(/\+/g," "),F=B.join("=").replace(/\+/g," ");E.append(decodeURIComponent(k),decodeURIComponent(F))}}),E}function L(b){var E=new p,O=b.replace(/\r?\n[\t ]+/g," ");return O.split("\r").map(function(B){return B.indexOf(`
`)===0?B.substr(1,B.length):B}).forEach(function(B){var k=B.split(":"),F=k.shift().trim();if(F){var K=k.join(":").trim();try{E.append(F,K)}catch(Z){console.warn("Response "+Z.message)}}}),E}P.call(S.prototype);function j(b,E){if(!(this instanceof j))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(E||(E={}),this.type="default",this.status=E.status===void 0?200:E.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=E.statusText===void 0?"":""+E.statusText,this.headers=new p(E.headers),this.url=E.url||"",this._initBody(b)}P.call(j.prototype),j.prototype.clone=function(){return new j(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},j.error=function(){var b=new j(null,{status:200,statusText:""});return b.ok=!1,b.status=0,b.type="error",b};var Q=[301,302,303,307,308];j.redirect=function(b,E){if(Q.indexOf(E)===-1)throw new RangeError("Invalid status code");return new j(null,{status:E,headers:{location:b}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(E,O){this.message=E,this.name=O;var B=Error(E);this.stack=B.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function z(b,E){return new Promise(function(O,B){var k=new S(b,E);if(k.signal&&k.signal.aborted)return B(new o.DOMException("Aborted","AbortError"));var F=new XMLHttpRequest;function K(){F.abort()}F.onload=function(){var J={statusText:F.statusText,headers:L(F.getAllResponseHeaders()||"")};k.url.indexOf("file://")===0&&(F.status<200||F.status>599)?J.status=200:J.status=F.status,J.url="responseURL"in F?F.responseURL:J.headers.get("X-Request-URL");var ge="response"in F?F.response:F.responseText;setTimeout(function(){O(new j(ge,J))},0)},F.onerror=function(){setTimeout(function(){B(new TypeError("Network request failed"))},0)},F.ontimeout=function(){setTimeout(function(){B(new TypeError("Network request timed out"))},0)},F.onabort=function(){setTimeout(function(){B(new o.DOMException("Aborted","AbortError"))},0)};function Z(J){try{return J===""&&a.location.href?a.location.href:J}catch{return J}}if(F.open(k.method,Z(k.url),!0),k.credentials==="include"?F.withCredentials=!0:k.credentials==="omit"&&(F.withCredentials=!1),"responseType"in F&&(c.blob?F.responseType="blob":c.arrayBuffer&&(F.responseType="arraybuffer")),E&&typeof E.headers=="object"&&!(E.headers instanceof p||a.Headers&&E.headers instanceof a.Headers)){var se=[];Object.getOwnPropertyNames(E.headers).forEach(function(J){se.push(h(J)),F.setRequestHeader(J,f(E.headers[J]))}),k.headers.forEach(function(J,ge){se.indexOf(ge)===-1&&F.setRequestHeader(ge,J)})}else k.headers.forEach(function(J,ge){F.setRequestHeader(ge,J)});k.signal&&(k.signal.addEventListener("abort",K),F.onreadystatechange=function(){F.readyState===4&&k.signal.removeEventListener("abort",K)}),F.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return z.polyfill=!0,a.fetch||(a.fetch=z,a.Headers=p,a.Request=S,a.Response=j),o.Headers=p,o.Request=S,o.Response=j,o.fetch=z,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=t.fetch?t:n;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,r.exports=e})(Bw,Bw.exports);var W6=Bw.exports;const IA=Ig(W6);var G6=Object.defineProperty,K6=Object.defineProperties,J6=Object.getOwnPropertyDescriptors,SA=Object.getOwnPropertySymbols,Y6=Object.prototype.hasOwnProperty,Q6=Object.prototype.propertyIsEnumerable,xA=(r,e,t)=>e in r?G6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,TA=(r,e)=>{for(var t in e||(e={}))Y6.call(e,t)&&xA(r,t,e[t]);if(SA)for(var t of SA(e))Q6.call(e,t)&&xA(r,t,e[t]);return r},PA=(r,e)=>K6(r,J6(e));const Z6={Accept:"application/json","Content-Type":"application/json"},X6="POST",OA={headers:Z6,method:X6},RA=10;let ms=class{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new jn.EventEmitter,this.isAvailable=!1,this.registering=!1,!Kv(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=$i(e),n=await(await IA(this.url,PA(TA({},OA),{body:t}))).json();this.onPayload({data:n})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!Kv(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=$i({id:1,jsonrpc:"2.0",method:"test",params:[]});await IA(e,PA(TA({},OA),{body:t}))}this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?rc(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),s=n.message||n.toString(),i=qg(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return WN(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>RA&&this.events.setMaxListeners(RA)}};const DA="error",eF="wss://relay.walletconnect.org",tF="wc",rF="universal_provider",Kf=`${tF}@2:${rF}:`,yI="https://rpc.walletconnect.org/v1/",Zc="generic",nF=`${yI}bundler`,zn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function sF(){}function n0(r){return r==null||typeof r!="object"&&typeof r!="function"}function s0(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function iF(r){if(n0(r))return r;if(Array.isArray(r)||s0(r)||r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);const e=Object.getPrototypeOf(r),t=e.constructor;if(r instanceof Date||r instanceof Map||r instanceof Set)return new t(r);if(r instanceof RegExp){const n=new t(r);return n.lastIndex=r.lastIndex,n}if(r instanceof DataView)return new t(r.buffer.slice(0));if(r instanceof Error){const n=new t(r.message);return n.stack=r.stack,n.name=r.name,n.cause=r.cause,n}if(typeof File<"u"&&r instanceof File)return new t([r],r.name,{type:r.type,lastModified:r.lastModified});if(typeof r=="object"){const n=Object.create(e);return Object.assign(n,r)}return r}function kA(r){return typeof r=="object"&&r!==null}function wI(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function bI(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const oF="[object RegExp]",EI="[object String]",vI="[object Number]",AI="[object Boolean]",CI="[object Arguments]",aF="[object Symbol]",cF="[object Date]",lF="[object Map]",uF="[object Set]",dF="[object Array]",hF="[object ArrayBuffer]",fF="[object Object]",pF="[object DataView]",gF="[object Uint8Array]",mF="[object Uint8ClampedArray]",yF="[object Uint16Array]",wF="[object Uint32Array]",bF="[object Int8Array]",EF="[object Int16Array]",vF="[object Int32Array]",AF="[object Float32Array]",CF="[object Float64Array]";function _F(r,e){return ol(r,void 0,r,new Map,e)}function ol(r,e,t,n=new Map,s=void 0){const i=s==null?void 0:s(r,e,t,n);if(i!=null)return i;if(n0(r))return r;if(n.has(r))return n.get(r);if(Array.isArray(r)){const o=new Array(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=ol(r[a],a,t,n,s);return Object.hasOwn(r,"index")&&(o.index=r.index),Object.hasOwn(r,"input")&&(o.input=r.input),o}if(r instanceof Date)return new Date(r.getTime());if(r instanceof RegExp){const o=new RegExp(r.source,r.flags);return o.lastIndex=r.lastIndex,o}if(r instanceof Map){const o=new Map;n.set(r,o);for(const[a,c]of r)o.set(a,ol(c,a,t,n,s));return o}if(r instanceof Set){const o=new Set;n.set(r,o);for(const a of r)o.add(ol(a,void 0,t,n,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(r))return r.subarray();if(s0(r)){const o=new(Object.getPrototypeOf(r)).constructor(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=ol(r[a],a,t,n,s);return o}if(r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);if(r instanceof DataView){const o=new DataView(r.buffer.slice(0),r.byteOffset,r.byteLength);return n.set(r,o),ua(o,r,t,n,s),o}if(typeof File<"u"&&r instanceof File){const o=new File([r],r.name,{type:r.type});return n.set(r,o),ua(o,r,t,n,s),o}if(r instanceof Blob){const o=new Blob([r],{type:r.type});return n.set(r,o),ua(o,r,t,n,s),o}if(r instanceof Error){const o=new r.constructor;return n.set(r,o),o.message=r.message,o.name=r.name,o.stack=r.stack,o.cause=r.cause,ua(o,r,t,n,s),o}if(typeof r=="object"&&NF(r)){const o=Object.create(Object.getPrototypeOf(r));return n.set(r,o),ua(o,r,t,n,s),o}return r}function ua(r,e,t=r,n,s){const i=[...Object.keys(e),...wI(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(r,a);(c==null||c.writable)&&(r[a]=ol(e[a],a,t,n,s))}}function NF(r){switch(bI(r)){case CI:case dF:case hF:case pF:case AI:case cF:case AF:case CF:case bF:case EF:case vF:case lF:case vI:case fF:case oF:case uF:case EI:case aF:case gF:case mF:case yF:case wF:return!0;default:return!1}}function IF(r,e){return _F(r,(t,n,s,i)=>{if(typeof r=="object")switch(Object.prototype.toString.call(r)){case vI:case EI:case AI:{const o=new r.constructor(r==null?void 0:r.valueOf());return ua(o,r),o}case CI:{const o={};return ua(o,r),o.length=r.length,o[Symbol.iterator]=r[Symbol.iterator],o}default:return}})}function UA(r){return IF(r)}function BA(r){return r!==null&&typeof r=="object"&&bI(r)==="[object Arguments]"}function SF(r){return s0(r)}function xF(r){var t;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const n=r[Symbol.toStringTag];return n==null||!((t=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&t.writable)?!1:r.toString()===`[object ${n}]`}let e=r;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e}function TF(r,...e){const t=e.slice(0,-1),n=e[e.length-1];let s=r;for(let i=0;i<t.length;i++){const o=t[i];s=Lw(s,o,n,new Map)}return s}function Lw(r,e,t,n){if(n0(r)&&(r=Object(r)),e==null||typeof e!="object")return r;if(n.has(e))return iF(n.get(e));if(n.set(e,r),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...wI(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=r[o];if(BA(a)&&(a={...a}),BA(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=UA(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){const f=d[h];u[f]=c[f]}c=u}else c=[];const l=t(c,a,o,r,e,n);l!=null?r[o]=l:Array.isArray(a)||kA(c)&&kA(a)?r[o]=Lw(c,a,t,n):c==null&&xF(a)?r[o]=Lw({},a,t,n):c==null&&SF(a)?r[o]=UA(a):(c===void 0||a!==void 0)&&(r[o]=a)}return r}function PF(r,...e){return TF(r,...e,sF)}var OF=Object.defineProperty,RF=Object.defineProperties,DF=Object.getOwnPropertyDescriptors,LA=Object.getOwnPropertySymbols,kF=Object.prototype.hasOwnProperty,UF=Object.prototype.propertyIsEnumerable,$A=(r,e,t)=>e in r?OF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Jf=(r,e)=>{for(var t in e||(e={}))kF.call(e,t)&&$A(r,t,e[t]);if(LA)for(var t of LA(e))UF.call(e,t)&&$A(r,t,e[t]);return r},BF=(r,e)=>RF(r,DF(e));function An(r,e,t){var n;const s=fl(r);return((n=e.rpcMap)==null?void 0:n[s.reference])||`${yI}?chainId=${s.namespace}:${s.reference}&projectId=${t}`}function Ac(r){return r.includes(":")?r.split(":")[1]:r}function _I(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function LF(r,e){const t=Object.keys(e.namespaces).filter(s=>s.includes(r));if(!t.length)return[];const n=[];return t.forEach(s=>{const i=e.namespaces[s].accounts;n.push(...i)}),n}function py(r={},e={}){const t=MA(r),n=MA(e);return PF(t,n)}function MA(r){var e,t,n,s;const i={};if(!Kd(r))return i;for(const[o,a]of Object.entries(r)){const c=Zb(o)?[o]:a.chains,l=a.methods||[],u=a.events||[],d=a.rpcMap||{},h=wd(o);i[h]=BF(Jf(Jf({},i[h]),a),{chains:yp(c,(e=i[h])==null?void 0:e.chains),methods:yp(l,(t=i[h])==null?void 0:t.methods),events:yp(u,(n=i[h])==null?void 0:n.events),rpcMap:Jf(Jf({},d),(s=i[h])==null?void 0:s.rpcMap)})}return i}function FA(r){return r.includes(":")?r.split(":")[2]:r}function jA(r){const e={};for(const[t,n]of Object.entries(r)){const s=n.methods||[],i=n.events||[],o=n.accounts||[],a=Zb(t)?[t]:n.chains?n.chains:_I(n.accounts);e[t]={chains:a,methods:s,events:i,accounts:o}}return e}function gy(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}const NI={},Ye=r=>NI[r],my=(r,e)=>{NI[r]=e};var $F=Object.defineProperty,MF=(r,e,t)=>e in r?$F(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Bc=(r,e,t)=>MF(r,typeof e!="symbol"?e+"":e,t);class FF{constructor(e){Bc(this,"name","polkadot"),Bc(this,"client"),Bc(this,"httpProviders"),Bc(this,"events"),Bc(this,"namespace"),Bc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(zn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ac(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||An(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ms(n,Ye("disableProviderPing")))}}var jF=Object.defineProperty,HF=Object.defineProperties,zF=Object.getOwnPropertyDescriptors,HA=Object.getOwnPropertySymbols,qF=Object.prototype.hasOwnProperty,VF=Object.prototype.propertyIsEnumerable,$w=(r,e,t)=>e in r?jF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,zA=(r,e)=>{for(var t in e||(e={}))qF.call(e,t)&&$w(r,t,e[t]);if(HA)for(var t of HA(e))VF.call(e,t)&&$w(r,t,e[t]);return r},qA=(r,e)=>HF(r,zF(e)),Lc=(r,e,t)=>$w(r,typeof e!="symbol"?e+"":e,t);class WF{constructor(e){Lc(this,"name","eip155"),Lc(this,"client"),Lc(this,"chainId"),Lc(this,"namespace"),Lc(this,"httpProviders"),Lc(this,"events"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(zn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const n=t||An(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ms(n,Ye("disableProviderPing")))}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=parseInt(Ac(t));e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,n;let s=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,n,s;const i=(n=(t=e.request)==null?void 0:t.params)==null?void 0:n[0];if(!i)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const o=this.client.session.get(e.topic),a=((s=o==null?void 0:o.sessionProperties)==null?void 0:s.capabilities)||{};if(a!=null&&a[i])return a==null?void 0:a[i];const c=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:qA(zA({},o.sessionProperties||{}),{capabilities:qA(zA({},a||{}),{[i]:c})})})}catch(l){console.warn("Failed to update session with capabilities",l)}return c}async getCallStatus(e){var t,n;const s=this.client.session.get(e.topic),i=(t=s.sessionProperties)==null?void 0:t.bundler_name;if(i){const a=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(n=s.sessionProperties)==null?void 0:n.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var n;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Oo("eth_getUserOperationReceipt",[(n=t.request.params)==null?void 0:n[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,t){return`${nF}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var GF=Object.defineProperty,KF=(r,e,t)=>e in r?GF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$c=(r,e,t)=>KF(r,typeof e!="symbol"?e+"":e,t);class JF{constructor(e){$c(this,"name","solana"),$c(this,"client"),$c(this,"httpProviders"),$c(this,"events"),$c(this,"namespace"),$c(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(zn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ac(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||An(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ms(n,Ye("disableProviderPing")))}}var YF=Object.defineProperty,QF=(r,e,t)=>e in r?YF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Mc=(r,e,t)=>QF(r,typeof e!="symbol"?e+"":e,t);class ZF{constructor(e){Mc(this,"name","cosmos"),Mc(this,"client"),Mc(this,"httpProviders"),Mc(this,"events"),Mc(this,"namespace"),Mc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(zn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ac(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||An(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ms(n,Ye("disableProviderPing")))}}var XF=Object.defineProperty,ej=(r,e,t)=>e in r?XF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Fc=(r,e,t)=>ej(r,typeof e!="symbol"?e+"":e,t);class tj{constructor(e){Fc(this,"name","algorand"),Fc(this,"client"),Fc(this,"httpProviders"),Fc(this,"events"),Fc(this,"namespace"),Fc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const n=t||An(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(zn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||An(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Hn(new ms(n,Ye("disableProviderPing")))}}var rj=Object.defineProperty,nj=(r,e,t)=>e in r?rj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,jc=(r,e,t)=>nj(r,typeof e!="symbol"?e+"":e,t);class sj{constructor(e){jc(this,"name","cip34"),jc(this,"client"),jc(this,"httpProviders"),jc(this,"events"),jc(this,"namespace"),jc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(zn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=this.getCardanoRPCUrl(t),s=Ac(t);e[s]=this.createHttpProvider(s,n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||this.getCardanoRPCUrl(e);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ms(n,Ye("disableProviderPing")))}}var ij=Object.defineProperty,oj=(r,e,t)=>e in r?ij(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Hc=(r,e,t)=>oj(r,typeof e!="symbol"?e+"":e,t);class aj{constructor(e){Hc(this,"name","elrond"),Hc(this,"client"),Hc(this,"httpProviders"),Hc(this,"events"),Hc(this,"namespace"),Hc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(zn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ac(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||An(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ms(n,Ye("disableProviderPing")))}}var cj=Object.defineProperty,lj=(r,e,t)=>e in r?cj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,zc=(r,e,t)=>lj(r,typeof e!="symbol"?e+"":e,t);class uj{constructor(e){zc(this,"name","multiversx"),zc(this,"client"),zc(this,"httpProviders"),zc(this,"events"),zc(this,"namespace"),zc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(zn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ac(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||An(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ms(n,Ye("disableProviderPing")))}}var dj=Object.defineProperty,hj=(r,e,t)=>e in r?dj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,qc=(r,e,t)=>hj(r,typeof e!="symbol"?e+"":e,t);class fj{constructor(e){qc(this,"name","near"),qc(this,"client"),qc(this,"httpProviders"),qc(this,"events"),qc(this,"namespace"),qc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||An(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(zn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||An(e,this.namespace);return typeof n>"u"?void 0:new Hn(new ms(n,Ye("disableProviderPing")))}}var pj=Object.defineProperty,gj=(r,e,t)=>e in r?pj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Vc=(r,e,t)=>gj(r,typeof e!="symbol"?e+"":e,t);class mj{constructor(e){Vc(this,"name","tezos"),Vc(this,"client"),Vc(this,"httpProviders"),Vc(this,"events"),Vc(this,"namespace"),Vc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||An(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(zn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||An(e,this.namespace);return typeof n>"u"?void 0:new Hn(new ms(n))}}var yj=Object.defineProperty,wj=(r,e,t)=>e in r?yj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Wc=(r,e,t)=>wj(r,typeof e!="symbol"?e+"":e,t);class bj{constructor(e){Wc(this,"name",Zc),Wc(this,"client"),Wc(this,"httpProviders"),Wc(this,"events"),Wc(this,"namespace"),Wc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(zn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const n={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(s=>{const i=fl(s);n[`${i.namespace}:${i.reference}`]=this.createHttpProvider(s)}),n}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||An(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ms(n,Ye("disableProviderPing")))}}var Ej=Object.defineProperty,vj=Object.defineProperties,Aj=Object.getOwnPropertyDescriptors,VA=Object.getOwnPropertySymbols,Cj=Object.prototype.hasOwnProperty,_j=Object.prototype.propertyIsEnumerable,Mw=(r,e,t)=>e in r?Ej(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Yf=(r,e)=>{for(var t in e||(e={}))Cj.call(e,t)&&Mw(r,t,e[t]);if(VA)for(var t of VA(e))_j.call(e,t)&&Mw(r,t,e[t]);return r},yy=(r,e)=>vj(r,Aj(e)),In=(r,e,t)=>Mw(r,typeof e!="symbol"?e+"":e,t);let Nj=class II{constructor(e){In(this,"client"),In(this,"namespaces"),In(this,"optionalNamespaces"),In(this,"sessionProperties"),In(this,"scopedProperties"),In(this,"events",new Db),In(this,"rpcProviders",{}),In(this,"session"),In(this,"providerOpts"),In(this,"logger"),In(this,"uri"),In(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:rf(Bu({level:(e==null?void 0:e.logger)||DA})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new II(e);return await t.initialize(),t}async request(e,t,n){const[s,i]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Yf({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:n})}sendAsync(e,t,n,s){const i=new Date().getTime();this.request(e,n,s).then(o=>t(null,zg(i,o))).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:at("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:n,response:s}=await this.client.authenticate(e,t);n&&(this.uri=n,this.events.emit("display_uri",n));const i=await s();if(this.session=i.session,this.session){const o=jA(this.session.namespaces);this.namespaces=py(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const s=await n();this.session=s;const i=jA(s.namespaces);return this.namespaces=py(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[n,s]=this.validateChain(e),i=this.getProvider(n);i.name===Zc?i.setDefaultChain(`${n}:${s}`,t):i.setDefaultChain(s,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Do(t)){for(const n of t)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await V6.init({core:this.providerOpts.core,logger:this.providerOpts.logger||DA,relayUrl:this.providerOpts.relayUrl||eF,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(n){throw this.logger.error("Failed to get session",n),new Error(`The provided session: ${(t=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:t.topic} doesn't exist in the Sign client`)}else{const n=this.client.session.getAll();this.session=n[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>wd(t)))];my("client",this.client),my("events",this.events),my("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const n=LF(t,this.session),s=_I(n),i=py(this.namespaces,this.optionalNamespaces),o=yy(Yf({},i[t]),{accounts:n,chains:s});switch(t){case"eip155":this.rpcProviders[t]=new WF({namespace:o});break;case"algorand":this.rpcProviders[t]=new tj({namespace:o});break;case"solana":this.rpcProviders[t]=new JF({namespace:o});break;case"cosmos":this.rpcProviders[t]=new ZF({namespace:o});break;case"polkadot":this.rpcProviders[t]=new FF({namespace:o});break;case"cip34":this.rpcProviders[t]=new sj({namespace:o});break;case"elrond":this.rpcProviders[t]=new aj({namespace:o});break;case"multiversx":this.rpcProviders[t]=new uj({namespace:o});break;case"near":this.rpcProviders[t]=new fj({namespace:o});break;case"tezos":this.rpcProviders[t]=new mj({namespace:o});break;default:this.rpcProviders[Zc]?this.rpcProviders[Zc].updateNamespace(o):this.rpcProviders[Zc]=new bj({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:n}=e;n===((t=this.session)==null?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:n,topic:s}=e;if(s!==((t=this.session)==null?void 0:t.topic))return;const{event:i}=n;if(i.name==="accountsChanged"){const o=i.data;o&&Do(o)&&this.events.emit("accountsChanged",o.map(FA))}else if(i.name==="chainChanged"){const o=n.chainId,a=n.event.data,c=wd(o),l=gy(o)!==gy(a)?`${c}:${gy(a)}`:o;this.onChainChanged(l)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var n,s;if(e!==((n=this.session)==null?void 0:n.topic))return;const{namespaces:i}=t,o=(s=this.client)==null?void 0:s.session.get(e);this.session=yy(Yf({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===((t=this.session)==null?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",yy(Yf({},at("USER_DISCONNECTED")),{data:e.topic})))}),this.on(zn.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[Zc]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:n,sessionProperties:s,scopedProperties:i}=e;t&&Object.keys(t).length&&(this.namespaces=t),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[t,n]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map(o=>wd(o)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const s=wd(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;const[n,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(n,s),this.events.emit("chainChanged",s);const i=this.getProvider(n).getDefaultChain();t||this.getProvider(n).setDefaultChain(s),this.emitAccountsChangedOnChainChange({namespace:n,previousChainId:i,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:t,newChainId:n}){var s,i;try{if(t===n)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${n}:`)).map(FA);if(!Do(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,t){if(!this.namespaces)return;const n=this.namespaces[e]?e:`${e}:${t}`,s={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[n]?this.namespaces[n]&&(this.namespaces[n].defaultChain=t):this.namespaces[n]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var n;const s=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.setItem(`${Kf}/${e}${s}`,t)}async getFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${Kf}/${e}${n}`)}async deleteFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${Kf}/${e}${n}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const n of t)n.startsWith(Kf)&&await this.client.core.storage.removeItem(n)}catch(t){this.logger.warn("Failed to cleanup storage",t)}}};var yu={};const Ij="https://secure.walletconnect.org/sdk",Sj=(typeof process<"u"&&typeof yu<"u"?yu.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||Ij,xj=(typeof process<"u"&&typeof yu<"u"?yu.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",Tj=(typeof process<"u"&&typeof yu<"u"?yu.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",fe={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},pr={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},sa=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),zt=xt({...sa}),cs={state:zt,subscribeKey(r,e){return tn(zt,r,e)},showLoading(r,e={}){this._showMessage({message:r,variant:"loading",...e})},showSuccess(r){this._showMessage({message:r,variant:"success"})},showSvg(r,e){this._showMessage({message:r,svg:e})},showError(r){const e=ve.parseError(r);this._showMessage({message:e,variant:"error"})},hide(){zt.message=sa.message,zt.variant=sa.variant,zt.svg=sa.svg,zt.open=sa.open,zt.autoClose=sa.autoClose},_showMessage({message:r,svg:e,variant:t="success",autoClose:n=sa.autoClose}){zt.open?(zt.open=!1,setTimeout(()=>{zt.message=r,zt.variant=t,zt.svg=e,zt.open=!0,zt.autoClose=n},150)):(zt.message=r,zt.variant=t,zt.svg=e,zt.open=!0,zt.autoClose=n)}},Od={getSIWX(){return G.state.siwx},async initializeIfEnabled(){var i;const r=G.state.siwx,e=x.getActiveCaipAddress();if(!(r&&e))return;const[t,n,s]=e.split(":");if(x.checkIfSupportedNetwork(t))try{if((await r.getSessions(`${t}:${n}`,s)).length)return;await Bt.open({view:"SIWXSignMessage"})}catch(o){console.error("SIWXUtil:initializeIfEnabled",o),At.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await((i=bt._getClient())==null?void 0:i.disconnect().catch(console.error)),et.reset("Connect"),cs.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const r=G.state.siwx,e=ve.getPlainAddress(x.getActiveCaipAddress()),t=x.getActiveCaipNetwork(),n=bt._getClient();if(!r)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!t)throw new Error("No ActiveCaipNetwork or client found");if(!n)throw new Error("No ConnectionController client found");try{const s=await r.createMessage({chainId:t.caipNetworkId,accountAddress:e}),i=s.toString();Ne.getConnectorId(t.chainNamespace)===ee.CONNECTOR_ID.AUTH&&et.pushTransactionStack({view:null,goBack:!1,replace:!0});const a=await n.signMessage(i);await r.addSession({data:s,message:i,signature:a}),Bt.close(),At.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){const i=this.getSIWXEventProperties();(!Bt.state.open||et.state.view==="ApproveTransaction")&&await Bt.open({view:"SIWXSignMessage"}),i.isSmartAccount?cs.showError("This application might not support Smart Accounts"):cs.showError("Signature declined"),At.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:i}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){var r;try{const e=this.getSIWX();((r=e==null?void 0:e.getRequired)==null?void 0:r.call(e))?await bt.disconnect():Bt.close(),et.reset("Connect"),At.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getSessions(){const r=G.state.siwx,e=ve.getPlainAddress(x.getActiveCaipAddress()),t=x.getActiveCaipNetwork();return r&&e&&t?r.getSessions(t.caipNetworkId,e):[]},async isSIWXCloseDisabled(){var e;const r=this.getSIWX();if(r){const t=et.state.view==="ApproveTransaction",n=et.state.view==="SIWXSignMessage";if(t||n)return((e=r.getRequired)==null?void 0:e.call(r))&&(await this.getSessions()).length===0}return!1},async universalProviderAuthenticate({universalProvider:r,chains:e,methods:t}){var a,c,l;const n=Od.getSIWX(),s=new Set(e.map(u=>u.split(":")[0]));if(!n||s.size!==1||!s.has("eip155"))return!1;const i=await n.createMessage({chainId:((a=x.getActiveCaipNetwork())==null?void 0:a.caipNetworkId)||"",accountAddress:""}),o=await r.authenticate({nonce:i.nonce,domain:i.domain,uri:i.uri,exp:i.expirationTime,iat:i.issuedAt,nbf:i.notBefore,requestId:i.requestId,version:i.version,resources:i.resources,statement:i.statement,chainId:i.chainId,methods:t,chains:[i.chainId,...e.filter(u=>u!==i.chainId)]});if(cs.showLoading("Authenticating...",{autoClose:!1}),de.setConnectedWalletInfo({...o.session.peer.metadata,name:o.session.peer.metadata.name,icon:(c=o.session.peer.metadata.icons)==null?void 0:c[0],type:"WALLET_CONNECT"},Array.from(s)[0]),(l=o==null?void 0:o.auths)!=null&&l.length){const u=o.auths.map(d=>{const h=r.client.formatAuthMessage({request:d.p,iss:d.p.iss});return{data:{...d.p,accountAddress:d.p.iss.split(":").slice(-1).join(""),chainId:d.p.iss.split(":").slice(2,4).join(":"),uri:d.p.aud,version:d.p.version||i.version,expirationTime:d.p.exp,issuedAt:d.p.iat,notBefore:d.p.nbf},message:h,signature:d.s.s,cacao:d}});try{await n.setSessions(u),At.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:Od.getSIWXEventProperties()})}catch(d){throw console.error("SIWX:universalProviderAuth - failed to set sessions",d),At.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:Od.getSIWXEventProperties()}),await r.disconnect().catch(console.error),d}finally{cs.hide()}}return!0},getSIWXEventProperties(){var e,t;const r=x.state.activeChain;return{network:((e=x.state.activeCaipNetwork)==null?void 0:e.caipNetworkId)||"",isSmartAccount:((t=de.state.preferredAccountTypes)==null?void 0:t[r])===pr.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const r=this.getSIWX();r&&await r.setSessions([])}},mt=xt({transactions:[],coinbaseTransactions:{},transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),Pj={state:mt,subscribe(r){return Nr(mt,()=>r(mt))},setLastNetworkInView(r){mt.lastNetworkInView=r},async fetchTransactions(r,e){var t,n;if(!r)throw new Error("Transactions can't be fetched without an accountAddress");mt.loading=!0;try{const s=await Ce.fetchTransactions({account:r,cursor:mt.next,onramp:e,cache:e==="coinbase"?"no-cache":void 0,chainId:(t=x.state.activeCaipNetwork)==null?void 0:t.caipNetworkId}),i=this.filterSpamTransactions(s.data),o=this.filterByConnectedChain(i),a=[...mt.transactions,...o];mt.loading=!1,e==="coinbase"?mt.coinbaseTransactions=this.groupTransactionsByYearAndMonth(mt.coinbaseTransactions,s.data):(mt.transactions=a,mt.transactionsByYear=this.groupTransactionsByYearAndMonth(mt.transactionsByYear,o)),mt.empty=a.length===0,mt.next=s.next?s.next:void 0}catch{const i=x.state.activeChain;At.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:r,projectId:G.state.projectId,cursor:mt.next,isSmartAccount:((n=de.state.preferredAccountTypes)==null?void 0:n[i])===pr.ACCOUNT_TYPES.SMART_ACCOUNT}}),cs.showError("Failed to fetch transactions"),mt.loading=!1,mt.empty=!0,mt.next=void 0}},groupTransactionsByYearAndMonth(r={},e=[]){const t=r;return e.forEach(n=>{const s=new Date(n.metadata.minedAt).getFullYear(),i=new Date(n.metadata.minedAt).getMonth(),o=t[s]??{},c=(o[i]??[]).filter(l=>l.id!==n.id);t[s]={...o,[i]:[...c,n].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),t},filterSpamTransactions(r){return r.filter(e=>!e.transfers.every(n=>{var s;return((s=n.nft_info)==null?void 0:s.flags.is_spam)===!0}))},filterByConnectedChain(r){var n;const e=(n=x.state.activeCaipNetwork)==null?void 0:n.caipNetworkId;return r.filter(s=>s.metadata.chain===e)},clearCursor(){mt.next=void 0},resetTransactions(){mt.transactions=[],mt.transactionsByYear={},mt.lastNetworkInView=void 0,mt.loading=!1,mt.empty=!1,mt.next=void 0}},yt=xt({wcError:!1,buffering:!1,status:"disconnected"});let Zo;const bt={state:yt,subscribeKey(r,e){return tn(yt,r,e)},_getClient(){return yt._client},setClient(r){yt._client=tc(r)},async connectWalletConnect(){var r,e,t,n;if(ve.isTelegram()||ve.isSafari()&&ve.isIos()){if(Zo){await Zo,Zo=void 0;return}if(!ve.isPairingExpired(yt==null?void 0:yt.wcPairingExpiry)){const s=yt.wcUri;yt.wcUri=s;return}Zo=(e=(r=this._getClient())==null?void 0:r.connectWalletConnect)==null?void 0:e.call(r).catch(()=>{}),this.state.status="connecting",await Zo,Zo=void 0,yt.wcPairingExpiry=void 0,this.state.status="connected"}else await((n=(t=this._getClient())==null?void 0:t.connectWalletConnect)==null?void 0:n.call(t))},async connectExternal(r,e,t=!0){var n,s;await((s=(n=this._getClient())==null?void 0:n.connectExternal)==null?void 0:s.call(n,r)),t&&x.setActiveNamespace(e)},async reconnectExternal(r){var t,n;await((n=(t=this._getClient())==null?void 0:t.reconnectExternal)==null?void 0:n.call(t,r));const e=r.chain||x.state.activeChain;e&&Ne.setConnectorId(r.id,e)},async setPreferredAccountType(r,e){var n;Bt.setLoading(!0,x.state.activeChain);const t=Ne.getAuthConnector();t&&(de.setPreferredAccountType(r,e),await t.provider.setPreferredAccount(r),ie.setPreferredAccountTypes(de.state.preferredAccountTypes??{[e]:r}),await this.reconnectExternal(t),Bt.setLoading(!1,x.state.activeChain),At.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:r,network:((n=x.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)||""}}))},async signMessage(r){var e;return(e=this._getClient())==null?void 0:e.signMessage(r)},parseUnits(r,e){var t;return(t=this._getClient())==null?void 0:t.parseUnits(r,e)},formatUnits(r,e){var t;return(t=this._getClient())==null?void 0:t.formatUnits(r,e)},async sendTransaction(r){var e;return(e=this._getClient())==null?void 0:e.sendTransaction(r)},async getCapabilities(r){var e;return(e=this._getClient())==null?void 0:e.getCapabilities(r)},async grantPermissions(r){var e;return(e=this._getClient())==null?void 0:e.grantPermissions(r)},async walletGetAssets(r){var e;return((e=this._getClient())==null?void 0:e.walletGetAssets(r))??{}},async estimateGas(r){var e;return(e=this._getClient())==null?void 0:e.estimateGas(r)},async writeContract(r){var e;return(e=this._getClient())==null?void 0:e.writeContract(r)},async getEnsAddress(r){var e;return(e=this._getClient())==null?void 0:e.getEnsAddress(r)},async getEnsAvatar(r){var e;return(e=this._getClient())==null?void 0:e.getEnsAvatar(r)},checkInstalled(r){var e,t;return((t=(e=this._getClient())==null?void 0:e.checkInstalled)==null?void 0:t.call(e,r))||!1},resetWcConnection(){yt.wcUri=void 0,yt.wcPairingExpiry=void 0,yt.wcLinking=void 0,yt.recentWallet=void 0,yt.status="disconnected",Pj.resetTransactions(),ie.deleteWalletConnectDeepLink()},resetUri(){yt.wcUri=void 0,yt.wcPairingExpiry=void 0,Zo=void 0},finalizeWcConnection(){var t,n;const{wcLinking:r,recentWallet:e}=bt.state;r&&ie.setWalletConnectDeepLink(r),e&&ie.setAppKitRecent(e),At.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:r?"mobile":"qrcode",name:((n=(t=et.state.data)==null?void 0:t.wallet)==null?void 0:n.name)||"Unknown"}})},setWcBasic(r){yt.wcBasic=r},setUri(r){yt.wcUri=r,yt.wcPairingExpiry=ve.getPairingExpiry()},setWcLinking(r){yt.wcLinking=r},setWcError(r){yt.wcError=r,yt.buffering=!1},setRecentWallet(r){yt.recentWallet=r},setBuffering(r){yt.buffering=r},setStatus(r){yt.status=r},async disconnect(r){try{Bt.setLoading(!0,r),await Od.clearSessions(),await x.disconnect(r),Bt.setLoading(!1,r),Ne.setFilterByNamespace(void 0)}catch{throw new Error("Failed to disconnect")}}},Gc=xt({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),Vs={state:Gc,subscribe(r){return Nr(Gc,()=>r(Gc))},subscribeOpen(r){return tn(Gc,"open",r)},set(r){Object.assign(Gc,{...Gc,...r})}};function Oj(r,{strict:e=!0}={}){return!r||typeof r!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(r):r.startsWith("0x")}function WA(r){return Oj(r,{strict:!1})?Math.ceil((r.length-2)/2):r.length}const SI="2.29.2";let ld={getDocsUrl:({docsBaseUrl:r,docsPath:e="",docsSlug:t})=>e?`${r??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${SI}`};class Cn extends Error{constructor(e,t={}){var a;const n=(()=>{var c;return t.cause instanceof Cn?t.cause.details:(c=t.cause)!=null&&c.message?t.cause.message:t.details})(),s=t.cause instanceof Cn&&t.cause.docsPath||t.docsPath,i=(a=ld.getDocsUrl)==null?void 0:a.call(ld,{...t,docsPath:s}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...n?[`Details: ${n}`]:[],...ld.version?[`Version: ${ld.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=SI}walk(e){return xI(this,e)}}function xI(r,e){return e!=null&&e(r)?r:r&&typeof r=="object"&&"cause"in r&&r.cause!==void 0?xI(r.cause,e):e?null:r}class TI extends Cn{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function i0(r,{dir:e,size:t=32}={}){return typeof r=="string"?Rj(r,{dir:e,size:t}):Dj(r,{dir:e,size:t})}function Rj(r,{dir:e,size:t=32}={}){if(t===null)return r;const n=r.replace("0x","");if(n.length>t*2)throw new TI({size:Math.ceil(n.length/2),targetSize:t,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function Dj(r,{dir:e,size:t=32}={}){if(t===null)return r;if(r.length>t)throw new TI({size:r.length,targetSize:t,type:"bytes"});const n=new Uint8Array(t);for(let s=0;s<t;s++){const i=e==="right";n[i?s:t-s-1]=r[i?s:r.length-s-1]}return n}class kj extends Cn{constructor({max:e,min:t,signed:n,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class Uj extends Cn{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function PI(r,{size:e}){if(WA(r)>e)throw new Uj({givenSize:WA(r),maxSize:e})}const Bj=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function GA(r,e={}){return typeof r=="number"||typeof r=="bigint"?$j(r,e):typeof r=="string"?RI(r,e):typeof r=="boolean"?Lj(r,e):OI(r,e)}function Lj(r,e={}){const t=`0x${Number(r)}`;return typeof e.size=="number"?(PI(t,{size:e.size}),i0(t,{size:e.size})):t}function OI(r,e={}){let t="";for(let s=0;s<r.length;s++)t+=Bj[r[s]];const n=`0x${t}`;return typeof e.size=="number"?(PI(n,{size:e.size}),i0(n,{dir:"right",size:e.size})):n}function $j(r,e={}){const{signed:t,size:n}=e,s=BigInt(r);let i;n?t?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof r=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&t?-i-1n:0;if(i&&s>i||s<o){const c=typeof r=="bigint"?"n":"";throw new kj({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:t,size:n,value:`${r}${c}`})}const a=`0x${(t&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?i0(a,{size:n}):a}const Mj=new TextEncoder;function RI(r,e={}){const t=Mj.encode(r);return OI(t,e)}class Fj extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const Va=(r,e,t)=>JSON.stringify(r,(n,s)=>typeof s=="bigint"?s.toString():s,t);function jj(r,e){let t=r.toString();const n=t.startsWith("-");n&&(t=t.slice(1)),t=t.padStart(e,"0");let[s,i]=[t.slice(0,t.length-e),t.slice(t.length-e)];return i=i.replace(/(0+)$/,""),`${n?"-":""}${s||"0"}${i?`.${i}`:""}`}const o0=r=>r;class Rd extends Cn{constructor({body:e,cause:t,details:n,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:t,details:n,metaMessages:[i&&`Status: ${i}`,`URL: ${o0(o)}`,e&&`Request body: ${Va(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class DI extends Cn{constructor({body:e,error:t,url:n}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:[`URL: ${o0(n)}`,`Request body: ${Va(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=t.code,this.data=t.data}}class KA extends Cn{constructor({body:e,url:t}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${o0(t)}`,`Request body: ${Va(e)}`],name:"TimeoutError"})}}const Hj=-1;class nn extends Cn{constructor(e,{code:t,docsPath:n,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:n,metaMessages:s||(e==null?void 0:e.metaMessages),name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof DI?e.code:t??Hj}}class _n extends nn{constructor(e,t){super(e,t),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t.data}}class Yd extends nn{constructor(e){super(e,{code:Yd.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(Yd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class Qd extends nn{constructor(e){super(e,{code:Qd.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(Qd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class Zd extends nn{constructor(e,{method:t}={}){super(e,{code:Zd.code,name:"MethodNotFoundRpcError",shortMessage:`The method${t?` "${t}"`:""} does not exist / is not available.`})}}Object.defineProperty(Zd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class Xd extends nn{constructor(e){super(e,{code:Xd.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Xd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class wu extends nn{constructor(e){super(e,{code:wu.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(wu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class eh extends nn{constructor(e){super(e,{code:eh.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(eh,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class th extends nn{constructor(e){super(e,{code:th.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(th,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class rh extends nn{constructor(e){super(e,{code:rh.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(rh,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class bu extends nn{constructor(e){super(e,{code:bu.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(bu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class wa extends nn{constructor(e,{method:t}={}){super(e,{code:wa.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${t?` "${t}"`:""} is not supported.`})}}Object.defineProperty(wa,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class Eu extends nn{constructor(e){super(e,{code:Eu.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(Eu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class nh extends nn{constructor(e){super(e,{code:nh.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(nh,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class Wa extends _n{constructor(e){super(e,{code:Wa.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(Wa,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class sh extends _n{constructor(e){super(e,{code:sh.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(sh,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class ih extends _n{constructor(e,{method:t}={}){super(e,{code:ih.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${t?` " ${t}"`:""}.`})}}Object.defineProperty(ih,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class oh extends _n{constructor(e){super(e,{code:oh.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(oh,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class ah extends _n{constructor(e){super(e,{code:ah.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(ah,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class ch extends _n{constructor(e){super(e,{code:ch.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(ch,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class lh extends _n{constructor(e){super(e,{code:lh.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(lh,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class uh extends _n{constructor(e){super(e,{code:uh.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(uh,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class dh extends _n{constructor(e){super(e,{code:dh.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(dh,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class hh extends _n{constructor(e){super(e,{code:hh.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(hh,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class fh extends _n{constructor(e){super(e,{code:fh.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(fh,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class ph extends _n{constructor(e){super(e,{code:ph.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(ph,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class gh extends _n{constructor(e){super(e,{code:gh.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(gh,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class zj extends nn{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}class a0 extends Cn{constructor({cause:e,message:t}={}){var s;const n=(s=t==null?void 0:t.replace("execution reverted: ",""))==null?void 0:s.replace("execution reverted","");super(`Execution reverted ${n?`with reason: ${n}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(a0,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(a0,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});function qj(){let r=()=>{},e=()=>{};return{promise:new Promise((n,s)=>{r=n,e=s}),resolve:r,reject:e}}const wy=new Map;function Vj({fn:r,id:e,shouldSplitBatch:t,wait:n=0,sort:s}){const i=async()=>{const u=c();o();const d=u.map(({args:h})=>h);d.length!==0&&r(d).then(h=>{s&&Array.isArray(h)&&h.sort(s);for(let f=0;f<u.length;f++){const{resolve:g}=u[f];g==null||g([h[f],h])}}).catch(h=>{for(let f=0;f<u.length;f++){const{reject:g}=u[f];g==null||g(h)}})},o=()=>wy.delete(e),a=()=>c().map(({args:u})=>u),c=()=>wy.get(e)||[],l=u=>wy.set(e,[...c(),u]);return{flush:o,async schedule(u){const{promise:d,resolve:h,reject:f}=qj();return(t==null?void 0:t([...a(),u]))&&i(),c().length>0?(l({args:u,resolve:h,reject:f}),d):(l({args:u,resolve:h,reject:f}),setTimeout(i,n),d)}}}async function kI(r){return new Promise(e=>setTimeout(e,r))}const Fw=256;let Qf=Fw,Zf;function Wj(r=11){if(!Zf||Qf+r>Fw*2){Zf="",Qf=0;for(let e=0;e<Fw;e++)Zf+=(256+Math.random()*256|0).toString(16).substring(1)}return Zf.substring(Qf,Qf+++r)}const Xf=new Fj(8192);function Gj(r,{enabled:e=!0,id:t}){if(!e||!t)return r();if(Xf.get(t))return Xf.get(t);const n=r().finally(()=>Xf.delete(t));return Xf.set(t,n),n}function Kj(r,{delay:e=100,retryCount:t=2,shouldRetry:n=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:l})=>{const u=typeof e=="function"?e({count:a,error:l}):e;u&&await kI(u),o({count:a+1})};try{const l=await r();s(l)}catch(l){if(a<t&&await n({count:a,error:l}))return c({error:l});i(l)}};o()})}function Jj(r,e={}){return async(t,n={})=>{var d;const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...e,...n},{method:l}=t;if((d=i==null?void 0:i.exclude)!=null&&d.includes(l))throw new wa(new Error("method not supported"),{method:l});if(i!=null&&i.include&&!i.include.includes(l))throw new wa(new Error("method not supported"),{method:l});const u=s?RI(`${c}.${Va(t)}`):void 0;return Gj(()=>Kj(async()=>{try{return await r(t)}catch(h){const f=h;switch(f.code){case Yd.code:throw new Yd(f);case Qd.code:throw new Qd(f);case Zd.code:throw new Zd(f,{method:t.method});case Xd.code:throw new Xd(f);case wu.code:throw new wu(f);case eh.code:throw new eh(f);case th.code:throw new th(f);case rh.code:throw new rh(f);case bu.code:throw new bu(f);case wa.code:throw new wa(f,{method:t.method});case Eu.code:throw new Eu(f);case nh.code:throw new nh(f);case Wa.code:throw new Wa(f);case sh.code:throw new sh(f);case ih.code:throw new ih(f);case oh.code:throw new oh(f);case ah.code:throw new ah(f);case ch.code:throw new ch(f);case lh.code:throw new lh(f);case uh.code:throw new uh(f);case dh.code:throw new dh(f);case hh.code:throw new hh(f);case fh.code:throw new fh(f);case ph.code:throw new ph(f);case gh.code:throw new gh(f);case 5e3:throw new Wa(f);default:throw h instanceof Cn?h:new zj(f)}}},{delay:({count:h,error:f})=>{var g;if(f&&f instanceof Rd){const p=(g=f==null?void 0:f.headers)==null?void 0:g.get("Retry-After");if(p!=null&&p.match(/\d/))return Number.parseInt(p)*1e3}return~~(1<<h)*o},retryCount:a,shouldRetry:({error:h})=>Yj(h)}),{enabled:s,id:u})}}function Yj(r){return"code"in r&&typeof r.code=="number"?r.code===-1||r.code===Eu.code||r.code===wu.code:r instanceof Rd&&r.status?r.status===403||r.status===408||r.status===413||r.status===429||r.status===500||r.status===502||r.status===503||r.status===504:!0}function UI({key:r,methods:e,name:t,request:n,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const l=Wj();return{config:{key:r,methods:e,name:t,request:n,retryCount:s,retryDelay:i,timeout:o,type:a},request:Jj(n,{methods:e,retryCount:s,retryDelay:i,uid:l}),value:c}}function JA(r,e={}){const{key:t="fallback",name:n="Fallback",rank:s=!1,shouldThrow:i=Qj,retryCount:o,retryDelay:a}=e;return({chain:c,pollingInterval:l=4e3,timeout:u,...d})=>{let h=r,f=()=>{};const g=UI({key:t,name:n,async request({method:p,params:m}){let w;const A=async(v=0)=>{const I=h[v]({...d,chain:c,retryCount:0,timeout:u});try{const T=await I.request({method:p,params:m});return f({method:p,params:m,response:T,transport:I,status:"success"}),T}catch(T){if(f({error:T,method:p,params:m,transport:I,status:"error"}),i(T)||v===h.length-1||(w??(w=h.slice(v+1).some(P=>{const{include:D,exclude:U}=P({chain:c}).config.methods||{};return D?D.includes(p):U?!U.includes(p):!0})),!w))throw T;return A(v+1)}};return A()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:p=>f=p,transports:h.map(p=>p({chain:c,retryCount:0}))});if(s){const p=typeof s=="object"?s:{};Zj({chain:c,interval:p.interval??l,onTransports:m=>h=m,ping:p.ping,sampleCount:p.sampleCount,timeout:p.timeout,transports:h,weights:p.weights})}return g}}function Qj(r){return!!("code"in r&&typeof r.code=="number"&&(r.code===bu.code||r.code===Wa.code||a0.nodeMessage.test(r.message)||r.code===5e3))}function Zj({chain:r,interval:e=4e3,onTransports:t,ping:n,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,u=[],d=async()=>{const h=await Promise.all(o.map(async p=>{const m=p({chain:r,retryCount:0,timeout:i}),w=Date.now();let A,v;try{await(n?n({transport:m}):m.request({method:"net_listening"})),v=1}catch{v=0}finally{A=Date.now()}return{latency:A-w,success:v}}));u.push(h),u.length>s&&u.shift();const f=Math.max(...u.map(p=>Math.max(...p.map(({latency:m})=>m)))),g=o.map((p,m)=>{const w=u.map(P=>P[m].latency),v=1-w.reduce((P,D)=>P+D,0)/w.length/f,I=u.map(P=>P[m].success),T=I.reduce((P,D)=>P+D,0)/I.length;return T===0?[0,m]:[l*v+c*T,m]}).sort((p,m)=>m[0]-p[0]);t(g.map(([,p])=>o[p])),await kI(e),d()};d()}class Xj extends Cn{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function e9(r,{errorInstance:e=new Error("timed out"),timeout:t,signal:n}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;t>0&&(o=setTimeout(()=>{n&&a.abort()},t)),s(await r({signal:(a==null?void 0:a.signal)||null}))}catch(a){(a==null?void 0:a.name)==="AbortError"&&i(e),i(a)}finally{clearTimeout(o)}})()})}function t9(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const YA=t9();function r9(r,e={}){return{async request(t){var d;const{body:n,onRequest:s=e.onRequest,onResponse:i=e.onResponse,timeout:o=e.timeout??1e4}=t,a={...e.fetchOptions??{},...t.fetchOptions??{}},{headers:c,method:l,signal:u}=a;try{const h=await e9(async({signal:g})=>{const p={...a,body:Array.isArray(n)?Va(n.map(v=>({jsonrpc:"2.0",id:v.id??YA.take(),...v}))):Va({jsonrpc:"2.0",id:n.id??YA.take(),...n}),headers:{"Content-Type":"application/json",...c},method:l||"POST",signal:u||(o>0?g:null)},m=new Request(r,p),w=await(s==null?void 0:s(m,p))??{...p,url:r};return await fetch(w.url??r,w)},{errorInstance:new KA({body:n,url:r}),timeout:o,signal:!0});i&&await i(h);let f;if((d=h.headers.get("Content-Type"))!=null&&d.startsWith("application/json"))f=await h.json();else{f=await h.text();try{f=JSON.parse(f||"{}")}catch(g){if(h.ok)throw g;f={error:f}}}if(!h.ok)throw new Rd({body:n,details:Va(f.error)||h.statusText,headers:h.headers,status:h.status,url:r});return f}catch(h){throw h instanceof Rd||h instanceof KA?h:new Rd({body:n,cause:h,url:r})}}}}function ep(r,e={}){const{batch:t,fetchOptions:n,key:s="http",methods:i,name:o="HTTP JSON-RPC",onFetchRequest:a,onFetchResponse:c,retryDelay:l,raw:u}=e;return({chain:d,retryCount:h,timeout:f})=>{const{batchSize:g=1e3,wait:p=0}=typeof t=="object"?t:{},m=e.retryCount??h,w=f??e.timeout??1e4,A=r||(d==null?void 0:d.rpcUrls.default.http[0]);if(!A)throw new Xj;const v=r9(A,{fetchOptions:n,onRequest:a,onResponse:c,timeout:w});return UI({key:s,methods:i,name:o,async request({method:I,params:T}){const P={method:I,params:T},{schedule:D}=Vj({id:A,wait:p,shouldSplitBatch(L){return L.length>g},fn:L=>v.request({body:L}),sort:(L,j)=>L.id-j.id}),U=async L=>t?D(L):[await v.request({body:L})],[{error:S,result:H}]=await U(P);if(u)return{error:S,result:H};if(S)throw new DI({body:P,error:S,url:A});return H},retryCount:m,retryDelay:l,timeout:w,type:"http"},{fetchOptions:n,url:A})}}function c0(r){return{formatters:void 0,fees:void 0,serializers:void 0,...r}}const by={createBalance(r,e){const t={name:r.metadata.name||"",symbol:r.metadata.symbol||"",decimals:r.metadata.decimals||0,value:r.metadata.value||0,price:r.metadata.price||0,iconUrl:r.metadata.iconUrl||""};return{name:t.name,symbol:t.symbol,chainId:e,address:r.address==="native"?void 0:this.convertAddressToCAIP10Address(r.address,e),value:t.value,price:t.price,quantity:{decimals:t.decimals.toString(),numeric:this.convertHexToBalance({hex:r.balance,decimals:t.decimals})},iconUrl:t.iconUrl}},convertHexToBalance({hex:r,decimals:e}){return jj(BigInt(r),e)},convertAddressToCAIP10Address(r,e){return`${e}:${r}`},createCAIP2ChainId(r,e){return`${e}:${parseInt(r,16)}`},getChainIdHexFromCAIP2ChainId(r){const e=r.split(":");if(e.length<2||!e[1])return"0x0";const t=e[1],n=parseInt(t,10);return isNaN(n)?"0x0":`0x${n.toString(16)}`},isWalletGetAssetsResponse(r){return typeof r!="object"||r===null?!1:Object.values(r).every(e=>Array.isArray(e)&&e.every(t=>this.isValidAsset(t)))},isValidAsset(r){return typeof r=="object"&&r!==null&&typeof r.address=="string"&&typeof r.balance=="string"&&(r.type==="ERC20"||r.type==="NATIVE")&&typeof r.metadata=="object"&&r.metadata!==null&&typeof r.metadata.name=="string"&&typeof r.metadata.symbol=="string"&&typeof r.metadata.decimals=="number"&&typeof r.metadata.price=="number"&&typeof r.metadata.iconUrl=="string"}},QA={async getMyTokensWithBalance(r){const e=de.state.address,t=x.state.activeCaipNetwork;if(!e||!t)return[];if(t.chainNamespace==="eip155"){const s=await this.getEIP155Balances(e,t);if(s)return this.filterLowQualityTokens(s)}const n=await Ce.getBalance(e,t.caipNetworkId,r);return this.filterLowQualityTokens(n.balances)},async getEIP155Balances(r,e){var t,n;try{const s=by.getChainIdHexFromCAIP2ChainId(e.caipNetworkId),i=await bt.getCapabilities(r);if(!((n=(t=i==null?void 0:i[s])==null?void 0:t.assetDiscovery)!=null&&n.supported))return null;const o=await bt.walletGetAssets({account:r,chainFilter:[s]});return by.isWalletGetAssetsResponse(o)?(o[s]||[]).map(c=>by.createBalance(c,e.caipNetworkId)):null}catch{return null}},filterLowQualityTokens(r){return r.filter(e=>e.quantity.decimals!=="0")},mapBalancesToSwapTokens(r){return(r==null?void 0:r.map(e=>({...e,address:e!=null&&e.address?e.address:x.getActiveNetworkTokenAddress(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1})))||[]}},nt=xt({tokenBalances:[],loading:!1}),ZA={state:nt,subscribe(r){return Nr(nt,()=>r(nt))},subscribeKey(r,e){return tn(nt,r,e)},setToken(r){r&&(nt.token=tc(r))},setTokenAmount(r){nt.sendTokenAmount=r},setReceiverAddress(r){nt.receiverAddress=r},setReceiverProfileImageUrl(r){nt.receiverProfileImageUrl=r},setReceiverProfileName(r){nt.receiverProfileName=r},setNetworkBalanceInUsd(r){nt.networkBalanceInUSD=r},setLoading(r){nt.loading=r},async sendToken(){var r;try{switch(this.setLoading(!0),(r=x.state.activeCaipNetwork)==null?void 0:r.chainNamespace){case"eip155":await this.sendEvmToken();return;case"solana":await this.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}finally{this.setLoading(!1)}},async sendEvmToken(){var t,n,s,i;const r=x.state.activeChain,e=(t=de.state.preferredAccountTypes)==null?void 0:t[r];if(!this.state.sendTokenAmount||!this.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!this.state.token)throw new Error("A token is required");(n=this.state.token)!=null&&n.address?(At.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===pr.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token.address,amount:this.state.sendTokenAmount,network:((s=x.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)||""}}),await this.sendERC20Token({receiverAddress:this.state.receiverAddress,tokenAddress:this.state.token.address,sendTokenAmount:this.state.sendTokenAmount,decimals:this.state.token.quantity.decimals})):(At.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===pr.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token.symbol||"",amount:this.state.sendTokenAmount,network:((i=x.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)||""}}),await this.sendNativeToken({receiverAddress:this.state.receiverAddress,sendTokenAmount:this.state.sendTokenAmount,decimals:this.state.token.quantity.decimals}))},async fetchTokenBalance(r){var i,o;nt.loading=!0;const e=(i=x.state.activeCaipNetwork)==null?void 0:i.caipNetworkId,t=(o=x.state.activeCaipNetwork)==null?void 0:o.chainNamespace,n=x.state.activeCaipAddress,s=n?ve.getPlainAddress(n):void 0;if(nt.lastRetry&&!ve.isAllowedRetry(nt.lastRetry,30*hr.ONE_SEC_MS))return nt.loading=!1,[];try{if(s&&e&&t){const a=await QA.getMyTokensWithBalance();return nt.tokenBalances=a,nt.lastRetry=void 0,a}}catch(a){nt.lastRetry=Date.now(),r==null||r(a),cs.showError("Token Balance Unavailable")}finally{nt.loading=!1}return[]},fetchNetworkBalance(){if(nt.tokenBalances.length===0)return;const r=QA.mapBalancesToSwapTokens(nt.tokenBalances);if(!r)return;const e=r.find(t=>t.address===x.getActiveNetworkTokenAddress());e&&(nt.networkBalanceInUSD=e?MT.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(r){var o,a,c;const e=x.state.activeChain;et.pushTransactionStack({view:null,goBack:!1});const t=r.receiverAddress,n=de.state.address,s=bt.parseUnits(r.sendTokenAmount.toString(),Number(r.decimals));await bt.sendTransaction({chainNamespace:"eip155",to:t,address:n,data:"0x",value:s??BigInt(0)}),At.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:((o=de.state.preferredAccountTypes)==null?void 0:o[e])===pr.ACCOUNT_TYPES.SMART_ACCOUNT,token:((a=this.state.token)==null?void 0:a.symbol)||"",amount:r.sendTokenAmount,network:((c=x.state.activeCaipNetwork)==null?void 0:c.caipNetworkId)||""}}),this.resetSend()},async sendERC20Token(r){et.pushTransactionStack({view:"Account",goBack:!1});const e=bt.parseUnits(r.sendTokenAmount.toString(),Number(r.decimals));if(de.state.address&&r.sendTokenAmount&&r.receiverAddress&&r.tokenAddress){const t=ve.getPlainAddress(r.tokenAddress);await bt.writeContract({fromAddress:de.state.address,tokenAddress:t,args:[r.receiverAddress,e??BigInt(0)],method:"transfer",abi:zT.getERC20Abi(t),chainNamespace:"eip155"}),this.resetSend()}},async sendSolanaToken(){if(!this.state.sendTokenAmount||!this.state.receiverAddress)throw new Error("An amount and receiver address are required");et.pushTransactionStack({view:"Account",goBack:!1}),await bt.sendTransaction({chainNamespace:"solana",to:this.state.receiverAddress,value:this.state.sendTokenAmount}),this.resetSend(),de.fetchTokenBalance()},resetSend(){nt.token=void 0,nt.sendTokenAmount=void 0,nt.receiverAddress=void 0,nt.receiverProfileImageUrl=void 0,nt.receiverProfileName=void 0,nt.loading=!1,nt.tokenBalances=[]}},Ey={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[],user:void 0},tp={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},ne=xt({chains:TT(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),x={state:ne,subscribe(r){return Nr(ne,()=>{r(ne)})},subscribeKey(r,e){return tn(ne,r,e)},subscribeChainProp(r,e,t){let n;return Nr(ne.chains,()=>{var i;const s=t||ne.activeChain;if(s){const o=(i=ne.chains.get(s))==null?void 0:i[r];n!==o&&(n=o,e(o))}})},initialize(r,e,t){const{chainId:n,namespace:s}=ie.getActiveNetworkProps(),i=e==null?void 0:e.find(u=>u.id.toString()===(n==null?void 0:n.toString())),a=r.find(u=>(u==null?void 0:u.namespace)===s)||(r==null?void 0:r[0]),c=r.map(u=>u.namespace).filter(u=>u!==void 0),l=G.state.enableEmbedded?new Set([...c]):new Set([...(e==null?void 0:e.map(u=>u.chainNamespace))??[]]);((r==null?void 0:r.length)===0||!a)&&(ne.noAdapters=!0),ne.noAdapters||(ne.activeChain=a==null?void 0:a.namespace,ne.activeCaipNetwork=i,this.setChainNetworkData(a==null?void 0:a.namespace,{caipNetwork:i}),ne.activeChain&&Vs.set({activeChain:a==null?void 0:a.namespace})),l.forEach(u=>{const d=e==null?void 0:e.filter(h=>h.chainNamespace===u);x.state.chains.set(u,{namespace:u,networkState:xt({...tp,caipNetwork:d==null?void 0:d[0]}),accountState:xt(Ey),caipNetworks:d??[],...t}),this.setRequestedCaipNetworks(d??[],u)})},removeAdapter(r){var e,t;if(ne.activeChain===r){const n=Array.from(ne.chains.entries()).find(([s])=>s!==r);if(n){const s=(t=(e=n[1])==null?void 0:e.caipNetworks)==null?void 0:t[0];s&&this.setActiveCaipNetwork(s)}}ne.chains.delete(r)},addAdapter(r,{networkControllerClient:e,connectionControllerClient:t},n){ne.chains.set(r.namespace,{namespace:r.namespace,networkState:{...tp,caipNetwork:n[0]},accountState:Ey,caipNetworks:n,connectionControllerClient:t,networkControllerClient:e}),this.setRequestedCaipNetworks((n==null?void 0:n.filter(s=>s.chainNamespace===r.namespace))??[],r.namespace)},addNetwork(r){var t;const e=ne.chains.get(r.chainNamespace);if(e){const n=[...e.caipNetworks||[]];(t=e.caipNetworks)!=null&&t.find(s=>s.id===r.id)||n.push(r),ne.chains.set(r.chainNamespace,{...e,caipNetworks:n}),this.setRequestedCaipNetworks(n,r.chainNamespace),Ne.filterByNamespace(r.chainNamespace,!0)}},removeNetwork(r,e){var n,s,i;const t=ne.chains.get(r);if(t){const o=((n=ne.activeCaipNetwork)==null?void 0:n.id)===e,a=[...((s=t.caipNetworks)==null?void 0:s.filter(c=>c.id!==e))||[]];o&&((i=t==null?void 0:t.caipNetworks)!=null&&i[0])&&this.setActiveCaipNetwork(t.caipNetworks[0]),ne.chains.set(r,{...t,caipNetworks:a}),this.setRequestedCaipNetworks(a||[],r),a.length===0&&Ne.filterByNamespace(r,!1)}},setAdapterNetworkState(r,e){const t=ne.chains.get(r);t&&(t.networkState={...t.networkState||tp,...e},ne.chains.set(r,t))},setChainAccountData(r,e,t=!0){if(!r)throw new Error("Chain is required to update chain account data");const n=ne.chains.get(r);if(n){const s={...n.accountState||Ey,...e};ne.chains.set(r,{...n,accountState:s}),(ne.chains.size===1||ne.activeChain===r)&&(e.caipAddress&&(ne.activeCaipAddress=e.caipAddress),de.replaceState(s))}},setChainNetworkData(r,e){if(!r)return;const t=ne.chains.get(r);if(t){const n={...t.networkState||tp,...e};ne.chains.set(r,{...t,networkState:n})}},setAccountProp(r,e,t,n=!0){this.setChainAccountData(t,{[r]:e},n),r==="status"&&e==="disconnected"&&t&&Ne.removeConnectorId(t)},setActiveNamespace(r){var n,s;ne.activeChain=r;const e=r?ne.chains.get(r):void 0,t=(n=e==null?void 0:e.networkState)==null?void 0:n.caipNetwork;t!=null&&t.id&&r&&(ne.activeCaipAddress=(s=e==null?void 0:e.accountState)==null?void 0:s.caipAddress,ne.activeCaipNetwork=t,this.setChainNetworkData(r,{caipNetwork:t}),ie.setActiveCaipNetworkId(t==null?void 0:t.caipNetworkId),Vs.set({activeChain:r,selectedNetworkId:t==null?void 0:t.caipNetworkId}))},setActiveCaipNetwork(r){var n,s,i;if(!r)return;ne.activeChain!==r.chainNamespace&&this.setIsSwitchingNamespace(!0);const e=ne.chains.get(r.chainNamespace);ne.activeChain=r.chainNamespace,ne.activeCaipNetwork=r,this.setChainNetworkData(r.chainNamespace,{caipNetwork:r}),(n=e==null?void 0:e.accountState)!=null&&n.address?ne.activeCaipAddress=`${r.chainNamespace}:${r.id}:${(s=e==null?void 0:e.accountState)==null?void 0:s.address}`:ne.activeCaipAddress=void 0,this.setAccountProp("caipAddress",ne.activeCaipAddress,r.chainNamespace),e&&de.replaceState(e.accountState),ZA.resetSend(),Vs.set({activeChain:ne.activeChain,selectedNetworkId:(i=ne.activeCaipNetwork)==null?void 0:i.caipNetworkId}),ie.setActiveCaipNetworkId(r.caipNetworkId),!this.checkIfSupportedNetwork(r.chainNamespace)&&G.state.enableNetworkSwitch&&!G.state.allowUnsupportedChain&&!bt.state.wcBasic&&this.showUnsupportedChainUI()},addCaipNetwork(r){var t;if(!r)return;const e=ne.chains.get(r.chainNamespace);e&&((t=e==null?void 0:e.caipNetworks)==null||t.push(r))},async switchActiveNamespace(r){var s;if(!r)return;const e=r!==x.state.activeChain,t=(s=x.getNetworkData(r))==null?void 0:s.caipNetwork,n=x.getCaipNetworkByNamespace(r,t==null?void 0:t.id);e&&n&&await x.switchActiveNetwork(n)},async switchActiveNetwork(r){var s;const e=x.state.chains.get(x.state.activeChain);!((s=e==null?void 0:e.caipNetworks)!=null&&s.some(i=>{var o;return i.id===((o=ne.activeCaipNetwork)==null?void 0:o.id)}))&&et.goBack();const n=this.getNetworkControllerClient(r.chainNamespace);n&&(await n.switchCaipNetwork(r),At.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:r.caipNetworkId}}))},getNetworkControllerClient(r){const e=r||ne.activeChain,t=ne.chains.get(e);if(!t)throw new Error("Chain adapter not found");if(!t.networkControllerClient)throw new Error("NetworkController client not set");return t.networkControllerClient},getConnectionControllerClient(r){const e=r||ne.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const t=ne.chains.get(e);if(!(t!=null&&t.connectionControllerClient))throw new Error("ConnectionController client not set");return t.connectionControllerClient},getAccountProp(r,e){var s;let t=ne.activeChain;if(e&&(t=e),!t)return;const n=(s=ne.chains.get(t))==null?void 0:s.accountState;if(n)return n[r]},getNetworkProp(r,e){var n;const t=(n=ne.chains.get(e))==null?void 0:n.networkState;if(t)return t[r]},getRequestedCaipNetworks(r){const e=ne.chains.get(r),{approvedCaipNetworkIds:t=[],requestedCaipNetworks:n=[]}=(e==null?void 0:e.networkState)||{};return ve.sortRequestedNetworks(t,n)},getAllRequestedCaipNetworks(){const r=[];return ne.chains.forEach(e=>{const t=this.getRequestedCaipNetworks(e.namespace);r.push(...t)}),r},setRequestedCaipNetworks(r,e){this.setAdapterNetworkState(e,{requestedCaipNetworks:r});const n=this.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(n));Ne.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const r=[];return ne.chains.forEach(e=>{const t=this.getApprovedCaipNetworkIds(e.namespace);r.push(...t)}),r},getActiveCaipNetwork(){return ne.activeCaipNetwork},getActiveCaipAddress(){return ne.activeCaipAddress},getApprovedCaipNetworkIds(r){var n;const e=ne.chains.get(r);return((n=e==null?void 0:e.networkState)==null?void 0:n.approvedCaipNetworkIds)||[]},async setApprovedCaipNetworksData(r){const e=this.getNetworkControllerClient(),t=await(e==null?void 0:e.getApprovedCaipNetworksData());this.setAdapterNetworkState(r,{approvedCaipNetworkIds:t==null?void 0:t.approvedCaipNetworkIds,supportsAllNetworks:t==null?void 0:t.supportsAllNetworks})},checkIfSupportedNetwork(r,e){const t=e||ne.activeCaipNetwork,n=this.getRequestedCaipNetworks(r);return n.length?n==null?void 0:n.some(s=>s.id===(t==null?void 0:t.id)):!0},checkIfSupportedChainId(r){if(!ne.activeChain)return!0;const e=this.getRequestedCaipNetworks(ne.activeChain);return e==null?void 0:e.some(t=>t.id===r)},setSmartAccountEnabledNetworks(r,e){this.setAdapterNetworkState(e,{smartAccountEnabledNetworks:r})},checkIfSmartAccountEnabled(){var n;const r=HC.caipNetworkIdToNumber((n=ne.activeCaipNetwork)==null?void 0:n.caipNetworkId),e=ne.activeChain;if(!e||!r)return!1;const t=this.getNetworkProp("smartAccountEnabledNetworks",e);return!!(t!=null&&t.includes(Number(r)))},getActiveNetworkTokenAddress(){var n,s;const r=((n=ne.activeCaipNetwork)==null?void 0:n.chainNamespace)||"eip155",e=((s=ne.activeCaipNetwork)==null?void 0:s.id)||1,t=hr.NATIVE_TOKEN_ADDRESS[r];return`${r}:${e}:${t}`},showUnsupportedChainUI(){Bt.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const r=ne.activeCaipNetwork;return!!(r!=null&&r.chainNamespace&&hr.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(r.chainNamespace))},resetNetwork(r){this.setAdapterNetworkState(r,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]})},resetAccount(r){const e=r;if(!e)throw new Error("Chain is required to set account prop");ne.activeCaipAddress=void 0,this.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountTypes:void 0,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,allAccounts:[],user:void 0,status:"disconnected"}),Ne.removeConnectorId(e)},async disconnect(r){const e=eP(r);try{ZA.resetSend();const t=await Promise.allSettled(e.map(async([s,i])=>{var o;try{const{caipAddress:a}=this.getAccountData(s)||{};a&&((o=i.connectionControllerClient)!=null&&o.disconnect)&&await i.connectionControllerClient.disconnect(s),this.resetAccount(s),this.resetNetwork(s)}catch(a){throw new Error(`Failed to disconnect chain ${s}: ${a.message}`)}}));bt.resetWcConnection();const n=t.filter(s=>s.status==="rejected");if(n.length>0)throw new Error(n.map(s=>s.reason.message).join(", "));ie.deleteConnectedSocialProvider(),r?Ne.removeConnectorId(r):Ne.resetConnectorIds(),At.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(t){console.error(t.message||"Failed to disconnect chains"),At.sendEvent({type:"track",event:"DISCONNECT_ERROR",properties:{message:t.message||"Failed to disconnect chains"}})}},setIsSwitchingNamespace(r){ne.isSwitchingNamespace=r},getFirstCaipNetworkSupportsAuthConnector(){var t,n;const r=[];let e;if(ne.chains.forEach(s=>{ee.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(i=>i===s.namespace)&&s.namespace&&r.push(s.namespace)}),r.length>0){const s=r[0];return e=s?(n=(t=ne.chains.get(s))==null?void 0:t.caipNetworks)==null?void 0:n[0]:void 0,e}},getAccountData(r){var e;return r?(e=x.state.chains.get(r))==null?void 0:e.accountState:de.state},getNetworkData(r){var t;const e=r||ne.activeChain;if(e)return(t=x.state.chains.get(e))==null?void 0:t.networkState},getCaipNetworkByNamespace(r,e){var s,i,o;if(!r)return;const t=x.state.chains.get(r),n=(s=t==null?void 0:t.caipNetworks)==null?void 0:s.find(a=>a.id===e);return n||((i=t==null?void 0:t.networkState)==null?void 0:i.caipNetwork)||((o=t==null?void 0:t.caipNetworks)==null?void 0:o[0])},getRequestedCaipNetworkIds(){const r=Ne.state.filterByNamespace;return(r?[ne.chains.get(r)]:Array.from(ne.chains.values())).flatMap(t=>(t==null?void 0:t.caipNetworks)||[]).map(t=>t.caipNetworkId)},getCaipNetworks(r){return r?x.getRequestedCaipNetworks(r):x.getAllRequestedCaipNetworks()}},n9={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},BI=ve.getBlockchainApiUrl(),ln=xt({clientId:null,api:new xg({baseUrl:BI,clientId:null}),supportedChains:{http:[],ws:[]}}),Ce={state:ln,async get(r){const{st:e,sv:t}=Ce.getSdkProperties(),n=G.state.projectId,s={...r.params||{},st:e,sv:t,projectId:n};return ln.api.get({...r,params:s})},getSdkProperties(){const{sdkType:r,sdkVersion:e}=G.state;return{st:r||"unknown",sv:e||"unknown"}},async isNetworkSupported(r){if(!r)return!1;try{ln.supportedChains.http.length||await Ce.getSupportedNetworks()}catch{return!1}return ln.supportedChains.http.includes(r)},async getSupportedNetworks(){const r=await Ce.get({path:"v1/supported-chains"});return ln.supportedChains=r,r},async fetchIdentity({address:r,caipNetworkId:e}){if(!await Ce.isNetworkSupported(e))return{avatar:"",name:""};const n=ie.getIdentityFromCacheForAddress(r);if(n)return n;const s=await Ce.get({path:`/v1/identity/${r}`,params:{sender:x.state.activeCaipAddress?ve.getPlainAddress(x.state.activeCaipAddress):void 0}});return ie.updateIdentityCache({address:r,identity:s,timestamp:Date.now()}),s},async fetchTransactions({account:r,cursor:e,onramp:t,signal:n,cache:s,chainId:i}){var a;return await Ce.isNetworkSupported((a=x.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?Ce.get({path:`/v1/account/${r}/history`,params:{cursor:e,onramp:t,chainId:i},signal:n,cache:s}):{data:[],next:void 0}},async fetchSwapQuote({amount:r,userAddress:e,from:t,to:n,gasPrice:s}){var o;return await Ce.isNetworkSupported((o=x.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)?Ce.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:r,userAddress:e,from:t,to:n,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:r}){var t;return await Ce.isNetworkSupported((t=x.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?Ce.get({path:"/v1/convert/tokens",params:{chainId:r}}):{tokens:[]}},async fetchTokenPrice({addresses:r}){var t;return await Ce.isNetworkSupported((t=x.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?ln.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:r,projectId:G.state.projectId},headers:{"Content-Type":"application/json"}}):{fungibles:[]}},async fetchSwapAllowance({tokenAddress:r,userAddress:e}){var n;return await Ce.isNetworkSupported((n=x.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?Ce.get({path:"/v1/convert/allowance",params:{tokenAddress:r,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:r}){var s;const{st:e,sv:t}=Ce.getSdkProperties();if(!await Ce.isNetworkSupported((s=x.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))throw new Error("Network not supported for Gas Price");return Ce.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:r,st:e,sv:t}})},async generateSwapCalldata({amount:r,from:e,to:t,userAddress:n,disableEstimate:s}){var o;if(!await Ce.isNetworkSupported((o=x.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return ln.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:r,eip155:{slippage:hr.CONVERT_SLIPPAGE_TOLERANCE},projectId:G.state.projectId,from:e,to:t,userAddress:n,disableEstimate:s}})},async generateApproveCalldata({from:r,to:e,userAddress:t}){var o;const{st:n,sv:s}=Ce.getSdkProperties();if(!await Ce.isNetworkSupported((o=x.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return Ce.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:t,from:r,to:e,st:n,sv:s}})},async getBalance(r,e,t){var l;const{st:n,sv:s}=Ce.getSdkProperties();if(!await Ce.isNetworkSupported((l=x.state.activeCaipNetwork)==null?void 0:l.caipNetworkId))return cs.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${r}`,a=ie.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await Ce.get({path:`/v1/account/${r}/balance`,params:{currency:"usd",chainId:e,forceUpdate:t,st:n,sv:s}});return ie.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(r){var t;return await Ce.isNetworkSupported((t=x.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?Ce.get({path:`/v1/profile/account/${r}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:r}){var t;return await Ce.isNetworkSupported((t=x.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?Ce.get({path:`/v1/profile/reverse/${r}`,params:{sender:de.state.address,apiVersion:"2"}}):[]},async getEnsNameSuggestions(r){var t;return await Ce.isNetworkSupported((t=x.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?Ce.get({path:`/v1/profile/suggestions/${r}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:r,address:e,message:t,signature:n}){var i;return await Ce.isNetworkSupported((i=x.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)?ln.api.post({path:"/v1/profile/account",body:{coin_type:r,address:e,message:t,signature:n},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:r,partnerUserId:e,defaultNetwork:t,purchaseAmount:n,paymentAmount:s}){var a;return await Ce.isNetworkSupported((a=x.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?(await ln.api.post({path:"/v1/generators/onrampurl",params:{projectId:G.state.projectId},body:{destinationWallets:r,defaultNetwork:t,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:n,presetFiatAmount:s}})).url:""},async getOnrampOptions(){var e;if(!await Ce.isNetworkSupported((e=x.state.activeCaipNetwork)==null?void 0:e.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await Ce.get({path:"/v1/onramp/options"})}catch{return n9}},async getOnrampQuote({purchaseCurrency:r,paymentCurrency:e,amount:t,network:n}){var s;try{return await Ce.isNetworkSupported((s=x.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?await ln.api.post({path:"/v1/onramp/quote",params:{projectId:G.state.projectId},body:{purchaseCurrency:r,paymentCurrency:e,amount:t,network:n}}):null}catch{return{coinbaseFee:{amount:t,currency:e.id},networkFee:{amount:t,currency:e.id},paymentSubtotal:{amount:t,currency:e.id},paymentTotal:{amount:t,currency:e.id},purchaseAmount:{amount:t,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(r){var t;return await Ce.isNetworkSupported((t=x.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?Ce.get({path:`/v1/sessions/${r}`}):[]},async revokeSmartSession(r,e,t){var s;return await Ce.isNetworkSupported((s=x.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?ln.api.post({path:`/v1/sessions/${r}/revoke`,params:{projectId:G.state.projectId},body:{pci:e,signature:t}}):{success:!1}},setClientId(r){ln.clientId=r,ln.api=new xg({baseUrl:BI,clientId:r})}},Sn=xt({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[]}),de={state:Sn,replaceState(r){r&&Object.assign(Sn,tc(r))},subscribe(r){return x.subscribeChainProp("accountState",e=>{if(e)return r(e)})},subscribeKey(r,e,t){let n;return x.subscribeChainProp("accountState",s=>{if(s){const i=s[r];n!==i&&(n=i,e(i))}},t)},setStatus(r,e){x.setAccountProp("status",r,e)},getCaipAddress(r){return x.getAccountProp("caipAddress",r)},setCaipAddress(r,e){const t=r?ve.getPlainAddress(r):void 0;e===x.state.activeChain&&(x.state.activeCaipAddress=r),x.setAccountProp("caipAddress",r,e),x.setAccountProp("address",t,e)},setBalance(r,e,t){x.setAccountProp("balance",r,t),x.setAccountProp("balanceSymbol",e,t)},setProfileName(r,e){x.setAccountProp("profileName",r,e)},setProfileImage(r,e){x.setAccountProp("profileImage",r,e)},setUser(r,e){x.setAccountProp("user",r,e)},setAddressExplorerUrl(r,e){x.setAccountProp("addressExplorerUrl",r,e)},setSmartAccountDeployed(r,e){x.setAccountProp("smartAccountDeployed",r,e)},setCurrentTab(r){x.setAccountProp("currentTab",r,x.state.activeChain)},setTokenBalance(r,e){r&&x.setAccountProp("tokenBalance",r,e)},setShouldUpdateToAddress(r,e){x.setAccountProp("shouldUpdateToAddress",r,e)},setAllAccounts(r,e){x.setAccountProp("allAccounts",r,e)},addAddressLabel(r,e,t){const n=x.getAccountProp("addressLabels",t)||new Map;n.set(r,e),x.setAccountProp("addressLabels",n,t)},removeAddressLabel(r,e){const t=x.getAccountProp("addressLabels",e)||new Map;t.delete(r),x.setAccountProp("addressLabels",t,e)},setConnectedWalletInfo(r,e){x.setAccountProp("connectedWalletInfo",r,e,!1)},setPreferredAccountType(r,e){x.setAccountProp("preferredAccountTypes",{...Sn.preferredAccountTypes,[e]:r},e)},setPreferredAccountTypes(r){Sn.preferredAccountTypes=r},setSocialProvider(r,e){r&&x.setAccountProp("socialProvider",r,e)},setSocialWindow(r,e){x.setAccountProp("socialWindow",r?tc(r):void 0,e)},setFarcasterUrl(r,e){x.setAccountProp("farcasterUrl",r,e)},async fetchTokenBalance(r){var i,o;Sn.balanceLoading=!0;const e=(i=x.state.activeCaipNetwork)==null?void 0:i.caipNetworkId,t=(o=x.state.activeCaipNetwork)==null?void 0:o.chainNamespace,n=x.state.activeCaipAddress,s=n?ve.getPlainAddress(n):void 0;if(Sn.lastRetry&&!ve.isAllowedRetry(Sn.lastRetry,30*hr.ONE_SEC_MS))return Sn.balanceLoading=!1,[];try{if(s&&e&&t){const c=(await Ce.getBalance(s,e)).balances.filter(l=>l.quantity.decimals!=="0");return this.setTokenBalance(c,t),Sn.lastRetry=void 0,Sn.balanceLoading=!1,c}}catch(a){Sn.lastRetry=Date.now(),r==null||r(a),cs.showError("Token Balance Unavailable")}finally{Sn.balanceLoading=!1}return[]},resetAccount(r){x.resetAccount(r)}},zr=xt({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),Bt={state:zr,subscribe(r){return Nr(zr,()=>r(zr))},subscribeKey(r,e){return tn(zr,r,e)},async open(r){var s;const e=de.state.status==="connected";bt.state.wcBasic?Ee.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await Ee.prefetch({fetchConnectorImages:!e,fetchFeaturedWallets:!e,fetchRecommendedWallets:!e}),r!=null&&r.namespace?(await x.switchActiveNamespace(r.namespace),Bt.setLoading(!0,r.namespace)):Bt.setLoading(!0),Ne.setFilterByNamespace(r==null?void 0:r.namespace);const t=(s=x.getAccountData(r==null?void 0:r.namespace))==null?void 0:s.caipAddress,n=x.state.noAdapters;G.state.manualWCControl||n&&!t?ve.isMobile()?et.reset("AllWallets"):et.reset("ConnectingWalletConnectBasic"):r!=null&&r.view?et.reset(r.view,r.data):t?et.reset("Account"):et.reset("Connect"),zr.open=!0,Vs.set({open:!0}),At.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!t}})},close(r=!1){if(r||et.state.view!=="ApproveTransaction"){const e=G.state.enableEmbedded,t=!!x.state.activeCaipAddress;zr.open&&At.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:t}}),zr.open=!1,Bt.clearLoading(),e?t?et.replace("Account"):et.push("Connect"):Vs.set({open:!1})}bt.resetUri()},setLoading(r,e){e&&zr.loadingNamespaceMap.set(e,r),zr.loading=r,Vs.set({loading:r})},clearLoading(){zr.loadingNamespaceMap.clear(),zr.loading=!1},shake(){zr.shake||(zr.shake=!0,setTimeout(()=>{zr.shake=!1},500))}},XA=2147483648,s9={convertEVMChainIdToCoinType(r){if(r>=XA)throw new Error("Invalid chainId");return(XA|r)>>>0}},xn=xt({suggestions:[],loading:!1}),LI={state:xn,subscribe(r){return Nr(xn,()=>r(xn))},subscribeKey(r,e){return tn(xn,r,e)},async resolveName(r){var e,t;try{return await Ce.lookupEnsName(r)}catch(n){const s=n;throw new Error(((t=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:t.description)||"Error resolving name")}},async isNameRegistered(r){try{return await Ce.lookupEnsName(r),!0}catch{return!1}},async getSuggestions(r){try{xn.loading=!0,xn.suggestions=[];const e=await Ce.getEnsNameSuggestions(r);return xn.suggestions=e.suggestions.map(t=>({...t,name:t.name}))||[],xn.suggestions}catch(e){const t=this.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(t)}finally{xn.loading=!1}},async getNamesForAddress(r){try{if(!x.state.activeCaipNetwork)return[];const t=ie.getEnsFromCacheForAddress(r);if(t)return t;const n=await Ce.reverseLookupEnsName({address:r});return ie.updateEnsCache({address:r,ens:n,timestamp:Date.now()}),n}catch(e){const t=this.parseEnsApiError(e,"Error fetching names for address");throw new Error(t)}},async registerName(r){const e=x.state.activeCaipNetwork;if(!e)throw new Error("Network not found");const t=de.state.address,n=Ne.getAuthConnector();if(!t||!n)throw new Error("Address or auth connector not found");xn.loading=!0;try{const s=JSON.stringify({name:r,attributes:{},timestamp:Math.floor(Date.now()/1e3)});et.pushTransactionStack({view:"RegisterAccountNameSuccess",goBack:!1,replace:!0,onCancel(){xn.loading=!1}});const i=await bt.signMessage(s),o=e.id;if(!o)throw new Error("Network not found");const a=s9.convertEVMChainIdToCoinType(Number(o));await Ce.registerEnsName({coinType:a,address:t,signature:i,message:s}),de.setProfileName(r,e.chainNamespace),et.replace("RegisterAccountNameSuccess")}catch(s){const i=this.parseEnsApiError(s,`Error registering name ${r}`);throw et.replace("RegisterAccountName"),new Error(i)}finally{xn.loading=!1}},validateName(r){return/^[a-zA-Z0-9-]{4,}$/u.test(r)},parseEnsApiError(r,e){var n,s;const t=r;return((s=(n=t==null?void 0:t.reasons)==null?void 0:n[0])==null?void 0:s.description)||e}};var $I={exports:{}},MI={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vu=we;function i9(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var o9=typeof Object.is=="function"?Object.is:i9,a9=vu.useState,c9=vu.useEffect,l9=vu.useLayoutEffect,u9=vu.useDebugValue;function d9(r,e){var t=e(),n=a9({inst:{value:t,getSnapshot:e}}),s=n[0].inst,i=n[1];return l9(function(){s.value=t,s.getSnapshot=e,vy(s)&&i({inst:s})},[r,t,e]),c9(function(){return vy(s)&&i({inst:s}),r(function(){vy(s)&&i({inst:s})})},[r]),u9(t),t}function vy(r){var e=r.getSnapshot;r=r.value;try{var t=e();return!o9(r,t)}catch{return!0}}function h9(r,e){return e()}var f9=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h9:d9;MI.useSyncExternalStore=vu.useSyncExternalStore!==void 0?vu.useSyncExternalStore:f9;$I.exports=MI;var p9=$I.exports;const g9=Ig(p9),m9={},{use:e1}=aT,{useSyncExternalStore:y9}=g9,w9=(r,e)=>{const t=we.useRef();we.useEffect(()=>{t.current=IT(r,e)}),we.useDebugValue(t.current)},b9=new WeakMap;function l0(r,e){const n=we.useRef(),s=we.useRef();let i=!0;const o=y9(we.useCallback(l=>{const u=Nr(r,l);return l(),u},[r,void 0]),()=>{const l=ec(r,e1);try{if(!i&&n.current&&s.current&&!jC(n.current,l,s.current,new WeakMap))return n.current}catch{}return l},()=>ec(r,e1));i=!1;const a=new WeakMap;we.useEffect(()=>{n.current=o,s.current=a}),(m9?"production":void 0)!=="production"&&w9(o,a);const c=we.useMemo(()=>new WeakMap,[]);return FC(o,a,c,b9)}function E9(){const{activeCaipNetwork:r}=l0(x.state);return{caipNetwork:r,chainId:r==null?void 0:r.id,caipNetworkId:r==null?void 0:r.caipNetworkId}}function v9(r){var o,a;const e=l0(x.state),t=e.activeChain;if(!t)return{allAccounts:[],address:void 0,caipAddress:void 0,status:void 0,isConnected:!1,embeddedWalletInfo:void 0};const n=(o=e.chains.get(t))==null?void 0:o.accountState,s=Ne.getAuthConnector(t),i=ie.getConnectedConnectorId(t);return{allAccounts:(n==null?void 0:n.allAccounts)||[],caipAddress:n==null?void 0:n.caipAddress,address:ve.getPlainAddress(n==null?void 0:n.caipAddress),isConnected:!!(n!=null&&n.caipAddress),status:n==null?void 0:n.status,embeddedWalletInfo:s&&i===ee.CONNECTOR_ID.AUTH?{user:n!=null&&n.user?{...n.user,username:ie.getConnectedSocialUsername()}:void 0,authProvider:(n==null?void 0:n.socialProvider)||"email",accountType:(a=n==null?void 0:n.preferredAccountTypes)==null?void 0:a[t],isSmartAccountDeployed:!!(n!=null&&n.smartAccountDeployed)}:void 0}}const ft={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:"eip155",ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"},Ms={ConnectorExplorerIds:{[ee.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[ee.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[ee.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[ee.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[ee.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[ft.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[ft.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[ft.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[ft.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[ft.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[ft.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[ft.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[ft.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[ft.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[ft.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[ft.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[ee.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[ee.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[ee.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[ee.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[ee.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[ee.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[ee.CONNECTOR_ID.INJECTED]:"Browser Wallet",[ee.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[ee.CONNECTOR_ID.COINBASE]:"Coinbase",[ee.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[ee.CONNECTOR_ID.LEDGER]:"Ledger",[ee.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[ee.CONNECTOR_ID.INJECTED]:"INJECTED",[ee.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[ee.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[ee.CONNECTOR_ID.AUTH]:"AUTH"}},Kg={getCaipTokens(r){if(!r)return;const e={};return Object.entries(r).forEach(([t,n])=>{e[`${ft.EIP155}:${t}`]=n}),e},isLowerCaseMatch(r,e){return(r==null?void 0:r.toLowerCase())===(e==null?void 0:e.toLowerCase())}},A9=new AbortController,$s={EmbeddedWalletAbortController:A9,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"INVALID_APP_CONFIGURATION"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found - please make sure it is included in 'networks' array in createAppKit function"},INVALID_APP_CONFIGURATION:{shortMessage:"Invalid App Configuration",longMessage:()=>`Origin ${C9()?window.origin:"unknown"} not found on Allowlist - update configuration on cloud.reown.com`},IFRAME_LOAD_FAILED:{shortMessage:"Network Error - Could not load embedded wallet",longMessage:()=>"There was an issue loading the embedded wallet. Please try again later."},IFRAME_REQUEST_TIMEOUT:{shortMessage:"Embedded Wallet Request Timed Out",longMessage:()=>"There was an issue doing the request to the embedded wallet. Please try again later."},UNVERIFIED_DOMAIN:{shortMessage:"Invalid App Configuration",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at cloud.reown.com"},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider - please check your time settings and connect again"},INVALID_PROJECT_ID:{shortMessage:"Invalid App Configuration",longMessage:"Invalid Project ID - update configuration"},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured - update configuration on cloud.reown.com"}}};function C9(){return typeof window<"u"}const _9={createLogger(r,e="error"){const t=Bu({level:e}),{logger:n}=Ub({opts:t});return n.error=(...s)=>{for(const i of s)if(i instanceof Error){r(i,...s);return}r(void 0,...s)},n}},N9="rpc.walletconnect.org";function t1(r,e){const t=new URL("https://rpc.walletconnect.org/v1/");return t.searchParams.set("chainId",r),t.searchParams.set("projectId",e),t.toString()}const Ay=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],Xc={extendRpcUrlWithProjectId(r,e){let t=!1;try{t=new URL(r).host===N9}catch{t=!1}if(t){const n=new URL(r);return n.searchParams.has("projectId")||n.searchParams.set("projectId",e),n.toString()}return r},isCaipNetwork(r){return"chainNamespace"in r&&"caipNetworkId"in r},getChainNamespace(r){return this.isCaipNetwork(r)?r.chainNamespace:ee.CHAIN.EVM},getCaipNetworkId(r){return this.isCaipNetwork(r)?r.caipNetworkId:`${ee.CHAIN.EVM}:${r.id}`},getDefaultRpcUrl(r,e,t){var s,i,o;const n=(o=(i=(s=r.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null?void 0:o[0];return Ay.includes(e)?t1(e,t):n||""},extendCaipNetwork(r,{customNetworkImageUrls:e,projectId:t,customRpcUrls:n}){var h,f,g,p,m;const s=this.getChainNamespace(r),i=this.getCaipNetworkId(r),o=(h=r.rpcUrls.default.http)==null?void 0:h[0],a=this.getDefaultRpcUrl(r,i,t),c=((p=(g=(f=r==null?void 0:r.rpcUrls)==null?void 0:f.chainDefault)==null?void 0:g.http)==null?void 0:p[0])||o,l=((m=n==null?void 0:n[i])==null?void 0:m.map(w=>w.url))||[],u=[...l,a],d=[...l];return c&&!d.includes(c)&&d.push(c),{...r,chainNamespace:s,caipNetworkId:i,assets:{imageId:Ms.NetworkImageIds[r.id],imageUrl:e==null?void 0:e[r.id]},rpcUrls:{...r.rpcUrls,default:{http:u},chainDefault:{http:d}}}},extendCaipNetworks(r,{customNetworkImageUrls:e,projectId:t,customRpcUrls:n}){return r.map(s=>Xc.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:n,projectId:t}))},getViemTransport(r,e,t){var s,i,o;const n=[];return t==null||t.forEach(a=>{n.push(ep(a.url,a.config))}),Ay.includes(r.caipNetworkId)&&n.push(ep(t1(r.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),(o=(i=(s=r==null?void 0:r.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null||o.forEach(a=>{n.push(ep(a))}),JA(n)},extendWagmiTransports(r,e,t){if(Ay.includes(r.caipNetworkId)){const n=this.getDefaultRpcUrl(r,r.caipNetworkId,e);return JA([t,ep(n)])}return t},getUnsupportedNetwork(r){return{id:r.split(":")[1],caipNetworkId:r,name:ee.UNSUPPORTED_NETWORK_NAME,chainNamespace:r.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(r){var c;const e=ie.getActiveCaipNetworkId(),t=x.getAllRequestedCaipNetworks(),n=Array.from(((c=x.state.chains)==null?void 0:c.keys())||[]),s=e==null?void 0:e.split(":")[0],i=s?n.includes(s):!1,o=t==null?void 0:t.find(l=>l.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||r||(t==null?void 0:t[0])}},Kp={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},qr=xt({providers:{...Kp},providerIds:{...Kp}}),qe={state:qr,subscribeKey(r,e){return tn(qr,r,e)},subscribe(r){return Nr(qr,()=>{r(qr)})},subscribeProviders(r){return Nr(qr.providers,()=>r(qr.providers))},setProvider(r,e){e&&(qr.providers[r]=tc(e))},getProvider(r){return qr.providers[r]},setProviderId(r,e){e&&(qr.providerIds[r]=e)},getProviderId(r){if(r)return qr.providerIds[r]},reset(){qr.providers={...Kp},qr.providerIds={...Kp}},resetChain(r){qr.providers[r]=void 0,qr.providerIds[r]=void 0}},r1={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},ar={set(r,e){En.isClient&&localStorage.setItem(`${fe.STORAGE_KEY}${r}`,e)},get(r){return En.isClient?localStorage.getItem(`${fe.STORAGE_KEY}${r}`):null},delete(r,e){En.isClient&&(e?localStorage.removeItem(r):localStorage.removeItem(`${fe.STORAGE_KEY}${r}`))}},rp=30*1e3,En={checkIfAllowedToTriggerEmail(){const r=ar.get(fe.LAST_EMAIL_LOGIN_TIME);if(r){const e=Date.now()-Number(r);if(e<rp){const t=Math.ceil((rp-e)/1e3);throw new Error(`Please try again after ${t} seconds`)}}},getTimeToNextEmailLogin(){const r=ar.get(fe.LAST_EMAIL_LOGIN_TIME);if(r){const e=Date.now()-Number(r);if(e<rp)return Math.ceil((rp-e)/1e3)}return 0},checkIfRequestExists(r){return pr.NOT_SAFE_RPC_METHODS.includes(r.method)||pr.SAFE_RPC_METHODS.includes(r.method)},getResponseType(r){return typeof r=="string"&&((r==null?void 0:r.match(r1.transactionHash))||(r==null?void 0:r.match(r1.signedMessage)))?fe.RPC_RESPONSE_TYPE_TX:fe.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(r){return pr.SAFE_RPC_METHODS.includes(r.method)},isClient:typeof window<"u"};var Je;(function(r){r.assertEqual=s=>s;function e(s){}r.assertIs=e;function t(s){throw new Error}r.assertNever=t,r.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},r.getValidEnumValues=s=>{const i=r.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return r.objectValues(o)},r.objectValues=s=>r.objectKeys(s).map(function(i){return s[i]}),r.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},r.find=(s,i)=>{for(const o of s)if(i(o))return o},r.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}r.joinValues=n,r.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Je||(Je={}));var jw;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(jw||(jw={}));const oe=Je.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),uo=r=>{switch(typeof r){case"undefined":return oe.undefined;case"string":return oe.string;case"number":return isNaN(r)?oe.nan:oe.number;case"boolean":return oe.boolean;case"function":return oe.function;case"bigint":return oe.bigint;case"symbol":return oe.symbol;case"object":return Array.isArray(r)?oe.array:r===null?oe.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?oe.promise:typeof Map<"u"&&r instanceof Map?oe.map:typeof Set<"u"&&r instanceof Set?oe.set:typeof Date<"u"&&r instanceof Date?oe.date:oe.object;default:return oe.unknown}},Y=Je.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),I9=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class hs extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(i){return i.message},n={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)n._errors.push(t(o));else{let a=n,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(t(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return s(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,Je.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}hs.create=r=>new hs(r);const mh=(r,e)=>{let t;switch(r.code){case Y.invalid_type:r.received===oe.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case Y.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,Je.jsonStringifyReplacer)}`;break;case Y.unrecognized_keys:t=`Unrecognized key(s) in object: ${Je.joinValues(r.keys,", ")}`;break;case Y.invalid_union:t="Invalid input";break;case Y.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Je.joinValues(r.options)}`;break;case Y.invalid_enum_value:t=`Invalid enum value. Expected ${Je.joinValues(r.options)}, received '${r.received}'`;break;case Y.invalid_arguments:t="Invalid function arguments";break;case Y.invalid_return_type:t="Invalid function return type";break;case Y.invalid_date:t="Invalid date";break;case Y.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:Je.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case Y.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case Y.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case Y.custom:t="Invalid input";break;case Y.invalid_intersection_types:t="Intersection results could not be merged";break;case Y.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case Y.not_finite:t="Number must be finite";break;default:t=e.defaultError,Je.assertNever(r)}return{message:t}};let FI=mh;function S9(r){FI=r}function Jp(){return FI}const Yp=r=>{const{data:e,path:t,errorMaps:n,issueData:s}=r,i=[...t,...s.path||[]],o={...s,path:i};let a="";const c=n.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},x9=[];function le(r,e){const t=Yp({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Jp(),mh].filter(n=>!!n)});r.common.issues.push(t)}class Ir{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const s of t){if(s.status==="aborted")return Se;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const s of t)n.push({key:await s.key,value:await s.value});return Ir.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const s of t){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return Se;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(n[i.value]=o.value)}return{status:e.value,value:n}}}const Se=Object.freeze({status:"aborted"}),jI=r=>({status:"dirty",value:r}),Mr=r=>({status:"valid",value:r}),Hw=r=>r.status==="aborted",zw=r=>r.status==="dirty",yh=r=>r.status==="valid",Qp=r=>typeof Promise<"u"&&r instanceof Promise;var me;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(me||(me={}));class Js{constructor(e,t,n,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const n1=(r,e)=>{if(yh(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new hs(r.common.issues);return this._error=t,this._error}}};function Pe(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:s}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:n??a.defaultError}:{message:t??a.defaultError},description:s}}class Le{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return uo(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:uo(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ir,ctx:{common:e.parent.common,data:e.data,parsedType:uo(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Qp(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const s={common:{issues:[],async:(n=t==null?void 0:t.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:uo(e)},i=this._parseSync({data:e,path:s.path,parent:s});return n1(s,i)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:uo(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(Qp(s)?s:Promise.resolve(s));return n1(n,i)}refine(e,t){const n=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:Y.custom,...n(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof t=="function"?t(n,s):t),!1))}_refinement(e){return new ps({schema:this,typeName:Ae.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Bi.create(this,this._def)}nullable(){return cc.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return fs.create(this,this._def)}promise(){return Cu.create(this,this._def)}or(e){return vh.create([this,e],this._def)}and(e){return Ah.create(this,e,this._def)}transform(e){return new ps({...Pe(this._def),schema:this,typeName:Ae.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Sh({...Pe(this._def),innerType:this,defaultValue:t,typeName:Ae.ZodDefault})}brand(){return new zI({typeName:Ae.ZodBranded,type:this,...Pe(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new tg({...Pe(this._def),innerType:this,catchValue:t,typeName:Ae.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return mf.create(this,e)}readonly(){return ng.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const T9=/^c[^\s-]{8,}$/i,P9=/^[a-z][a-z0-9]*$/,O9=/^[0-9A-HJKMNP-TV-Z]{26}$/,R9=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,D9=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,k9="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Cy;const U9=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,B9=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,L9=r=>r.precision?r.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}Z$`):r.precision===0?r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function $9(r,e){return!!((e==="v4"||!e)&&U9.test(r)||(e==="v6"||!e)&&B9.test(r))}class ds extends Le{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==oe.string){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_type,expected:oe.string,received:i.parsedType}),Se}const n=new Ir;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),le(s,{code:Y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),le(s,{code:Y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?le(s,{code:Y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&le(s,{code:Y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")D9.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"email",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")Cy||(Cy=new RegExp(k9,"u")),Cy.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"emoji",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")R9.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"uuid",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")T9.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"cuid",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")P9.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"cuid2",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")O9.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"ulid",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),le(s,{validation:"url",code:Y.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"regex",code:Y.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),le(s,{code:Y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),le(s,{code:Y.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),le(s,{code:Y.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?L9(i).test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{code:Y.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="ip"?$9(e.data,i.version)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"ip",code:Y.invalid_string,message:i.message}),n.dirty()):Je.assertNever(i);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(s=>e.test(s),{validation:t,code:Y.invalid_string,...me.errToObj(n)})}_addCheck(e){return new ds({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...me.errToObj(e)})}url(e){return this._addCheck({kind:"url",...me.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...me.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...me.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...me.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...me.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...me.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...me.errToObj(e)})}datetime(e){var t;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,...me.errToObj(e==null?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...me.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...me.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...me.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...me.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...me.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...me.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...me.errToObj(t)})}nonempty(e){return this.min(1,me.errToObj(e))}trim(){return new ds({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ds({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ds({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ds.create=r=>{var e;return new ds({checks:[],typeName:Ae.ZodString,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...Pe(r)})};function M9(r,e){const t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=t>n?t:n,i=parseInt(r.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class $o extends Le{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==oe.number){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_type,expected:oe.number,received:i.parsedType}),Se}let n;const s=new Ir;for(const i of this._def.checks)i.kind==="int"?Je.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),le(n,{code:Y.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),le(n,{code:Y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),le(n,{code:Y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?M9(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),le(n,{code:Y.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),le(n,{code:Y.not_finite,message:i.message}),s.dirty()):Je.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,me.toString(t))}gt(e,t){return this.setLimit("min",e,!1,me.toString(t))}lte(e,t){return this.setLimit("max",e,!0,me.toString(t))}lt(e,t){return this.setLimit("max",e,!1,me.toString(t))}setLimit(e,t,n,s){return new $o({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:me.toString(s)}]})}_addCheck(e){return new $o({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:me.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:me.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:me.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:me.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:me.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:me.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:me.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:me.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:me.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Je.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}$o.create=r=>new $o({checks:[],typeName:Ae.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...Pe(r)});class Mo extends Le{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==oe.bigint){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_type,expected:oe.bigint,received:i.parsedType}),Se}let n;const s=new Ir;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),le(n,{code:Y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),le(n,{code:Y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),le(n,{code:Y.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Je.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,me.toString(t))}gt(e,t){return this.setLimit("min",e,!1,me.toString(t))}lte(e,t){return this.setLimit("max",e,!0,me.toString(t))}lt(e,t){return this.setLimit("max",e,!1,me.toString(t))}setLimit(e,t,n,s){return new Mo({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:me.toString(s)}]})}_addCheck(e){return new Mo({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:me.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:me.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:me.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:me.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:me.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Mo.create=r=>{var e;return new Mo({checks:[],typeName:Ae.ZodBigInt,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...Pe(r)})};class wh extends Le{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==oe.boolean){const n=this._getOrReturnCtx(e);return le(n,{code:Y.invalid_type,expected:oe.boolean,received:n.parsedType}),Se}return Mr(e.data)}}wh.create=r=>new wh({typeName:Ae.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...Pe(r)});class oc extends Le{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==oe.date){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_type,expected:oe.date,received:i.parsedType}),Se}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_date}),Se}const n=new Ir;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),le(s,{code:Y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),le(s,{code:Y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):Je.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new oc({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:me.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:me.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}oc.create=r=>new oc({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:Ae.ZodDate,...Pe(r)});class Zp extends Le{_parse(e){if(this._getType(e)!==oe.symbol){const n=this._getOrReturnCtx(e);return le(n,{code:Y.invalid_type,expected:oe.symbol,received:n.parsedType}),Se}return Mr(e.data)}}Zp.create=r=>new Zp({typeName:Ae.ZodSymbol,...Pe(r)});class bh extends Le{_parse(e){if(this._getType(e)!==oe.undefined){const n=this._getOrReturnCtx(e);return le(n,{code:Y.invalid_type,expected:oe.undefined,received:n.parsedType}),Se}return Mr(e.data)}}bh.create=r=>new bh({typeName:Ae.ZodUndefined,...Pe(r)});class Eh extends Le{_parse(e){if(this._getType(e)!==oe.null){const n=this._getOrReturnCtx(e);return le(n,{code:Y.invalid_type,expected:oe.null,received:n.parsedType}),Se}return Mr(e.data)}}Eh.create=r=>new Eh({typeName:Ae.ZodNull,...Pe(r)});class Au extends Le{constructor(){super(...arguments),this._any=!0}_parse(e){return Mr(e.data)}}Au.create=r=>new Au({typeName:Ae.ZodAny,...Pe(r)});class Ga extends Le{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Mr(e.data)}}Ga.create=r=>new Ga({typeName:Ae.ZodUnknown,...Pe(r)});class Mi extends Le{_parse(e){const t=this._getOrReturnCtx(e);return le(t,{code:Y.invalid_type,expected:oe.never,received:t.parsedType}),Se}}Mi.create=r=>new Mi({typeName:Ae.ZodNever,...Pe(r)});class Xp extends Le{_parse(e){if(this._getType(e)!==oe.undefined){const n=this._getOrReturnCtx(e);return le(n,{code:Y.invalid_type,expected:oe.void,received:n.parsedType}),Se}return Mr(e.data)}}Xp.create=r=>new Xp({typeName:Ae.ZodVoid,...Pe(r)});class fs extends Le{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),s=this._def;if(t.parsedType!==oe.array)return le(t,{code:Y.invalid_type,expected:oe.array,received:t.parsedType}),Se;if(s.exactLength!==null){const o=t.data.length>s.exactLength.value,a=t.data.length<s.exactLength.value;(o||a)&&(le(t,{code:o?Y.too_big:Y.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(le(t,{code:Y.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(le(t,{code:Y.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>s.type._parseAsync(new Js(t,o,t.path,a)))).then(o=>Ir.mergeArray(n,o));const i=[...t.data].map((o,a)=>s.type._parseSync(new Js(t,o,t.path,a)));return Ir.mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new fs({...this._def,minLength:{value:e,message:me.toString(t)}})}max(e,t){return new fs({...this._def,maxLength:{value:e,message:me.toString(t)}})}length(e,t){return new fs({...this._def,exactLength:{value:e,message:me.toString(t)}})}nonempty(e){return this.min(1,e)}}fs.create=(r,e)=>new fs({type:r,minLength:null,maxLength:null,exactLength:null,typeName:Ae.ZodArray,...Pe(e)});function el(r){if(r instanceof It){const e={};for(const t in r.shape){const n=r.shape[t];e[t]=Bi.create(el(n))}return new It({...r._def,shape:()=>e})}else return r instanceof fs?new fs({...r._def,type:el(r.element)}):r instanceof Bi?Bi.create(el(r.unwrap())):r instanceof cc?cc.create(el(r.unwrap())):r instanceof Ys?Ys.create(r.items.map(e=>el(e))):r}class It extends Le{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=Je.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==oe.object){const l=this._getOrReturnCtx(e);return le(l,{code:Y.invalid_type,expected:oe.object,received:l.parsedType}),Se}const{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Mi&&this._def.unknownKeys==="strip"))for(const l in s.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const u=i[l],d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Js(s,d,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof Mi){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(l==="strict")a.length>0&&(le(s,{code:Y.unrecognized_keys,keys:a}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of a){const d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Js(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const d=await u.key;l.push({key:d,value:await u.value,alwaysSet:u.alwaysSet})}return l}).then(l=>Ir.mergeObjectSync(n,l)):Ir.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return me.errToObj,new It({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,t,n).message)!==null&&o!==void 0?o:n.defaultError;return t.code==="unrecognized_keys"?{message:(a=me.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new It({...this._def,unknownKeys:"strip"})}passthrough(){return new It({...this._def,unknownKeys:"passthrough"})}extend(e){return new It({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new It({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Ae.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new It({...this._def,catchall:e})}pick(e){const t={};return Je.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new It({...this._def,shape:()=>t})}omit(e){const t={};return Je.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new It({...this._def,shape:()=>t})}deepPartial(){return el(this)}partial(e){const t={};return Je.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];e&&!e[n]?t[n]=s:t[n]=s.optional()}),new It({...this._def,shape:()=>t})}required(e){const t={};return Je.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Bi;)i=i._def.innerType;t[n]=i}}),new It({...this._def,shape:()=>t})}keyof(){return HI(Je.objectKeys(this.shape))}}It.create=(r,e)=>new It({shape:()=>r,unknownKeys:"strip",catchall:Mi.create(),typeName:Ae.ZodObject,...Pe(e)});It.strictCreate=(r,e)=>new It({shape:()=>r,unknownKeys:"strict",catchall:Mi.create(),typeName:Ae.ZodObject,...Pe(e)});It.lazycreate=(r,e)=>new It({shape:r,unknownKeys:"strip",catchall:Mi.create(),typeName:Ae.ZodObject,...Pe(e)});class vh extends Le{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new hs(a.ctx.common.issues));return le(t,{code:Y.invalid_union,unionErrors:o}),Se}if(t.common.async)return Promise.all(n.map(async i=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of n){const l={...t,common:{...t.common,issues:[]},parent:null},u=c._parseSync({data:t.data,path:t.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new hs(c));return le(t,{code:Y.invalid_union,unionErrors:a}),Se}}get options(){return this._def.options}}vh.create=(r,e)=>new vh({options:r,typeName:Ae.ZodUnion,...Pe(e)});const Ap=r=>r instanceof _h?Ap(r.schema):r instanceof ps?Ap(r.innerType()):r instanceof Nh?[r.value]:r instanceof Fo?r.options:r instanceof Ih?Object.keys(r.enum):r instanceof Sh?Ap(r._def.innerType):r instanceof bh?[void 0]:r instanceof Eh?[null]:null;class Jg extends Le{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==oe.object)return le(t,{code:Y.invalid_type,expected:oe.object,received:t.parsedType}),Se;const n=this.discriminator,s=t.data[n],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(le(t,{code:Y.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Se)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const s=new Map;for(const i of t){const o=Ap(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new Jg({typeName:Ae.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...Pe(n)})}}function qw(r,e){const t=uo(r),n=uo(e);if(r===e)return{valid:!0,data:r};if(t===oe.object&&n===oe.object){const s=Je.objectKeys(e),i=Je.objectKeys(r).filter(a=>s.indexOf(a)!==-1),o={...r,...e};for(const a of i){const c=qw(r[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(t===oe.array&&n===oe.array){if(r.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<r.length;i++){const o=r[i],a=e[i],c=qw(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return t===oe.date&&n===oe.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class Ah extends Le{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=(i,o)=>{if(Hw(i)||Hw(o))return Se;const a=qw(i.value,o.value);return a.valid?((zw(i)||zw(o))&&t.dirty(),{status:t.value,value:a.data}):(le(n,{code:Y.invalid_intersection_types}),Se)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Ah.create=(r,e,t)=>new Ah({left:r,right:e,typeName:Ae.ZodIntersection,...Pe(t)});class Ys extends Le{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==oe.array)return le(n,{code:Y.invalid_type,expected:oe.array,received:n.parsedType}),Se;if(n.data.length<this._def.items.length)return le(n,{code:Y.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Se;!this._def.rest&&n.data.length>this._def.items.length&&(le(n,{code:Y.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...n.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new Js(n,o,n.path,a)):null}).filter(o=>!!o);return n.common.async?Promise.all(i).then(o=>Ir.mergeArray(t,o)):Ir.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new Ys({...this._def,rest:e})}}Ys.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ys({items:r,typeName:Ae.ZodTuple,rest:null,...Pe(e)})};class Ch extends Le{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==oe.object)return le(n,{code:Y.invalid_type,expected:oe.object,received:n.parsedType}),Se;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in n.data)s.push({key:i._parse(new Js(n,a,n.path,a)),value:o._parse(new Js(n,n.data[a],n.path,a))});return n.common.async?Ir.mergeObjectAsync(t,s):Ir.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof Le?new Ch({keyType:e,valueType:t,typeName:Ae.ZodRecord,...Pe(n)}):new Ch({keyType:ds.create(),valueType:e,typeName:Ae.ZodRecord,...Pe(t)})}}class eg extends Le{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==oe.map)return le(n,{code:Y.invalid_type,expected:oe.map,received:n.parsedType}),Se;const s=this._def.keyType,i=this._def.valueType,o=[...n.data.entries()].map(([a,c],l)=>({key:s._parse(new Js(n,a,n.path,[l,"key"])),value:i._parse(new Js(n,c,n.path,[l,"value"]))}));if(n.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return Se;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(l.value,u.value)}return{status:t.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return Se;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(l.value,u.value)}return{status:t.value,value:a}}}}eg.create=(r,e,t)=>new eg({valueType:e,keyType:r,typeName:Ae.ZodMap,...Pe(t)});class ac extends Le{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==oe.set)return le(n,{code:Y.invalid_type,expected:oe.set,received:n.parsedType}),Se;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(le(n,{code:Y.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(le(n,{code:Y.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const i=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return Se;u.status==="dirty"&&t.dirty(),l.add(u.value)}return{status:t.value,value:l}}const a=[...n.data.values()].map((c,l)=>i._parse(new Js(n,c,n.path,l)));return n.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,t){return new ac({...this._def,minSize:{value:e,message:me.toString(t)}})}max(e,t){return new ac({...this._def,maxSize:{value:e,message:me.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ac.create=(r,e)=>new ac({valueType:r,minSize:null,maxSize:null,typeName:Ae.ZodSet,...Pe(e)});class pl extends Le{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==oe.function)return le(t,{code:Y.invalid_type,expected:oe.function,received:t.parsedType}),Se;function n(a,c){return Yp({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Jp(),mh].filter(l=>!!l),issueData:{code:Y.invalid_arguments,argumentsError:c}})}function s(a,c){return Yp({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Jp(),mh].filter(l=>!!l),issueData:{code:Y.invalid_return_type,returnTypeError:c}})}const i={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Cu){const a=this;return Mr(async function(...c){const l=new hs([]),u=await a._def.args.parseAsync(c,i).catch(f=>{throw l.addIssue(n(c,f)),l}),d=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(d,i).catch(f=>{throw l.addIssue(s(d,f)),l})})}else{const a=this;return Mr(function(...c){const l=a._def.args.safeParse(c,i);if(!l.success)throw new hs([n(c,l.error)]);const u=Reflect.apply(o,this,l.data),d=a._def.returns.safeParse(u,i);if(!d.success)throw new hs([s(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new pl({...this._def,args:Ys.create(e).rest(Ga.create())})}returns(e){return new pl({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new pl({args:e||Ys.create([]).rest(Ga.create()),returns:t||Ga.create(),typeName:Ae.ZodFunction,...Pe(n)})}}class _h extends Le{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}_h.create=(r,e)=>new _h({getter:r,typeName:Ae.ZodLazy,...Pe(e)});class Nh extends Le{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return le(t,{received:t.data,code:Y.invalid_literal,expected:this._def.value}),Se}return{status:"valid",value:e.data}}get value(){return this._def.value}}Nh.create=(r,e)=>new Nh({value:r,typeName:Ae.ZodLiteral,...Pe(e)});function HI(r,e){return new Fo({values:r,typeName:Ae.ZodEnum,...Pe(e)})}class Fo extends Le{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return le(t,{expected:Je.joinValues(n),received:t.parsedType,code:Y.invalid_type}),Se}if(this._def.values.indexOf(e.data)===-1){const t=this._getOrReturnCtx(e),n=this._def.values;return le(t,{received:t.data,code:Y.invalid_enum_value,options:n}),Se}return Mr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return Fo.create(e)}exclude(e){return Fo.create(this.options.filter(t=>!e.includes(t)))}}Fo.create=HI;class Ih extends Le{_parse(e){const t=Je.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==oe.string&&n.parsedType!==oe.number){const s=Je.objectValues(t);return le(n,{expected:Je.joinValues(s),received:n.parsedType,code:Y.invalid_type}),Se}if(t.indexOf(e.data)===-1){const s=Je.objectValues(t);return le(n,{received:n.data,code:Y.invalid_enum_value,options:s}),Se}return Mr(e.data)}get enum(){return this._def.values}}Ih.create=(r,e)=>new Ih({values:r,typeName:Ae.ZodNativeEnum,...Pe(e)});class Cu extends Le{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==oe.promise&&t.common.async===!1)return le(t,{code:Y.invalid_type,expected:oe.promise,received:t.parsedType}),Se;const n=t.parsedType===oe.promise?t.data:Promise.resolve(t.data);return Mr(n.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Cu.create=(r,e)=>new Cu({type:r,typeName:Ae.ZodPromise,...Pe(e)});class ps extends Le{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ae.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{le(n,o),o.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(n.data,i);return n.common.issues.length?{status:"dirty",value:n.data}:n.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:n.path,parent:n})):this._def.schema._parseSync({data:o,path:n.path,parent:n})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?Se:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?Se:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(s.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!yh(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>yh(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:t.value,value:a})):o);Je.assertNever(s)}}ps.create=(r,e,t)=>new ps({schema:r,typeName:Ae.ZodEffects,effect:e,...Pe(t)});ps.createWithPreprocess=(r,e,t)=>new ps({schema:e,effect:{type:"preprocess",transform:r},typeName:Ae.ZodEffects,...Pe(t)});class Bi extends Le{_parse(e){return this._getType(e)===oe.undefined?Mr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Bi.create=(r,e)=>new Bi({innerType:r,typeName:Ae.ZodOptional,...Pe(e)});class cc extends Le{_parse(e){return this._getType(e)===oe.null?Mr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}cc.create=(r,e)=>new cc({innerType:r,typeName:Ae.ZodNullable,...Pe(e)});class Sh extends Le{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===oe.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Sh.create=(r,e)=>new Sh({innerType:r,typeName:Ae.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Pe(e)});class tg extends Le{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Qp(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new hs(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new hs(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}tg.create=(r,e)=>new tg({innerType:r,typeName:Ae.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Pe(e)});class rg extends Le{_parse(e){if(this._getType(e)!==oe.nan){const n=this._getOrReturnCtx(e);return le(n,{code:Y.invalid_type,expected:oe.nan,received:n.parsedType}),Se}return{status:"valid",value:e.data}}}rg.create=r=>new rg({typeName:Ae.ZodNaN,...Pe(r)});const F9=Symbol("zod_brand");class zI extends Le{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class mf extends Le{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Se:i.status==="dirty"?(t.dirty(),jI(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Se:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,t){return new mf({in:e,out:t,typeName:Ae.ZodPipeline})}}class ng extends Le{_parse(e){const t=this._def.innerType._parse(e);return yh(t)&&(t.value=Object.freeze(t.value)),t}}ng.create=(r,e)=>new ng({innerType:r,typeName:Ae.ZodReadonly,...Pe(e)});const qI=(r,e={},t)=>r?Au.create().superRefine((n,s)=>{var i,o;if(!r(n)){const a=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:t)!==null&&o!==void 0?o:!0,l=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...l,fatal:c})}}):Au.create(),j9={object:It.lazycreate};var Ae;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(Ae||(Ae={}));const H9=(r,e={message:`Input not instance of ${r.name}`})=>qI(t=>t instanceof r,e),VI=ds.create,WI=$o.create,z9=rg.create,q9=Mo.create,GI=wh.create,V9=oc.create,W9=Zp.create,G9=bh.create,K9=Eh.create,J9=Au.create,Y9=Ga.create,Q9=Mi.create,Z9=Xp.create,X9=fs.create,e7=It.create,t7=It.strictCreate,r7=vh.create,n7=Jg.create,s7=Ah.create,i7=Ys.create,o7=Ch.create,a7=eg.create,c7=ac.create,l7=pl.create,u7=_h.create,d7=Nh.create,h7=Fo.create,f7=Ih.create,p7=Cu.create,s1=ps.create,g7=Bi.create,m7=cc.create,y7=ps.createWithPreprocess,w7=mf.create,b7=()=>VI().optional(),E7=()=>WI().optional(),v7=()=>GI().optional(),A7={string:r=>ds.create({...r,coerce:!0}),number:r=>$o.create({...r,coerce:!0}),boolean:r=>wh.create({...r,coerce:!0}),bigint:r=>Mo.create({...r,coerce:!0}),date:r=>oc.create({...r,coerce:!0})},C7=Se;var C=Object.freeze({__proto__:null,defaultErrorMap:mh,setErrorMap:S9,getErrorMap:Jp,makeIssue:Yp,EMPTY_PATH:x9,addIssueToContext:le,ParseStatus:Ir,INVALID:Se,DIRTY:jI,OK:Mr,isAborted:Hw,isDirty:zw,isValid:yh,isAsync:Qp,get util(){return Je},get objectUtil(){return jw},ZodParsedType:oe,getParsedType:uo,ZodType:Le,ZodString:ds,ZodNumber:$o,ZodBigInt:Mo,ZodBoolean:wh,ZodDate:oc,ZodSymbol:Zp,ZodUndefined:bh,ZodNull:Eh,ZodAny:Au,ZodUnknown:Ga,ZodNever:Mi,ZodVoid:Xp,ZodArray:fs,ZodObject:It,ZodUnion:vh,ZodDiscriminatedUnion:Jg,ZodIntersection:Ah,ZodTuple:Ys,ZodRecord:Ch,ZodMap:eg,ZodSet:ac,ZodFunction:pl,ZodLazy:_h,ZodLiteral:Nh,ZodEnum:Fo,ZodNativeEnum:Ih,ZodPromise:Cu,ZodEffects:ps,ZodTransformer:ps,ZodOptional:Bi,ZodNullable:cc,ZodDefault:Sh,ZodCatch:tg,ZodNaN:rg,BRAND:F9,ZodBranded:zI,ZodPipeline:mf,ZodReadonly:ng,custom:qI,Schema:Le,ZodSchema:Le,late:j9,get ZodFirstPartyTypeKind(){return Ae},coerce:A7,any:J9,array:X9,bigint:q9,boolean:GI,date:V9,discriminatedUnion:n7,effect:s1,enum:h7,function:l7,instanceof:H9,intersection:s7,lazy:u7,literal:d7,map:a7,nan:z9,nativeEnum:f7,never:Q9,null:K9,nullable:m7,number:WI,object:e7,oboolean:v7,onumber:E7,optional:g7,ostring:b7,pipeline:w7,preprocess:y7,promise:p7,record:o7,set:c7,strictObject:t7,string:VI,symbol:W9,transformer:s1,tuple:i7,undefined:G9,union:r7,unknown:Y9,void:Z9,NEVER:C7,ZodIssueCode:Y,quotelessJson:I9,ZodError:hs});const Pt=C.object({message:C.string()});function ae(r){return C.literal(fe[r])}C.object({accessList:C.array(C.string()),blockHash:C.string().nullable(),blockNumber:C.string().nullable(),chainId:C.string().or(C.number()),from:C.string(),gas:C.string(),hash:C.string(),input:C.string().nullable(),maxFeePerGas:C.string(),maxPriorityFeePerGas:C.string(),nonce:C.string(),r:C.string(),s:C.string(),to:C.string(),transactionIndex:C.string().nullable(),type:C.string(),v:C.string(),value:C.string()});const _7=C.object({chainId:C.string().or(C.number())}),N7=C.object({email:C.string().email()}),I7=C.object({otp:C.string()}),S7=C.object({uri:C.string()}),x7=C.object({chainId:C.optional(C.string().or(C.number())),preferredAccountType:C.optional(C.string())}),T7=C.object({provider:C.enum(["google","github","apple","facebook","x","discord"])}),P7=C.object({email:C.string().email()}),O7=C.object({otp:C.string()}),R7=C.object({otp:C.string()}),D7=C.object({themeMode:C.optional(C.enum(["light","dark"])),themeVariables:C.optional(C.record(C.string(),C.string().or(C.number()))),w3mThemeVariables:C.optional(C.record(C.string(),C.string()))}),k7=C.object({metadata:C.object({name:C.string(),description:C.string(),url:C.string(),icons:C.array(C.string())}).optional(),sdkVersion:C.string().optional(),sdkType:C.string().optional(),projectId:C.string()}),U7=C.object({type:C.string()}),B7=C.object({action:C.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),L7=C.object({url:C.string()}),$7=C.object({userName:C.string()}),M7=C.object({email:C.string().optional().nullable(),address:C.string(),chainId:C.string().or(C.number()),accounts:C.array(C.object({address:C.string(),type:C.enum([pr.ACCOUNT_TYPES.EOA,pr.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:C.string().optional().nullable()}),F7=C.object({action:C.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),j7=C.object({email:C.string().email().optional().nullable(),address:C.string(),chainId:C.string().or(C.number()),smartAccountDeployed:C.optional(C.boolean()),accounts:C.array(C.object({address:C.string(),type:C.enum([pr.ACCOUNT_TYPES.EOA,pr.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:C.optional(C.string())}),H7=C.object({uri:C.string()}),z7=C.object({isConnected:C.boolean()}),q7=C.object({chainId:C.string().or(C.number())}),V7=C.object({chainId:C.string().or(C.number())}),W7=C.object({newEmail:C.string().email()}),G7=C.object({smartAccountEnabledNetworks:C.array(C.number())});C.object({address:C.string(),isDeployed:C.boolean()});const K7=C.object({version:C.string().optional()}),J7=C.object({type:C.string(),address:C.string()}),Y7=C.any(),Q7=C.object({method:C.literal("eth_accounts")}),Z7=C.object({method:C.literal("eth_blockNumber")}),X7=C.object({method:C.literal("eth_call"),params:C.array(C.any())}),eH=C.object({method:C.literal("eth_chainId")}),tH=C.object({method:C.literal("eth_estimateGas"),params:C.array(C.any())}),rH=C.object({method:C.literal("eth_feeHistory"),params:C.array(C.any())}),nH=C.object({method:C.literal("eth_gasPrice")}),sH=C.object({method:C.literal("eth_getAccount"),params:C.array(C.any())}),iH=C.object({method:C.literal("eth_getBalance"),params:C.array(C.any())}),oH=C.object({method:C.literal("eth_getBlockByHash"),params:C.array(C.any())}),aH=C.object({method:C.literal("eth_getBlockByNumber"),params:C.array(C.any())}),cH=C.object({method:C.literal("eth_getBlockReceipts"),params:C.array(C.any())}),lH=C.object({method:C.literal("eth_getBlockTransactionCountByHash"),params:C.array(C.any())}),uH=C.object({method:C.literal("eth_getBlockTransactionCountByNumber"),params:C.array(C.any())}),dH=C.object({method:C.literal("eth_getCode"),params:C.array(C.any())}),hH=C.object({method:C.literal("eth_getFilterChanges"),params:C.array(C.any())}),fH=C.object({method:C.literal("eth_getFilterLogs"),params:C.array(C.any())}),pH=C.object({method:C.literal("eth_getLogs"),params:C.array(C.any())}),gH=C.object({method:C.literal("eth_getProof"),params:C.array(C.any())}),mH=C.object({method:C.literal("eth_getStorageAt"),params:C.array(C.any())}),yH=C.object({method:C.literal("eth_getTransactionByBlockHashAndIndex"),params:C.array(C.any())}),wH=C.object({method:C.literal("eth_getTransactionByBlockNumberAndIndex"),params:C.array(C.any())}),bH=C.object({method:C.literal("eth_getTransactionByHash"),params:C.array(C.any())}),EH=C.object({method:C.literal("eth_getTransactionCount"),params:C.array(C.any())}),vH=C.object({method:C.literal("eth_getTransactionReceipt"),params:C.array(C.any())}),AH=C.object({method:C.literal("eth_getUncleCountByBlockHash"),params:C.array(C.any())}),CH=C.object({method:C.literal("eth_getUncleCountByBlockNumber"),params:C.array(C.any())}),_H=C.object({method:C.literal("eth_maxPriorityFeePerGas")}),NH=C.object({method:C.literal("eth_newBlockFilter")}),IH=C.object({method:C.literal("eth_newFilter"),params:C.array(C.any())}),SH=C.object({method:C.literal("eth_newPendingTransactionFilter")}),xH=C.object({method:C.literal("eth_sendRawTransaction"),params:C.array(C.any())}),TH=C.object({method:C.literal("eth_syncing"),params:C.array(C.any())}),PH=C.object({method:C.literal("eth_uninstallFilter"),params:C.array(C.any())}),i1=C.object({method:C.literal("personal_sign"),params:C.array(C.any())}),OH=C.object({method:C.literal("eth_signTypedData_v4"),params:C.array(C.any())}),RH=C.object({method:C.literal("eth_sendTransaction"),params:C.array(C.any())}),DH=C.object({method:C.literal("solana_signMessage"),params:C.object({message:C.string(),pubkey:C.string()})}),kH=C.object({method:C.literal("solana_signTransaction"),params:C.object({transaction:C.string()})}),UH=C.object({method:C.literal("solana_signAllTransactions"),params:C.object({transactions:C.array(C.string())})}),BH=C.object({method:C.literal("solana_signAndSendTransaction"),params:C.object({transaction:C.string(),options:C.object({skipPreflight:C.boolean().optional(),preflightCommitment:C.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:C.number().optional(),minContextSlot:C.number().optional()}).optional()})}),LH=C.object({method:C.literal("wallet_sendCalls"),params:C.array(C.object({chainId:C.string().or(C.number()).optional(),from:C.string().optional(),version:C.string().optional(),capabilities:C.any().optional(),calls:C.array(C.object({to:C.string().startsWith("0x"),data:C.string().startsWith("0x").optional(),value:C.string().optional()}))}))}),$H=C.object({method:C.literal("wallet_getCallsStatus"),params:C.array(C.string())}),MH=C.object({method:C.literal("wallet_getCapabilities")}),FH=C.object({method:C.literal("wallet_grantPermissions"),params:C.array(C.any())}),jH=C.object({method:C.literal("wallet_revokePermissions"),params:C.any()}),HH=C.object({method:C.literal("wallet_getAssets"),params:C.any()}),o1=C.object({token:C.string()}),ce=C.object({id:C.string().optional()}),ud={appEvent:ce.extend({type:ae("APP_SWITCH_NETWORK"),payload:_7}).or(ce.extend({type:ae("APP_CONNECT_EMAIL"),payload:N7})).or(ce.extend({type:ae("APP_CONNECT_DEVICE")})).or(ce.extend({type:ae("APP_CONNECT_OTP"),payload:I7})).or(ce.extend({type:ae("APP_CONNECT_SOCIAL"),payload:S7})).or(ce.extend({type:ae("APP_GET_FARCASTER_URI")})).or(ce.extend({type:ae("APP_CONNECT_FARCASTER")})).or(ce.extend({type:ae("APP_GET_USER"),payload:C.optional(x7)})).or(ce.extend({type:ae("APP_GET_SOCIAL_REDIRECT_URI"),payload:T7})).or(ce.extend({type:ae("APP_SIGN_OUT")})).or(ce.extend({type:ae("APP_IS_CONNECTED"),payload:C.optional(o1)})).or(ce.extend({type:ae("APP_GET_CHAIN_ID")})).or(ce.extend({type:ae("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(ce.extend({type:ae("APP_INIT_SMART_ACCOUNT")})).or(ce.extend({type:ae("APP_SET_PREFERRED_ACCOUNT"),payload:U7})).or(ce.extend({type:ae("APP_RPC_REQUEST"),payload:i1.or(HH).or(Q7).or(Z7).or(X7).or(eH).or(tH).or(rH).or(nH).or(sH).or(iH).or(oH).or(aH).or(cH).or(lH).or(uH).or(dH).or(hH).or(fH).or(pH).or(gH).or(mH).or(yH).or(wH).or(bH).or(EH).or(vH).or(AH).or(CH).or(_H).or(NH).or(IH).or(SH).or(xH).or(TH).or(PH).or(i1).or(OH).or(RH).or(DH).or(kH).or(UH).or(BH).or($H).or(LH).or(MH).or(FH).or(jH)})).or(ce.extend({type:ae("APP_UPDATE_EMAIL"),payload:P7})).or(ce.extend({type:ae("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:O7})).or(ce.extend({type:ae("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:R7})).or(ce.extend({type:ae("APP_SYNC_THEME"),payload:D7})).or(ce.extend({type:ae("APP_SYNC_DAPP_DATA"),payload:k7})).or(ce.extend({type:ae("APP_RELOAD")})),frameEvent:ce.extend({type:ae("FRAME_SWITCH_NETWORK_ERROR"),payload:Pt}).or(ce.extend({type:ae("FRAME_SWITCH_NETWORK_SUCCESS"),payload:V7})).or(ce.extend({type:ae("FRAME_CONNECT_EMAIL_SUCCESS"),payload:B7})).or(ce.extend({type:ae("FRAME_CONNECT_EMAIL_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:L7})).or(ce.extend({type:ae("FRAME_GET_FARCASTER_URI_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:$7})).or(ce.extend({type:ae("FRAME_CONNECT_FARCASTER_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_CONNECT_OTP_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_CONNECT_OTP_SUCCESS")})).or(ce.extend({type:ae("FRAME_CONNECT_DEVICE_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_CONNECT_DEVICE_SUCCESS")})).or(ce.extend({type:ae("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:M7})).or(ce.extend({type:ae("FRAME_CONNECT_SOCIAL_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_GET_USER_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_GET_USER_SUCCESS"),payload:j7})).or(ce.extend({type:ae("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:H7})).or(ce.extend({type:ae("FRAME_SIGN_OUT_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_SIGN_OUT_SUCCESS")})).or(ce.extend({type:ae("FRAME_IS_CONNECTED_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_IS_CONNECTED_SUCCESS"),payload:z7})).or(ce.extend({type:ae("FRAME_GET_CHAIN_ID_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_GET_CHAIN_ID_SUCCESS"),payload:q7})).or(ce.extend({type:ae("FRAME_RPC_REQUEST_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_RPC_REQUEST_SUCCESS"),payload:Y7})).or(ce.extend({type:ae("FRAME_SESSION_UPDATE"),payload:o1})).or(ce.extend({type:ae("FRAME_UPDATE_EMAIL_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_UPDATE_EMAIL_SUCCESS"),payload:F7})).or(ce.extend({type:ae("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(ce.extend({type:ae("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:W7})).or(ce.extend({type:ae("FRAME_SYNC_THEME_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_SYNC_THEME_SUCCESS")})).or(ce.extend({type:ae("FRAME_SYNC_DAPP_DATA_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(ce.extend({type:ae("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:G7})).or(ce.extend({type:ae("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:J7})).or(ce.extend({type:ae("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_READY"),payload:K7})).or(ce.extend({type:ae("FRAME_RELOAD_ERROR"),payload:Pt})).or(ce.extend({type:ae("FRAME_RELOAD_SUCCESS")}))};function _y(r,e={}){var t;return typeof(e==null?void 0:e.type)=="string"&&((t=e==null?void 0:e.type)==null?void 0:t.includes(r))}class zH{constructor({projectId:e,isAppClient:t=!1,chainId:n="eip155:1",enableLogger:s=!0}){if(this.iframe=null,this.iframeIsReady=!1,this.rpcUrl=ee.BLOCKCHAIN_API_RPC_URL,this.initFrame=()=>{const i=document.getElementById("w3m-iframe");this.iframe&&!i&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(i,o,a)=>{function c({data:l}){if(!_y(fe.FRAME_EVENT_KEY,l))return;const u=ud.frameEvent.parse(l);u.id===i&&(o(u),window.removeEventListener("message",c))}En.isClient&&(window.addEventListener("message",c),a.addEventListener("abort",()=>{window.removeEventListener("message",c)}))},onFrameEvent:i=>{En.isClient&&window.addEventListener("message",({data:o})=>{if(!_y(fe.FRAME_EVENT_KEY,o))return;const a=ud.frameEvent.parse(o);i(a)})},onAppEvent:i=>{En.isClient&&window.addEventListener("message",({data:o})=>{if(!_y(fe.APP_EVENT_KEY,o))return;const a=ud.appEvent.parse(o);i(a)})},postAppEvent:i=>{var o;if(En.isClient){if(!((o=this.iframe)!=null&&o.contentWindow))throw new Error("W3mFrame: iframe is not set");ud.appEvent.parse(i),this.iframe.contentWindow.postMessage(i,"*")}},postFrameEvent:i=>{if(En.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");ud.frameEvent.parse(i),parent.postMessage(i,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((i,o)=>{this.frameLoadPromiseResolver={resolve:i,reject:o}}),t&&(this.frameLoadPromise=new Promise((i,o)=>{this.frameLoadPromiseResolver={resolve:i,reject:o}}),En.isClient)){const i=document.createElement("iframe");i.id="w3m-iframe",i.src=`${Sj}?projectId=${e}&chainId=${n}&version=${Tj}&enableLogger=${s}`,i.name="w3m-secure-iframe",i.style.position="fixed",i.style.zIndex="999999",i.style.display="none",i.style.border="none",i.style.animationDelay="0s, 50ms",i.style.borderBottomLeftRadius="clamp(0px, var(--wui-border-radius-l), 44px)",i.style.borderBottomRightRadius="clamp(0px, var(--wui-border-radius-l), 44px)",this.iframe=i,this.iframe.onerror=()=>{var o;(o=this.frameLoadPromiseResolver)==null||o.reject("Unable to load email login dependency")},this.events.onFrameEvent(o=>{var a;o.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,(a=this.frameLoadPromiseResolver)==null||a.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(t=>({[t]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${t}&projectId=${this.projectId}`,chainId:t}}));return Object.assign({},...e)}}class qH{constructor(e){var i;const t=Bu({level:xj}),{logger:n,chunkLoggerController:s}=Ub({opts:t});this.logger=Sr(n,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&((i=this.chunkLoggerController)!=null&&i.downloadLogsBlobInBrowser)&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{var o;(o=this.chunkLoggerController)!=null&&o.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class VH{constructor({projectId:e,chainId:t,enableLogger:n=!0,onTimeout:s,abortController:i}){this.openRpcRequests=[],n&&(this.w3mLogger=new qH(e)),this.abortController=i,this.w3mFrame=new zH({projectId:e,isAppClient:!0,chainId:t,enableLogger:n}),this.onTimeout=s,this.getLoginEmailUsed()&&this.w3mFrame.initFrame(),this.initPromise=new Promise(o=>{this.w3mFrame.events.onFrameEvent(async a=>{a.type===fe.FRAME_READY&&(this.initPromise=void 0,await new Promise(c=>{setTimeout(c,500)}),o())})})}async init(){this.w3mFrame.initFrame(),this.initPromise&&await this.initPromise}getLoginEmailUsed(){return!!ar.get(fe.EMAIL_LOGIN_USED_KEY)}getEmail(){return ar.get(fe.EMAIL)}getUsername(){return ar.get(fe.SOCIAL_USERNAME)}async reload(){var e;try{this.w3mFrame.initFrame(),await this.appEvent({type:fe.APP_RELOAD})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error reloading iframe"),t}}async connectEmail(e){var t;try{En.checkIfAllowedToTriggerEmail(),this.w3mFrame.initFrame();const n=await this.appEvent({type:fe.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting email"),n}}async connectDevice(){var e;try{return this.appEvent({type:fe.APP_CONNECT_DEVICE})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error connecting device"),t}}async connectOtp(e){var t;try{return this.appEvent({type:fe.APP_CONNECT_OTP,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting otp"),n}}async isConnected(){var e;try{if(!this.getLoginEmailUsed())return{isConnected:!1};const t=await this.appEvent({type:fe.APP_IS_CONNECTED});return t!=null&&t.isConnected||this.deleteAuthLoginCache(),t}catch(t){throw this.deleteAuthLoginCache(),(e=this.w3mLogger)==null||e.logger.error({error:t},"Error checking connection"),t}}async getChainId(){var e;try{const t=await this.appEvent({type:fe.APP_GET_CHAIN_ID});return this.setLastUsedChainId(t.chainId),t}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting chain id"),t}}async getSocialRedirectUri(e){var t;try{return this.w3mFrame.initFrame(),this.appEvent({type:fe.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error getting social redirect uri"),n}}async updateEmail(e){var t;try{const n=await this.appEvent({type:fe.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error updating email"),n}}async updateEmailPrimaryOtp(e){var t;try{return this.appEvent({type:fe.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error updating email primary otp"),n}}async updateEmailSecondaryOtp(e){var t;try{const n=await this.appEvent({type:fe.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(n.newEmail),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error updating email secondary otp"),n}}async syncTheme(e){var t;try{return this.appEvent({type:fe.APP_SYNC_THEME,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error syncing theme"),n}}async syncDappData(e){var t;try{return this.appEvent({type:fe.APP_SYNC_DAPP_DATA,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error syncing dapp data"),n}}async getSmartAccountEnabledNetworks(){var e;try{const t=await this.appEvent({type:fe.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(t.smartAccountEnabledNetworks),t}catch(t){throw this.persistSmartAccountEnabledNetworks([]),(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting smart account enabled networks"),t}}async setPreferredAccount(e){var t;try{return this.appEvent({type:fe.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error setting preferred account"),n}}async connect(e){var t;try{const n=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.getUser({chainId:n,preferredAccountType:e==null?void 0:e.preferredAccountType});return this.setLoginSuccess(s.email),this.setLastUsedChainId(s.chainId),this.user=s,s}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting"),n}}async getUser(e){var t;try{const n=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.appEvent({type:fe.APP_GET_USER,payload:{...e,chainId:n}});return this.user=s,s}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting"),n}}async connectSocial(e){var t;try{this.w3mFrame.initFrame();const n=await this.appEvent({type:fe.APP_CONNECT_SOCIAL,payload:{uri:e}});return n.userName&&this.setSocialLoginSuccess(n.userName),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting social"),n}}async getFarcasterUri(){var e;try{return this.w3mFrame.initFrame(),await this.appEvent({type:fe.APP_GET_FARCASTER_URI})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting farcaster uri"),t}}async connectFarcaster(){var e;try{const t=await this.appEvent({type:fe.APP_CONNECT_FARCASTER});return t.userName&&this.setSocialLoginSuccess(t.userName),t}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error connecting farcaster"),t}}async switchNetwork(e){var t;try{const n=await this.appEvent({type:fe.APP_SWITCH_NETWORK,payload:{chainId:e}});return this.setLastUsedChainId(n.chainId),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error switching network"),n}}async disconnect(){var e;try{const t=await this.appEvent({type:fe.APP_SIGN_OUT});return this.deleteAuthLoginCache(),t}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error disconnecting"),t}}async request(e){var t,n,s,i;try{if(pr.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();(t=this.rpcRequestHandler)==null||t.call(this,e);const o=await this.appEvent({type:fe.APP_RPC_REQUEST,payload:e});return(n=this.rpcSuccessHandler)==null||n.call(this,o,e),o}catch(o){throw(s=this.rpcErrorHandler)==null||s.call(this,o,e),(i=this.w3mLogger)==null||i.logger.error({error:o},"Error requesting"),o}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===fe.FRAME_IS_CONNECTED_SUCCESS&&t.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===fe.FRAME_IS_CONNECTED_ERROR&&e(),t.type===fe.FRAME_IS_CONNECTED_SUCCESS&&!t.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===fe.FRAME_GET_USER_SUCCESS&&e(t.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===fe.FRAME_CONNECT_SOCIAL_SUCCESS&&e(t.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===fe.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(t.payload):t.type===fe.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:pr.ACCOUNT_TYPES.EOA})})}onGetSmartAccountEnabledNetworks(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===fe.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS?e(t.payload.smartAccountEnabledNetworks):t.type===fe.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR&&e([])})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}rejectRpcRequests(){var e;try{this.openRpcRequests.forEach(({abortController:t,method:n})=>{pr.SAFE_RPC_METHODS.includes(n)||t.abort()}),this.openRpcRequests=[]}catch(t){(e=this.w3mLogger)==null||e.logger.error({error:t},"Error aborting RPC request")}}async appEvent(e){let t,n;function s(c){return c.replace("@w3m-app/","")}const i=[fe.APP_SYNC_DAPP_DATA,fe.APP_SYNC_THEME,fe.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(n=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(n),[fe.APP_CONNECT_EMAIL,fe.APP_CONNECT_DEVICE,fe.APP_CONNECT_OTP,fe.APP_CONNECT_SOCIAL,fe.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(t=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_request_timeout"),this.abortController.abort()},3e4)),new Promise((c,l)=>{var f,g,p;const u=Math.random().toString(36).substring(7);(p=(f=this.w3mLogger)==null?void 0:(g=f.logger).info)==null||p.call(g,{event:e,id:u},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:u});const d=new AbortController;if(o==="RPC_REQUEST"){const m=e;this.openRpcRequests=[...this.openRpcRequests,{...m.payload,abortController:d}]}d.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?l(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&l(new Error("Something went wrong"))});function h(m,w){var A,v,I;m.id===u&&((v=w==null?void 0:(A=w.logger).info)==null||v.call(A,{framEvent:m,id:u},"Received frame response"),m.type===`@w3m-frame/${o}_SUCCESS`?(t&&clearTimeout(t),n&&clearTimeout(n),"payload"in m&&c(m.payload),c(void 0)):m.type===`@w3m-frame/${o}_ERROR`&&(t&&clearTimeout(t),n&&clearTimeout(n),"payload"in m&&l(new Error(((I=m.payload)==null?void 0:I.message)||"An error occurred")),l(new Error("An error occurred"))))}this.w3mFrame.events.registerFrameEventHandler(u,m=>h(m,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){ar.set(fe.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){ar.set(fe.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&ar.set(fe.EMAIL,e),ar.set(fe.EMAIL_LOGIN_USED_KEY,"true"),ar.delete(fe.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){ar.delete(fe.EMAIL_LOGIN_USED_KEY),ar.delete(fe.EMAIL),ar.delete(fe.LAST_USED_CHAIN_KEY),ar.delete(fe.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&ar.set(fe.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=ar.get(fe.LAST_USED_CHAIN_KEY)??void 0,t=Number(e);return isNaN(t)?e:t}persistSmartAccountEnabledNetworks(e){ar.set(fe.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}}class Dd{constructor(){}static getInstance({projectId:e,chainId:t,enableLogger:n,onTimeout:s,abortController:i}){return Dd.instance||(Dd.instance=new VH({projectId:e,chainId:t,enableLogger:n,onTimeout:s,abortController:i})),Dd.instance}}var a1={};const WH={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof a1<"u"?a1.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}},Vw={filterOutDuplicatesByRDNS(r){const e=G.state.enableEIP6963?Ne.state.connectors:[],t=ie.getRecentWallets(),n=e.map(a=>{var c;return(c=a.info)==null?void 0:c.rdns}).filter(Boolean),s=t.map(a=>a.rdns).filter(Boolean),i=n.concat(s);if(i.includes("io.metamask.mobile")&&ve.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return r.filter(a=>!i.includes(String(a==null?void 0:a.rdns)))},filterOutDuplicatesByIds(r){const e=Ne.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),t=ie.getRecentWallets(),n=e.map(a=>a.explorerId),s=t.map(a=>a.id),i=n.concat(s);return r.filter(a=>!i.includes(a==null?void 0:a.id))},filterOutDuplicateWallets(r){const e=this.filterOutDuplicatesByRDNS(r);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(r){const{connectors:e}=Ne.state,t=e.filter(i=>i.type==="ANNOUNCED").reduce((i,o)=>{var a;return(a=o.info)!=null&&a.rdns&&(i[o.info.rdns]=!0),i},{});return r.map(i=>({...i,installed:!!i.rdns&&!!t[i.rdns??""]})).sort((i,o)=>Number(o.installed)-Number(i.installed))},getConnectOrderMethod(r,e){var c;const t=(r==null?void 0:r.connectMethodsOrder)||((c=G.state.features)==null?void 0:c.connectMethodsOrder),n=e||Ne.state.connectors;if(t)return t;const{injected:s,announced:i}=Cp.getConnectorsByType(n,Ee.state.recommended,Ee.state.featured),o=s.filter(Cp.showConnector),a=i.filter(Cp.showConnector);return o.length||a.length?["wallet","email","social"]:WH.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(r){const e=!!r.rdns&&Ee.state.excludedWallets.some(n=>n.rdns===r.rdns),t=!!r.name&&Ee.state.excludedWallets.some(n=>Kg.isLowerCaseMatch(n.name,r.name));return e||t}},Cp={getConnectorsByType(r,e,t){const{customWallets:n}=G.state,s=ie.getRecentWallets(),i=Vw.filterOutDuplicateWallets(e),o=Vw.filterOutDuplicateWallets(t),a=r.filter(d=>d.type==="MULTI_CHAIN"),c=r.filter(d=>d.type==="ANNOUNCED"),l=r.filter(d=>d.type==="INJECTED"),u=r.filter(d=>d.type==="EXTERNAL");return{custom:n,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(r){var s;const e=(s=r.info)==null?void 0:s.rdns,t=!!e&&Ee.state.excludedWallets.some(i=>!!i.rdns&&i.rdns===e),n=!!r.name&&Ee.state.excludedWallets.some(i=>Kg.isLowerCaseMatch(i.name,r.name));return!(r.type==="INJECTED"&&(r.name==="Browser Wallet"&&(!ve.isMobile()||ve.isMobile()&&!e&&!bt.checkInstalled())||t||n)||(r.type==="ANNOUNCED"||r.type==="EXTERNAL")&&(t||n))},getIsConnectedWithWC(){return Array.from(x.state.chains.values()).some(t=>Ne.getConnectorId(t.namespace)===ee.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:r,featured:e,custom:t,recent:n,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=(l=>(l=G.state.features)==null?void 0:l.connectorTypeOrder)()??[]}){const u=Cp.getIsConnectedWithWC(),f=[{type:"walletConnect",isEnabled:G.state.enableWalletConnect&&!u},{type:"recent",isEnabled:n.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:t&&t.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:r.length>0}].filter(w=>w.isEnabled),g=new Set(f.map(w=>w.type)),p=c.filter(w=>g.has(w)).map(w=>({type:w,isEnabled:!0})),m=f.filter(({type:w})=>!p.some(({type:v})=>v===w));return Array.from(new Set([...p,...m].map(({type:w})=>w)))}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const _p=globalThis,u0=_p.ShadowRoot&&(_p.ShadyCSS===void 0||_p.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,d0=Symbol(),c1=new WeakMap;let KI=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==d0)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(u0&&e===void 0){const n=t!==void 0&&t.length===1;n&&(e=c1.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&c1.set(t,e))}return e}toString(){return this.cssText}};const Pn=r=>new KI(typeof r=="string"?r:r+"",void 0,d0),gl=(r,...e)=>{const t=r.length===1?r[0]:e.reduce((n,s,i)=>n+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+r[i+1],r[0]);return new KI(t,r,d0)},GH=(r,e)=>{if(u0)r.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const n=document.createElement("style"),s=_p.litNonce;s!==void 0&&n.setAttribute("nonce",s),n.textContent=t.cssText,r.appendChild(n)}},l1=u0?r=>r:r=>r instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return Pn(t)})(r):r;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:KH,defineProperty:JH,getOwnPropertyDescriptor:YH,getOwnPropertyNames:QH,getOwnPropertySymbols:ZH,getPrototypeOf:XH}=Object,ko=globalThis,u1=ko.trustedTypes,ez=u1?u1.emptyScript:"",Ny=ko.reactiveElementPolyfillSupport,kd=(r,e)=>r,Ww={toAttribute(r,e){switch(e){case Boolean:r=r?ez:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,e){let t=r;switch(e){case Boolean:t=r!==null;break;case Number:t=r===null?null:Number(r);break;case Object:case Array:try{t=JSON.parse(r)}catch{t=null}}return t}},JI=(r,e)=>!KH(r,e),d1={attribute:!0,type:String,converter:Ww,reflect:!1,useDefault:!1,hasChanged:JI};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),ko.litPropertyMetadata??(ko.litPropertyMetadata=new WeakMap);let tl=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=d1){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const n=Symbol(),s=this.getPropertyDescriptor(e,n,t);s!==void 0&&JH(this.prototype,e,s)}}static getPropertyDescriptor(e,t,n){const{get:s,set:i}=YH(this.prototype,e)??{get(){return this[t]},set(o){this[t]=o}};return{get:s,set(o){const a=s==null?void 0:s.call(this);i==null||i.call(this,o),this.requestUpdate(e,a,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??d1}static _$Ei(){if(this.hasOwnProperty(kd("elementProperties")))return;const e=XH(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(kd("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(kd("properties"))){const t=this.properties,n=[...QH(t),...ZH(t)];for(const s of n)this.createProperty(s,t[s])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[n,s]of t)this.elementProperties.set(n,s)}this._$Eh=new Map;for(const[t,n]of this.elementProperties){const s=this._$Eu(t,n);s!==void 0&&this._$Eh.set(s,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const s of n)t.unshift(l1(s))}else e!==void 0&&t.push(l1(e));return t}static _$Eu(e,t){const n=t.attribute;return n===!1?void 0:typeof n=="string"?n:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$EO)==null||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const n of t.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return GH(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(t=>{var n;return(n=t.hostConnected)==null?void 0:n.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(t=>{var n;return(n=t.hostDisconnected)==null?void 0:n.call(t)})}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$ET(e,t){var i;const n=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,n);if(s!==void 0&&n.reflect===!0){const o=(((i=n.converter)==null?void 0:i.toAttribute)!==void 0?n.converter:Ww).toAttribute(t,n.type);this._$Em=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$Em=null}}_$AK(e,t){var i,o;const n=this.constructor,s=n._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const a=n.getPropertyOptions(s),c=typeof a.converter=="function"?{fromAttribute:a.converter}:((i=a.converter)==null?void 0:i.fromAttribute)!==void 0?a.converter:Ww;this._$Em=s,this[s]=c.fromAttribute(t,a.type)??((o=this._$Ej)==null?void 0:o.get(s))??null,this._$Em=null}}requestUpdate(e,t,n){var s;if(e!==void 0){const i=this.constructor,o=this[e];if(n??(n=i.getPropertyOptions(e)),!((n.hasChanged??JI)(o,t)||n.useDefault&&n.reflect&&o===((s=this._$Ej)==null?void 0:s.get(e))&&!this.hasAttribute(i._$Eu(e,n))))return;this.C(e,t,n)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,t,{useDefault:n,reflect:s,wrapped:i},o){n&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??t??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||n||(t=void 0),this._$AL.set(e,t)),s===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var n;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[i,o]of this._$Ep)this[i]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[i,o]of s){const{wrapped:a}=o,c=this[i];a!==!0||this._$AL.has(i)||c===void 0||this.C(i,void 0,o,c)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(n=this._$EO)==null||n.forEach(s=>{var i;return(i=s.hostUpdate)==null?void 0:i.call(s)}),this.update(t)):this._$EM()}catch(s){throw e=!1,this._$EM(),s}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$EO)==null||t.forEach(n=>{var s;return(s=n.hostUpdated)==null?void 0:s.call(n)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(t=>this._$ET(t,this[t]))),this._$EM()}updated(e){}firstUpdated(e){}};tl.elementStyles=[],tl.shadowRootOptions={mode:"open"},tl[kd("elementProperties")]=new Map,tl[kd("finalized")]=new Map,Ny==null||Ny({ReactiveElement:tl}),(ko.reactiveElementVersions??(ko.reactiveElementVersions=[])).push("2.1.0");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ud=globalThis,sg=Ud.trustedTypes,h1=sg?sg.createPolicy("lit-html",{createHTML:r=>r}):void 0,YI="$lit$",ho=`lit$${Math.random().toFixed(9).slice(2)}$`,QI="?"+ho,tz=`<${QI}>`,lc=document,xh=()=>lc.createComment(""),Th=r=>r===null||typeof r!="object"&&typeof r!="function",h0=Array.isArray,rz=r=>h0(r)||typeof(r==null?void 0:r[Symbol.iterator])=="function",Iy=`[ 	
\f\r]`,dd=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,f1=/-->/g,p1=/>/g,Xo=RegExp(`>|${Iy}(?:([^\\s"'>=/]+)(${Iy}*=${Iy}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),g1=/'/g,m1=/"/g,ZI=/^(?:script|style|textarea|title)$/i,XI=r=>(e,...t)=>({_$litType$:r,strings:e,values:t}),EJ=XI(1),vJ=XI(2),_u=Symbol.for("lit-noChange"),Xt=Symbol.for("lit-nothing"),y1=new WeakMap,ba=lc.createTreeWalker(lc,129);function eS(r,e){if(!h0(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return h1!==void 0?h1.createHTML(e):e}const nz=(r,e)=>{const t=r.length-1,n=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=dd;for(let a=0;a<t;a++){const c=r[a];let l,u,d=-1,h=0;for(;h<c.length&&(o.lastIndex=h,u=o.exec(c),u!==null);)h=o.lastIndex,o===dd?u[1]==="!--"?o=f1:u[1]!==void 0?o=p1:u[2]!==void 0?(ZI.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=Xo):u[3]!==void 0&&(o=Xo):o===Xo?u[0]===">"?(o=s??dd,d=-1):u[1]===void 0?d=-2:(d=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?Xo:u[3]==='"'?m1:g1):o===m1||o===g1?o=Xo:o===f1||o===p1?o=dd:(o=Xo,s=void 0);const f=o===Xo&&r[a+1].startsWith("/>")?" ":"";i+=o===dd?c+tz:d>=0?(n.push(l),c.slice(0,d)+YI+c.slice(d)+ho+f):c+ho+(d===-2?a:f)}return[eS(r,i+(r[t]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),n]};class Ph{constructor({strings:e,_$litType$:t},n){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[l,u]=nz(e,t);if(this.el=Ph.createElement(l,n),ba.currentNode=this.el.content,t===2||t===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=ba.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(YI)){const h=u[o++],f=s.getAttribute(d).split(ho),g=/([.?@])?(.*)/.exec(h);c.push({type:1,index:i,name:g[2],strings:f,ctor:g[1]==="."?iz:g[1]==="?"?oz:g[1]==="@"?az:Yg}),s.removeAttribute(d)}else d.startsWith(ho)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(ZI.test(s.tagName)){const d=s.textContent.split(ho),h=d.length-1;if(h>0){s.textContent=sg?sg.emptyScript:"";for(let f=0;f<h;f++)s.append(d[f],xh()),ba.nextNode(),c.push({type:2,index:++i});s.append(d[h],xh())}}}else if(s.nodeType===8)if(s.data===QI)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(ho,d+1))!==-1;)c.push({type:7,index:i}),d+=ho.length-1}i++}}static createElement(e,t){const n=lc.createElement("template");return n.innerHTML=e,n}}function Nu(r,e,t=r,n){var o,a;if(e===_u)return e;let s=n!==void 0?(o=t._$Co)==null?void 0:o[n]:t._$Cl;const i=Th(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==i&&((a=s==null?void 0:s._$AO)==null||a.call(s,!1),i===void 0?s=void 0:(s=new i(r),s._$AT(r,t,n)),n!==void 0?(t._$Co??(t._$Co=[]))[n]=s:t._$Cl=s),s!==void 0&&(e=Nu(r,s._$AS(r,e.values),s,n)),e}class sz{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:n}=this._$AD,s=((e==null?void 0:e.creationScope)??lc).importNode(t,!0);ba.currentNode=s;let i=ba.nextNode(),o=0,a=0,c=n[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new yf(i,i.nextSibling,this,e):c.type===1?l=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(l=new cz(i,this,e)),this._$AV.push(l),c=n[++a]}o!==(c==null?void 0:c.index)&&(i=ba.nextNode(),o++)}return ba.currentNode=lc,s}p(e){let t=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}}class yf{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,n,s){this.type=2,this._$AH=Xt,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Nu(this,e,t),Th(e)?e===Xt||e==null||e===""?(this._$AH!==Xt&&this._$AR(),this._$AH=Xt):e!==this._$AH&&e!==_u&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):rz(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Xt&&Th(this._$AH)?this._$AA.nextSibling.data=e:this.T(lc.createTextNode(e)),this._$AH=e}$(e){var i;const{values:t,_$litType$:n}=e,s=typeof n=="number"?this._$AC(e):(n.el===void 0&&(n.el=Ph.createElement(eS(n.h,n.h[0]),this.options)),n);if(((i=this._$AH)==null?void 0:i._$AD)===s)this._$AH.p(t);else{const o=new sz(s,this),a=o.u(this.options);o.p(t),this.T(a),this._$AH=o}}_$AC(e){let t=y1.get(e.strings);return t===void 0&&y1.set(e.strings,t=new Ph(e)),t}k(e){h0(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,s=0;for(const i of e)s===t.length?t.push(n=new yf(this.O(xh()),this.O(xh()),this,this.options)):n=t[s],n._$AI(i),s++;s<t.length&&(this._$AR(n&&n._$AB.nextSibling,s),t.length=s)}_$AR(e=this._$AA.nextSibling,t){var n;for((n=this._$AP)==null?void 0:n.call(this,!1,!0,t);e&&e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}}class Yg{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,n,s,i){this.type=1,this._$AH=Xt,this._$AN=void 0,this.element=e,this.name=t,this._$AM=s,this.options=i,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=Xt}_$AI(e,t=this,n,s){const i=this.strings;let o=!1;if(i===void 0)e=Nu(this,e,t,0),o=!Th(e)||e!==this._$AH&&e!==_u,o&&(this._$AH=e);else{const a=e;let c,l;for(e=i[0],c=0;c<i.length-1;c++)l=Nu(this,a[n+c],t,c),l===_u&&(l=this._$AH[c]),o||(o=!Th(l)||l!==this._$AH[c]),l===Xt?e=Xt:e!==Xt&&(e+=(l??"")+i[c+1]),this._$AH[c]=l}o&&!s&&this.j(e)}j(e){e===Xt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class iz extends Yg{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Xt?void 0:e}}class oz extends Yg{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Xt)}}class az extends Yg{constructor(e,t,n,s,i){super(e,t,n,s,i),this.type=5}_$AI(e,t=this){if((e=Nu(this,e,t,0)??Xt)===_u)return;const n=this._$AH,s=e===Xt&&n!==Xt||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,i=e!==Xt&&(n===Xt||s);s&&this.element.removeEventListener(this.name,this,n),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class cz{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){Nu(this,e)}}const Sy=Ud.litHtmlPolyfillSupport;Sy==null||Sy(Ph,yf),(Ud.litHtmlVersions??(Ud.litHtmlVersions=[])).push("3.3.0");const lz=(r,e,t)=>{const n=(t==null?void 0:t.renderBefore)??e;let s=n._$litPart$;if(s===void 0){const i=(t==null?void 0:t.renderBefore)??null;n._$litPart$=s=new yf(e.insertBefore(xh(),i),i,void 0,t??{})}return s._$AI(r),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ka=globalThis;class Np extends tl{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=lz(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return _u}}var UC;Np._$litElement$=!0,Np.finalized=!0,(UC=Ka.litElementHydrateSupport)==null||UC.call(Ka,{LitElement:Np});const xy=Ka.litElementPolyfillSupport;xy==null||xy({LitElement:Np});(Ka.litElementVersions??(Ka.litElementVersions=[])).push("4.2.0");let Bd,Uo,Bo;function AJ(r,e){Bd=document.createElement("style"),Uo=document.createElement("style"),Bo=document.createElement("style"),Bd.textContent=ml(r).core.cssText,Uo.textContent=ml(r).dark.cssText,Bo.textContent=ml(r).light.cssText,document.head.appendChild(Bd),document.head.appendChild(Uo),document.head.appendChild(Bo),tS(e)}function tS(r){Uo&&Bo&&(r==="light"?(Uo.removeAttribute("media"),Bo.media="enabled"):(Bo.removeAttribute("media"),Uo.media="enabled"))}function uz(r){Bd&&Uo&&Bo&&(Bd.textContent=ml(r).core.cssText,Uo.textContent=ml(r).dark.cssText,Bo.textContent=ml(r).light.cssText)}function ml(r){return{core:gl`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${Pn(r!=null&&r["--w3m-color-mix-strength"]?`${r["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${Pn((r==null?void 0:r["--w3m-font-family"])||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${Pn((r==null?void 0:r["--w3m-font-size-master"])||"10px")};
        --w3m-border-radius-master: ${Pn((r==null?void 0:r["--w3m-border-radius-master"])||"4px")};
        --w3m-z-index: ${Pn((r==null?void 0:r["--w3m-z-index"])||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:gl`
      :root {
        --w3m-color-mix: ${Pn((r==null?void 0:r["--w3m-color-mix"])||"#fff")};
        --w3m-accent: ${Pn(Pi(r,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${Pn(Pi(r,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:gl`
      :root {
        --w3m-color-mix: ${Pn((r==null?void 0:r["--w3m-color-mix"])||"#000")};
        --w3m-accent: ${Pn(Pi(r,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${Pn(Pi(r,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}const CJ=gl`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,_J=gl`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,NJ=gl`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`,Oi={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]},dz=c0({id:42161,name:"Arbitrum One",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://arb1.arbitrum.io/rpc"]}},blockExplorers:{default:{name:"Arbiscan",url:"https://arbiscan.io",apiUrl:"https://api.arbiscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:7654707}}}),hz=c0({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xce01f8eee7E479C928F8919abD53E553a36CeF67",blockCreated:19258213},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}}),fz=c0({id:11155111,name:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.drpc.org"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.etherscan.io",apiUrl:"https://api-sepolia.etherscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:751532},ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xc8Af999e38273D658BE1b921b88A9Ddf005769cC",blockCreated:5317080}},testnet:!0});function wf(r){return{formatters:void 0,fees:void 0,serializers:void 0,...r}}const w1=wf({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),b1=wf({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});wf({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});wf({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});wf({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const pz={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},Ip={getMethodsByChainNamespace(r){return pz[r]||[]},createDefaultNamespace(r){return{methods:this.getMethodsByChainNamespace(r),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(r,e){if(!e)return{...r};const t={...r},n=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>n.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>n.add(s)),e.events&&Object.keys(e.events).forEach(s=>n.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&n.add(i)}),n.forEach(s=>{t[s]||(t[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{t[s]&&(t[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{t[s]&&(t[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{t[s]&&(t[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!t[a]||(t[a].rpcMap||(t[a].rpcMap={}),s.has(a)||(t[a].rpcMap={},s.add(a)),t[a].rpcMap[c]=o)})}return t},createNamespaces(r,e){const t=r.reduce((n,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];n[o]||(n[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=n[o];switch(u.chains.push(l),l){case w1.caipNetworkId:u.chains.push(w1.deprecatedCaipNetworkId);break;case b1.caipNetworkId:u.chains.push(b1.deprecatedCaipNetworkId);break}return u!=null&&u.rpcMap&&c&&(u.rpcMap[i]=c),n},{});return this.applyNamespaceOverrides(t,e)},resolveReownName:async r=>{var n;const e=await LI.resolveName(r);return((n=(Object.values(e==null?void 0:e.addresses)||[])[0])==null?void 0:n.address)||!1},getChainsFromNamespaces(r={}){return Object.values(r).flatMap(e=>{const t=e.chains||[],n=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...t,...n]))})},isSessionEventData(r){return typeof r=="object"&&r!==null&&"id"in r&&"topic"in r&&"params"in r&&typeof r.params=="object"&&r.params!==null&&"chainId"in r.params&&"event"in r.params&&typeof r.params.event=="object"&&r.params.event!==null},isOriginAllowed(r,e,t){for(const n of[...e,...t])if(n.includes("*")){const i=`^${n.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(r))return!0}else if(n===r)return!0;return!1}};class f0{constructor({provider:e,namespace:t}){this.id=ee.CONNECTOR_ID.WALLET_CONNECT,this.name=Ms.ConnectorNamesMap[ee.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=Ms.ConnectorImageIds[ee.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=x.getCaipNetworks.bind(x),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=t}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const t=this.getCaipNetworks(),n=G.state.universalProviderConfigOverride,s=Ip.createNamespaces(t,n);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(t=>t.caipNetworkId);return Od.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:gz})}}const gz=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];class rS{constructor(e){this.availableConnectors=[],this.eventListeners=new Map,this.getCaipNetworks=t=>x.getCaipNetworks(t),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get networks(){return this.getCaipNetworks(this.namespace)}setAuthProvider(e){this.addConnector({id:ee.CONNECTOR_ID.AUTH,type:"AUTH",name:ee.CONNECTOR_NAMES.AUTH,provider:e,imageId:Ms.ConnectorImageIds[ee.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const t=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(n=>t.has(n.id)?!1:(t.add(n.id),!0)),this.emit("connectors",this.availableConnectors)}setStatus(e,t){de.setStatus(e,t)}on(e,t){var n;this.eventListeners.has(e)||this.eventListeners.set(e,new Set),(n=this.eventListeners.get(e))==null||n.add(t)}off(e,t){const n=this.eventListeners.get(e);n&&n.delete(t)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,t){const n=this.eventListeners.get(e);n&&n.forEach(s=>s(t))}async connectWalletConnect(e){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(e){var i;const{caipNetwork:t,providerType:n}=e;if(!e.provider)return;const s="provider"in e.provider?e.provider.provider:e.provider;if(n==="WALLET_CONNECT"){s.setDefaultChain(t.caipNetworkId);return}if(s&&n==="AUTH"){const o=s,a=(i=de.state.preferredAccountTypes)==null?void 0:i[t.chainNamespace];await o.switchNetwork(t.caipNetworkId);const c=await o.getUser({chainId:t.caipNetworkId,preferredAccountType:a});this.emit("switchNetwork",c)}}getWalletConnectConnector(){const e=this.connectors.find(t=>t instanceof f0);if(!e)throw new Error("WalletConnectConnector not found");return e}}class mz extends rS{setUniversalProvider(e){this.addConnector(new f0({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace}))}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect()}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}}async getAccounts({namespace:e}){var s,i,o,a;const t=this.provider,n=((a=(o=(i=(s=t==null?void 0:t.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const[,,l]=c.split(":");return l}).filter((c,l,u)=>u.indexOf(c)===l))||[];return Promise.resolve({accounts:n.map(c=>ve.createAccount(e,c,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){var i,o,a,c,l;if(!(e.caipNetwork&&hr.BALANCE_SUPPORTED_CHAINS.includes((i=e.caipNetwork)==null?void 0:i.chainNamespace))||(o=e.caipNetwork)!=null&&o.testnet)return{balance:"0.00",symbol:((a=e.caipNetwork)==null?void 0:a.nativeCurrency.symbol)||""};if(de.state.balanceLoading&&e.chainId===((c=x.state.activeCaipNetwork)==null?void 0:c.id))return{balance:de.state.balance||"0.00",symbol:de.state.balanceSymbol||""};const s=(await de.fetchTokenBalance()).find(u=>{var d,h;return u.chainId===`${(d=e.caipNetwork)==null?void 0:d.chainNamespace}:${e.chainId}`&&u.symbol===((h=e.caipNetwork)==null?void 0:h.nativeCurrency.symbol)});return{balance:(s==null?void 0:s.quantity.numeric)||"0.00",symbol:(s==null?void 0:s.symbol)||((l=e.caipNetwork)==null?void 0:l.nativeCurrency.symbol)||""}}async signMessage(e){var o,a,c;const{provider:t,message:n,address:s}=e;if(!t)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return((o=x.state.activeCaipNetwork)==null?void 0:o.chainNamespace)===ee.CHAIN.SOLANA?i=(await t.request({method:"solana_signMessage",params:{message:Z_.encode(new TextEncoder().encode(n)),pubkey:s}},(a=x.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)).signature:i=await t.request({method:"personal_sign",params:[n,s]},(c=x.state.activeCaipNetwork)==null?void 0:c.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){var s,i,o,a,c,l;const{caipNetwork:t}=e,n=this.getWalletConnectConnector();if(t.chainNamespace===ee.CHAIN.EVM)try{await((s=n.provider)==null?void 0:s.request({method:"wallet_switchEthereumChain",params:[{chainId:GA(t.id)}]}))}catch(u){if(u.code===Oi.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||u.code===Oi.ERROR_INVALID_CHAIN_ID||u.code===Oi.ERROR_CODE_DEFAULT||((o=(i=u==null?void 0:u.data)==null?void 0:i.originalError)==null?void 0:o.code)===Oi.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await((l=n.provider)==null?void 0:l.request({method:"wallet_addEthereumChain",params:[{chainId:GA(t.id),rpcUrls:[(a=t==null?void 0:t.rpcUrls.chainDefault)==null?void 0:a.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[(c=t.blockExplorers)==null?void 0:c.default.url]}]}))}catch{throw new Error("Chain is not supported")}}n.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(n=>n.type==="WALLET_CONNECT");return e==null?void 0:e.provider}}class yz{constructor(e){this.chainNamespaces=[],this.reportedAlertErrors={},this.getCaipNetwork=(t,n)=>{var s,i,o,a;if(t){const c=(i=(s=x.getNetworkData(t))==null?void 0:s.requestedCaipNetworks)==null?void 0:i.find(u=>u.id===n);if(c)return c;const l=(o=x.getNetworkData(t))==null?void 0:o.caipNetwork;return l||((a=x.getRequestedCaipNetworks(t).filter(u=>u.chainNamespace===t))==null?void 0:a[0])}return x.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const t=this.getCaipNetwork();if(t)return t.id},this.getCaipNetworks=t=>x.getCaipNetworks(t),this.getActiveChainNamespace=()=>x.state.activeChain,this.setRequestedCaipNetworks=(t,n)=>{x.setRequestedCaipNetworks(t,n)},this.getApprovedCaipNetworkIds=()=>x.getAllApprovedCaipNetworkIds(),this.getCaipAddress=t=>x.state.activeChain===t||!t?x.state.activeCaipAddress:x.getAccountProp("caipAddress",t),this.setClientId=t=>{Ce.setClientId(t)},this.getProvider=t=>qe.getProvider(t),this.getProviderType=t=>qe.getProviderId(t),this.getPreferredAccountType=t=>{var n;return(n=de.state.preferredAccountTypes)==null?void 0:n[t]},this.setCaipAddress=(t,n)=>{de.setCaipAddress(t,n)},this.setBalance=(t,n,s)=>{de.setBalance(t,n,s)},this.setProfileName=(t,n)=>{de.setProfileName(t,n)},this.setProfileImage=(t,n)=>{de.setProfileImage(t,n)},this.setUser=(t,n)=>{de.setUser(t,n),G.state.enableEmbedded&&Bt.close()},this.resetAccount=t=>{de.resetAccount(t)},this.setCaipNetwork=t=>{x.setActiveCaipNetwork(t)},this.setCaipNetworkOfNamespace=(t,n)=>{x.setChainNetworkData(n,{caipNetwork:t})},this.setAllAccounts=(t,n)=>{de.setAllAccounts(t,n),G.setHasMultipleAddresses((t==null?void 0:t.length)>1)},this.setStatus=(t,n)=>{de.setStatus(t,n),Ne.isConnected()?ie.setConnectionStatus("connected"):ie.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=t=>x.getAccountProp("address",t),this.setConnectors=t=>{const n=[...Ne.state.allConnectors,...t];Ne.setConnectors(n)},this.fetchIdentity=t=>Ce.fetchIdentity(t),this.getReownName=t=>LI.getNamesForAddress(t),this.getConnectors=()=>Ne.getConnectors(),this.getConnectorImage=t=>VC.getConnectorImage(t),this.setConnectedWalletInfo=(t,n)=>{const s=qe.getProviderId(n),i=t?{...t,type:s}:void 0;de.setConnectedWalletInfo(i,n)},this.getIsConnectedState=()=>!!x.state.activeCaipAddress,this.addAddressLabel=(t,n,s)=>{de.addAddressLabel(t,n,s)},this.removeAddressLabel=(t,n)=>{de.removeAddressLabel(t,n)},this.getAddress=t=>x.state.activeChain===t||!t?de.state.address:x.getAccountProp("address",t),this.setApprovedCaipNetworksData=t=>x.setApprovedCaipNetworksData(t),this.resetNetwork=t=>{x.resetNetwork(t)},this.addConnector=t=>{Ne.addConnector(t)},this.resetWcConnection=()=>{bt.resetWcConnection()},this.setAddressExplorerUrl=(t,n)=>{de.setAddressExplorerUrl(t,n)},this.setSmartAccountDeployed=(t,n)=>{de.setSmartAccountDeployed(t,n)},this.setSmartAccountEnabledNetworks=(t,n)=>{x.setSmartAccountEnabledNetworks(t,n)},this.setPreferredAccountType=(t,n)=>{de.setPreferredAccountType(t,n)},this.setEIP6963Enabled=t=>{G.setEIP6963Enabled(t)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.initialize(e)}getChainNamespacesSet(e,t){const n=e==null?void 0:e.map(i=>i.namespace).filter(i=>!!i);if(n!=null&&n.length)return[...new Set(n)];const s=t==null?void 0:t.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){var t,n,s;this.initControllers(e),await this.initChainAdapters(),await this.injectModalUi(),this.sendInitializeEvent(e),Vs.set({initialized:!0}),await this.syncExistingConnection(),((t=G.state.features)!=null&&t.email||Array.isArray((n=G.state.features)==null?void 0:n.socials)&&((s=G.state.features)==null?void 0:s.socials.length)>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){const e=await Ee.fetchAllowedOrigins();if(e&&ve.isClient()){const t=window.location.origin;Ip.isOriginAllowed(t,e,Oi.DEFAULT_ALLOWED_ANCESTORS)||Si.open($s.ALERT_ERRORS.INVALID_APP_CONFIGURATION,"error")}else Si.open($s.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}sendInitializeEvent(e){var n;const{...t}=e;delete t.adapters,delete t.universalProvider,At.sendEvent({type:"track",event:"INITIALIZE",properties:{...t,networks:e.networks.map(s=>s.id),siweConfig:{options:((n=e.siweConfig)==null?void 0:n.options)||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&Cr.setThemeMode(e.themeMode),e.themeVariables&&Cr.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");x.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const t=this.getDefaultNetwork();t&&x.setActiveCaipNetwork(t)}initializeConnectionController(e){bt.setWcBasic(e.basic??!1)}initializeConnectorController(){Ne.initialize(this.chainNamespaces)}initializeOptionsController(e){var o;G.setDebug(e.debug!==!1),G.setEnableWalletConnect(e.enableWalletConnect!==!1),G.setEnableWalletGuide(e.enableWalletGuide!==!1),G.setEnableWallets(e.enableWallets!==!1),G.setEIP6963Enabled(e.enableEIP6963!==!1),G.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),G.setEnableAuthLogger(e.enableAuthLogger!==!1),G.setCustomRpcUrls(e.customRpcUrls),G.setSdkVersion(e.sdkVersion),G.setProjectId(e.projectId),G.setEnableEmbedded(e.enableEmbedded),G.setAllWallets(e.allWallets),G.setIncludeWalletIds(e.includeWalletIds),G.setExcludeWalletIds(e.excludeWalletIds),G.setFeaturedWalletIds(e.featuredWalletIds),G.setTokens(e.tokens),G.setTermsConditionsUrl(e.termsConditionsUrl),G.setPrivacyPolicyUrl(e.privacyPolicyUrl),G.setCustomWallets(e.customWallets),G.setFeatures(e.features),G.setAllowUnsupportedChain(e.allowUnsupportedChain),G.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),G.setDefaultAccountTypes(e.defaultAccountTypes);const t=ie.getPreferredAccountTypes(),n={...G.state.defaultAccountTypes,...t};de.setPreferredAccountTypes(n);const s=this.getDefaultMetaData();if(!e.metadata&&s&&(e.metadata=s),G.setMetadata(e.metadata),G.setDisableAppend(e.disableAppend),G.setEnableEmbedded(e.enableEmbedded),G.setSIWX(e.siwx),!e.projectId){Si.open($s.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(((o=e.adapters)==null?void 0:o.find(a=>a.namespace===ee.CHAIN.EVM))&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");G.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){var e,t,n,s;return typeof window<"u"&&typeof document<"u"?{name:((t=(e=document.getElementsByTagName("title"))==null?void 0:e[0])==null?void 0:t.textContent)||"",description:((n=document.querySelector('meta[property="og:description"]'))==null?void 0:n.content)||"",url:window.location.origin,icons:[((s=document.querySelector('link[rel~="icon"]'))==null?void 0:s.href)||""]}:null}setUnsupportedNetwork(e){const t=this.getActiveChainNamespace();if(t){const n=Xc.getUnsupportedNetwork(`${t}:${e}`);x.setActiveCaipNetwork(n)}}getDefaultNetwork(){return Xc.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return Xc.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return Xc.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const t=e.networks.find(s=>{var i;return s.id===((i=e.defaultNetwork)==null?void 0:i.id)});return t?Xc.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{var i;const e=x.state.activeChain,t=this.getAdapter(e),n=(i=this.getCaipNetwork(e))==null?void 0:i.id;if(!t)throw new Error("Adapter not found");const s=await t.connectWalletConnect(n);this.close(),this.setClientId((s==null?void 0:s.clientId)||null),ie.setConnectedNamespaces([...x.state.chains.keys()]),this.chainNamespaces.forEach(o=>{Ne.setConnectorId(ft.CONNECTOR_TYPE_WALLET_CONNECT,o)}),await this.syncWalletConnectAccount()},connectExternal:async({id:e,info:t,type:n,provider:s,chain:i,caipNetwork:o})=>{var f,g,p,m,w,A;const a=x.state.activeChain,c=i||a,l=this.getAdapter(c);if(i&&i!==a&&!o){const v=this.getCaipNetworks().find(I=>I.chainNamespace===i);v&&this.setCaipNetwork(v)}if(!l)throw new Error("Adapter not found");const u=this.getCaipNetwork(c),d=await l.connect({id:e,info:t,type:n,provider:s,chainId:(o==null?void 0:o.id)||(u==null?void 0:u.id),rpcUrl:((p=(g=(f=o==null?void 0:o.rpcUrls)==null?void 0:f.default)==null?void 0:g.http)==null?void 0:p[0])||((A=(w=(m=u==null?void 0:u.rpcUrls)==null?void 0:m.default)==null?void 0:w.http)==null?void 0:A[0])});if(!d)return;ie.addConnectedNamespace(c),this.syncProvider({...d,chainNamespace:c});const{accounts:h}=await l.getAccounts({namespace:c,id:e});this.setAllAccounts(h,c),this.setStatus("connected",c),this.syncConnectedWalletInfo(c)},reconnectExternal:async({id:e,info:t,type:n,provider:s})=>{var a;const i=x.state.activeChain,o=this.getAdapter(i);o!=null&&o.reconnect&&(await(o==null?void 0:o.reconnect({id:e,info:t,type:n,provider:s,chainId:(a=this.getCaipNetwork())==null?void 0:a.id})),ie.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnect:async e=>{const t=e||x.state.activeChain,n=this.getAdapter(t),s=qe.getProvider(t),i=qe.getProviderId(t);await(n==null?void 0:n.disconnect({provider:s,providerType:i})),ie.removeConnectedNamespace(t),qe.resetChain(t),this.setUser(void 0,t),this.setStatus("disconnected",t),this.setConnectedWalletInfo(void 0,t)},checkInstalled:e=>e?e.some(t=>{var n;return!!((n=window.ethereum)!=null&&n[String(t)])}):!!window.ethereum,signMessage:async e=>{const t=this.getAdapter(x.state.activeChain),n=await(t==null?void 0:t.signMessage({message:e,address:de.state.address,provider:qe.getProvider(x.state.activeChain)}));return(n==null?void 0:n.signature)||""},sendTransaction:async e=>{const t=e.chainNamespace;if(hr.SEND_SUPPORTED_NAMESPACES.includes(t)){const n=this.getAdapter(x.state.activeChain),s=qe.getProvider(t),i=await(n==null?void 0:n.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}));return(i==null?void 0:i.hash)||""}return""},estimateGas:async e=>{if(e.chainNamespace===ee.CHAIN.EVM){const t=this.getAdapter(x.state.activeChain),n=qe.getProvider(x.state.activeChain),s=this.getCaipNetwork();if(!s)throw new Error("CaipNetwork is undefined");const i=await(t==null?void 0:t.estimateGas({...e,provider:n,caipNetwork:s}));return(i==null?void 0:i.gas)||0n}return 0n},getEnsAvatar:async()=>{var e;return await this.syncIdentity({address:de.state.address,chainId:Number((e=this.getCaipNetwork())==null?void 0:e.id),chainNamespace:x.state.activeChain}),de.state.profileImage||!1},getEnsAddress:async e=>await Ip.resolveReownName(e),writeContract:async e=>{const t=this.getAdapter(x.state.activeChain),n=this.getCaipNetwork(),s=this.getCaipAddress(),i=qe.getProvider(x.state.activeChain);if(!n||!s)throw new Error("CaipNetwork or CaipAddress is undefined");const o=await(t==null?void 0:t.writeContract({...e,caipNetwork:n,provider:i,caipAddress:s}));return o==null?void 0:o.hash},parseUnits:(e,t)=>{const n=this.getAdapter(x.state.activeChain);return(n==null?void 0:n.parseUnits({value:e,decimals:t}))??0n},formatUnits:(e,t)=>{const n=this.getAdapter(x.state.activeChain);return(n==null?void 0:n.formatUnits({value:e,decimals:t}))??"0"},getCapabilities:async e=>{const t=this.getAdapter(x.state.activeChain);return await(t==null?void 0:t.getCapabilities(e))},grantPermissions:async e=>{const t=this.getAdapter(x.state.activeChain);return await(t==null?void 0:t.grantPermissions(e))},revokePermissions:async e=>{const t=this.getAdapter(x.state.activeChain);return t!=null&&t.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{const t=this.getAdapter(x.state.activeChain);return await(t==null?void 0:t.walletGetAssets(e))??{}}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},bt.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){var t,n,s,i,o;if(qe.getProviderId(x.state.activeChain)===ft.CONNECTOR_TYPE_WALLET_CONNECT){const a=(n=(t=this.universalProvider)==null?void 0:t.session)==null?void 0:n.namespaces;return{supportsAllNetworks:((o=(i=(s=this.universalProvider)==null?void 0:s.session)==null?void 0:i.peer)==null?void 0:o.metadata.name)==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(a)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=qe.getProvider(t),i=qe.getProviderId(t);if(e.chainNamespace===x.state.activeChain){const o=this.getAdapter(t);await(o==null?void 0:o.switchNetwork({caipNetwork:e,provider:s,providerType:i}))}else if(this.setCaipNetwork(e),i===ft.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(t);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(t=>{const n=t.chains||[],s=t.accounts.map(i=>{const{chainId:o,chainNamespace:a}=li.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...n,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,n)=>{var i;const s=e==null?void 0:e.find(o=>o.namespace===n);return s?(s.construct({namespace:n,projectId:(i=this.options)==null?void 0:i.projectId,networks:this.getCaipNetworks()}),t[n]=s):t[n]=new mz({namespace:n,networks:this.getCaipNetworks()}),t},{})}async initChainAdapter(e){var t;this.onConnectors(e),this.listenAdapter(e),(t=this.chainAdapters)==null||t[e].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){const t=this.getAdapter(e);t==null||t.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const t=this.getAdapter(e);if(!t)return;const n=ie.getConnectionStatus();n==="connected"?this.setStatus("connecting",e):n==="disconnected"?(ie.clearAddressCache(),this.setStatus(n,e)):this.setStatus(n,e),t.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(l=>l.id===i||l.caipNetworkId===i),a=x.state.activeChain===e,c=x.getAccountProp("address",e);if(o){const l=a&&s?s:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),t.on("disconnect",this.disconnect.bind(this,e)),t.on("pendingTransactions",()=>{const s=de.state.address,i=x.state.activeCaipNetwork;!s||!(i!=null&&i.id)||this.updateNativeBalance(s,i.id,i.chainNamespace)}),t.on("accountChanged",({address:s,chainId:i})=>{var a,c;const o=x.state.activeChain===e;o&&i?this.syncAccount({address:s,chainId:i,chainNamespace:e}):o&&((a=x.state.activeCaipNetwork)!=null&&a.id)?this.syncAccount({address:s,chainId:(c=x.state.activeCaipNetwork)==null?void 0:c.id,chainNamespace:e}):this.syncAccountInfo(s,i,e),this.syncAllAccounts(e)})}async createUniversalProviderForAdapter(e){var t,n,s;await this.getUniversalProvider(),this.universalProvider&&((s=(n=(t=this.chainAdapters)==null?void 0:t[e])==null?void 0:n.setUniversalProvider)==null||s.call(n,this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async syncNamespaceConnection(e){try{const t=Ne.getConnectorId(e);switch(this.setStatus("connecting",e),t){case ee.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case ee.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}async syncAdapterConnection(e){var o,a,c;const t=this.getAdapter(e),n=Ne.getConnectorId(e),s=this.getCaipNetwork(e),i=Ne.getConnectors(e).find(l=>l.id===n);try{if(!t||!i)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!(s!=null&&s.id))throw new Error("CaipNetwork not found");const l=await(t==null?void 0:t.syncConnection({namespace:e,id:i.id,chainId:s.id,rpcUrl:(c=(a=(o=s==null?void 0:s.rpcUrls)==null?void 0:o.default)==null?void 0:a.http)==null?void 0:c[0]}));if(l){const u=await(t==null?void 0:t.getAccounts({namespace:e,id:i.id}));u&&u.accounts.length>0?this.setAllAccounts(u.accounts,e):this.setAllAccounts([ve.createAccount(e,l.address,"eoa")],e),this.syncProvider({...l,chainNamespace:e}),await this.syncAccount({...l,chainNamespace:e}),this.setStatus("connected",e)}else this.setStatus("disconnected",e)}catch{this.setStatus("disconnected",e)}}async syncWalletConnectAccount(){const e=this.chainNamespaces.map(async t=>{var a,c,l,u,d;const n=this.getAdapter(t),s=((u=(l=(c=(a=this.universalProvider)==null?void 0:a.session)==null?void 0:c.namespaces)==null?void 0:l[t])==null?void 0:u.accounts)||[],i=(d=x.state.activeCaipNetwork)==null?void 0:d.id,o=s.find(h=>{const{chainId:f}=li.parseCaipAddress(h);return f===(i==null?void 0:i.toString())})||s[0];if(o){const h=li.validateCaipAddress(o),{chainId:f,address:g}=li.parseCaipAddress(h);if(qe.setProviderId(t,ft.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&x.state.activeCaipNetwork&&(n==null?void 0:n.namespace)!==ee.CHAIN.EVM){const p=n==null?void 0:n.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:x.state.activeCaipNetwork});qe.setProvider(t,p)}else qe.setProvider(t,this.universalProvider);Ne.setConnectorId(ee.CONNECTOR_ID.WALLET_CONNECT,t),ie.addConnectedNamespace(t),this.syncWalletConnectAccounts(t),await this.syncAccount({address:g,chainId:f,chainNamespace:t})}else this.setStatus("disconnected",t);this.syncConnectedWalletInfo(t),await x.setApprovedCaipNetworksData(t)});await Promise.all(e)}syncWalletConnectAccounts(e){var n,s,i,o,a;const t=(a=(o=(i=(s=(n=this.universalProvider)==null?void 0:n.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const{address:l}=li.parseCaipAddress(c);return l}).filter((c,l,u)=>u.indexOf(c)===l);t&&this.setAllAccounts(t.map(c=>ve.createAccount(e,c,e==="bip122"?"payment":"eoa")),e)}syncProvider({type:e,provider:t,id:n,chainNamespace:s}){qe.setProviderId(s,e),qe.setProvider(s,t),Ne.setConnectorId(n,s)}async syncAllAccounts(e){const t=Ne.getConnectorId(e);if(!t)return;const n=this.getAdapter(e),s=await(n==null?void 0:n.getAccounts({namespace:e,id:t}));s&&s.accounts.length>0&&this.setAllAccounts(s.accounts,e)}async syncAccount(e){var d,h;const t=e.chainNamespace===x.state.activeChain,n=x.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=ie.getActiveNetworkProps(),c=i||a,l=((d=x.state.activeCaipNetwork)==null?void 0:d.name)===ee.UNSUPPORTED_NETWORK_NAME,u=x.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let f=this.getCaipNetworks().find(m=>m.id.toString()===c.toString()),g=this.getCaipNetworks().find(m=>m.chainNamespace===o);if(!u&&!f&&!g){const m=this.getApprovedCaipNetworkIds()||[],w=m.find(v=>{var I;return((I=li.parseCaipNetworkId(v))==null?void 0:I.chainId)===c.toString()}),A=m.find(v=>{var I;return((I=li.parseCaipNetworkId(v))==null?void 0:I.chainNamespace)===o});f=this.getCaipNetworks().find(v=>v.caipNetworkId===w),g=this.getCaipNetworks().find(v=>v.caipNetworkId===A||"deprecatedCaipNetworkId"in v&&v.deprecatedCaipNetworkId===A)}const p=f||g;(p==null?void 0:p.chainNamespace)===x.state.activeChain?G.state.enableNetworkSwitch&&!G.state.allowUnsupportedChain&&((h=x.state.activeCaipNetwork)==null?void 0:h.name)===ee.UNSUPPORTED_NETWORK_NAME?x.showUnsupportedChainUI():this.setCaipNetwork(p):t||n&&this.setCaipNetworkOfNamespace(n,o),this.syncConnectedWalletInfo(o),Kg.isLowerCaseMatch(s,de.state.address)||this.syncAccountInfo(s,p==null?void 0:p.id,o),t?await this.syncBalance({address:s,chainId:p==null?void 0:p.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:n==null?void 0:n.id,chainNamespace:o})}}async syncAccountInfo(e,t,n){const s=this.getCaipAddress(n),i=t||(s==null?void 0:s.split(":")[1]);if(!i)return;const o=`${n}:${i}:${e}`;this.setCaipAddress(o,n),await this.syncIdentity({address:e,chainId:i,chainNamespace:n})}async syncReownName(e,t){try{const n=await this.getReownName(e);if(n[0]){const s=n[0];this.setProfileName(s.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){var s;const t=Ne.getConnectorId(e),n=qe.getProviderId(e);if(n===ft.CONNECTOR_TYPE_ANNOUNCED||n===ft.CONNECTOR_TYPE_INJECTED){if(t){const i=this.getConnectors().find(o=>o.id===t);if(i){const{info:o,name:a,imageUrl:c}=i,l=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:l,...o},e)}}}else if(n===ft.CONNECTOR_TYPE_WALLET_CONNECT){const i=qe.getProvider(e);i!=null&&i.session&&this.setConnectedWalletInfo({...i.session.peer.metadata,name:i.session.peer.metadata.name,icon:(s=i.session.peer.metadata.icons)==null?void 0:s[0]},e)}else if(t)if(t===ee.CONNECTOR_ID.COINBASE){const i=this.getConnectors().find(o=>o.id===ee.CONNECTOR_ID.COINBASE);this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(i)},e)}else this.setConnectedWalletInfo({name:t},e)}async syncBalance(e){!HC.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(n=>{var s;return n.id.toString()===((s=e.chainId)==null?void 0:s.toString())})||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async updateNativeBalance(e,t,n){const s=this.getAdapter(n),i=x.getCaipNetworkByNamespace(n,t);if(s){const o=await s.getBalance({address:e,chainId:t,caipNetwork:i,tokens:this.options.tokens});this.setBalance(o.balance,o.symbol,n)}}async initializeUniversalAdapter(){var n,s,i,o,a,c,l,u,d,h;const e=_9.createLogger((f,...g)=>{f&&this.handleAlertError(f),console.error(...g)}),t={projectId:(n=this.options)==null?void 0:n.projectId,metadata:{name:(s=this.options)!=null&&s.metadata?(i=this.options)==null?void 0:i.metadata.name:"",description:(o=this.options)!=null&&o.metadata?(a=this.options)==null?void 0:a.metadata.description:"",url:(c=this.options)!=null&&c.metadata?(l=this.options)==null?void 0:l.metadata.url:"",icons:(u=this.options)!=null&&u.metadata?(d=this.options)==null?void 0:d.metadata.icons:[""]},logger:e};G.setManualWCControl(!!((h=this.options)!=null&&h.manualWCControl)),this.universalProvider=this.options.universalProvider??await Nj.init(t),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&(this.universalProvider.on("display_uri",e=>{bt.setUri(e)}),this.universalProvider.on("connect",bt.finalizeWcConnection),this.universalProvider.on("disconnect",()=>{this.chainNamespaces.forEach(e=>{this.resetAccount(e)}),bt.resetWcConnection()}),this.universalProvider.on("chainChanged",e=>{const t=this.getCaipNetworks().find(s=>s.id==e),n=this.getCaipNetwork();if(!t){this.setUnsupportedNetwork(e);return}(n==null?void 0:n.id)!==(t==null?void 0:t.id)&&this.setCaipNetwork(t)}),this.universalProvider.on("session_event",e=>{if(Ip.isSessionEventData(e)){const{name:t,data:n}=e.params.event;t==="accountsChanged"&&Array.isArray(n)&&ve.isCaipAddress(n[0])&&this.syncAccount(li.parseCaipAddress(n[0]))}}))}createUniversalProvider(){var e;return!this.universalProviderInitPromise&&ve.isClient()&&((e=this.options)!=null&&e.projectId)&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){At.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const t=Object.entries($s.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[n,s]=t??[],{message:i,alertErrorKey:o}=s??{};if(n&&i&&!this.reportedAlertErrors[n]){const a=$s.ALERT_ERRORS[o];a&&(Si.open(a,"error"),this.reportedAlertErrors[n]=!0)}}getAdapter(e){var t;if(e)return(t=this.chainAdapters)==null?void 0:t[e]}createAdapter(e){var s;if(!e)return;const t=e.namespace;if(!t)return;this.createClients();const n=e;n.namespace=t,n.construct({namespace:t,projectId:(s=this.options)==null?void 0:s.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=n)}async open(e){if(await this.injectModalUi(),e!=null&&e.uri&&bt.setUri(e.uri),e!=null&&e.arguments)switch(e==null?void 0:e.view){case"Swap":return Bt.open({...e,data:{swap:e.arguments}})}return Bt.open(e)}async close(e=!1){await this.injectModalUi(),Bt.close(e)}setLoading(e,t){Bt.setLoading(e,t)}async disconnect(e){await bt.disconnect(e)}getSIWX(){return G.state.siwx}getError(){return""}getChainId(){var e;return(e=x.state.activeCaipNetwork)==null?void 0:e.id}async switchNetwork(e){const t=this.getCaipNetworks().find(n=>n.id===e.id);if(!t){Si.open($s.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await x.switchActiveNetwork(t)}getWalletProvider(){return x.state.activeChain?qe.state.providers[x.state.activeChain]:null}getWalletProviderType(){return qe.getProviderId(x.state.activeChain)}subscribeProviders(e){return qe.subscribeProviders(e)}getThemeMode(){return Cr.state.themeMode}getThemeVariables(){return Cr.state.themeVariables}setThemeMode(e){Cr.setThemeMode(e),tS(Cr.state.themeMode)}setTermsConditionsUrl(e){G.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){G.setPrivacyPolicyUrl(e)}setThemeVariables(e){Cr.setThemeVariables(e),uz(Cr.state.themeVariables)}subscribeTheme(e){return Cr.subscribe(e)}getWalletInfo(){return de.state.connectedWalletInfo}getAccount(e){var o;const t=Ne.getAuthConnector(e),n=x.getAccountData(e),s=x.state.activeChain,i=ie.getConnectedConnectorId(e);if(n)return{allAccounts:n.allAccounts,caipAddress:n.caipAddress,address:ve.getPlainAddress(n.caipAddress),isConnected:!!n.caipAddress,status:n.status,embeddedWalletInfo:t&&i===ee.CONNECTOR_ID.AUTH?{user:n.user?{...n.user,username:ie.getConnectedSocialUsername()}:void 0,authProvider:n.socialProvider||"email",accountType:(o=n.preferredAccountTypes)==null?void 0:o[e||s],isSmartAccountDeployed:!!n.smartAccountDeployed}:void 0}}subscribeAccount(e,t){const n=()=>{const s=this.getAccount(t);s&&e(s)};t?x.subscribeChainProp("accountState",n,t):x.subscribe(n),Ne.subscribe(n)}subscribeNetwork(e){return x.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t==null?void 0:t.id,caipNetworkId:t==null?void 0:t.caipNetworkId})})}subscribeWalletInfo(e){return de.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){de.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){x.subscribeKey("activeCaipNetwork",e)}getState(){return Vs.state}subscribeState(e){return Vs.subscribe(e)}showErrorMessage(e){cs.showError(e)}showSuccessMessage(e){cs.showSuccess(e)}getEvent(){return{...At.state}}subscribeEvents(e){return At.subscribe(e)}replace(e){et.replace(e)}redirect(e){et.push(e)}popTransactionStack(e){et.popTransactionStack(e)}isOpen(){return Bt.state.open}isTransactionStackEmpty(){return et.state.transactionStack.length===0}isTransactionShouldReplaceView(){var e;return(e=et.state.transactionStack[et.state.transactionStack.length-1])==null?void 0:e.replace}static getInstance(){return this.instance}updateFeatures(e){G.setFeatures(e)}updateOptions(e){const n={...G.state||{},...e};G.setOptions(n)}setConnectMethodsOrder(e){G.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){G.setWalletFeaturesOrder(e)}setCollapseWallets(e){G.setCollapseWallets(e)}setSocialsOrder(e){G.setSocialsOrder(e)}getConnectMethodsOrder(){return Vw.getConnectOrderMethod(G.state.features,Ne.getConnectors())}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const n=this.extendCaipNetwork(t,this.options);this.getCaipNetworks().find(s=>s.id===n.id)||x.addNetwork(n)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===t)&&x.removeNetwork(e,t)}}let E1=!1;class wz extends yz{setupAuthConnectorListeners(e){e.onRpcRequest(t=>{En.checkIfRequestExists(t)?En.checkIfRequestIsSafe(t)||this.handleUnsafeRPCRequest():(this.open(),console.error(pr.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:t.method}),setTimeout(()=>{this.showErrorMessage(pr.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close(!0):this.popTransactionStack(!0))}),e.onRpcSuccess((t,n)=>{const s=En.checkIfRequestIsSafe(n),i=de.state.address,o=x.state.activeCaipNetwork;s||(this.isTransactionStackEmpty()?(this.close(!0),i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace)):(this.popTransactionStack(),i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace)))}),e.onNotConnected(()=>{const t=x.state.activeChain;Ne.getConnectorId(t)===ee.CONNECTOR_ID.AUTH&&(this.setCaipAddress(void 0,t),this.setLoading(!1,t))}),e.onConnect(async t=>{var a,c;const n=x.state.activeChain,s=n===ee.CHAIN.EVM?`eip155:${t.chainId}:${t.address}`:`${t.chainId}:${t.address}`,i=t.preferredAccountType||((a=de.state.preferredAccountTypes)==null?void 0:a[n])||G.state.defaultAccountTypes[n];Kg.isLowerCaseMatch(t.address,de.state.address)||this.syncIdentity({address:t.address,chainId:t.chainId,chainNamespace:n}),this.setCaipAddress(s,n),this.setUser({...de.state.user||{},...t},n),this.setSmartAccountDeployed(!!t.smartAccountDeployed,n),this.setPreferredAccountType(i,n);const o=(c=t.accounts)==null?void 0:c.map(l=>{var u;return ve.createAccount(n,l.address,l.type||((u=de.state.preferredAccountTypes)==null?void 0:u[n])||G.state.defaultAccountTypes[n])});this.setAllAccounts(o||[ve.createAccount(n,t.address,t.preferredAccountType||i)],n),await e.getSmartAccountEnabledNetworks(),this.setLoading(!1,n)}),e.onSocialConnected(({userName:t})=>{this.setUser({...de.state.user||{},username:t},x.state.activeChain)}),e.onGetSmartAccountEnabledNetworks(t=>{this.setSmartAccountEnabledNetworks(t,x.state.activeChain)}),e.onSetPreferredAccount(({address:t,type:n})=>{t&&this.setPreferredAccountType(n,x.state.activeChain)})}async syncAuthConnector(e,t){var u,d,h,f;const n=ee.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t);if(!n)return;this.setLoading(!0,t);const s=e.getLoginEmailUsed();this.setLoading(s,t),s&&this.setStatus("connecting",t);const i=e.getEmail(),o=e.getUsername();this.setUser({...((u=de.state)==null?void 0:u.user)||{},username:o,email:i},x.state.activeChain),this.setupAuthConnectorListeners(e);const{isConnected:a}=await e.isConnected(),c=Cr.getSnapshot(),l=G.getSnapshot();e.syncDappData({metadata:l.metadata,sdkVersion:l.sdkVersion,projectId:l.projectId,sdkType:l.sdkType}),e.syncTheme({themeMode:c.themeMode,themeVariables:c.themeVariables,w3mThemeVariables:Pi(c.themeVariables,c.themeMode)}),t&&n&&(a&&((d=this.connectionControllerClient)!=null&&d.connectExternal)?(await((f=this.connectionControllerClient)==null?void 0:f.connectExternal({id:ee.CONNECTOR_ID.AUTH,info:{name:ee.CONNECTOR_ID.AUTH},type:ft.CONNECTOR_TYPE_AUTH,provider:e,chainId:(h=x.state.activeCaipNetwork)==null?void 0:h.id,chain:t})),this.setStatus("connected",t)):Ne.getConnectorId(t)===ee.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",t),ie.removeConnectedNamespace(t))),this.setLoading(!1,t)}async checkExistingTelegramSocialConnection(e){var t;try{if(!ve.isTelegram())return;const n=ie.getTelegramSocialProvider();if(!n||typeof window>"u"||typeof document>"u")return;const i=new URL(window.location.href).searchParams.get("result_uri");if(!i)return;de.setSocialProvider(n,e),await((t=this.authProvider)==null?void 0:t.init());const o=Ne.getAuthConnector();n&&o&&(this.setLoading(!0,e),await o.provider.connectSocial(i),await bt.connectExternal(o,o.chain),ie.setConnectedSocialProvider(n),ie.removeTelegramSocialProvider(),At.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:n}}))}catch(n){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",n)}try{const n=new URL(window.location.href);n.searchParams.delete("result_uri"),window.history.replaceState({},document.title,n.toString())}catch(n){console.error("tma social login failed",n)}}createAuthProvider(e){var o,a,c,l,u,d,h,f,g,p,m,w,A,v,I;if(!ee.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const n=((a=(o=this.options)==null?void 0:o.features)==null?void 0:a.email)===void 0?hr.DEFAULT_FEATURES.email:(l=(c=this.options)==null?void 0:c.features)==null?void 0:l.email,s=(d=(u=this.options)==null?void 0:u.features)!=null&&d.socials?((g=(f=(h=this.options)==null?void 0:h.features)==null?void 0:f.socials)==null?void 0:g.length)>0:((m=(p=this.options)==null?void 0:p.features)==null?void 0:m.socials)??hr.DEFAULT_FEATURES.socials,i=n||s;!this.authProvider&&((w=this.options)!=null&&w.projectId)&&i&&(this.authProvider=Dd.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:(A=this.getCaipNetwork(e))==null?void 0:A.caipNetworkId,abortController:$s.EmbeddedWalletAbortController,onTimeout:T=>{T==="iframe_load_failed"?Si.open($s.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):T==="iframe_request_timeout"?Si.open($s.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):T==="unverified_domain"&&Si.open($s.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")}}),Vs.subscribeOpen(T=>{var P;!T&&this.isTransactionStackEmpty()&&((P=this.authProvider)==null||P.rejectRpcRequests())}),e===ee.CHAIN.EVM&&((v=de.state.preferredAccountTypes)!=null&&v.eip155)&&this.authProvider.setPreferredAccount((I=de.state.preferredAccountTypes)==null?void 0:I.eip155),this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){var t,n,s;this.createAuthProvider(e),this.authProvider&&((s=(n=(t=this.chainAdapters)==null?void 0:t[e])==null?void 0:n.setAuthProvider)==null||s.call(n,this.authProvider))}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&Ee.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){var i,o;if(!e)return;const t=x.state.activeChain,n=e.chainNamespace,s=this.getAddressByChainNamespace(e.chainNamespace);if(e.chainNamespace===x.state.activeChain&&s){const a=this.getAdapter(n),c=qe.getProvider(n),l=qe.getProviderId(n);await(a==null?void 0:a.switchNetwork({caipNetwork:e,provider:c,providerType:l})),this.setCaipNetwork(e)}else{const c=qe.getProviderId(t)===ft.CONNECTOR_TYPE_AUTH,l=qe.getProviderId(n),u=l===ft.CONNECTOR_TYPE_AUTH,d=ee.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n);if((c||u)&&d)try{x.state.activeChain=e.chainNamespace,await((o=(i=this.connectionControllerClient)==null?void 0:i.connectExternal)==null?void 0:o.call(i,{id:ee.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:n,chainId:e.id,type:ft.CONNECTOR_TYPE_AUTH,caipNetwork:e})),this.setCaipNetwork(e)}catch{const f=this.getAdapter(n);await(f==null?void 0:f.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:l}))}else l===ft.CONNECTOR_TYPE_WALLET_CONNECT?(this.setCaipNetwork(e),this.syncWalletConnectAccount()):(this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:n}))}}async initChainAdapter(e){await super.initChainAdapter(e),this.createAuthProviderForAdapter(e)}async syncIdentity({address:e,chainId:t,chainNamespace:n}){var o;const s=`${n}:${t}`,i=(o=this.caipNetworks)==null?void 0:o.find(a=>a.caipNetworkId===s);if(n!==ee.CHAIN.EVM||i!=null&&i.testnet){this.setProfileName(null,n),this.setProfileImage(null,n);return}try{const{name:a,avatar:c}=await this.fetchIdentity({address:e,caipNetworkId:s});this.setProfileName(a,n),this.setProfileImage(c,n)}catch{await this.syncReownName(e,n),t!==1&&this.setProfileImage(null,n)}}syncConnectedWalletInfo(e){const t=qe.getProviderId(e);if(t===ft.CONNECTOR_TYPE_AUTH){const n=this.authProvider;if(n){const s=ie.getConnectedSocialProvider()??"email",i=n.getEmail()??n.getUsername();this.setConnectedWalletInfo({name:t,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(!E1&&ve.isClient()){const e={...hr.DEFAULT_FEATURES,...this.options.features},t=[];if(e&&((e.email||e.socials&&e.socials.length)&&t.push(dn(()=>import("./embedded-wallet-CDUjZTH1.js"),__vite__mapDeps([7,8,1,2,9,10,11,12,13,14,15,16,17,18,3,4,5,6]))),e.email&&t.push(dn(()=>import("./email-BGgvX3q3.js"),__vite__mapDeps([19,8,1,2,18,12,17,11,16,20,13,3,4,5,6]))),e.socials&&t.push(dn(()=>import("./socials-CSe6500F.js"),__vite__mapDeps([21,8,1,2,22,11,23,24,17,25,16,12,18,26,10,3,27,4,5,6]))),e.swaps&&t.push(dn(()=>import("./swaps-zLcQnVP9.js"),__vite__mapDeps([28,8,1,2,16,12,29,30,31,10,17,27,13,11,3,4,5,6]))),e.send&&t.push(dn(()=>import("./send-BHskZs48.js"),__vite__mapDeps([32,8,1,2,16,12,17,11,23,18,31,10,13,33,34,3,4,5,6]))),e.receive&&t.push(dn(()=>import("./receive-B2EiuSey.js"),__vite__mapDeps([35,8,1,2,36,10,26,3,4,5,6]))),e.onramp&&t.push(dn(()=>import("./onramp-qXNy1jep.js"),__vite__mapDeps([37,8,1,2,38,27,17,10,12,39,22,11,23,40,18,16,25,13,3,4,5,6]))),e.history&&t.push(dn(()=>import("./transactions-CygGkv1G.js"),__vite__mapDeps([41,8,1,2,42,38,27,17,18,10,3,4,5,6]))),e.pay&&t.push(dn(()=>import("./index-Cpxi2SpK.js"),__vite__mapDeps([43,8,1,2,16,12,44,10,17,14,39,34,25,3,4,5,6])))),await Promise.all([...t,dn(()=>import("./index-NaQbG-4d.js"),__vite__mapDeps([45,8,1,2,10,12,33,17,46,30,14,39,16,15,44,42,38,27,18,29,11,13,34,20,22,23,24,9,25,36,26,3,40,4,5,6])),dn(()=>import("./w3m-modal-C2Qgs_c_.js"),__vite__mapDeps([47,8,1,2,14,10,17,15,12,30,46,3,4,5,6]))]),!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!G.state.disableAppend&&!G.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}E1=!0}}}let so;function bz(r){r&&(so=r)}function Ez(r){const{providers:e,providerIds:t}=l0(qe.state),n=e[r],s=t[r];return{walletProvider:n,walletProviderType:s}}function vz(){if(!so)throw new Error('Please call "createAppKit" before using "useAppKit" hook');async function r(t){await(so==null?void 0:so.open(t))}async function e(){await(so==null?void 0:so.close())}return{open:r,close:e}}const Az="1.7.4";let np;function Cz(r){return np||(np=new wz({...r,sdkVersion:ve.generateSdkVersion(r.adapters??[],"react",Az)}),bz(np)),np}const _z="6.14.0";function Nz(r,e,t){const n=e.split("|").map(i=>i.trim());for(let i=0;i<n.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof r===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${t}`,s.value=r,s}async function Dr(r){const e=Object.keys(r);return(await Promise.all(e.map(n=>Promise.resolve(r[n])))).reduce((n,s,i)=>(n[e[i]]=s,n),{})}function ye(r,e,t){for(let n in e){let s=e[n];const i=t?t[n]:null;i&&Nz(s,i,n),Object.defineProperty(r,n,{enumerable:!0,value:s,writable:!1})}}function al(r){if(r==null)return"null";if(Array.isArray(r))return"[ "+r.map(al).join(", ")+" ]";if(r instanceof Uint8Array){const e="0123456789abcdef";let t="0x";for(let n=0;n<r.length;n++)t+=e[r[n]>>4],t+=e[r[n]&15];return t}if(typeof r=="object"&&typeof r.toJSON=="function")return al(r.toJSON());switch(typeof r){case"boolean":case"symbol":return r.toString();case"bigint":return BigInt(r).toString();case"number":return r.toString();case"string":return JSON.stringify(r);case"object":{const e=Object.keys(r);return e.sort(),"{ "+e.map(t=>`${al(t)}: ${al(r[t])}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function dr(r,e){return r&&r.code===e}function p0(r){return dr(r,"CALL_EXCEPTION")}function Nt(r,e,t){let n=r;{const i=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${al(t)}`);for(const o in t){if(o==="shortMessage")continue;const a=t[o];i.push(o+"="+al(a))}}i.push(`code=${e}`),i.push(`version=${_z}`),i.length&&(r+=" ("+i.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(r);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(r);break;default:s=new Error(r)}return ye(s,{code:e}),t&&Object.assign(s,t),s.shortMessage==null&&ye(s,{shortMessage:n}),s}function q(r,e,t,n){if(!r)throw Nt(e,t,n)}function R(r,e,t,n){q(r,e,"INVALID_ARGUMENT",{argument:t,value:n})}function nS(r,e,t){t==null&&(t=""),t&&(t=": "+t),q(r>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:r,expectedCount:e}),q(r<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:r,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((r,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"é".normalize("NFD")!=="é")throw new Error("broken");r.push(e)}catch{}return r},[]);function bf(r,e,t){if(t==null&&(t=""),r!==e){let n=t,s="new";t&&(n+=".",s+=" "+t),q(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function sS(r,e,t){if(r instanceof Uint8Array)return t?new Uint8Array(r):r;if(typeof r=="string"&&r.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const n=new Uint8Array((r.length-2)/2);let s=2;for(let i=0;i<n.length;i++)n[i]=parseInt(r.substring(s,s+2),16),s+=2;return n}R(!1,"invalid BytesLike value",e||"value",r)}function Be(r,e){return sS(r,e,!1)}function kr(r,e){return sS(r,e,!0)}function pt(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&r.length!==2+2*e||e===!0&&r.length%2!==0)}function g0(r){return pt(r,!0)||r instanceof Uint8Array}const v1="0123456789abcdef";function re(r){const e=Be(r);let t="0x";for(let n=0;n<e.length;n++){const s=e[n];t+=v1[(s&240)>>4]+v1[s&15]}return t}function Rt(r){return"0x"+r.map(e=>re(e).substring(2)).join("")}function yl(r){return pt(r,!0)?(r.length-2)/2:Be(r).length}function Ot(r,e,t){const n=Be(r);return t!=null&&t>n.length&&q(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:t}),re(n.slice(e??0,t??n.length))}function iS(r,e,t){const n=Be(r);q(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),t?s.set(n,e-n.length):s.set(n,0),re(s)}function Fi(r,e){return iS(r,e,!0)}function Iz(r,e){return iS(r,e,!1)}const Qg=BigInt(0),ls=BigInt(1),Gw=9007199254740991;function ig(r,e){const t=Zg(r,"value"),n=BigInt(Re(e,"width"));if(q(t>>n===Qg,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:r}),t>>n-ls){const s=(ls<<n)-ls;return-((~t&s)+ls)}return t}function oS(r,e){let t=he(r,"value");const n=BigInt(Re(e,"width")),s=ls<<n-ls;if(t<Qg){t=-t,q(t<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});const i=(ls<<n)-ls;return(~t&i)+ls}else q(t<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});return t}function Ea(r,e){const t=Zg(r,"value"),n=BigInt(Re(e,"bits"));return t&(ls<<n)-ls}function he(r,e){switch(typeof r){case"bigint":return r;case"number":return R(Number.isInteger(r),"underflow",e||"value",r),R(r>=-9007199254740991&&r<=Gw,"overflow",e||"value",r),BigInt(r);case"string":try{if(r==="")throw new Error("empty string");return r[0]==="-"&&r[1]!=="-"?-BigInt(r.substring(1)):BigInt(r)}catch(t){R(!1,`invalid BigNumberish string: ${t.message}`,e||"value",r)}}R(!1,"invalid BigNumberish value",e||"value",r)}function Zg(r,e){const t=he(r,e);return q(t>=Qg,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:r}),t}const A1="0123456789abcdef";function Xg(r){if(r instanceof Uint8Array){let e="0x0";for(const t of r)e+=A1[t>>4],e+=A1[t&15];return BigInt(e)}return he(r)}function Re(r,e){switch(typeof r){case"bigint":return R(r>=-9007199254740991&&r<=Gw,"overflow",e||"value",r),Number(r);case"number":return R(Number.isInteger(r),"underflow",e||"value",r),R(r>=-9007199254740991&&r<=Gw,"overflow",e||"value",r),r;case"string":try{if(r==="")throw new Error("empty string");return Re(BigInt(r),e)}catch(t){R(!1,`invalid numeric string: ${t.message}`,e||"value",r)}}R(!1,"invalid numeric value",e||"value",r)}function Sz(r){return Re(Xg(r))}function jo(r,e){let n=Zg(r,"value").toString(16);if(e==null)n.length%2&&(n="0"+n);else{const s=Re(e,"width");for(q(s*2>=n.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:r});n.length<s*2;)n="0"+n}return"0x"+n}function fr(r){const e=Zg(r,"value");if(e===Qg)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);const n=new Uint8Array(t.length/2);for(let s=0;s<n.length;s++){const i=s*2;n[s]=parseInt(t.substring(i,i+2),16)}return n}function Ri(r){let e=re(g0(r)?r:fr(r)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const C1="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const _1=BigInt(58);function xz(r){const e=Be(r);let t=Xg(e),n="";for(;t;)n=C1[Number(t%_1)]+n,t/=_1;for(let s=0;s<e.length&&!e[s];s++)n=C1[0]+n;return n}function Tz(r){r=atob(r);const e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return Be(e)}function Pz(r){const e=Be(r);let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}var Al;class aS{constructor(e,t,n){$(this,"filter");$(this,"emitter");M(this,Al);_(this,Al,t),ye(this,{emitter:e,filter:n})}async removeListener(){y(this,Al)!=null&&await this.emitter.off(this.filter,y(this,Al))}}Al=new WeakMap;function Oz(r,e,t,n,s){R(!1,`invalid codepoint at offset ${e}; ${r}`,"bytes",t)}function cS(r,e,t,n,s){if(r==="BAD_PREFIX"||r==="UNEXPECTED_CONTINUE"){let i=0;for(let o=e+1;o<t.length&&t[o]>>6===2;o++)i++;return i}return r==="OVERRUN"?t.length-e-1:0}function Rz(r,e,t,n,s){return r==="OVERLONG"?(R(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),n.push(s),0):(n.push(65533),cS(r,e,t))}const Dz=Object.freeze({error:Oz,ignore:cS,replace:Rz});function kz(r,e){e==null&&(e=Dz.error);const t=Be(r,"bytes"),n=[];let s=0;for(;s<t.length;){const i=t[s++];if(!(i>>7)){n.push(i);continue}let o=null,a=null;if((i&224)===192)o=1,a=127;else if((i&240)===224)o=2,a=2047;else if((i&248)===240)o=3,a=65535;else{(i&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,t,n):s+=e("BAD_PREFIX",s-1,t,n);continue}if(s-1+o>=t.length){s+=e("OVERRUN",s-1,t,n);continue}let c=i&(1<<8-o-1)-1;for(let l=0;l<o;l++){let u=t[s];if((u&192)!=128){s+=e("MISSING_CONTINUE",s,t,n),c=null;break}c=c<<6|u&63,s++}if(c!==null){if(c>1114111){s+=e("OUT_OF_RANGE",s-1-o,t,n,c);continue}if(c>=55296&&c<=57343){s+=e("UTF16_SURROGATE",s-1-o,t,n,c);continue}if(c<=a){s+=e("OVERLONG",s-1-o,t,n,c);continue}n.push(c)}}return n}function Ws(r,e){R(typeof r=="string","invalid string value","str",r);let t=[];for(let n=0;n<r.length;n++){const s=r.charCodeAt(n);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){n++;const i=r.charCodeAt(n);R(n<r.length&&(i&64512)===56320,"invalid surrogate pair","str",r);const o=65536+((s&1023)<<10)+(i&1023);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return new Uint8Array(t)}function Uz(r){return r.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function og(r,e){return Uz(kz(r,e))}function lS(r){async function e(t,n){q(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const s=t.url.split(":")[0].toLowerCase();q(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),q(s==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,a=setTimeout(()=>{i=Nt("request timeout","TIMEOUT"),o.abort()},t.timeout);n&&n.addListener(()=>{i=Nt("request cancelled","CANCELLED"),o.abort()});const c=Object.assign({},r,{method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:o.signal});let l;try{l=await fetch(t.url,c)}catch(f){throw clearTimeout(a),i||f}clearTimeout(a);const u={};l.headers.forEach((f,g)=>{u[g.toLowerCase()]=f});const d=await l.arrayBuffer(),h=d==null?null:new Uint8Array(d);return{statusCode:l.status,statusMessage:l.statusText,headers:u,body:h}}return e}const Bz=12,Lz=250;let N1=lS();const $z=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),Mz=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let Ty=!1;async function uS(r,e){try{const t=r.match($z);if(!t)throw new Error("invalid data");return new Lo(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?Tz(t[3]):jz(t[3]))}catch{return new Lo(599,"BAD REQUEST (invalid data: URI)",{},null,new ji(r))}}function dS(r){async function e(t,n){try{const s=t.match(Mz);if(!s)throw new Error("invalid link");return new ji(`${r}${s[2]}`)}catch{return new Lo(599,"BAD REQUEST (invalid IPFS URI)",{},null,new ji(t))}}return e}const sp={data:uS,ipfs:dS("https://gateway.ipfs.io/ipfs/")},hS=new WeakMap;var _a,fo;class Fz{constructor(e){M(this,_a);M(this,fo);_(this,_a,[]),_(this,fo,!1),hS.set(e,()=>{if(!y(this,fo)){_(this,fo,!0);for(const t of y(this,_a))setTimeout(()=>{t()},0);_(this,_a,[])}})}addListener(e){q(!y(this,fo),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),y(this,_a).push(e)}get cancelled(){return y(this,fo)}checkSignal(){q(!this.cancelled,"cancelled","CANCELLED",{})}}_a=new WeakMap,fo=new WeakMap;function ip(r){if(r==null)throw new Error("missing signal; should not happen");return r.checkSignal(),r}var Cl,_l,ts,mi,Nl,Il,Jt,pn,yi,Na,Ia,Sa,xs,rs,po,xa,Ed;const bg=class bg{constructor(e){M(this,xa);M(this,Cl);M(this,_l);M(this,ts);M(this,mi);M(this,Nl);M(this,Il);M(this,Jt);M(this,pn);M(this,yi);M(this,Na);M(this,Ia);M(this,Sa);M(this,xs);M(this,rs);M(this,po);_(this,Il,String(e)),_(this,Cl,!1),_(this,_l,!0),_(this,ts,{}),_(this,mi,""),_(this,Nl,3e5),_(this,rs,{slotInterval:Lz,maxAttempts:Bz}),_(this,po,null)}get url(){return y(this,Il)}set url(e){_(this,Il,String(e))}get body(){return y(this,Jt)==null?null:new Uint8Array(y(this,Jt))}set body(e){if(e==null)_(this,Jt,void 0),_(this,pn,void 0);else if(typeof e=="string")_(this,Jt,Ws(e)),_(this,pn,"text/plain");else if(e instanceof Uint8Array)_(this,Jt,e),_(this,pn,"application/octet-stream");else if(typeof e=="object")_(this,Jt,Ws(JSON.stringify(e))),_(this,pn,"application/json");else throw new Error("invalid body")}hasBody(){return y(this,Jt)!=null}get method(){return y(this,mi)?y(this,mi):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),_(this,mi,String(e).toUpperCase())}get headers(){const e=Object.assign({},y(this,ts));return y(this,yi)&&(e.authorization=`Basic ${Pz(Ws(y(this,yi)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&y(this,pn)&&(e["content-type"]=y(this,pn)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){y(this,ts)[String(e).toLowerCase()]=String(t)}clearHeaders(){_(this,ts,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return y(this,yi)||null}setCredentials(e,t){R(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),_(this,yi,`${e}:${t}`)}get allowGzip(){return y(this,_l)}set allowGzip(e){_(this,_l,!!e)}get allowInsecureAuthentication(){return!!y(this,Cl)}set allowInsecureAuthentication(e){_(this,Cl,!!e)}get timeout(){return y(this,Nl)}set timeout(e){R(e>=0,"timeout must be non-zero","timeout",e),_(this,Nl,e)}get preflightFunc(){return y(this,Na)||null}set preflightFunc(e){_(this,Na,e)}get processFunc(){return y(this,Ia)||null}set processFunc(e){_(this,Ia,e)}get retryFunc(){return y(this,Sa)||null}set retryFunc(e){_(this,Sa,e)}get getUrlFunc(){return y(this,po)||N1}set getUrlFunc(e){_(this,po,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${y(this,Jt)?re(y(this,Jt)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(y(this,rs).slotInterval=e.slotInterval),e.maxAttempts!=null&&(y(this,rs).maxAttempts=e.maxAttempts)}send(){return q(y(this,xs)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),_(this,xs,new Fz(this)),W(this,xa,Ed).call(this,0,I1()+this.timeout,0,this,new Lo(0,"",{},null,this))}cancel(){q(y(this,xs)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=hS.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),n=e.split(":")[0].toLowerCase();q(this.method==="GET"&&(t!=="https"||n!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new bg(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,_(s,ts,Object.assign({},y(this,ts))),y(this,Jt)&&_(s,Jt,new Uint8Array(y(this,Jt))),_(s,pn,y(this,pn)),s}clone(){const e=new bg(this.url);return _(e,mi,y(this,mi)),y(this,Jt)&&_(e,Jt,y(this,Jt)),_(e,pn,y(this,pn)),_(e,ts,Object.assign({},y(this,ts))),_(e,yi,y(this,yi)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),_(e,Na,y(this,Na)),_(e,Ia,y(this,Ia)),_(e,Sa,y(this,Sa)),_(e,rs,Object.assign({},y(this,rs))),_(e,po,y(this,po)),e}static lockConfig(){Ty=!0}static getGateway(e){return sp[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(Ty)throw new Error("gateways locked");sp[e]=t}static registerGetUrl(e){if(Ty)throw new Error("gateways locked");N1=e}static createGetUrlFunc(e){return lS(e)}static createDataGateway(){return uS}static createIpfsGatewayFunc(e){return dS(e)}};Cl=new WeakMap,_l=new WeakMap,ts=new WeakMap,mi=new WeakMap,Nl=new WeakMap,Il=new WeakMap,Jt=new WeakMap,pn=new WeakMap,yi=new WeakMap,Na=new WeakMap,Ia=new WeakMap,Sa=new WeakMap,xs=new WeakMap,rs=new WeakMap,po=new WeakMap,xa=new WeakSet,Ed=async function(e,t,n,s,i){var u,d,h;if(e>=y(this,rs).maxAttempts)return i.makeServerError("exceeded maximum retry limit");q(I1()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),n>0&&await Hz(n);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in sp){const f=await sp[a](o.url,ip(y(s,xs)));if(f instanceof Lo){let g=f;if(this.processFunc){ip(y(s,xs));try{g=await this.processFunc(o,g)}catch(p){(p.throttle==null||typeof p.stall!="number")&&g.makeServerError("error in post-processing function",p).assertOk()}}return g}o=f}this.preflightFunc&&(o=await this.preflightFunc(o));const c=await this.getUrlFunc(o,ip(y(s,xs)));let l=new Lo(c.statusCode,c.statusMessage,c.headers,c.body,s);if(l.statusCode===301||l.statusCode===302){try{const f=l.headers.location||"";return W(u=o.redirect(f),xa,Ed).call(u,e+1,t,0,s,l)}catch{}return l}else if(l.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,l,e))){const f=l.headers["retry-after"];let g=y(this,rs).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof f=="string"&&f.match(/^[1-9][0-9]*$/)&&(g=parseInt(f)),W(d=o.clone(),xa,Ed).call(d,e+1,t,g,s,l)}if(this.processFunc){ip(y(s,xs));try{l=await this.processFunc(o,l)}catch(f){(f.throttle==null||typeof f.stall!="number")&&l.makeServerError("error in post-processing function",f).assertOk();let g=y(this,rs).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return f.stall>=0&&(g=f.stall),W(h=o.clone(),xa,Ed).call(h,e+1,t,g,s,l)}}return l};let ji=bg;var Hh,zh,qh,gn,Sl,Ta;const k0=class k0{constructor(e,t,n,s,i){M(this,Hh);M(this,zh);M(this,qh);M(this,gn);M(this,Sl);M(this,Ta);_(this,Hh,e),_(this,zh,t),_(this,qh,Object.keys(n).reduce((o,a)=>(o[a.toLowerCase()]=String(n[a]),o),{})),_(this,gn,s==null?null:new Uint8Array(s)),_(this,Sl,i||null),_(this,Ta,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${y(this,gn)?re(y(this,gn)):"null"}>`}get statusCode(){return y(this,Hh)}get statusMessage(){return y(this,zh)}get headers(){return Object.assign({},y(this,qh))}get body(){return y(this,gn)==null?null:new Uint8Array(y(this,gn))}get bodyText(){try{return y(this,gn)==null?"":og(y(this,gn))}catch{q(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{q(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let n;e?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new k0(599,n,this.headers,this.body,y(this,Sl)||void 0);return _(s,Ta,{message:e,error:t}),s}throwThrottleError(e,t){t==null?t=-1:R(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const n=new Error(e||"throttling requests");throw ye(n,{stall:t,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return y(this,gn)!=null}get request(){return y(this,Sl)}ok(){return y(this,Ta).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=y(this,Ta);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let s=null;try{y(this,gn)&&(s=og(y(this,gn)))}catch{}q(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:n,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};Hh=new WeakMap,zh=new WeakMap,qh=new WeakMap,gn=new WeakMap,Sl=new WeakMap,Ta=new WeakMap;let Lo=k0;function I1(){return new Date().getTime()}function jz(r){return Ws(r.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function Hz(r){return new Promise(e=>setTimeout(e,r))}const zz=BigInt(-1),Zn=BigInt(0),cl=BigInt(1),qz=BigInt(5),Kc={};let wl="0000";for(;wl.length<80;)wl+=wl;function ea(r){let e=wl;for(;e.length<r;)e+=e;return BigInt("1"+e.substring(0,r))}function hd(r,e,t){const n=BigInt(e.width);if(e.signed){const s=cl<<n-cl;q(t==null||r>=-s&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r>Zn?r=ig(Ea(r,n),n):r=-ig(Ea(-r,n),n)}else{const s=cl<<n;q(t==null||r>=0&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r=(r%s+s)%s&s-cl}return r}function Py(r){typeof r=="number"&&(r=`fixed128x${r}`);let e=!0,t=128,n=18;if(typeof r=="string"){if(r!=="fixed")if(r==="ufixed")e=!1;else{const i=r.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);R(i,"invalid fixed format","format",r),e=i[1]!=="u",t=parseInt(i[2]),n=parseInt(i[3])}}else if(r){const i=r,o=(a,c,l)=>i[a]==null?l:(R(typeof i[a]===c,"invalid fixed format ("+a+" not "+c+")","format."+a,i[a]),i[a]);e=o("signed","boolean",e),t=o("width","number",t),n=o("decimals","number",n)}R(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),R(n<=80,"invalid FixedNumber decimals (too large)","format.decimals",n);const s=(e?"":"u")+"fixed"+String(t)+"x"+String(n);return{signed:e,width:t,decimals:n,name:s}}function Vz(r,e){let t="";r<Zn&&(t="-",r*=zz);let n=r.toString();if(e===0)return t+n;for(;n.length<=e;)n=wl+n;const s=n.length-e;for(n=n.substring(0,s)+"."+n.substring(s);n[0]==="0"&&n[1]!==".";)n=n.substring(1);for(;n[n.length-1]==="0"&&n[n.length-2]!==".";)n=n.substring(0,n.length-1);return t+n}var ns,ot,Or,tt,ia,di,Kw,Jw,Yw,Qw;const co=class co{constructor(e,t,n){M(this,tt);$(this,"format");M(this,ns);M(this,ot);M(this,Or);$(this,"_value");bf(e,Kc,"FixedNumber"),_(this,ot,t),_(this,ns,n);const s=Vz(t,n.decimals);ye(this,{format:n.name,_value:s}),_(this,Or,ea(n.decimals))}get signed(){return y(this,ns).signed}get width(){return y(this,ns).width}get decimals(){return y(this,ns).decimals}get value(){return y(this,ot)}addUnsafe(e){return W(this,tt,Kw).call(this,e)}add(e){return W(this,tt,Kw).call(this,e,"add")}subUnsafe(e){return W(this,tt,Jw).call(this,e)}sub(e){return W(this,tt,Jw).call(this,e,"sub")}mulUnsafe(e){return W(this,tt,Yw).call(this,e)}mul(e){return W(this,tt,Yw).call(this,e,"mul")}mulSignal(e){W(this,tt,ia).call(this,e);const t=y(this,ot)*y(e,ot);return q(t%y(this,Or)===Zn,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),W(this,tt,di).call(this,t/y(this,Or),"mulSignal")}divUnsafe(e){return W(this,tt,Qw).call(this,e)}div(e){return W(this,tt,Qw).call(this,e,"div")}divSignal(e){q(y(e,ot)!==Zn,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),W(this,tt,ia).call(this,e);const t=y(this,ot)*y(this,Or);return q(t%y(e,ot)===Zn,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),W(this,tt,di).call(this,t/y(e,ot),"divSignal")}cmp(e){let t=this.value,n=e.value;const s=this.decimals-e.decimals;return s>0?n*=ea(s):s<0&&(t*=ea(-s)),t<n?-1:t>n?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=y(this,ot);return y(this,ot)<Zn&&(e-=y(this,Or)-cl),e=y(this,ot)/y(this,Or)*y(this,Or),W(this,tt,di).call(this,e,"floor")}ceiling(){let e=y(this,ot);return y(this,ot)>Zn&&(e+=y(this,Or)-cl),e=y(this,ot)/y(this,Or)*y(this,Or),W(this,tt,di).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const t=this.decimals-e,n=qz*ea(t-1);let s=this.value+n;const i=ea(t);return s=s/i*i,hd(s,y(this,ns),"round"),new co(Kc,s,y(this,ns))}isZero(){return y(this,ot)===Zn}isNegative(){return y(this,ot)<Zn}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return co.fromString(this.toString(),e)}static fromValue(e,t,n){const s=t==null?0:Re(t),i=Py(n);let o=he(e,"value");const a=s-i.decimals;if(a>0){const c=ea(a);q(o%c===Zn,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=c}else a<0&&(o*=ea(-a));return hd(o,i,"fromValue"),new co(Kc,o,i)}static fromString(e,t){const n=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);R(n&&n[2].length+n[3].length>0,"invalid FixedNumber string value","value",e);const s=Py(t);let i=n[2]||"0",o=n[3]||"";for(;o.length<s.decimals;)o+=wl;q(o.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,s.decimals);const a=BigInt(n[1]+i+o);return hd(a,s,"fromString"),new co(Kc,a,s)}static fromBytes(e,t){let n=Xg(Be(e,"value"));const s=Py(t);return s.signed&&(n=ig(n,s.width)),hd(n,s,"fromBytes"),new co(Kc,n,s)}};ns=new WeakMap,ot=new WeakMap,Or=new WeakMap,tt=new WeakSet,ia=function(e){R(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},di=function(e,t){return e=hd(e,y(this,ns),t),new co(Kc,e,y(this,ns))},Kw=function(e,t){return W(this,tt,ia).call(this,e),W(this,tt,di).call(this,y(this,ot)+y(e,ot),t)},Jw=function(e,t){return W(this,tt,ia).call(this,e),W(this,tt,di).call(this,y(this,ot)-y(e,ot),t)},Yw=function(e,t){return W(this,tt,ia).call(this,e),W(this,tt,di).call(this,y(this,ot)*y(e,ot)/y(this,Or),t)},Qw=function(e,t){return q(y(e,ot)!==Zn,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),W(this,tt,ia).call(this,e),W(this,tt,di).call(this,y(this,ot)*y(this,Or)/y(e,ot),t)};let ag=co;function Wz(r){let e=r.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function S1(r,e,t){let n=0;for(let s=0;s<t;s++)n=n*256+r[e+s];return n}function x1(r,e,t,n){const s=[];for(;t<e+1+n;){const i=fS(r,t);s.push(i.result),t+=i.consumed,q(t<=e+1+n,"child data too short","BUFFER_OVERRUN",{buffer:r,length:n,offset:e})}return{consumed:1+n,result:s}}function fS(r,e){q(r.length!==0,"data too short","BUFFER_OVERRUN",{buffer:r,length:0,offset:1});const t=n=>{q(n<=r.length,"data short segment too short","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n})};if(r[e]>=248){const n=r[e]-247;t(e+1+n);const s=S1(r,e+1,n);return t(e+1+n+s),x1(r,e,e+1+n,n+s)}else if(r[e]>=192){const n=r[e]-192;return t(e+1+n),x1(r,e,e+1,n)}else if(r[e]>=184){const n=r[e]-183;t(e+1+n);const s=S1(r,e+1,n);t(e+1+n+s);const i=re(r.slice(e+1+n,e+1+n+s));return{consumed:1+n+s,result:i}}else if(r[e]>=128){const n=r[e]-128;t(e+1+n);const s=re(r.slice(e+1,e+1+n));return{consumed:1+n,result:s}}return{consumed:1,result:Wz(r[e])}}function Ef(r){const e=Be(r,"data"),t=fS(e,0);return R(t.consumed===e.length,"unexpected junk after rlp payload","data",r),t.result}function T1(r){const e=[];for(;r;)e.unshift(r&255),r>>=8;return e}function pS(r){if(Array.isArray(r)){let n=[];if(r.forEach(function(i){n=n.concat(pS(i))}),n.length<=55)return n.unshift(192+n.length),n;const s=T1(n.length);return s.unshift(247+s.length),s.concat(n)}const e=Array.prototype.slice.call(Be(r,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=T1(e.length);return t.unshift(183+t.length),t.concat(e)}const P1="0123456789abcdef";function Ho(r){let e="0x";for(const t of pS(r))e+=P1[t>>4],e+=P1[t&15];return e}const gS=["wei","kwei","mwei","gwei","szabo","finney","ether"];function mS(r,e){let t=18;if(typeof e=="string"){const n=gS.indexOf(e);R(n>=0,"invalid unit","unit",e),t=3*n}else e!=null&&(t=Re(e,"unit"));return ag.fromValue(r,t,{decimals:t,width:512}).toString()}function yS(r,e){R(typeof r=="string","value must be a string","value",r);let t=18;if(typeof e=="string"){const n=gS.indexOf(e);R(n>=0,"invalid unit","unit",e),t=3*n}else e!=null&&(t=Re(e,"unit"));return ag.fromString(r,{decimals:t,width:512}).value}function m0(r){return mS(r,18)}function O1(r){return yS(r,18)}const Ur=32,Zw=new Uint8Array(Ur),Gz=["then"],op={},wS=new WeakMap;function da(r){return wS.get(r)}function R1(r,e){wS.set(r,e)}function fd(r,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${r}`);throw t.error=e,t}function Xw(r,e,t){return r.indexOf(null)>=0?e.map((n,s)=>n instanceof Iu?Xw(da(n),n,t):n):r.reduce((n,s,i)=>{let o=e.getValue(s);return s in n||(t&&o instanceof Iu&&(o=Xw(da(o),o,t)),n[s]=o),n},{})}var xl;const ll=class ll extends Array{constructor(...t){const n=t[0];let s=t[1],i=(t[2]||[]).slice(),o=!0;n!==op&&(s=t,i=[],o=!1);super(s.length);M(this,xl);s.forEach((l,u)=>{this[u]=l});const a=i.reduce((l,u)=>(typeof u=="string"&&l.set(u,(l.get(u)||0)+1),l),new Map);if(R1(this,Object.freeze(s.map((l,u)=>{const d=i[u];return d!=null&&a.get(d)===1?d:null}))),_(this,xl,[]),y(this,xl)==null&&y(this,xl),!o)return;Object.freeze(this);const c=new Proxy(this,{get:(l,u,d)=>{if(typeof u=="string"){if(u.match(/^[0-9]+$/)){const f=Re(u,"%index");if(f<0||f>=this.length)throw new RangeError("out of result range");const g=l[f];return g instanceof Error&&fd(`index ${f}`,g),g}if(Gz.indexOf(u)>=0)return Reflect.get(l,u,d);const h=l[u];if(h instanceof Function)return function(...f){return h.apply(this===d?l:this,f)};if(!(u in l))return l.getValue.apply(this===d?l:this,[u])}return Reflect.get(l,u,d)}});return R1(c,da(this)),c}toArray(t){const n=[];return this.forEach((s,i)=>{s instanceof Error&&fd(`index ${i}`,s),t&&s instanceof ll&&(s=s.toArray(t)),n.push(s)}),n}toObject(t){const n=da(this);return n.reduce((s,i,o)=>(q(i!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),Xw(n,this,t)),{})}slice(t,n){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const s=da(this),i=[],o=[];for(let a=t;a<n;a++)i.push(this[a]),o.push(s[a]);return new ll(op,i,o)}filter(t,n){const s=da(this),i=[],o=[];for(let a=0;a<this.length;a++){const c=this[a];c instanceof Error&&fd(`index ${a}`,c),t.call(n,c,a,this)&&(i.push(c),o.push(s[a]))}return new ll(op,i,o)}map(t,n){const s=[];for(let i=0;i<this.length;i++){const o=this[i];o instanceof Error&&fd(`index ${i}`,o),s.push(t.call(n,o,i,this))}return s}getValue(t){const n=da(this).indexOf(t);if(n===-1)return;const s=this[n];return s instanceof Error&&fd(`property ${JSON.stringify(t)}`,s.error),s}static fromItems(t,n){return new ll(op,t,n)}};xl=new WeakMap;let Iu=ll;function D1(r){let e=fr(r);return q(e.length<=Ur,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:Ur,offset:e.length}),e.length!==Ur&&(e=kr(Rt([Zw.slice(e.length%Ur),e]))),e}class zi{constructor(e,t,n,s){$(this,"name");$(this,"type");$(this,"localName");$(this,"dynamic");ye(this,{name:e,type:t,localName:n,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){R(!1,e,this.localName,t)}}var wi,Pa,Tl,Sp;class eb{constructor(){M(this,Tl);M(this,wi);M(this,Pa);_(this,wi,[]),_(this,Pa,0)}get data(){return Rt(y(this,wi))}get length(){return y(this,Pa)}appendWriter(e){return W(this,Tl,Sp).call(this,kr(e.data))}writeBytes(e){let t=kr(e);const n=t.length%Ur;return n&&(t=kr(Rt([t,Zw.slice(n)]))),W(this,Tl,Sp).call(this,t)}writeValue(e){return W(this,Tl,Sp).call(this,D1(e))}writeUpdatableValue(){const e=y(this,wi).length;return y(this,wi).push(Zw),_(this,Pa,y(this,Pa)+Ur),t=>{y(this,wi)[e]=D1(t)}}}wi=new WeakMap,Pa=new WeakMap,Tl=new WeakSet,Sp=function(e){return y(this,wi).push(e),_(this,Pa,y(this,Pa)+e.length),e.length};var Gr,mn,Oa,Ra,go,pc,rb,bS;const U0=class U0{constructor(e,t,n){M(this,pc);$(this,"allowLoose");M(this,Gr);M(this,mn);M(this,Oa);M(this,Ra);M(this,go);ye(this,{allowLoose:!!t}),_(this,Gr,kr(e)),_(this,Oa,0),_(this,Ra,null),_(this,go,n??1024),_(this,mn,0)}get data(){return re(y(this,Gr))}get dataLength(){return y(this,Gr).length}get consumed(){return y(this,mn)}get bytes(){return new Uint8Array(y(this,Gr))}subReader(e){const t=new U0(y(this,Gr).slice(y(this,mn)+e),this.allowLoose,y(this,go));return _(t,Ra,this),t}readBytes(e,t){let n=W(this,pc,bS).call(this,0,e,!!t);return W(this,pc,rb).call(this,e),_(this,mn,y(this,mn)+n.length),n.slice(0,e)}readValue(){return Xg(this.readBytes(Ur))}readIndex(){return Sz(this.readBytes(Ur))}};Gr=new WeakMap,mn=new WeakMap,Oa=new WeakMap,Ra=new WeakMap,go=new WeakMap,pc=new WeakSet,rb=function(e){var t;if(y(this,Ra))return W(t=y(this,Ra),pc,rb).call(t,e);_(this,Oa,y(this,Oa)+e),q(y(this,go)<1||y(this,Oa)<=y(this,go)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${y(this,go)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:kr(y(this,Gr)),offset:y(this,mn),length:e,info:{bytesRead:y(this,Oa),dataLength:this.dataLength}})},bS=function(e,t,n){let s=Math.ceil(t/Ur)*Ur;return y(this,mn)+s>y(this,Gr).length&&(this.allowLoose&&n&&y(this,mn)+t<=y(this,Gr).length?s=t:q(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:kr(y(this,Gr)),length:y(this,Gr).length,offset:y(this,mn)+s})),y(this,Gr).slice(y(this,mn),y(this,mn)+s)};let tb=U0;function cg(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`Wrong positive integer: ${r}`)}function y0(r,...e){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(r.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${r.length}`)}function Kz(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");cg(r.outputLen),cg(r.blockLen)}function Su(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function ES(r,e){y0(r);const t=e.outputLen;if(r.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const Oy=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const vS=r=>r instanceof Uint8Array,Jz=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),Ry=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),Cs=(r,e)=>r<<32-e|r>>>e,Yz=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Yz)throw new Error("Non little-endian hardware is not supported");function Qz(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function em(r){if(typeof r=="string"&&(r=Qz(r)),!vS(r))throw new Error(`expected Uint8Array, got ${typeof r}`);return r}function Zz(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!vS(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}class w0{clone(){return this._cloneInto()}}function b0(r){const e=n=>r().update(em(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Xz(r=32){if(Oy&&typeof Oy.getRandomValues=="function")return Oy.getRandomValues(new Uint8Array(r));throw new Error("crypto.getRandomValues must be defined")}class AS extends w0{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Kz(e);const n=em(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return Su(this),this.iHash.update(e),this}digestInto(e){Su(this),y0(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const CS=(r,e,t)=>new AS(r,e).update(t).digest();CS.create=(r,e)=>new AS(r,e);function eq(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}class _S extends w0{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ry(this.buffer)}update(e){Su(this);const{view:t,buffer:n,blockLen:s}=this;e=em(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Ry(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Su(this),ES(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)t[d]=0;eq(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Ry(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}}const tq=(r,e,t)=>r&e^~r&t,rq=(r,e,t)=>r&e^r&t^e&t,nq=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),eo=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),to=new Uint32Array(64);class sq extends _S{constructor(){super(64,32,8,!1),this.A=eo[0]|0,this.B=eo[1]|0,this.C=eo[2]|0,this.D=eo[3]|0,this.E=eo[4]|0,this.F=eo[5]|0,this.G=eo[6]|0,this.H=eo[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let d=0;d<16;d++,t+=4)to[d]=e.getUint32(t,!1);for(let d=16;d<64;d++){const h=to[d-15],f=to[d-2],g=Cs(h,7)^Cs(h,18)^h>>>3,p=Cs(f,17)^Cs(f,19)^f>>>10;to[d]=p+to[d-7]+g+to[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=Cs(a,6)^Cs(a,11)^Cs(a,25),f=u+h+tq(a,c,l)+nq[d]+to[d]|0,p=(Cs(n,2)^Cs(n,13)^Cs(n,22))+rq(n,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=n,n=f+p|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){to.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const NS=b0(()=>new sq),ap=BigInt(2**32-1),nb=BigInt(32);function IS(r,e=!1){return e?{h:Number(r&ap),l:Number(r>>nb&ap)}:{h:Number(r>>nb&ap)|0,l:Number(r&ap)|0}}function SS(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=IS(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const iq=(r,e)=>BigInt(r>>>0)<<nb|BigInt(e>>>0),oq=(r,e,t)=>r>>>t,aq=(r,e,t)=>r<<32-t|e>>>t,cq=(r,e,t)=>r>>>t|e<<32-t,lq=(r,e,t)=>r<<32-t|e>>>t,uq=(r,e,t)=>r<<64-t|e>>>t-32,dq=(r,e,t)=>r>>>t-32|e<<64-t,hq=(r,e)=>e,fq=(r,e)=>r,xS=(r,e,t)=>r<<t|e>>>32-t,TS=(r,e,t)=>e<<t|r>>>32-t,PS=(r,e,t)=>e<<t-32|r>>>64-t,OS=(r,e,t)=>r<<t-32|e>>>64-t;function pq(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const gq=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),mq=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,yq=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),wq=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,bq=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),Eq=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,Ue={fromBig:IS,split:SS,toBig:iq,shrSH:oq,shrSL:aq,rotrSH:cq,rotrSL:lq,rotrBH:uq,rotrBL:dq,rotr32H:hq,rotr32L:fq,rotlSH:xS,rotlSL:TS,rotlBH:PS,rotlBL:OS,add:pq,add3L:gq,add3H:mq,add4L:yq,add4H:wq,add5H:Eq,add5L:bq},[vq,Aq]=Ue.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),ro=new Uint32Array(80),no=new Uint32Array(80);class Cq extends _S{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:g,Hh:p,Hl:m}=this;return[e,t,n,s,i,o,a,c,l,u,d,h,f,g,p,m]}set(e,t,n,s,i,o,a,c,l,u,d,h,f,g,p,m){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=g|0,this.Hh=p|0,this.Hl=m|0}process(e,t){for(let v=0;v<16;v++,t+=4)ro[v]=e.getUint32(t),no[v]=e.getUint32(t+=4);for(let v=16;v<80;v++){const I=ro[v-15]|0,T=no[v-15]|0,P=Ue.rotrSH(I,T,1)^Ue.rotrSH(I,T,8)^Ue.shrSH(I,T,7),D=Ue.rotrSL(I,T,1)^Ue.rotrSL(I,T,8)^Ue.shrSL(I,T,7),U=ro[v-2]|0,S=no[v-2]|0,H=Ue.rotrSH(U,S,19)^Ue.rotrBH(U,S,61)^Ue.shrSH(U,S,6),L=Ue.rotrSL(U,S,19)^Ue.rotrBL(U,S,61)^Ue.shrSL(U,S,6),j=Ue.add4L(D,L,no[v-7],no[v-16]),Q=Ue.add4H(j,P,H,ro[v-7],ro[v-16]);ro[v]=Q|0,no[v]=j|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:g,Gh:p,Gl:m,Hh:w,Hl:A}=this;for(let v=0;v<80;v++){const I=Ue.rotrSH(d,h,14)^Ue.rotrSH(d,h,18)^Ue.rotrBH(d,h,41),T=Ue.rotrSL(d,h,14)^Ue.rotrSL(d,h,18)^Ue.rotrBL(d,h,41),P=d&f^~d&p,D=h&g^~h&m,U=Ue.add5L(A,T,D,Aq[v],no[v]),S=Ue.add5H(U,w,I,P,vq[v],ro[v]),H=U|0,L=Ue.rotrSH(n,s,28)^Ue.rotrBH(n,s,34)^Ue.rotrBH(n,s,39),j=Ue.rotrSL(n,s,28)^Ue.rotrBL(n,s,34)^Ue.rotrBL(n,s,39),Q=n&i^n&a^i&a,z=s&o^s&c^o&c;w=p|0,A=m|0,p=f|0,m=g|0,f=d|0,g=h|0,{h:d,l:h}=Ue.add(l|0,u|0,S|0,H|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const b=Ue.add3L(H,j,z);n=Ue.add3H(b,S,L,Q),s=b|0}({h:n,l:s}=Ue.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=Ue.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Ue.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Ue.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Ue.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:g}=Ue.add(this.Fh|0,this.Fl|0,f|0,g|0),{h:p,l:m}=Ue.add(this.Gh|0,this.Gl|0,p|0,m|0),{h:w,l:A}=Ue.add(this.Hh|0,this.Hl|0,w|0,A|0),this.set(n,s,i,o,a,c,l,u,d,h,f,g,p,m,w,A)}roundClean(){ro.fill(0),no.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const _q=b0(()=>new Cq);function Nq(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const k1=Nq();k1.crypto||k1.msCrypto;function Iq(r){switch(r){case"sha256":return NS.create();case"sha512":return _q.create()}R(!1,"invalid hashing algorithm name","algorithm",r)}const[RS,DS,kS]=[[],[],[]],Sq=BigInt(0),pd=BigInt(1),xq=BigInt(2),Tq=BigInt(7),Pq=BigInt(256),Oq=BigInt(113);for(let r=0,e=pd,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],RS.push(2*(5*n+t)),DS.push((r+1)*(r+2)/2%64);let s=Sq;for(let i=0;i<7;i++)e=(e<<pd^(e>>Tq)*Oq)%Pq,e&xq&&(s^=pd<<(pd<<BigInt(i))-pd);kS.push(s)}const[Rq,Dq]=SS(kS,!0),U1=(r,e,t)=>t>32?PS(r,e,t):xS(r,e,t),B1=(r,e,t)=>t>32?OS(r,e,t):TS(r,e,t);function kq(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],d=U1(l,u,1)^t[a],h=B1(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)r[o+f]^=d,r[o+f+1]^=h}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=DS[o],c=U1(s,i,a),l=B1(s,i,a),u=RS[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=Rq[n],r[1]^=Dq[n]}t.fill(0)}class E0 extends w0{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,cg(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Jz(this.state)}keccak(){kq(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Su(this);const{blockLen:t,state:n}=this;e=em(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,t&128&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Su(this,!1),y0(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return cg(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(ES(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new E0(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Uq=(r,e,t)=>b0(()=>new E0(e,r,t)),Bq=Uq(1,136,256/8);let US=!1;const BS=function(r){return Bq(r)};let LS=BS;function jt(r){const e=Be(r,"data");return re(LS(e))}jt._=BS;jt.lock=function(){US=!0};jt.register=function(r){if(US)throw new TypeError("keccak256 is locked");LS=r};Object.freeze(jt);const $S=function(r){return Iq("sha256").update(r).digest()};let MS=$S,FS=!1;function qu(r){const e=Be(r,"data");return re(MS(e))}qu._=$S;qu.lock=function(){FS=!0};qu.register=function(r){if(FS)throw new Error("sha256 is locked");MS=r};Object.freeze(qu);Object.freeze(qu);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const jS=BigInt(0),tm=BigInt(1),Lq=BigInt(2),rm=r=>r instanceof Uint8Array,$q=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function xu(r){if(!rm(r))throw new Error("Uint8Array expected");let e="";for(let t=0;t<r.length;t++)e+=$q[r[t]];return e}function HS(r){const e=r.toString(16);return e.length&1?`0${e}`:e}function v0(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return BigInt(r===""?"0":`0x${r}`)}function Tu(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let n=0;n<t.length;n++){const s=n*2,i=r.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[n]=o}return t}function Ja(r){return v0(xu(r))}function A0(r){if(!rm(r))throw new Error("Uint8Array expected");return v0(xu(Uint8Array.from(r).reverse()))}function Pu(r,e){return Tu(r.toString(16).padStart(e*2,"0"))}function C0(r,e){return Pu(r,e).reverse()}function Mq(r){return Tu(HS(r))}function es(r,e,t){let n;if(typeof e=="string")try{n=Tu(e)}catch(i){throw new Error(`${r} must be valid hex string, got "${e}". Cause: ${i}`)}else if(rm(e))n=Uint8Array.from(e);else throw new Error(`${r} must be hex string or Uint8Array`);const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(`${r} expected ${t} bytes, got ${s}`);return n}function Oh(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!rm(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}function Fq(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function jq(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Hq(r){let e;for(e=0;r>jS;r>>=tm,e+=1);return e}function zq(r,e){return r>>BigInt(e)&tm}const qq=(r,e,t)=>r|(t?tm:jS)<<BigInt(e),_0=r=>(Lq<<BigInt(r-1))-tm,Dy=r=>new Uint8Array(r),L1=r=>Uint8Array.from(r);function zS(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=Dy(r),s=Dy(r),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...d)=>t(s,n,...d),c=(d=Dy())=>{s=a(L1([0]),d),n=a(),d.length!==0&&(s=a(L1([1]),d),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const h=[];for(;d<e;){n=a();const f=n.slice();h.push(f),d+=n.length}return Oh(...h)};return(d,h)=>{o(),c(d);let f;for(;!(f=h(l()));)c();return o(),f}}const Vq={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||r instanceof Uint8Array,isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function vf(r,e,t={}){const n=(s,i,o)=>{const a=Vq[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${i}`)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}const Wq=Object.freeze(Object.defineProperty({__proto__:null,bitGet:zq,bitLen:Hq,bitMask:_0,bitSet:qq,bytesToHex:xu,bytesToNumberBE:Ja,bytesToNumberLE:A0,concatBytes:Oh,createHmacDrbg:zS,ensureBytes:es,equalBytes:Fq,hexToBytes:Tu,hexToNumber:v0,numberToBytesBE:Pu,numberToBytesLE:C0,numberToHexUnpadded:HS,numberToVarBytesBE:Mq,utf8ToBytes:jq,validateObject:vf},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const rr=BigInt(0),Lt=BigInt(1),ha=BigInt(2),Gq=BigInt(3),sb=BigInt(4),$1=BigInt(5),M1=BigInt(8);BigInt(9);BigInt(16);function Yr(r,e){const t=r%e;return t>=rr?t:e+t}function Kq(r,e,t){if(t<=rr||e<rr)throw new Error("Expected power/modulo > 0");if(t===Lt)return rr;let n=Lt;for(;e>rr;)e&Lt&&(n=n*r%t),r=r*r%t,e>>=Lt;return n}function Tn(r,e,t){let n=r;for(;e-- >rr;)n*=n,n%=t;return n}function ib(r,e){if(r===rr||e<=rr)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=Yr(r,e),n=e,s=rr,i=Lt;for(;t!==rr;){const a=n/t,c=n%t,l=s-i*a;n=t,t=c,s=i,i=l}if(n!==Lt)throw new Error("invert: does not exist");return Yr(s,e)}function Jq(r){const e=(r-Lt)/ha;let t,n,s;for(t=r-Lt,n=0;t%ha===rr;t/=ha,n++);for(s=ha;s<r&&Kq(s,e,r)!==r-Lt;s++);if(n===1){const o=(r+Lt)/sb;return function(c,l){const u=c.pow(l,o);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}const i=(t+Lt)/ha;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=n,u=a.pow(a.mul(a.ONE,s),t),d=a.pow(c,i),h=a.pow(c,t);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let f=1;for(let p=a.sqr(h);f<l&&!a.eql(p,a.ONE);f++)p=a.sqr(p);const g=a.pow(u,Lt<<BigInt(l-f-1));u=a.sqr(g),d=a.mul(d,g),h=a.mul(h,u),l=f}return d}}function Yq(r){if(r%sb===Gq){const e=(r+Lt)/sb;return function(n,s){const i=n.pow(s,e);if(!n.eql(n.sqr(i),s))throw new Error("Cannot find square root");return i}}if(r%M1===$1){const e=(r-$1)/M1;return function(n,s){const i=n.mul(s,ha),o=n.pow(i,e),a=n.mul(s,o),c=n.mul(n.mul(a,ha),o),l=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(l),s))throw new Error("Cannot find square root");return l}}return Jq(r)}const Qq=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Zq(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=Qq.reduce((n,s)=>(n[s]="function",n),e);return vf(r,t)}function Xq(r,e,t){if(t<rr)throw new Error("Expected power > 0");if(t===rr)return r.ONE;if(t===Lt)return e;let n=r.ONE,s=e;for(;t>rr;)t&Lt&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Lt;return n}function eV(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function qS(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function tV(r,e,t=!1,n={}){if(r<=rr)throw new Error(`Expected Field ORDER > 0, got ${r}`);const{nBitLength:s,nByteLength:i}=qS(r,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=Yq(r),a=Object.freeze({ORDER:r,BITS:s,BYTES:i,MASK:_0(s),ZERO:rr,ONE:Lt,create:c=>Yr(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return rr<=c&&c<r},is0:c=>c===rr,isOdd:c=>(c&Lt)===Lt,neg:c=>Yr(-c,r),eql:(c,l)=>c===l,sqr:c=>Yr(c*c,r),add:(c,l)=>Yr(c+l,r),sub:(c,l)=>Yr(c-l,r),mul:(c,l)=>Yr(c*l,r),pow:(c,l)=>Xq(a,c,l),div:(c,l)=>Yr(c*ib(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>ib(c,r),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>eV(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?C0(c,i):Pu(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return t?A0(c):Ja(c)}});return Object.freeze(a)}function VS(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function WS(r){const e=VS(r);return e+Math.ceil(e/2)}function rV(r,e,t=!1){const n=r.length,s=VS(e),i=WS(e);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);const o=t?Ja(r):A0(r),a=Yr(o,e-Lt)+Lt;return t?C0(a,s):Pu(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const nV=BigInt(0),ky=BigInt(1);function sV(r,e){const t=(s,i)=>{const o=i.negate();return s?o:i},n=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:t,unsafeLadder(s,i){let o=r.ZERO,a=s;for(;i>nV;)i&ky&&(o=o.add(a)),a=a.double(),i>>=ky;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=n(i),c=[];let l=s,u=l;for(let d=0;d<o;d++){u=l,c.push(u);for(let h=1;h<a;h++)u=u.add(l),c.push(u);l=u.double()}return c},wNAF(s,i,o){const{windows:a,windowSize:c}=n(s);let l=r.ZERO,u=r.BASE;const d=BigInt(2**s-1),h=2**s,f=BigInt(s);for(let g=0;g<a;g++){const p=g*c;let m=Number(o&d);o>>=f,m>c&&(m-=h,o+=ky);const w=p,A=p+Math.abs(m)-1,v=g%2!==0,I=m<0;m===0?u=u.add(t(v,i[w])):l=l.add(t(I,i[A]))}return{p:l,f:u}},wNAFCached(s,i,o,a){const c=s._WINDOW_SIZE||1;let l=i.get(s);return l||(l=this.precomputeWindow(s,c),c!==1&&i.set(s,a(l))),this.wNAF(c,l,o)}}}function GS(r){return Zq(r.Fp),vf(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...qS(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function iV(r){const e=GS(r);vf(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:oV,hexToBytes:aV}=Wq,va={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(r){const{Err:e}=va;if(r.length<2||r[0]!==2)throw new e("Invalid signature integer tag");const t=r[1],n=r.subarray(2,t+2);if(!t||n.length!==t)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:oV(n),l:r.subarray(t+2)}},toSig(r){const{Err:e}=va,t=typeof r=="string"?aV(r):r;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let n=t.length;if(n<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=va._parseInt(t.subarray(2)),{d:o,l:a}=va._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(r){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,t=l=>{const u=l.toString(16);return u.length&1?`0${u}`:u},n=e(t(r.s)),s=e(t(r.r)),i=n.length/2,o=s.length/2,a=t(i),c=t(o);return`30${t(o+i+4)}02${c}${s}02${a}${n}`}},Ti=BigInt(0),Mn=BigInt(1);BigInt(2);const F1=BigInt(3);BigInt(4);function cV(r){const e=iV(r),{Fp:t}=e,n=e.toBytes||((g,p,m)=>{const w=p.toAffine();return Oh(Uint8Array.from([4]),t.toBytes(w.x),t.toBytes(w.y))}),s=e.fromBytes||(g=>{const p=g.subarray(1),m=t.fromBytes(p.subarray(0,t.BYTES)),w=t.fromBytes(p.subarray(t.BYTES,2*t.BYTES));return{x:m,y:w}});function i(g){const{a:p,b:m}=e,w=t.sqr(g),A=t.mul(w,g);return t.add(t.add(A,t.mul(g,p)),m)}if(!t.eql(t.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(g){return typeof g=="bigint"&&Ti<g&&g<e.n}function a(g){if(!o(g))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(g){const{allowedPrivateKeyLengths:p,nByteLength:m,wrapPrivateKey:w,n:A}=e;if(p&&typeof g!="bigint"){if(g instanceof Uint8Array&&(g=xu(g)),typeof g!="string"||!p.includes(g.length))throw new Error("Invalid key");g=g.padStart(m*2,"0")}let v;try{v=typeof g=="bigint"?g:Ja(es("private key",g,m))}catch{throw new Error(`private key must be ${m} bytes, hex or bigint, not ${typeof g}`)}return w&&(v=Yr(v,A)),a(v),v}const l=new Map;function u(g){if(!(g instanceof d))throw new Error("ProjectivePoint expected")}class d{constructor(p,m,w){if(this.px=p,this.py=m,this.pz=w,p==null||!t.isValid(p))throw new Error("x required");if(m==null||!t.isValid(m))throw new Error("y required");if(w==null||!t.isValid(w))throw new Error("z required")}static fromAffine(p){const{x:m,y:w}=p||{};if(!p||!t.isValid(m)||!t.isValid(w))throw new Error("invalid affine point");if(p instanceof d)throw new Error("projective point not allowed");const A=v=>t.eql(v,t.ZERO);return A(m)&&A(w)?d.ZERO:new d(m,w,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){const m=t.invertBatch(p.map(w=>w.pz));return p.map((w,A)=>w.toAffine(m[A])).map(d.fromAffine)}static fromHex(p){const m=d.fromAffine(s(es("pointHex",p)));return m.assertValidity(),m}static fromPrivateKey(p){return d.BASE.multiply(c(p))}_setWindowSize(p){this._WINDOW_SIZE=p,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:p,y:m}=this.toAffine();if(!t.isValid(p)||!t.isValid(m))throw new Error("bad point: x or y not FE");const w=t.sqr(m),A=i(p);if(!t.eql(w,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:p}=this.toAffine();if(t.isOdd)return!t.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){u(p);const{px:m,py:w,pz:A}=this,{px:v,py:I,pz:T}=p,P=t.eql(t.mul(m,T),t.mul(v,A)),D=t.eql(t.mul(w,T),t.mul(I,A));return P&&D}negate(){return new d(this.px,t.neg(this.py),this.pz)}double(){const{a:p,b:m}=e,w=t.mul(m,F1),{px:A,py:v,pz:I}=this;let T=t.ZERO,P=t.ZERO,D=t.ZERO,U=t.mul(A,A),S=t.mul(v,v),H=t.mul(I,I),L=t.mul(A,v);return L=t.add(L,L),D=t.mul(A,I),D=t.add(D,D),T=t.mul(p,D),P=t.mul(w,H),P=t.add(T,P),T=t.sub(S,P),P=t.add(S,P),P=t.mul(T,P),T=t.mul(L,T),D=t.mul(w,D),H=t.mul(p,H),L=t.sub(U,H),L=t.mul(p,L),L=t.add(L,D),D=t.add(U,U),U=t.add(D,U),U=t.add(U,H),U=t.mul(U,L),P=t.add(P,U),H=t.mul(v,I),H=t.add(H,H),U=t.mul(H,L),T=t.sub(T,U),D=t.mul(H,S),D=t.add(D,D),D=t.add(D,D),new d(T,P,D)}add(p){u(p);const{px:m,py:w,pz:A}=this,{px:v,py:I,pz:T}=p;let P=t.ZERO,D=t.ZERO,U=t.ZERO;const S=e.a,H=t.mul(e.b,F1);let L=t.mul(m,v),j=t.mul(w,I),Q=t.mul(A,T),z=t.add(m,w),b=t.add(v,I);z=t.mul(z,b),b=t.add(L,j),z=t.sub(z,b),b=t.add(m,A);let E=t.add(v,T);return b=t.mul(b,E),E=t.add(L,Q),b=t.sub(b,E),E=t.add(w,A),P=t.add(I,T),E=t.mul(E,P),P=t.add(j,Q),E=t.sub(E,P),U=t.mul(S,b),P=t.mul(H,Q),U=t.add(P,U),P=t.sub(j,U),U=t.add(j,U),D=t.mul(P,U),j=t.add(L,L),j=t.add(j,L),Q=t.mul(S,Q),b=t.mul(H,b),j=t.add(j,Q),Q=t.sub(L,Q),Q=t.mul(S,Q),b=t.add(b,Q),L=t.mul(j,b),D=t.add(D,L),L=t.mul(E,b),P=t.mul(z,P),P=t.sub(P,L),L=t.mul(z,j),U=t.mul(E,U),U=t.add(U,L),new d(P,D,U)}subtract(p){return this.add(p.negate())}is0(){return this.equals(d.ZERO)}wNAF(p){return f.wNAFCached(this,l,p,m=>{const w=t.invertBatch(m.map(A=>A.pz));return m.map((A,v)=>A.toAffine(w[v])).map(d.fromAffine)})}multiplyUnsafe(p){const m=d.ZERO;if(p===Ti)return m;if(a(p),p===Mn)return this;const{endo:w}=e;if(!w)return f.unsafeLadder(this,p);let{k1neg:A,k1:v,k2neg:I,k2:T}=w.splitScalar(p),P=m,D=m,U=this;for(;v>Ti||T>Ti;)v&Mn&&(P=P.add(U)),T&Mn&&(D=D.add(U)),U=U.double(),v>>=Mn,T>>=Mn;return A&&(P=P.negate()),I&&(D=D.negate()),D=new d(t.mul(D.px,w.beta),D.py,D.pz),P.add(D)}multiply(p){a(p);let m=p,w,A;const{endo:v}=e;if(v){const{k1neg:I,k1:T,k2neg:P,k2:D}=v.splitScalar(m);let{p:U,f:S}=this.wNAF(T),{p:H,f:L}=this.wNAF(D);U=f.constTimeNegate(I,U),H=f.constTimeNegate(P,H),H=new d(t.mul(H.px,v.beta),H.py,H.pz),w=U.add(H),A=S.add(L)}else{const{p:I,f:T}=this.wNAF(m);w=I,A=T}return d.normalizeZ([w,A])[0]}multiplyAndAddUnsafe(p,m,w){const A=d.BASE,v=(T,P)=>P===Ti||P===Mn||!T.equals(A)?T.multiplyUnsafe(P):T.multiply(P),I=v(this,m).add(v(p,w));return I.is0()?void 0:I}toAffine(p){const{px:m,py:w,pz:A}=this,v=this.is0();p==null&&(p=v?t.ONE:t.inv(A));const I=t.mul(m,p),T=t.mul(w,p),P=t.mul(A,p);if(v)return{x:t.ZERO,y:t.ZERO};if(!t.eql(P,t.ONE))throw new Error("invZ was invalid");return{x:I,y:T}}isTorsionFree(){const{h:p,isTorsionFree:m}=e;if(p===Mn)return!0;if(m)return m(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:p,clearCofactor:m}=e;return p===Mn?this:m?m(d,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),n(d,this,p)}toHex(p=!0){return xu(this.toRawBytes(p))}}d.BASE=new d(e.Gx,e.Gy,t.ONE),d.ZERO=new d(t.ZERO,t.ONE,t.ZERO);const h=e.nBitLength,f=sV(d,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}function lV(r){const e=GS(r);return vf(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function uV(r){const e=lV(r),{Fp:t,n}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o(b){return Ti<b&&b<t.ORDER}function a(b){return Yr(b,n)}function c(b){return ib(b,n)}const{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:d,isWithinCurveOrder:h}=cV({...e,toBytes(b,E,O){const B=E.toAffine(),k=t.toBytes(B.x),F=Oh;return O?F(Uint8Array.from([E.hasEvenY()?2:3]),k):F(Uint8Array.from([4]),k,t.toBytes(B.y))},fromBytes(b){const E=b.length,O=b[0],B=b.subarray(1);if(E===s&&(O===2||O===3)){const k=Ja(B);if(!o(k))throw new Error("Point is not on curve");const F=d(k);let K=t.sqrt(F);const Z=(K&Mn)===Mn;return(O&1)===1!==Z&&(K=t.neg(K)),{x:k,y:K}}else if(E===i&&O===4){const k=t.fromBytes(B.subarray(0,t.BYTES)),F=t.fromBytes(B.subarray(t.BYTES,2*t.BYTES));return{x:k,y:F}}else throw new Error(`Point of length ${E} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),f=b=>xu(Pu(b,e.nByteLength));function g(b){const E=n>>Mn;return b>E}function p(b){return g(b)?a(-b):b}const m=(b,E,O)=>Ja(b.slice(E,O));class w{constructor(E,O,B){this.r=E,this.s=O,this.recovery=B,this.assertValidity()}static fromCompact(E){const O=e.nByteLength;return E=es("compactSignature",E,O*2),new w(m(E,0,O),m(E,O,2*O))}static fromDER(E){const{r:O,s:B}=va.toSig(es("DER",E));return new w(O,B)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(E){return new w(this.r,this.s,E)}recoverPublicKey(E){const{r:O,s:B,recovery:k}=this,F=D(es("msgHash",E));if(k==null||![0,1,2,3].includes(k))throw new Error("recovery id invalid");const K=k===2||k===3?O+e.n:O;if(K>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const Z=k&1?"03":"02",se=l.fromHex(Z+f(K)),J=c(K),ge=a(-F*J),_e=a(B*J),$e=l.BASE.multiplyAndAddUnsafe(se,ge,_e);if(!$e)throw new Error("point at infinify");return $e.assertValidity(),$e}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Tu(this.toDERHex())}toDERHex(){return va.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Tu(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const A={isValidPrivateKey(b){try{return u(b),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const b=WS(e.n);return rV(e.randomBytes(b),e.n)},precompute(b=8,E=l.BASE){return E._setWindowSize(b),E.multiply(BigInt(3)),E}};function v(b,E=!0){return l.fromPrivateKey(b).toRawBytes(E)}function I(b){const E=b instanceof Uint8Array,O=typeof b=="string",B=(E||O)&&b.length;return E?B===s||B===i:O?B===2*s||B===2*i:b instanceof l}function T(b,E,O=!0){if(I(b))throw new Error("first arg must be private key");if(!I(E))throw new Error("second arg must be public key");return l.fromHex(E).multiply(u(b)).toRawBytes(O)}const P=e.bits2int||function(b){const E=Ja(b),O=b.length*8-e.nBitLength;return O>0?E>>BigInt(O):E},D=e.bits2int_modN||function(b){return a(P(b))},U=_0(e.nBitLength);function S(b){if(typeof b!="bigint")throw new Error("bigint expected");if(!(Ti<=b&&b<U))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Pu(b,e.nByteLength)}function H(b,E,O=L){if(["recovered","canonical"].some(Ie=>Ie in O))throw new Error("sign() legacy options not supported");const{hash:B,randomBytes:k}=e;let{lowS:F,prehash:K,extraEntropy:Z}=O;F==null&&(F=!0),b=es("msgHash",b),K&&(b=es("prehashed msgHash",B(b)));const se=D(b),J=u(E),ge=[S(J),S(se)];if(Z!=null){const Ie=Z===!0?k(t.BYTES):Z;ge.push(es("extraEntropy",Ie))}const _e=Oh(...ge),$e=se;function Oe(Ie){const Ct=P(Ie);if(!h(Ct))return;const Tt=c(Ct),Et=l.BASE.multiply(Ct).toAffine(),it=a(Et.x);if(it===Ti)return;const ut=a(Tt*a($e+it*J));if(ut===Ti)return;let xr=(Et.x===it?0:2)|Number(Et.y&Mn),Wu=ut;return F&&g(ut)&&(Wu=p(ut),xr^=1),new w(it,Wu,xr)}return{seed:_e,k2sig:Oe}}const L={lowS:e.lowS,prehash:!1},j={lowS:e.lowS,prehash:!1};function Q(b,E,O=L){const{seed:B,k2sig:k}=H(b,E,O),F=e;return zS(F.hash.outputLen,F.nByteLength,F.hmac)(B,k)}l.BASE._setWindowSize(8);function z(b,E,O,B=j){var Et;const k=b;if(E=es("msgHash",E),O=es("publicKey",O),"strict"in B)throw new Error("options.strict was renamed to lowS");const{lowS:F,prehash:K}=B;let Z,se;try{if(typeof k=="string"||k instanceof Uint8Array)try{Z=w.fromDER(k)}catch(it){if(!(it instanceof va.Err))throw it;Z=w.fromCompact(k)}else if(typeof k=="object"&&typeof k.r=="bigint"&&typeof k.s=="bigint"){const{r:it,s:ut}=k;Z=new w(it,ut)}else throw new Error("PARSE");se=l.fromHex(O)}catch(it){if(it.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(F&&Z.hasHighS())return!1;K&&(E=e.hash(E));const{r:J,s:ge}=Z,_e=D(E),$e=c(ge),Oe=a(_e*$e),Ie=a(J*$e),Ct=(Et=l.BASE.multiplyAndAddUnsafe(se,Oe,Ie))==null?void 0:Et.toAffine();return Ct?a(Ct.x)===J:!1}return{CURVE:e,getPublicKey:v,getSharedSecret:T,sign:Q,verify:z,ProjectivePoint:l,Signature:w,utils:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function dV(r){return{hash:r,hmac:(e,...t)=>CS(r,e,Zz(...t)),randomBytes:Xz}}function hV(r,e){const t=n=>uV({...r,...dV(n)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const KS=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),j1=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),fV=BigInt(1),ob=BigInt(2),H1=(r,e)=>(r+e/ob)/e;function pV(r){const e=KS,t=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=r*r*r%e,u=l*l*r%e,d=Tn(u,t,e)*u%e,h=Tn(d,t,e)*u%e,f=Tn(h,ob,e)*l%e,g=Tn(f,s,e)*f%e,p=Tn(g,i,e)*g%e,m=Tn(p,a,e)*p%e,w=Tn(m,c,e)*m%e,A=Tn(w,a,e)*p%e,v=Tn(A,t,e)*u%e,I=Tn(v,o,e)*g%e,T=Tn(I,n,e)*l%e,P=Tn(T,ob,e);if(!ab.eql(ab.sqr(P),r))throw new Error("Cannot find square root");return P}const ab=tV(KS,void 0,void 0,{sqrt:pV}),io=hV({a:BigInt(0),b:BigInt(7),Fp:ab,n:j1,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{const e=j1,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-fV*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,o=BigInt("0x100000000000000000000000000000000"),a=H1(i*r,e),c=H1(-n*r,e);let l=Yr(r-a*t-c*s,e),u=Yr(-a*n-c*i,e);const d=l>o,h=u>o;if(d&&(l=e-l),h&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:d,k1:l,k2neg:h,k2:u}}}},NS);BigInt(0);io.ProjectivePoint;const Rh="0x0000000000000000000000000000000000000000",z1="0x0000000000000000000000000000000000000000000000000000000000000000",q1=BigInt(0),V1=BigInt(1),W1=BigInt(2),G1=BigInt(27),K1=BigInt(28),cp=BigInt(35),Jc={};function J1(r){return Fi(fr(r),32)}var Pl,Ol,Rl,Da;const Xn=class Xn{constructor(e,t,n,s){M(this,Pl);M(this,Ol);M(this,Rl);M(this,Da);bf(e,Jc,"Signature"),_(this,Pl,t),_(this,Ol,n),_(this,Rl,s),_(this,Da,null)}get r(){return y(this,Pl)}set r(e){R(yl(e)===32,"invalid r","value",e),_(this,Pl,re(e))}get s(){return y(this,Ol)}set s(e){R(yl(e)===32,"invalid s","value",e);const t=re(e);R(parseInt(t.substring(0,3))<8,"non-canonical s","value",t),_(this,Ol,t)}get v(){return y(this,Rl)}set v(e){const t=Re(e,"value");R(t===27||t===28,"invalid v","v",e),_(this,Rl,t)}get networkV(){return y(this,Da)}get legacyChainId(){const e=this.networkV;return e==null?null:Xn.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=Be(this.s);return this.yParity&&(e[0]|=128),re(e)}get compactSerialized(){return Rt([this.r,this.yParityAndS])}get serialized(){return Rt([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this.s}", yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new Xn(Jc,this.r,this.s,this.v);return this.networkV&&_(e,Da,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this.s,v:this.v}}static getChainId(e){const t=he(e,"v");return t==G1||t==K1?q1:(R(t>=cp,"invalid EIP-155 v","v",e),(t-cp)/W1)}static getChainIdV(e,t){return he(e)*W1+BigInt(35+t-27)}static getNormalizedV(e){const t=he(e);return t===q1||t===G1?27:t===V1||t===K1?28:(R(t>=cp,"invalid v","v",e),t&V1?27:28)}static from(e){function t(l,u){R(l,u,"signature",e)}if(e==null)return new Xn(Jc,z1,z1,27);if(typeof e=="string"){const l=Be(e,"signature");if(l.length===64){const u=re(l.slice(0,32)),d=l.slice(32,64),h=d[0]&128?28:27;return d[0]&=127,new Xn(Jc,u,re(d),h)}if(l.length===65){const u=re(l.slice(0,32)),d=l.slice(32,64);t((d[0]&128)===0,"non-canonical s");const h=Xn.getNormalizedV(l[64]);return new Xn(Jc,u,re(d),h)}t(!1,"invalid raw signature length")}if(e instanceof Xn)return e.clone();const n=e.r;t(n!=null,"missing r");const s=J1(n),i=function(l,u){if(l!=null)return J1(l);if(u!=null){t(pt(u,32),"invalid yParityAndS");const d=Be(u);return d[0]&=127,re(d)}t(!1,"missing s")}(e.s,e.yParityAndS);t((Be(i)[0]&128)==0,"non-canonical s");const{networkV:o,v:a}=function(l,u,d){if(l!=null){const h=he(l);return{networkV:h>=cp?h:void 0,v:Xn.getNormalizedV(h)}}if(u!=null)return t(pt(u,32),"invalid yParityAndS"),{v:Be(u)[0]&128?28:27};if(d!=null){switch(Re(d,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),c=new Xn(Jc,s,i,a);return o&&_(c,Da,o),t(e.yParity==null||Re(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}};Pl=new WeakMap,Ol=new WeakMap,Rl=new WeakMap,Da=new WeakMap;let Xr=Xn;var bi;const fa=class fa{constructor(e){M(this,bi);R(yl(e)===32,"invalid private key","privateKey","[REDACTED]"),_(this,bi,re(e))}get privateKey(){return y(this,bi)}get publicKey(){return fa.computePublicKey(y(this,bi))}get compressedPublicKey(){return fa.computePublicKey(y(this,bi),!0)}sign(e){R(yl(e)===32,"invalid digest length","digest",e);const t=io.sign(kr(e),kr(y(this,bi)),{lowS:!0});return Xr.from({r:jo(t.r,32),s:jo(t.s,32),v:t.recovery?28:27})}computeSharedSecret(e){const t=fa.computePublicKey(e);return re(io.getSharedSecret(kr(y(this,bi)),Be(t),!1))}static computePublicKey(e,t){let n=Be(e,"key");if(n.length===32){const i=io.getPublicKey(n,!!t);return re(i)}if(n.length===64){const i=new Uint8Array(65);i[0]=4,i.set(n,1),n=i}const s=io.ProjectivePoint.fromHex(n);return re(s.toRawBytes(t))}static recoverPublicKey(e,t){R(yl(e)===32,"invalid digest length","digest",e);const n=Xr.from(t);let s=io.Signature.fromCompact(kr(Rt([n.r,n.s])));s=s.addRecoveryBit(n.yParity);const i=s.recoverPublicKey(kr(e));return R(i!=null,"invalid signature for digest","signature",t),"0x"+i.toHex(!1)}static addPoints(e,t,n){const s=io.ProjectivePoint.fromHex(fa.computePublicKey(e).substring(2)),i=io.ProjectivePoint.fromHex(fa.computePublicKey(t).substring(2));return"0x"+s.add(i).toHex(!!n)}};bi=new WeakMap;let Dh=fa;const gV=BigInt(0),mV=BigInt(36);function Y1(r){r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const n=Be(jt(t));for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(n[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const N0={};for(let r=0;r<10;r++)N0[String(r)]=String(r);for(let r=0;r<26;r++)N0[String.fromCharCode(65+r)]=String(10+r);const Q1=15;function yV(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(n=>N0[n]).join("");for(;e.length>=Q1;){let n=e.substring(0,Q1);e=parseInt(n,10)%97+e.substring(n.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const wV=function(){const r={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];r[t]=BigInt(e)}return r}();function bV(r){r=r.toLowerCase();let e=gV;for(let t=0;t<r.length;t++)e=e*mV+wV[r[t]];return e}function rt(r){if(R(typeof r=="string","invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/)){r.startsWith("0x")||(r="0x"+r);const e=Y1(r);return R(!r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===r,"bad address checksum","address",r),e}if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){R(r.substring(2,4)===yV(r),"bad icap checksum","address",r);let e=bV(r.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return Y1("0x"+e)}R(!1,"invalid address","address",r)}function EV(r){const e=rt(r.from);let n=he(r.nonce,"tx.nonce").toString(16);return n==="0"?n="0x":n.length%2?n="0x0"+n:n="0x"+n,rt(Ot(jt(Ho([e,n])),12))}function JS(r){return r&&typeof r.getAddress=="function"}async function Uy(r,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(q(typeof r!="string","unconfigured name","UNCONFIGURED_NAME",{value:r}),R(!1,"invalid AddressLike value; did not resolve to a value address","target",r)),rt(t)}function Br(r,e){if(typeof r=="string")return r.match(/^0x[0-9a-f]{40}$/i)?rt(r):(q(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),Uy(r,e.resolveName(r)));if(JS(r))return Uy(r,r.getAddress());if(r&&typeof r.then=="function")return Uy(r,r);R(!1,"unsupported addressable value","target",r)}const hi={};function ue(r,e){let t=!1;return e<0&&(t=!0,e*=-1),new _r(hi,`${t?"":"u"}int${e}`,r,{signed:t,width:e})}function Ke(r,e){return new _r(hi,`bytes${e||""}`,r,{size:e})}const Z1=Symbol.for("_ethers_typed");var ka;const fi=class fi{constructor(e,t,n,s){$(this,"type");$(this,"value");M(this,ka);$(this,"_typedSymbol");s==null&&(s=null),bf(hi,e,"Typed"),ye(this,{_typedSymbol:Z1,type:t,value:n}),_(this,ka,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return y(this,ka)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return y(this,ka)===!0?-1:y(this,ka)===!1?this.value.length:null}static from(e,t){return new fi(hi,e,t)}static uint8(e){return ue(e,8)}static uint16(e){return ue(e,16)}static uint24(e){return ue(e,24)}static uint32(e){return ue(e,32)}static uint40(e){return ue(e,40)}static uint48(e){return ue(e,48)}static uint56(e){return ue(e,56)}static uint64(e){return ue(e,64)}static uint72(e){return ue(e,72)}static uint80(e){return ue(e,80)}static uint88(e){return ue(e,88)}static uint96(e){return ue(e,96)}static uint104(e){return ue(e,104)}static uint112(e){return ue(e,112)}static uint120(e){return ue(e,120)}static uint128(e){return ue(e,128)}static uint136(e){return ue(e,136)}static uint144(e){return ue(e,144)}static uint152(e){return ue(e,152)}static uint160(e){return ue(e,160)}static uint168(e){return ue(e,168)}static uint176(e){return ue(e,176)}static uint184(e){return ue(e,184)}static uint192(e){return ue(e,192)}static uint200(e){return ue(e,200)}static uint208(e){return ue(e,208)}static uint216(e){return ue(e,216)}static uint224(e){return ue(e,224)}static uint232(e){return ue(e,232)}static uint240(e){return ue(e,240)}static uint248(e){return ue(e,248)}static uint256(e){return ue(e,256)}static uint(e){return ue(e,256)}static int8(e){return ue(e,-8)}static int16(e){return ue(e,-16)}static int24(e){return ue(e,-24)}static int32(e){return ue(e,-32)}static int40(e){return ue(e,-40)}static int48(e){return ue(e,-48)}static int56(e){return ue(e,-56)}static int64(e){return ue(e,-64)}static int72(e){return ue(e,-72)}static int80(e){return ue(e,-80)}static int88(e){return ue(e,-88)}static int96(e){return ue(e,-96)}static int104(e){return ue(e,-104)}static int112(e){return ue(e,-112)}static int120(e){return ue(e,-120)}static int128(e){return ue(e,-128)}static int136(e){return ue(e,-136)}static int144(e){return ue(e,-144)}static int152(e){return ue(e,-152)}static int160(e){return ue(e,-160)}static int168(e){return ue(e,-168)}static int176(e){return ue(e,-176)}static int184(e){return ue(e,-184)}static int192(e){return ue(e,-192)}static int200(e){return ue(e,-200)}static int208(e){return ue(e,-208)}static int216(e){return ue(e,-216)}static int224(e){return ue(e,-224)}static int232(e){return ue(e,-232)}static int240(e){return ue(e,-240)}static int248(e){return ue(e,-248)}static int256(e){return ue(e,-256)}static int(e){return ue(e,-256)}static bytes1(e){return Ke(e,1)}static bytes2(e){return Ke(e,2)}static bytes3(e){return Ke(e,3)}static bytes4(e){return Ke(e,4)}static bytes5(e){return Ke(e,5)}static bytes6(e){return Ke(e,6)}static bytes7(e){return Ke(e,7)}static bytes8(e){return Ke(e,8)}static bytes9(e){return Ke(e,9)}static bytes10(e){return Ke(e,10)}static bytes11(e){return Ke(e,11)}static bytes12(e){return Ke(e,12)}static bytes13(e){return Ke(e,13)}static bytes14(e){return Ke(e,14)}static bytes15(e){return Ke(e,15)}static bytes16(e){return Ke(e,16)}static bytes17(e){return Ke(e,17)}static bytes18(e){return Ke(e,18)}static bytes19(e){return Ke(e,19)}static bytes20(e){return Ke(e,20)}static bytes21(e){return Ke(e,21)}static bytes22(e){return Ke(e,22)}static bytes23(e){return Ke(e,23)}static bytes24(e){return Ke(e,24)}static bytes25(e){return Ke(e,25)}static bytes26(e){return Ke(e,26)}static bytes27(e){return Ke(e,27)}static bytes28(e){return Ke(e,28)}static bytes29(e){return Ke(e,29)}static bytes30(e){return Ke(e,30)}static bytes31(e){return Ke(e,31)}static bytes32(e){return Ke(e,32)}static address(e){return new fi(hi,"address",e)}static bool(e){return new fi(hi,"bool",!!e)}static bytes(e){return new fi(hi,"bytes",e)}static string(e){return new fi(hi,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new fi(hi,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===Z1}static dereference(e,t){if(fi.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};ka=new WeakMap;let _r=fi;class vV extends zi{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let n=_r.dereference(t,"string");try{n=rt(n)}catch(s){return this._throwError(s.message,t)}return e.writeValue(n)}decode(e){return rt(jo(e.readValue(),20))}}class AV extends zi{constructor(t){super(t.name,t.type,"_",t.dynamic);$(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,n){return this.coder.encode(t,n)}decode(t){return this.coder.decode(t)}}function YS(r,e,t){let n=[];if(Array.isArray(t))n=t;else if(t&&typeof t=="object"){let c={};n=e.map(l=>{const u=l.localName;return q(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),q(!c[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),c[u]=!0,t[u]})}else R(!1,"invalid tuple value","tuple",t);R(e.length===n.length,"types/value length mismatch","tuple",t);let s=new eb,i=new eb,o=[];e.forEach((c,l)=>{let u=n[l];if(c.dynamic){let d=i.length;c.encode(i,u);let h=s.writeUpdatableValue();o.push(f=>{h(f+d)})}else c.encode(s,u)}),o.forEach(c=>{c(s.length)});let a=r.appendWriter(s);return a+=r.appendWriter(i),a}function QS(r,e){let t=[],n=[],s=r.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let a=r.readIndex(),c=s.subReader(a);try{o=i.decode(c)}catch(l){if(dr(l,"BUFFER_OVERRUN"))throw l;o=l,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(r)}catch(a){if(dr(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");t.push(o),n.push(i.localName||null)}),Iu.fromItems(t,n)}class CV extends zi{constructor(t,n,s){const i=t.type+"["+(n>=0?n:"")+"]",o=n===-1||t.dynamic;super("array",i,s,o);$(this,"coder");$(this,"length");ye(this,{coder:t,length:n})}defaultValue(){const t=this.coder.defaultValue(),n=[];for(let s=0;s<this.length;s++)n.push(t);return n}encode(t,n){const s=_r.dereference(n,"array");Array.isArray(s)||this._throwError("expected array value",s);let i=this.length;i===-1&&(i=s.length,t.writeValue(s.length)),nS(s.length,i,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let a=0;a<s.length;a++)o.push(this.coder);return YS(t,o,s)}decode(t){let n=this.length;n===-1&&(n=t.readIndex(),q(n*Ur<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:n*Ur,length:t.dataLength}));let s=[];for(let i=0;i<n;i++)s.push(new AV(this.coder));return QS(t,s)}}class _V extends zi{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const n=_r.dereference(t,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class ZS extends zi{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=kr(t);let n=e.writeValue(t.length);return n+=e.writeBytes(t),n}decode(e){return e.readBytes(e.readIndex(),!0)}}class NV extends ZS{constructor(e){super("bytes",e)}decode(e){return re(super.decode(e))}}class IV extends zi{constructor(t,n){let s="bytes"+String(t);super(s,s,n,!1);$(this,"size");ye(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,n){let s=kr(_r.dereference(n,this.type));return s.length!==this.size&&this._throwError("incorrect data length",n),t.writeBytes(s)}decode(t){return re(t.readBytes(this.size))}}const SV=new Uint8Array([]);class xV extends zi{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(SV)}decode(e){return e.readBytes(0),null}}const TV=BigInt(0),PV=BigInt(1),OV=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class RV extends zi{constructor(t,n,s){const i=(n?"int":"uint")+t*8;super(i,i,s,!1);$(this,"size");$(this,"signed");ye(this,{size:t,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,n){let s=he(_r.dereference(n,this.type)),i=Ea(OV,Ur*8);if(this.signed){let o=Ea(i,this.size*8-1);(s>o||s<-(o+PV))&&this._throwError("value out-of-bounds",n),s=oS(s,8*Ur)}else(s<TV||s>Ea(i,this.size*8))&&this._throwError("value out-of-bounds",n);return t.writeValue(s)}decode(t){let n=Ea(t.readValue(),this.size*8);return this.signed&&(n=ig(n,this.size*8)),n}}class DV extends ZS{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Ws(_r.dereference(t,"string")))}decode(e){return og(super.decode(e))}}class lp extends zi{constructor(t,n){let s=!1;const i=[];t.forEach(a=>{a.dynamic&&(s=!0),i.push(a.type)});const o="tuple("+i.join(",")+")";super("tuple",o,n,s);$(this,"coders");ye(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(s=>{t.push(s.defaultValue())});const n=this.coders.reduce((s,i)=>{const o=i.localName;return o&&(s[o]||(s[o]=0),s[o]++),s},{});return this.coders.forEach((s,i)=>{let o=s.localName;!o||n[o]!==1||(o==="length"&&(o="_length"),t[o]==null&&(t[o]=t[i]))}),Object.freeze(t)}encode(t,n){const s=_r.dereference(n,"tuple");return YS(t,this.coders,s)}decode(t){return QS(t,this.coders)}}function By(r,e){return{address:rt(r),storageKeys:e.map((t,n)=>(R(pt(t,32),"invalid slot",`storageKeys[${n}]`,t),t.toLowerCase()))}}function Cc(r){if(Array.isArray(r))return r.map((t,n)=>Array.isArray(t)?(R(t.length===2,"invalid slot set",`value[${n}]`,t),By(t[0],t[1])):(R(t!=null&&typeof t=="object","invalid address-slot set","value",r),By(t.address,t.storageKeys)));R(r!=null&&typeof r=="object","invalid access list","value",r);const e=Object.keys(r).map(t=>{const n=r[t].reduce((s,i)=>(s[i]=!0,s),{});return By(t,Object.keys(n).sort())});return e.sort((t,n)=>t.address.localeCompare(n.address)),e}function XS(r){return{address:rt(r.address),nonce:he(r.nonce!=null?r.nonce:0),chainId:he(r.chainId!=null?r.chainId:0),signature:Xr.from(r.signature)}}function kV(r){let e;return typeof r=="string"?e=Dh.computePublicKey(r,!1):e=r.publicKey,rt(jt("0x"+e.substring(4)).substring(26))}function UV(r,e){return kV(Dh.recoverPublicKey(r,e))}const Qt=BigInt(0),BV=BigInt(2),LV=BigInt(27),$V=BigInt(28),MV=BigInt(35),FV=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Ly=4096*32;function jV(r){return{blobToKzgCommitment:n=>{if("computeBlobProof"in r){if("blobToKzgCommitment"in r&&typeof r.blobToKzgCommitment=="function")return Be(r.blobToKzgCommitment(re(n)))}else if("blobToKzgCommitment"in r&&typeof r.blobToKzgCommitment=="function")return Be(r.blobToKzgCommitment(n));if("blobToKZGCommitment"in r&&typeof r.blobToKZGCommitment=="function")return Be(r.blobToKZGCommitment(re(n)));R(!1,"unsupported KZG library","kzg",r)},computeBlobKzgProof:(n,s)=>{if("computeBlobProof"in r&&typeof r.computeBlobProof=="function")return Be(r.computeBlobProof(re(n),re(s)));if("computeBlobKzgProof"in r&&typeof r.computeBlobKzgProof=="function")return r.computeBlobKzgProof(n,s);if("computeBlobKZGProof"in r&&typeof r.computeBlobKZGProof=="function")return Be(r.computeBlobKZGProof(re(n),re(s)));R(!1,"unsupported KZG library","kzg",r)}}}function X1(r,e){let t=r.toString(16);for(;t.length<2;)t="0"+t;return t+=qu(e).substring(4),"0x"+t}function Vu(r){return r==="0x"?null:rt(r)}function nm(r,e){try{return Cc(r)}catch(t){R(!1,t.message,e,r)}}function HV(r,e){try{if(!Array.isArray(r))throw new Error("authorizationList: invalid array");const t=[];for(let n=0;n<r.length;n++){const s=r[n];if(!Array.isArray(s))throw new Error(`authorization[${n}]: invalid array`);if(s.length!==6)throw new Error(`authorization[${n}]: wrong length`);if(!s[1])throw new Error(`authorization[${n}]: null address`);t.push({address:Vu(s[1]),nonce:ct(s[2],"nonce"),chainId:ct(s[0],"chainId"),signature:Xr.from({yParity:_c(s[3],"yParity"),r:Fi(s[4],32),s:Fi(s[5],32)})})}return t}catch(t){R(!1,t.message,e,r)}}function _c(r,e){return r==="0x"?0:Re(r,e)}function ct(r,e){if(r==="0x")return Qt;const t=he(r,e);return R(t<=FV,"value exceeds uint size",e,t),t}function ze(r,e){const t=he(r,"value"),n=fr(t);return R(n.length<=32,"value too large",`tx.${e}`,t),n}function sm(r){return Cc(r).map(e=>[e.address,e.storageKeys])}function zV(r){return r.map(e=>[ze(e.chainId,"chainId"),e.address,ze(e.nonce,"nonce"),ze(e.signature.yParity,"yParity"),e.signature.r,e.signature.s])}function qV(r,e){R(Array.isArray(r),`invalid ${e}`,"value",r);for(let t=0;t<r.length;t++)R(pt(r[t],32),"invalid ${ param } hash",`value[${t}]`,r[t]);return r}function VV(r){const e=Ef(r);R(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",r);const t={type:0,nonce:_c(e[0],"nonce"),gasPrice:ct(e[1],"gasPrice"),gasLimit:ct(e[2],"gasLimit"),to:Vu(e[3]),value:ct(e[4],"value"),data:re(e[5]),chainId:Qt};if(e.length===6)return t;const n=ct(e[6],"v"),s=ct(e[7],"r"),i=ct(e[8],"s");if(s===Qt&&i===Qt)t.chainId=n;else{let o=(n-MV)/BV;o<Qt&&(o=Qt),t.chainId=o,R(o!==Qt||n===LV||n===$V,"non-canonical legacy v","v",e[6]),t.signature=Xr.from({r:Fi(e[7],32),s:Fi(e[8],32),v:n})}return t}function WV(r,e){const t=[ze(r.nonce,"nonce"),ze(r.gasPrice||0,"gasPrice"),ze(r.gasLimit,"gasLimit"),r.to||"0x",ze(r.value,"value"),r.data];let n=Qt;if(r.chainId!=Qt)n=he(r.chainId,"tx.chainId"),R(!e||e.networkV==null||e.legacyChainId===n,"tx.chainId/sig.v mismatch","sig",e);else if(r.signature){const i=r.signature.legacyChainId;i!=null&&(n=i)}if(!e)return n!==Qt&&(t.push(fr(n)),t.push("0x"),t.push("0x")),Ho(t);let s=BigInt(27+e.yParity);return n!==Qt?s=Xr.getChainIdV(n,e.v):BigInt(e.v)!==s&&R(!1,"tx.chainId/sig.v mismatch","sig",e),t.push(fr(s)),t.push(fr(e.r)),t.push(fr(e.s)),Ho(t)}function im(r,e){let t;try{if(t=_c(e[0],"yParity"),t!==0&&t!==1)throw new Error("bad yParity")}catch{R(!1,"invalid yParity","yParity",e[0])}const n=Fi(e[1],32),s=Fi(e[2],32),i=Xr.from({r:n,s,yParity:t});r.signature=i}function GV(r){const e=Ef(Be(r).slice(1));R(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",re(r));const t={type:2,chainId:ct(e[0],"chainId"),nonce:_c(e[1],"nonce"),maxPriorityFeePerGas:ct(e[2],"maxPriorityFeePerGas"),maxFeePerGas:ct(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:ct(e[4],"gasLimit"),to:Vu(e[5]),value:ct(e[6],"value"),data:re(e[7]),accessList:nm(e[8],"accessList")};return e.length===9||im(t,e.slice(9)),t}function KV(r,e){const t=[ze(r.chainId,"chainId"),ze(r.nonce,"nonce"),ze(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ze(r.maxFeePerGas||0,"maxFeePerGas"),ze(r.gasLimit,"gasLimit"),r.to||"0x",ze(r.value,"value"),r.data,sm(r.accessList||[])];return e&&(t.push(ze(e.yParity,"yParity")),t.push(fr(e.r)),t.push(fr(e.s))),Rt(["0x02",Ho(t)])}function JV(r){const e=Ef(Be(r).slice(1));R(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",re(r));const t={type:1,chainId:ct(e[0],"chainId"),nonce:_c(e[1],"nonce"),gasPrice:ct(e[2],"gasPrice"),gasLimit:ct(e[3],"gasLimit"),to:Vu(e[4]),value:ct(e[5],"value"),data:re(e[6]),accessList:nm(e[7],"accessList")};return e.length===8||im(t,e.slice(8)),t}function YV(r,e){const t=[ze(r.chainId,"chainId"),ze(r.nonce,"nonce"),ze(r.gasPrice||0,"gasPrice"),ze(r.gasLimit,"gasLimit"),r.to||"0x",ze(r.value,"value"),r.data,sm(r.accessList||[])];return e&&(t.push(ze(e.yParity,"recoveryParam")),t.push(fr(e.r)),t.push(fr(e.s))),Rt(["0x01",Ho(t)])}function QV(r){let e=Ef(Be(r).slice(1)),t="3",n=null;if(e.length===4&&Array.isArray(e[0])){t="3 (network format)";const i=e[1],o=e[2],a=e[3];R(Array.isArray(i),"invalid network format: blobs not an array","fields[1]",i),R(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),R(Array.isArray(a),"invalid network format: proofs not an array","fields[3]",a),R(i.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),R(i.length===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),n=[];for(let c=0;c<e[1].length;c++)n.push({data:i[c],commitment:o[c],proof:a[c]});e=e[0]}R(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${t}`,"data",re(r));const s={type:3,chainId:ct(e[0],"chainId"),nonce:_c(e[1],"nonce"),maxPriorityFeePerGas:ct(e[2],"maxPriorityFeePerGas"),maxFeePerGas:ct(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:ct(e[4],"gasLimit"),to:Vu(e[5]),value:ct(e[6],"value"),data:re(e[7]),accessList:nm(e[8],"accessList"),maxFeePerBlobGas:ct(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};n&&(s.blobs=n),R(s.to!=null,`invalid address for transaction type: ${t}`,"data",r),R(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",r);for(let i=0;i<s.blobVersionedHashes.length;i++)R(pt(s.blobVersionedHashes[i],32),`invalid blobVersionedHash at index ${i}: must be length 32`,"data",r);return e.length===11||im(s,e.slice(11)),s}function ZV(r,e,t){const n=[ze(r.chainId,"chainId"),ze(r.nonce,"nonce"),ze(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ze(r.maxFeePerGas||0,"maxFeePerGas"),ze(r.gasLimit,"gasLimit"),r.to||Rh,ze(r.value,"value"),r.data,sm(r.accessList||[]),ze(r.maxFeePerBlobGas||0,"maxFeePerBlobGas"),qV(r.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(n.push(ze(e.yParity,"yParity")),n.push(fr(e.r)),n.push(fr(e.s)),t)?Rt(["0x03",Ho([n,t.map(s=>s.data),t.map(s=>s.commitment),t.map(s=>s.proof)])]):Rt(["0x03",Ho(n)])}function XV(r){const e=Ef(Be(r).slice(1));R(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",re(r));const t={type:4,chainId:ct(e[0],"chainId"),nonce:_c(e[1],"nonce"),maxPriorityFeePerGas:ct(e[2],"maxPriorityFeePerGas"),maxFeePerGas:ct(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:ct(e[4],"gasLimit"),to:Vu(e[5]),value:ct(e[6],"value"),data:re(e[7]),accessList:nm(e[8],"accessList"),authorizationList:HV(e[9],"authorizationList")};return e.length===10||im(t,e.slice(10)),t}function eW(r,e){const t=[ze(r.chainId,"chainId"),ze(r.nonce,"nonce"),ze(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ze(r.maxFeePerGas||0,"maxFeePerGas"),ze(r.gasLimit,"gasLimit"),r.to||"0x",ze(r.value,"value"),r.data,sm(r.accessList||[]),zV(r.authorizationList||[])];return e&&(t.push(ze(e.yParity,"yParity")),t.push(fr(e.r)),t.push(fr(e.s))),Rt(["0x04",Ho(t)])}var ss,Dl,kl,Ul,Bl,Ll,$l,Ml,Fl,jl,Hl,zl,Ua,mo,Ts,yo,ql,Vl,xp;const Ss=class Ss{constructor(){M(this,Vl);M(this,ss);M(this,Dl);M(this,kl);M(this,Ul);M(this,Bl);M(this,Ll);M(this,$l);M(this,Ml);M(this,Fl);M(this,jl);M(this,Hl);M(this,zl);M(this,Ua);M(this,mo);M(this,Ts);M(this,yo);M(this,ql);_(this,ss,null),_(this,Dl,null),_(this,Ul,0),_(this,Bl,Qt),_(this,Ll,null),_(this,$l,null),_(this,Ml,null),_(this,kl,"0x"),_(this,Fl,Qt),_(this,jl,Qt),_(this,Hl,null),_(this,zl,null),_(this,Ua,null),_(this,mo,null),_(this,Ts,null),_(this,yo,null),_(this,ql,null)}get type(){return y(this,ss)}set type(e){switch(e){case null:_(this,ss,null);break;case 0:case"legacy":_(this,ss,0);break;case 1:case"berlin":case"eip-2930":_(this,ss,1);break;case 2:case"london":case"eip-1559":_(this,ss,2);break;case 3:case"cancun":case"eip-4844":_(this,ss,3);break;case 4:case"pectra":case"eip-7702":_(this,ss,4);break;default:R(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=y(this,Dl);return e==null&&this.type===3?Rh:e}set to(e){_(this,Dl,e==null?null:rt(e))}get nonce(){return y(this,Ul)}set nonce(e){_(this,Ul,Re(e,"value"))}get gasLimit(){return y(this,Bl)}set gasLimit(e){_(this,Bl,he(e))}get gasPrice(){const e=y(this,Ll);return e==null&&(this.type===0||this.type===1)?Qt:e}set gasPrice(e){_(this,Ll,e==null?null:he(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=y(this,$l);return e??(this.type===2||this.type===3?Qt:null)}set maxPriorityFeePerGas(e){_(this,$l,e==null?null:he(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=y(this,Ml);return e??(this.type===2||this.type===3?Qt:null)}set maxFeePerGas(e){_(this,Ml,e==null?null:he(e,"maxFeePerGas"))}get data(){return y(this,kl)}set data(e){_(this,kl,re(e))}get value(){return y(this,Fl)}set value(e){_(this,Fl,he(e,"value"))}get chainId(){return y(this,jl)}set chainId(e){_(this,jl,he(e))}get signature(){return y(this,Hl)||null}set signature(e){_(this,Hl,e==null?null:Xr.from(e))}get accessList(){const e=y(this,zl)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){_(this,zl,e==null?null:Cc(e))}get authorizationList(){const e=y(this,ql)||null;return e==null&&this.type===4?[]:e}set authorizationList(e){_(this,ql,e==null?null:e.map(t=>XS(t)))}get maxFeePerBlobGas(){const e=y(this,Ua);return e==null&&this.type===3?Qt:e}set maxFeePerBlobGas(e){_(this,Ua,e==null?null:he(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=y(this,mo);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){R(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)R(pt(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}_(this,mo,e)}get blobs(){return y(this,yo)==null?null:y(this,yo).map(e=>Object.assign({},e))}set blobs(e){if(e==null){_(this,yo,null);return}const t=[],n=[];for(let s=0;s<e.length;s++){const i=e[s];if(g0(i)){q(y(this,Ts),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=Be(i);if(R(o.length<=Ly,"blob is too large",`blobs[${s}]`,i),o.length!==Ly){const l=new Uint8Array(Ly);l.set(o),o=l}const a=y(this,Ts).blobToKzgCommitment(o),c=re(y(this,Ts).computeBlobKzgProof(o,a));t.push({data:re(o),commitment:re(a),proof:c}),n.push(X1(1,a))}else{const o=re(i.commitment);t.push({data:re(i.data),commitment:o,proof:re(i.proof)}),n.push(X1(1,o))}}_(this,yo,t),_(this,mo,n)}get kzg(){return y(this,Ts)}set kzg(e){e==null?_(this,Ts,null):_(this,Ts,jV(e))}get hash(){return this.signature==null?null:jt(W(this,Vl,xp).call(this,!0,!1))}get unsignedHash(){return jt(this.unsignedSerialized)}get from(){return this.signature==null?null:UV(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:Dh.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return W(this,Vl,xp).call(this,!0,!0)}get unsignedSerialized(){return W(this,Vl,xp).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,t=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,n=this.accessList!=null,s=y(this,Ua)!=null||y(this,mo);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&q(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),q(!t||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),q(this.type!==0||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):this.authorizationList&&this.authorizationList.length?i.push(4):t?i.push(2):e?(i.push(1),n||i.push(0)):n?(i.push(1),i.push(2)):(s&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return Ss.from(this)}toJSON(){const e=t=>t==null?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new Ss;if(typeof e=="string"){const n=Be(e);if(n[0]>=127)return Ss.from(VV(n));switch(n[0]){case 1:return Ss.from(JV(n));case 2:return Ss.from(GV(n));case 3:return Ss.from(QV(n));case 4:return Ss.from(XV(n))}q(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const t=new Ss;return e.type!=null&&(t.type=e.type),e.to!=null&&(t.to=e.to),e.nonce!=null&&(t.nonce=e.nonce),e.gasLimit!=null&&(t.gasLimit=e.gasLimit),e.gasPrice!=null&&(t.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(t.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(t.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(t.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(t.data=e.data),e.value!=null&&(t.value=e.value),e.chainId!=null&&(t.chainId=e.chainId),e.signature!=null&&(t.signature=Xr.from(e.signature)),e.accessList!=null&&(t.accessList=e.accessList),e.authorizationList!=null&&(t.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(t.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(t.kzg=e.kzg),e.blobs!=null&&(t.blobs=e.blobs),e.hash!=null&&(R(t.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),R(t.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(R(t.isSigned(),"unsigned transaction cannot define '.from'","tx",e),R(t.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),t}};ss=new WeakMap,Dl=new WeakMap,kl=new WeakMap,Ul=new WeakMap,Bl=new WeakMap,Ll=new WeakMap,$l=new WeakMap,Ml=new WeakMap,Fl=new WeakMap,jl=new WeakMap,Hl=new WeakMap,zl=new WeakMap,Ua=new WeakMap,mo=new WeakMap,Ts=new WeakMap,yo=new WeakMap,ql=new WeakMap,Vl=new WeakSet,xp=function(e,t){q(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=e?this.signature:null;switch(this.inferType()){case 0:return WV(this,n);case 1:return YV(this,n);case 2:return KV(this,n);case 3:return ZV(this,n,t?this.blobs:null);case 4:return eW(this,n)}q(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let lg=Ss;function uc(r){return jt(Ws(r))}var tW="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const eC=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),tC=4;function rW(r){let e=0;function t(){return r[e++]<<8|r[e++]}let n=t(),s=1,i=[0,1];for(let T=1;T<n;T++)i.push(s+=t());let o=t(),a=e;e+=o;let c=0,l=0;function u(){return c==0&&(l=l<<8|r[e++],c=8),l>>--c&1}const d=31,h=2**d,f=h>>>1,g=f>>1,p=h-1;let m=0;for(let T=0;T<d;T++)m=m<<1|u();let w=[],A=0,v=h;for(;;){let T=Math.floor(((m-A+1)*s-1)/v),P=0,D=n;for(;D-P>1;){let H=P+D>>>1;T<i[H]?D=H:P=H}if(P==0)break;w.push(P);let U=A+Math.floor(v*i[P]/s),S=A+Math.floor(v*i[P+1]/s)-1;for(;!((U^S)&f);)m=m<<1&p|u(),U=U<<1&p,S=S<<1&p|1;for(;U&~S&g;)m=m&f|m<<1&p>>>1|u(),U=U<<1^f,S=(S^f)<<1|f|1;A=U,v=1+S-U}let I=n-4;return w.map(T=>{switch(T-I){case 3:return I+65792+(r[a++]<<16|r[a++]<<8|r[a++]);case 2:return I+256+(r[a++]<<8|r[a++]);case 1:return I+r[a++];default:return T-1}})}function nW(r){let e=0;return()=>r[e++]}function ex(r){return nW(rW(sW(r)))}function sW(r){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,i)=>e[s.charCodeAt(0)]=i);let t=r.length,n=new Uint8Array(6*t>>3);for(let s=0,i=0,o=0,a=0;s<t;s++)a=a<<6|e[r.charCodeAt(s)],o+=6,o>=8&&(n[i++]=a>>(o-=8));return n}function iW(r){return r&1?~r>>1:r>>1}function oW(r,e){let t=Array(r);for(let n=0,s=0;n<r;n++)t[n]=s+=iW(e());return t}function kh(r,e=0){let t=[];for(;;){let n=r(),s=r();if(!s)break;e+=n;for(let i=0;i<s;i++)t.push(e+i);e+=s+1}return t}function tx(r){return Uh(()=>{let e=kh(r);if(e.length)return e})}function rx(r){let e=[];for(;;){let t=r();if(t==0)break;e.push(aW(t,r))}for(;;){let t=r()-1;if(t<0)break;e.push(cW(t,r))}return e.flat()}function Uh(r){let e=[];for(;;){let t=r(e.length);if(!t)break;e.push(t)}return e}function nx(r,e,t){let n=Array(r).fill().map(()=>[]);for(let s=0;s<e;s++)oW(r,t).forEach((i,o)=>n[o].push(i));return n}function aW(r,e){let t=1+e(),n=e(),s=Uh(e);return nx(s.length,1+r,e).flatMap((o,a)=>{let[c,...l]=o;return Array(s[a]).fill().map((u,d)=>{let h=d*n;return[c+d*t,l.map(f=>f+h)]})})}function cW(r,e){let t=1+e();return nx(t,1+r,e).map(s=>[s[0],s.slice(1)])}function lW(r){let e=[],t=kh(r);return s(n([]),[]),e;function n(i){let o=r(),a=Uh(()=>{let c=kh(r).map(l=>t[l]);if(c.length)return n(c)});return{S:o,B:a,Q:i}}function s({S:i,B:o},a,c){if(!(i&4&&c===a[a.length-1])){i&2&&(c=a[a.length-1]),i&1&&e.push(a);for(let l of o)for(let u of l.Q)s(l,[...a,u],c)}}}function uW(r){return r.toString(16).toUpperCase().padStart(2,"0")}function sx(r){return`{${uW(r)}}`}function dW(r){let e=[];for(let t=0,n=r.length;t<n;){let s=r.codePointAt(t);t+=s<65536?1:2,e.push(s)}return e}function Ou(r){let t=r.length;if(t<4096)return String.fromCodePoint(...r);let n=[];for(let s=0;s<t;)n.push(String.fromCodePoint(...r.slice(s,s+=4096)));return n.join("")}function hW(r,e){let t=r.length,n=t-e.length;for(let s=0;n==0&&s<t;s++)n=r[s]-e[s];return n}var fW="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const Bh=44032,ug=4352,dg=4449,hg=4519,ix=19,ox=21,Ru=28,fg=ox*Ru,pW=ix*fg,gW=Bh+pW,mW=ug+ix,yW=dg+ox,wW=hg+Ru;function vd(r){return r>>24&255}function ax(r){return r&16777215}let cb,rC,lb,Tp;function bW(){let r=ex(fW);cb=new Map(tx(r).flatMap((e,t)=>e.map(n=>[n,t+1<<24]))),rC=new Set(kh(r)),lb=new Map,Tp=new Map;for(let[e,t]of rx(r)){if(!rC.has(e)&&t.length==2){let[n,s]=t,i=Tp.get(n);i||(i=new Map,Tp.set(n,i)),i.set(s,e)}lb.set(e,t.reverse())}}function cx(r){return r>=Bh&&r<gW}function EW(r,e){if(r>=ug&&r<mW&&e>=dg&&e<yW)return Bh+(r-ug)*fg+(e-dg)*Ru;if(cx(r)&&e>hg&&e<wW&&(r-Bh)%Ru==0)return r+(e-hg);{let t=Tp.get(r);return t&&(t=t.get(e),t)?t:-1}}function lx(r){cb||bW();let e=[],t=[],n=!1;function s(i){let o=cb.get(i);o&&(n=!0,i|=o),e.push(i)}for(let i of r)for(;;){if(i<128)e.push(i);else if(cx(i)){let o=i-Bh,a=o/fg|0,c=o%fg/Ru|0,l=o%Ru;s(ug+a),s(dg+c),l>0&&s(hg+l)}else{let o=lb.get(i);o?t.push(...o):s(i)}if(!t.length)break;i=t.pop()}if(n&&e.length>1){let i=vd(e[0]);for(let o=1;o<e.length;o++){let a=vd(e[o]);if(a==0||i<=a){i=a;continue}let c=o-1;for(;;){let l=e[c+1];if(e[c+1]=e[c],e[c]=l,!c||(i=vd(e[--c]),i<=a))break}i=vd(e[o])}}return e}function vW(r){let e=[],t=[],n=-1,s=0;for(let i of r){let o=vd(i),a=ax(i);if(n==-1)o==0?n=a:e.push(a);else if(s>0&&s>=o)o==0?(e.push(n,...t),t.length=0,n=a):t.push(a),s=o;else{let c=EW(n,a);c>=0?n=c:s==0&&o==0?(e.push(n),n=a):(t.push(a),s=o)}}return n>=0&&e.push(n,...t),e}function ux(r){return lx(r).map(ax)}function AW(r){return vW(lx(r))}const nC=45,dx=".",hx=65039,fx=1,pg=r=>Array.from(r);function Lh(r,e){return r.P.has(e)||r.Q.has(e)}class CW extends Array{get is_emoji(){return!0}}let ub,px,Aa,db,gx,bl,$y,rl,oa,sC,hb;function I0(){if(ub)return;let r=ex(tW);const e=()=>kh(r),t=()=>new Set(e()),n=(u,d)=>d.forEach(h=>u.add(h));ub=new Map(rx(r)),px=t(),Aa=e(),db=new Set(e().map(u=>Aa[u])),Aa=new Set(Aa),gx=t(),t();let s=tx(r),i=r();const o=()=>{let u=new Set;return e().forEach(d=>n(u,s[d])),n(u,e()),u};bl=Uh(u=>{let d=Uh(r).map(h=>h+96);if(d.length){let h=u>=i;d[0]-=32,d=Ou(d),h&&(d=`Restricted[${d}]`);let f=o(),g=o(),p=!r();return{N:d,P:f,Q:g,M:p,R:h}}}),$y=t(),rl=new Map;let a=e().concat(pg($y)).sort((u,d)=>u-d);a.forEach((u,d)=>{let h=r(),f=a[d]=h?a[d-h]:{V:[],M:new Map};f.V.push(u),$y.has(u)||rl.set(u,f)});for(let{V:u,M:d}of new Set(rl.values())){let h=[];for(let g of u){let p=bl.filter(w=>Lh(w,g)),m=h.find(({G:w})=>p.some(A=>w.has(A)));m||(m={G:new Set,V:[]},h.push(m)),m.V.push(g),n(m.G,p)}let f=h.flatMap(g=>pg(g.G));for(let{G:g,V:p}of h){let m=new Set(f.filter(w=>!g.has(w)));for(let w of p)d.set(w,m)}}oa=new Set;let c=new Set;const l=u=>oa.has(u)?c.add(u):oa.add(u);for(let u of bl){for(let d of u.P)l(d);for(let d of u.Q)l(d)}for(let u of oa)!rl.has(u)&&!c.has(u)&&rl.set(u,fx);n(oa,ux(oa)),sC=lW(r).map(u=>CW.from(u)).sort(hW),hb=new Map;for(let u of sC){let d=[hb];for(let h of u){let f=d.map(g=>{let p=g.get(h);return p||(p=new Map,g.set(h,p)),p});h===hx?d.push(...f):d=f}for(let h of d)h.V=u}}function S0(r){return(mx(r)?"":`${x0(om([r]))} `)+sx(r)}function x0(r){return`"${r}"‎`}function _W(r){if(r.length>=4&&r[2]==nC&&r[3]==nC)throw new Error(`invalid label extension: "${Ou(r.slice(0,4))}"`)}function NW(r){for(let t=r.lastIndexOf(95);t>0;)if(r[--t]!==95)throw new Error("underscore allowed only at start")}function IW(r){let e=r[0],t=eC.get(e);if(t)throw Ld(`leading ${t}`);let n=r.length,s=-1;for(let i=1;i<n;i++){e=r[i];let o=eC.get(e);if(o){if(s==i)throw Ld(`${t} + ${o}`);s=i+1,t=o}}if(s==n)throw Ld(`trailing ${t}`)}function om(r,e=1/0,t=sx){let n=[];SW(r[0])&&n.push("◌"),r.length>e&&(e>>=1,r=[...r.slice(0,e),8230,...r.slice(-e)]);let s=0,i=r.length;for(let o=0;o<i;o++){let a=r[o];mx(a)&&(n.push(Ou(r.slice(s,o))),n.push(t(a)),s=o+1)}return n.push(Ou(r.slice(s,i))),n.join("")}function SW(r){return I0(),Aa.has(r)}function mx(r){return I0(),gx.has(r)}function xW(r){return RW(TW(r,AW,UW))}function TW(r,e,t){if(!r)return[];I0();let n=0;return r.split(dx).map(s=>{let i=dW(s),o={input:i,offset:n};n+=i.length+1;try{let a=o.tokens=kW(i,e,t),c=a.length,l;if(!c)throw new Error("empty label");let u=o.output=a.flat();if(NW(u),!(o.emoji=c>1||a[0].is_emoji)&&u.every(h=>h<128))_W(u),l="ASCII";else{let h=a.flatMap(f=>f.is_emoji?[]:f);if(!h.length)l="Emoji";else{if(Aa.has(u[0]))throw Ld("leading combining mark");for(let p=1;p<c;p++){let m=a[p];if(!m.is_emoji&&Aa.has(m[0]))throw Ld(`emoji + combining mark: "${Ou(a[p-1])} + ${om([m[0]])}"`)}IW(u);let f=pg(new Set(h)),[g]=OW(f);DW(g,h),PW(g,f),l=g.N}}o.type=l}catch(a){o.error=a}return o})}function PW(r,e){let t,n=[];for(let s of e){let i=rl.get(s);if(i===fx)return;if(i){let o=i.M.get(s);if(t=t?t.filter(a=>o.has(a)):pg(o),!t.length)return}else n.push(s)}if(t){for(let s of t)if(n.every(i=>Lh(s,i)))throw new Error(`whole-script confusable: ${r.N}/${s.N}`)}}function OW(r){let e=bl;for(let t of r){let n=e.filter(s=>Lh(s,t));if(!n.length)throw bl.some(s=>Lh(s,t))?wx(e[0],t):yx(t);if(e=n,n.length==1)break}return e}function RW(r){return r.map(({input:e,error:t,output:n})=>{if(t){let s=t.message;throw new Error(r.length==1?s:`Invalid label ${x0(om(e,63))}: ${s}`)}return Ou(n)}).join(dx)}function yx(r){return new Error(`disallowed character: ${S0(r)}`)}function wx(r,e){let t=S0(e),n=bl.find(s=>s.P.has(e));return n&&(t=`${n.N} ${t}`),new Error(`illegal mixture: ${r.N} + ${t}`)}function Ld(r){return new Error(`illegal placement: ${r}`)}function DW(r,e){for(let t of e)if(!Lh(r,t))throw wx(r,t);if(r.M){let t=ux(e);for(let n=1,s=t.length;n<s;n++)if(db.has(t[n])){let i=n+1;for(let o;i<s&&db.has(o=t[i]);i++)for(let a=n;a<i;a++)if(t[a]==o)throw new Error(`duplicate non-spacing marks: ${S0(o)}`);if(i-n>tC)throw new Error(`excessive non-spacing marks: ${x0(om(t.slice(n-1,i)))} (${i-n}/${tC})`);n=i}}}function kW(r,e,t){let n=[],s=[];for(r=r.slice().reverse();r.length;){let i=BW(r);if(i)s.length&&(n.push(e(s)),s=[]),n.push(t(i));else{let o=r.pop();if(oa.has(o))s.push(o);else{let a=ub.get(o);if(a)s.push(...a);else if(!px.has(o))throw yx(o)}}}return s.length&&n.push(e(s)),n}function UW(r){return r.filter(e=>e!=hx)}function BW(r,e){let t=hb,n,s=r.length;for(;s&&(t=t.get(r[--s]),!!t);){let{V:i}=t;i&&(n=i,r.length=s)}return n}const bx=new Uint8Array(32);bx.fill(0);function iC(r){return R(r.length!==0,"invalid ENS name; empty component","comp",r),r}function Ex(r){const e=Ws(LW(r)),t=[];if(r.length===0)return t;let n=0;for(let s=0;s<e.length;s++)e[s]===46&&(t.push(iC(e.slice(n,s))),n=s+1);return R(n<e.length,"invalid ENS name; empty component","name",r),t.push(iC(e.slice(n))),t}function LW(r){try{if(r.length===0)throw new Error("empty label");return xW(r)}catch(e){R(!1,`invalid ENS name (${e.message})`,"name",r)}}function fb(r){R(typeof r=="string","invalid ENS name; not a string","name",r),R(r.length,"invalid ENS name (empty label)","name",r);let e=bx;const t=Ex(r);for(;t.length;)e=jt(Rt([e,jt(t.pop())]));return re(e)}function $W(r,e){const t=e;return R(t<=255,"DNS encoded label cannot exceed 255","length",t),re(Rt(Ex(r).map(n=>{R(n.length<=t,`label ${JSON.stringify(r)} exceeds ${t} bytes`,"name",r);const s=new Uint8Array(n.length+1);return s.set(n,1),s[0]=s.length-1,s})))+"00"}const vx=new Uint8Array(32);vx.fill(0);const MW=BigInt(-1),Ax=BigInt(0),Cx=BigInt(1),FW=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function jW(r){const e=Be(r),t=e.length%32;return t?Rt([e,vx.slice(t)]):re(e)}const HW=jo(Cx,32),zW=jo(Ax,32),oC={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},My=["name","version","chainId","verifyingContract","salt"];function aC(r){return function(e){return R(typeof e=="string",`invalid domain value for ${JSON.stringify(r)}`,`domain.${r}`,e),e}}const qW={name:aC("name"),version:aC("version"),chainId:function(r){const e=he(r,"domain.chainId");return R(e>=0,"invalid chain ID","domain.chainId",r),Number.isSafeInteger(e)?Number(e):Ri(e)},verifyingContract:function(r){try{return rt(r).toLowerCase()}catch{}R(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",r)},salt:function(r){const e=Be(r,"domain.salt");return R(e.length===32,'invalid domain value "salt"',"domain.salt",r),re(e)}};function Fy(r){{const e=r.match(/^(u?)int(\d+)$/);if(e){const t=e[1]==="",n=parseInt(e[2]);R(n%8===0&&n!==0&&n<=256&&e[2]===String(n),"invalid numeric width","type",r);const s=Ea(FW,t?n-1:n),i=t?(s+Cx)*MW:Ax;return function(o){const a=he(o,"value");return R(a>=i&&a<=s,`value out-of-bounds for ${r}`,"value",a),jo(t?oS(a,256):a,32)}}}{const e=r.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return R(t!==0&&t<=32&&e[1]===String(t),"invalid bytes width","type",r),function(n){const s=Be(n);return R(s.length===t,`invalid length for ${r}`,"value",n),jW(n)}}}switch(r){case"address":return function(e){return Fi(rt(e),32)};case"bool":return function(e){return e?HW:zW};case"bytes":return function(e){return jt(e)};case"string":return function(e){return uc(e)}}return null}function cC(r,e){return`${r}(${e.map(({name:t,type:n})=>n+" "+t).join(",")})`}function up(r){const e=r.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:r}}var Vh,Ei,Wl,Eg,_x;const Rn=class Rn{constructor(e){M(this,Eg);$(this,"primaryType");M(this,Vh);M(this,Ei);M(this,Wl);_(this,Ei,new Map),_(this,Wl,new Map);const t=new Map,n=new Map,s=new Map,i={};Object.keys(e).forEach(c=>{i[c]=e[c].map(({name:l,type:u})=>{let{base:d,index:h}=up(u);return d==="int"&&!e.int&&(d="int256"),d==="uint"&&!e.uint&&(d="uint256"),{name:l,type:d+(h||"")}}),t.set(c,new Set),n.set(c,[]),s.set(c,new Set)}),_(this,Vh,JSON.stringify(i));for(const c in i){const l=new Set;for(const u of i[c]){R(!l.has(u.name),`duplicate variable name ${JSON.stringify(u.name)} in ${JSON.stringify(c)}`,"types",e),l.add(u.name);const d=up(u.type).base;R(d!==c,`circular type reference to ${JSON.stringify(d)}`,"types",e),!Fy(d)&&(R(n.has(d),`unknown type ${JSON.stringify(d)}`,"types",e),n.get(d).push(c),t.get(c).add(d))}}const o=Array.from(n.keys()).filter(c=>n.get(c).length===0);R(o.length!==0,"missing primary type","types",e),R(o.length===1,`ambiguous primary types or unused types: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"types",e),ye(this,{primaryType:o[0]});function a(c,l){R(!l.has(c),`circular type reference to ${JSON.stringify(c)}`,"types",e),l.add(c);for(const u of t.get(c))if(n.has(u)){a(u,l);for(const d of l)s.get(d).add(u)}l.delete(c)}a(this.primaryType,new Set);for(const[c,l]of s){const u=Array.from(l);u.sort(),y(this,Ei).set(c,cC(c,i[c])+u.map(d=>cC(d,i[d])).join(""))}}get types(){return JSON.parse(y(this,Vh))}getEncoder(e){let t=y(this,Wl).get(e);return t||(t=W(this,Eg,_x).call(this,e),y(this,Wl).set(e,t)),t}encodeType(e){const t=y(this,Ei).get(e);return R(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return jt(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,n){if(Fy(e))return n(e,t);const s=up(e).array;if(s)return R(s.count===-1||s.count===t.length,`array length mismatch; expected length ${s.count}`,"value",t),t.map(o=>this._visit(s.prefix,o,n));const i=this.types[e];if(i)return i.reduce((o,{name:a,type:c})=>(o[a]=this._visit(c,t[a],n),o),{});R(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new Rn(e)}static getPrimaryType(e){return Rn.from(e).primaryType}static hashStruct(e,t,n){return Rn.from(t).hashStruct(e,n)}static hashDomain(e){const t=[];for(const n in e){if(e[n]==null)continue;const s=oC[n];R(s,`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",e),t.push({name:n,type:s})}return t.sort((n,s)=>My.indexOf(n.name)-My.indexOf(s.name)),Rn.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,n){return Rt(["0x1901",Rn.hashDomain(e),Rn.from(t).hash(n)])}static hash(e,t,n){return jt(Rn.encode(e,t,n))}static async resolveNames(e,t,n,s){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const i={};e.verifyingContract&&!pt(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const o=Rn.from(t);o.visit(n,(a,c)=>(a==="address"&&!pt(c,20)&&(i[c]="0x"),c));for(const a in i)i[a]=await s(a);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),n=o.visit(n,(a,c)=>a==="address"&&i[c]?i[c]:c),{domain:e,value:n}}static getPayload(e,t,n){Rn.hashDomain(e);const s={},i=[];My.forEach(c=>{const l=e[c];l!=null&&(s[c]=qW[c](l),i.push({name:c,type:oC[c]}))});const o=Rn.from(t);t=o.types;const a=Object.assign({},t);return R(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",t),a.EIP712Domain=i,o.encode(n),{types:a,domain:s,primaryType:o.primaryType,message:o.visit(n,(c,l)=>{if(c.match(/^bytes(\d*)/))return re(Be(l));if(c.match(/^u?int/))return he(l).toString();switch(c){case"address":return l.toLowerCase();case"bool":return!!l;case"string":return R(typeof l=="string","invalid string","value",l),l}R(!1,"unsupported type","type",c)})}}};Vh=new WeakMap,Ei=new WeakMap,Wl=new WeakMap,Eg=new WeakSet,_x=function(e){{const s=Fy(e);if(s)return s}const t=up(e).array;if(t){const s=t.prefix,i=this.getEncoder(s);return o=>{R(t.count===-1||t.count===o.length,`array length mismatch; expected length ${t.count}`,"value",o);let a=o.map(i);return y(this,Ei).has(s)&&(a=a.map(jt)),jt(Rt(a))}}const n=this.types[e];if(n){const s=uc(y(this,Ei).get(e));return i=>{const o=n.map(({name:a,type:c})=>{const l=this.getEncoder(c)(i[a]);return y(this,Ei).has(c)?jt(l):l});return o.unshift(s),Rt(o)}}R(!1,`unknown type: ${e}`,"type",e)};let gg=Rn;function Lr(r){const e=new Set;return r.forEach(t=>e.add(t)),Object.freeze(e)}const VW="external public payable override",WW=Lr(VW.split(" ")),Nx="constant external internal payable private public pure view override",GW=Lr(Nx.split(" ")),Ix="constructor error event fallback function receive struct",Sx=Lr(Ix.split(" ")),xx="calldata memory storage payable indexed",KW=Lr(xx.split(" ")),JW="tuple returns",YW=[Ix,xx,JW,Nx].join(" "),QW=Lr(YW.split(" ")),ZW={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},XW=new RegExp("^(\\s*)"),eG=new RegExp("^([0-9]+)"),tG=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),Tx=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),Px=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var cr,is,Wh,pb;const vg=class vg{constructor(e){M(this,Wh);M(this,cr);M(this,is);_(this,cr,0),_(this,is,e.slice())}get offset(){return y(this,cr)}get length(){return y(this,is).length-y(this,cr)}clone(){return new vg(y(this,is))}reset(){_(this,cr,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=W(this,Wh,pb).call(this,y(this,cr)+1,e.match+1);return _(this,cr,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;y(this,cr)<e.match-1;){const n=this.peek().linkNext;t.push(W(this,Wh,pb).call(this,y(this,cr)+1,n)),_(this,cr,n)}return _(this,cr,e.match+1),t}peek(){if(y(this,cr)>=y(this,is).length)throw new Error("out-of-bounds");return y(this,is)[y(this,cr)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return Ku(this,cr)._++,e}toString(){const e=[];for(let t=y(this,cr);t<y(this,is).length;t++){const n=y(this,is)[t];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}};cr=new WeakMap,is=new WeakMap,Wh=new WeakSet,pb=function(e=0,t=0){return new vg(y(this,is).slice(e,t).map(n=>Object.freeze(Object.assign({},n,{match:n.match-e,linkBack:n.linkBack-e,linkNext:n.linkNext-e}))))};let gs=vg;function Vo(r){const e=[],t=o=>{const a=i<r.length?JSON.stringify(r[i]):"$EOI";throw new Error(`invalid token ${a} at ${i}: ${o}`)};let n=[],s=[],i=0;for(;i<r.length;){let o=r.substring(i),a=o.match(XW);a&&(i+=a[1].length,o=r.substring(i));const c={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(c);let l=ZW[o[0]]||"";if(l){if(c.type=l,c.text=o[0],i++,l==="OPEN_PAREN")n.push(e.length-1),s.push(e.length-1);else if(l=="CLOSE_PAREN")n.length===0&&t("no matching open bracket"),c.match=n.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1;else if(l==="COMMA")c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(l==="OPEN_BRACKET")c.type="BRACKET";else if(l==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const d=e.pop().text;u=d+u,e[e.length-1].value=Re(d)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(a=o.match(tG),a){if(c.text=a[1],i+=c.text.length,QW.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(Px)){c.type="TYPE";continue}c.type="ID";continue}if(a=o.match(eG),a){c.text=a[1],c.type="NUMBER",i+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new gs(e.map(o=>Object.freeze(o)))}function lC(r,e){let t=[];for(const n in e.keys())r.has(n)&&t.push(n);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function am(r,e){if(e.peekKeyword(Sx)){const t=e.pop().text;if(t!==r)throw new Error(`expected ${r}, got ${t}`)}return e.popType("ID")}function Hi(r,e){const t=new Set;for(;;){const n=r.peekType("KEYWORD");if(n==null||e&&!e.has(n))break;if(r.pop(),t.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);t.add(n)}return Object.freeze(t)}function Ox(r){let e=Hi(r,GW);return lC(e,Lr("constant payable nonpayable".split(" "))),lC(e,Lr("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function Li(r,e){return r.popParams().map(t=>gr.from(t,e))}function Rx(r){if(r.peekType("AT")){if(r.pop(),r.peekType("NUMBER"))return he(r.pop().text);throw new Error("invalid gas")}return null}function dc(r){if(r.length)throw new Error(`unexpected tokens at offset ${r.offset}: ${r.toString()}`)}const rG=new RegExp(/^(.*)\[([0-9]*)\]$/);function uC(r){const e=r.match(Px);if(R(e,"invalid type","type",r),r==="uint")return"uint256";if(r==="int")return"int256";if(e[2]){const t=parseInt(e[2]);R(t!==0&&t<=32,"invalid bytes length","type",r)}else if(e[3]){const t=parseInt(e[3]);R(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",r)}return r}const St={},en=Symbol.for("_ethers_internal"),dC="_ParamTypeInternal",hC="_ErrorInternal",fC="_EventInternal",pC="_ConstructorInternal",gC="_FallbackInternal",mC="_FunctionInternal",yC="_StructInternal";var Gl,Pp;const Dn=class Dn{constructor(e,t,n,s,i,o,a,c){M(this,Gl);$(this,"name");$(this,"type");$(this,"baseType");$(this,"indexed");$(this,"components");$(this,"arrayLength");$(this,"arrayChildren");if(bf(e,St,"ParamType"),Object.defineProperty(this,en,{value:dC}),o&&(o=Object.freeze(o.slice())),s==="array"){if(a==null||c==null)throw new Error("")}else if(a!=null||c!=null)throw new Error("");if(s==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");ye(this,{name:t,type:n,baseType:s,indexed:i,components:o,arrayLength:a,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const n=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=n,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(n=>n.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(s=>n.arrayChildren.walk(s,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((s,i)=>n.components[i].walk(s,t))}return t(this.type,e)}async walkAsync(e,t){const n=[],s=[e];return W(this,Gl,Pp).call(this,n,e,t,i=>{s[0]=i}),n.length&&await Promise.all(n),s[0]}static from(e,t){if(Dn.isParamType(e))return e;if(typeof e=="string")try{return Dn.from(Vo(e),t)}catch{R(!1,"invalid param type","obj",e)}else if(e instanceof gs){let a="",c="",l=null;Hi(e,Lr(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",l=e.popParams().map(p=>Dn.from(p)),a=`tuple(${l.map(p=>p.format()).join(",")})`):(a=uC(e.popType("TYPE")),c=a);let u=null,d=null;for(;e.length&&e.peekType("BRACKET");){const p=e.pop();u=new Dn(St,"",a,c,null,l,d,u),d=p.value,a+=p.text,c="array",l=null}let h=null;if(Hi(e,KW).has("indexed")){if(!t)throw new Error("");h=!0}const g=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new Dn(St,g,a,c,h,l,d,u)}const n=e.name;R(!n||typeof n=="string"&&n.match(Tx),"invalid name","obj.name",n);let s=e.indexed;s!=null&&(R(t,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let i=e.type,o=i.match(rG);if(o){const a=parseInt(o[2]||"-1"),c=Dn.from({type:o[1],components:e.components});return new Dn(St,n||"",i,"array",s,null,a,c)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const a=e.components!=null?e.components.map(l=>Dn.from(l)):null;return new Dn(St,n||"",i,"tuple",s,a,null,null)}return i=uC(e.type),new Dn(St,n||"",i,i,s,null,null,null)}static isParamType(e){return e&&e[en]===dC}};Gl=new WeakSet,Pp=function(e,t,n,s){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=t.slice();a.forEach((c,l)=>{var u;W(u=o,Gl,Pp).call(u,e,c,n,d=>{a[l]=d})}),s(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(t))a=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");a=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in t))throw new Error(`missing value for component ${c.name}`);return t[c.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((c,l)=>{var u;W(u=o[l],Gl,Pp).call(u,e,c,n,d=>{a[l]=d})}),s(a);return}const i=n(this.type,t);i.then?e.push(async function(){s(await i)}()):s(i)};let gr=Dn;class hc{constructor(e,t,n){$(this,"type");$(this,"inputs");bf(e,St,"Fragment"),n=Object.freeze(n.slice()),ye(this,{type:t,inputs:n})}static from(e){if(typeof e=="string"){try{hc.from(JSON.parse(e))}catch{}return hc.from(Vo(e))}if(e instanceof gs)switch(e.peekKeyword(Sx)){case"constructor":return Di.from(e);case"error":return Qr.from(e);case"event":return Fs.from(e);case"fallback":case"receive":return gi.from(e);case"function":return js.from(e);case"struct":return Ya.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return Di.from(e);case"error":return Qr.from(e);case"event":return Fs.from(e);case"fallback":case"receive":return gi.from(e);case"function":return js.from(e);case"struct":return Ya.from(e)}q(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}R(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return Di.isFragment(e)}static isError(e){return Qr.isFragment(e)}static isEvent(e){return Fs.isFragment(e)}static isFunction(e){return js.isFragment(e)}static isStruct(e){return Ya.isFragment(e)}}class cm extends hc{constructor(t,n,s,i){super(t,n,i);$(this,"name");R(typeof s=="string"&&s.match(Tx),"invalid identifier","name",s),i=Object.freeze(i.slice()),ye(this,{name:s})}}function $h(r,e){return"("+e.map(t=>t.format(r)).join(r==="full"?", ":",")+")"}class Qr extends cm{constructor(e,t,n){super(e,"error",t,n),Object.defineProperty(this,en,{value:hC})}get selector(){return uc(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+$h(e,this.inputs)),t.join(" ")}static from(e){if(Qr.isFragment(e))return e;if(typeof e=="string")return Qr.from(Vo(e));if(e instanceof gs){const t=am("error",e),n=Li(e);return dc(e),new Qr(St,t,n)}return new Qr(St,e.name,e.inputs?e.inputs.map(gr.from):[])}static isFragment(e){return e&&e[en]===hC}}class Fs extends cm{constructor(t,n,s,i){super(t,"event",n,s);$(this,"anonymous");Object.defineProperty(this,en,{value:fC}),ye(this,{anonymous:i})}get topicHash(){return uc(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("event"),n.push(this.name+$h(t,this.inputs)),t!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(t,n){return n=(n||[]).map(i=>gr.from(i)),new Fs(St,t,n,!1).topicHash}static from(t){if(Fs.isFragment(t))return t;if(typeof t=="string")try{return Fs.from(Vo(t))}catch{R(!1,"invalid event fragment","obj",t)}else if(t instanceof gs){const n=am("event",t),s=Li(t,!0),i=!!Hi(t,Lr(["anonymous"])).has("anonymous");return dc(t),new Fs(St,n,s,i)}return new Fs(St,t.name,t.inputs?t.inputs.map(n=>gr.from(n,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[en]===fC}}class Di extends hc{constructor(t,n,s,i,o){super(t,n,s);$(this,"payable");$(this,"gas");Object.defineProperty(this,en,{value:pC}),ye(this,{payable:i,gas:o})}format(t){if(q(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[`constructor${$h(t,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(t){if(Di.isFragment(t))return t;if(typeof t=="string")try{return Di.from(Vo(t))}catch{R(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof gs){Hi(t,Lr(["constructor"]));const n=Li(t),s=!!Hi(t,WW).has("payable"),i=Rx(t);return dc(t),new Di(St,"constructor",n,s,i)}return new Di(St,"constructor",t.inputs?t.inputs.map(gr.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[en]===pC}}class gi extends hc{constructor(t,n,s){super(t,"fallback",n);$(this,"payable");Object.defineProperty(this,en,{value:gC}),ye(this,{payable:s})}format(t){const n=this.inputs.length===0?"receive":"fallback";if(t==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:s})}return`${n}()${this.payable?" payable":""}`}static from(t){if(gi.isFragment(t))return t;if(typeof t=="string")try{return gi.from(Vo(t))}catch{R(!1,"invalid fallback fragment","obj",t)}else if(t instanceof gs){const n=t.toString(),s=t.peekKeyword(Lr(["fallback","receive"]));if(R(s,"type must be fallback or receive","obj",n),t.popKeyword(Lr(["fallback","receive"]))==="receive"){const c=Li(t);return R(c.length===0,"receive cannot have arguments","obj.inputs",c),Hi(t,Lr(["payable"])),dc(t),new gi(St,[],!0)}let o=Li(t);o.length?R(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(c=>c.format("minimal")).join(", ")):o=[gr.from("bytes")];const a=Ox(t);if(R(a==="nonpayable"||a==="payable","fallback cannot be constants","obj.stateMutability",a),Hi(t,Lr(["returns"])).has("returns")){const c=Li(t);R(c.length===1&&c[0].type==="bytes","invalid fallback outputs","obj.outputs",c.map(l=>l.format("minimal")).join(", "))}return dc(t),new gi(St,o,a==="payable")}if(t.type==="receive")return new gi(St,[],!0);if(t.type==="fallback"){const n=[gr.from("bytes")],s=t.stateMutability==="payable";return new gi(St,n,s)}R(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[en]===gC}}class js extends cm{constructor(t,n,s,i,o,a){super(t,"function",n,i);$(this,"constant");$(this,"outputs");$(this,"stateMutability");$(this,"payable");$(this,"gas");Object.defineProperty(this,en,{value:mC}),o=Object.freeze(o.slice()),ye(this,{constant:s==="view"||s==="pure",gas:a,outputs:o,payable:s==="payable",stateMutability:s})}get selector(){return uc(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t))),outputs:this.outputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("function"),n.push(this.name+$h(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push($h(t,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(t,n){return n=(n||[]).map(i=>gr.from(i)),new js(St,t,"view",n,[],null).selector}static from(t){if(js.isFragment(t))return t;if(typeof t=="string")try{return js.from(Vo(t))}catch{R(!1,"invalid function fragment","obj",t)}else if(t instanceof gs){const s=am("function",t),i=Li(t),o=Ox(t);let a=[];Hi(t,Lr(["returns"])).has("returns")&&(a=Li(t));const c=Rx(t);return dc(t),new js(St,s,o,i,a,c)}let n=t.stateMutability;return n==null&&(n="payable",typeof t.constant=="boolean"?(n="view",t.constant||(n="payable",typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable")),new js(St,t.name,n,t.inputs?t.inputs.map(gr.from):[],t.outputs?t.outputs.map(gr.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[en]===mC}}class Ya extends cm{constructor(e,t,n){super(e,"struct",t,n),Object.defineProperty(this,en,{value:yC})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Ya.from(Vo(e))}catch{R(!1,"invalid struct fragment","obj",e)}else if(e instanceof gs){const t=am("struct",e),n=Li(e);return dc(e),new Ya(St,t,n)}return new Ya(St,e.name,e.inputs?e.inputs.map(gr.from):[])}static isFragment(e){return e&&e[en]===yC}}const ys=new Map;ys.set(0,"GENERIC_PANIC");ys.set(1,"ASSERT_FALSE");ys.set(17,"OVERFLOW");ys.set(18,"DIVIDE_BY_ZERO");ys.set(33,"ENUM_RANGE_ERROR");ys.set(34,"BAD_STORAGE_DATA");ys.set(49,"STACK_UNDERFLOW");ys.set(50,"ARRAY_RANGE_ERROR");ys.set(65,"OUT_OF_MEMORY");ys.set(81,"UNINITIALIZED_FUNCTION_CALL");const nG=new RegExp(/^bytes([0-9]*)$/),sG=new RegExp(/^(u?int)([0-9]*)$/);let jy=null,wC=1024;function iG(r,e,t,n){let s="missing revert data",i=null;const o=null;let a=null;if(t){s="execution reverted";const l=Be(t);if(t=re(t),l.length===0)s+=" (no data present; likely require(false) occurred",i="require(false)";else if(l.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(re(l.slice(0,4))==="0x08c379a0")try{i=n.decode(["string"],l.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[i]},s+=`: ${JSON.stringify(i)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(re(l.slice(0,4))==="0x4e487b71")try{const u=Number(n.decode(["uint256"],l.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[u]},i=`Panic due to ${ys.get(u)||"UNKNOWN"}(${u})`,s+=`: ${i}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const c={to:e.to?rt(e.to):null,data:e.data||"0x"};return e.from&&(c.from=rt(e.from)),Nt(s,"CALL_EXCEPTION",{action:r,data:t,reason:i,transaction:c,invocation:o,revert:a})}var wo,nl;const Ag=class Ag{constructor(){M(this,wo)}getDefaultValue(e){const t=e.map(s=>W(this,wo,nl).call(this,gr.from(s)));return new lp(t,"_").defaultValue()}encode(e,t){nS(t.length,e.length,"types/values length mismatch");const n=e.map(o=>W(this,wo,nl).call(this,gr.from(o))),s=new lp(n,"_"),i=new eb;return s.encode(i,t),i.data}decode(e,t,n){const s=e.map(o=>W(this,wo,nl).call(this,gr.from(o)));return new lp(s,"_").decode(new tb(t,n,wC))}static _setDefaultMaxInflation(e){R(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),wC=e}static defaultAbiCoder(){return jy==null&&(jy=new Ag),jy}static getBuiltinCallException(e,t,n){return iG(e,t,n,Ag.defaultAbiCoder())}};wo=new WeakSet,nl=function(e){if(e.isArray())return new CV(W(this,wo,nl).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new lp(e.components.map(n=>W(this,wo,nl).call(this,n)),e.name);switch(e.baseType){case"address":return new vV(e.name);case"bool":return new _V(e.name);case"string":return new DV(e.name);case"bytes":return new NV(e.name);case"":return new xV(e.name)}let t=e.type.match(sG);if(t){let n=parseInt(t[2]||"256");return R(n!==0&&n<=256&&n%8===0,"invalid "+t[1]+" bit length","param",e),new RV(n/8,t[1]==="int",e.name)}if(t=e.type.match(nG),t){let n=parseInt(t[1]);return R(n!==0&&n<=32,"invalid bytes length","param",e),new IV(n,e.name)}R(!1,"invalid type","type",e.type)};let Mh=Ag;class oG{constructor(e,t,n){$(this,"fragment");$(this,"name");$(this,"signature");$(this,"topic");$(this,"args");const s=e.name,i=e.format();ye(this,{fragment:e,name:s,signature:i,topic:t,args:n})}}class aG{constructor(e,t,n,s){$(this,"fragment");$(this,"name");$(this,"args");$(this,"signature");$(this,"selector");$(this,"value");const i=e.name,o=e.format();ye(this,{fragment:e,name:i,args:n,signature:o,selector:t,value:s})}}class cG{constructor(e,t,n){$(this,"fragment");$(this,"name");$(this,"args");$(this,"signature");$(this,"selector");const s=e.name,i=e.format();ye(this,{fragment:e,name:s,args:n,signature:i,selector:t})}}class bC{constructor(e){$(this,"hash");$(this,"_isIndexed");ye(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const EC={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},vC={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:r=>`reverted with reason string ${JSON.stringify(r)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:r=>{let e="unknown panic code";return r>=0&&r<=255&&EC[r.toString()]&&(e=EC[r.toString()]),`reverted with panic code 0x${r.toString(16)} (${e})`}}};var Ps,Os,Rs,Er,Gs,Op,Rp;const pa=class pa{constructor(e){M(this,Gs);$(this,"fragments");$(this,"deploy");$(this,"fallback");$(this,"receive");M(this,Ps);M(this,Os);M(this,Rs);M(this,Er);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,_(this,Rs,new Map),_(this,Ps,new Map),_(this,Os,new Map);const n=[];for(const o of t)try{n.push(hc.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}ye(this,{fragments:Object.freeze(n)});let s=null,i=!1;_(this,Er,this.getAbiCoder()),this.fragments.forEach((o,a)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}ye(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(R(!s||o.payable!==s.payable,"conflicting fallback fragments",`fragments[${a}]`,o),s=o,i=s.payable);return;case"function":c=y(this,Rs);break;case"event":c=y(this,Os);break;case"error":c=y(this,Ps);break;default:return}const l=o.format();c.has(l)||c.set(l,o)}),this.deploy||ye(this,{deploy:Di.from("constructor()")}),ye(this,{fallback:s,receive:i})}format(e){const t=e?"minimal":"full";return this.fragments.map(s=>s.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return Mh.defaultAbiCoder()}getFunctionName(e){const t=W(this,Gs,Op).call(this,e,null,!1);return R(t,"no matching function","key",e),t.name}hasFunction(e){return!!W(this,Gs,Op).call(this,e,null,!1)}getFunction(e,t){return W(this,Gs,Op).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(y(this,Rs).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Rs).get(s),n)}}getEventName(e){const t=W(this,Gs,Rp).call(this,e,null,!1);return R(t,"no matching event","key",e),t.name}hasEvent(e){return!!W(this,Gs,Rp).call(this,e,null,!1)}getEvent(e,t){return W(this,Gs,Rp).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(y(this,Os).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Os).get(s),n)}}getError(e,t){if(pt(e)){const s=e.toLowerCase();if(vC[s])return Qr.from(vC[s].signature);for(const i of y(this,Ps).values())if(s===i.selector)return i;return null}if(e.indexOf("(")===-1){const s=[];for(const[i,o]of y(this,Ps))i.split("(")[0]===e&&s.push(o);if(s.length===0)return e==="Error"?Qr.from("error Error(string)"):e==="Panic"?Qr.from("error Panic(uint256)"):null;if(s.length>1){const i=s.map(o=>JSON.stringify(o.format())).join(", ");R(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return s[0]}if(e=Qr.from(e).format(),e==="Error(string)")return Qr.from("error Error(string)");if(e==="Panic(uint256)")return Qr.from("error Panic(uint256)");const n=y(this,Ps).get(e);return n||null}forEachError(e){const t=Array.from(y(this,Ps).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Ps).get(s),n)}}_decodeParams(e,t){return y(this,Er).decode(e,t)}_encodeParams(e,t){return y(this,Er).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);R(n,"unknown error","fragment",e),e=n}return R(Ot(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,Ot(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);R(n,"unknown error","fragment",e),e=n}return Rt([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);R(n,"unknown function","fragment",e),e=n}return R(Ot(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,Ot(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);R(n,"unknown function","fragment",e),e=n}return Rt([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const i=this.getFunction(e);R(i,"unknown function","fragment",e),e=i}let n="invalid length for result data";const s=kr(t);if(s.length%32===0)try{return y(this,Er).decode(e.outputs,s)}catch{n="could not decode result data"}q(!1,n,"BAD_DATA",{value:re(s),info:{method:e.name,signature:e.format()}})}makeError(e,t){const n=Be(e,"data"),s=Mh.getBuiltinCallException("call",t,n);if(s.message.startsWith("execution reverted (unknown custom error)")){const a=re(n.slice(0,4)),c=this.getError(a);if(c)try{const l=y(this,Er).decode(c.inputs,n.slice(4));s.revert={name:c.name,signature:c.format(),args:l},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(t);return o&&(s.invocation={method:o.name,signature:o.signature,args:o.args}),s}encodeFunctionResult(e,t){if(typeof e=="string"){const n=this.getFunction(e);R(n,"unknown function","fragment",e),e=n}return re(y(this,Er).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const i=this.getEvent(e);R(i,"unknown event","eventFragment",e),e=i}q(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const s=(i,o)=>i.type==="string"?uc(o):i.type==="bytes"?jt(re(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=jo(o):i.type.match(/^bytes/)?o=Iz(o,32):i.type==="address"&&y(this,Er).encode(["address"],[o]),Fi(re(o),32));for(t.forEach((i,o)=>{const a=e.inputs[o];if(!a.indexed){R(i==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,i);return}i==null?n.push(null):a.baseType==="array"||a.baseType==="tuple"?R(!1,"filtering with tuples or arrays not supported","contract."+a.name,i):Array.isArray(i)?n.push(i.map(c=>s(a,c))):n.push(s(a,i))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,t){if(typeof e=="string"){const o=this.getEvent(e);R(o,"unknown event","eventFragment",e),e=o}const n=[],s=[],i=[];return e.anonymous||n.push(e.topicHash),R(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((o,a)=>{const c=t[a];if(o.indexed)if(o.type==="string")n.push(uc(c));else if(o.type==="bytes")n.push(jt(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");n.push(y(this,Er).encode([o.type],[c]))}else s.push(o),i.push(c)}),{data:y(this,Er).encode(s,i),topics:n}}decodeEventLog(e,t,n){if(typeof e=="string"){const f=this.getEvent(e);R(f,"unknown event","eventFragment",e),e=f}if(n!=null&&!e.anonymous){const f=e.topicHash;R(pt(n[0],32)&&n[0].toLowerCase()===f,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const s=[],i=[],o=[];e.inputs.forEach((f,g)=>{f.indexed?f.type==="string"||f.type==="bytes"||f.baseType==="tuple"||f.baseType==="array"?(s.push(gr.from({type:"bytes32",name:f.name})),o.push(!0)):(s.push(f),o.push(!1)):(i.push(f),o.push(!1))});const a=n!=null?y(this,Er).decode(s,Rt(n)):null,c=y(this,Er).decode(i,t,!0),l=[],u=[];let d=0,h=0;return e.inputs.forEach((f,g)=>{let p=null;if(f.indexed)if(a==null)p=new bC(null);else if(o[g])p=new bC(a[h++]);else try{p=a[h++]}catch(m){p=m}else try{p=c[d++]}catch(m){p=m}l.push(p),u.push(f.name||null)}),Iu.fromItems(l,u)}parseTransaction(e){const t=Be(e.data,"tx.data"),n=he(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(re(t.slice(0,4)));if(!s)return null;const i=y(this,Er).decode(s.inputs,t.slice(4));return new aG(s,s.selector,i,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new oG(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=re(e),n=this.getError(Ot(t,0,4));if(!n)return null;const s=y(this,Er).decode(n.inputs,Ot(t,4));return new cG(n,n.selector,s)}static from(e){return e instanceof pa?e:typeof e=="string"?new pa(JSON.parse(e)):typeof e.formatJson=="function"?new pa(e.formatJson()):typeof e.format=="function"?new pa(e.format("json")):new pa(e)}};Ps=new WeakMap,Os=new WeakMap,Rs=new WeakMap,Er=new WeakMap,Gs=new WeakSet,Op=function(e,t,n){if(pt(e)){const i=e.toLowerCase();for(const o of y(this,Rs).values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of y(this,Rs))o.split("(")[0]===e&&i.push(a);if(t){const o=t.length>0?t[t.length-1]:null;let a=t.length,c=!0;_r.isTyped(o)&&o.type==="overrides"&&(c=!1,a--);for(let l=i.length-1;l>=0;l--){const u=i[l].inputs.length;u!==a&&(!c||u!==a-1)&&i.splice(l,1)}for(let l=i.length-1;l>=0;l--){const u=i[l].inputs;for(let d=0;d<t.length;d++)if(_r.isTyped(t[d])){if(d>=u.length){if(t[d].type==="overrides")continue;i.splice(l,1);break}if(t[d].type!==u[d].baseType){i.splice(l,1);break}}}}if(i.length===1&&t&&t.length!==i[0].inputs.length){const o=t[t.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");R(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const s=y(this,Rs).get(js.from(e).format());return s||null},Rp=function(e,t,n){if(pt(e)){const i=e.toLowerCase();for(const o of y(this,Os).values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of y(this,Os))o.split("(")[0]===e&&i.push(a);if(t){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<t.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const a=i[o].inputs;for(let c=0;c<t.length;c++)if(_r.isTyped(t[c])&&t[c].type!==a[c].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");R(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const s=y(this,Os).get(Fs.from(e).format());return s||null};let gb=pa;const Dx=BigInt(0);function El(r){return r??null}function Dt(r){return r==null?null:r.toString()}class AC{constructor(e,t,n){$(this,"gasPrice");$(this,"maxFeePerGas");$(this,"maxPriorityFeePerGas");ye(this,{gasPrice:El(e),maxFeePerGas:El(t),maxPriorityFeePerGas:El(n)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:n}=this;return{_type:"FeeData",gasPrice:Dt(e),maxFeePerGas:Dt(t),maxPriorityFeePerGas:Dt(n)}}}function mg(r){const e={};r.to&&(e.to=r.to),r.from&&(e.from=r.from),r.data&&(e.data=re(r.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of t)!(s in r)||r[s]==null||(e[s]=he(r[s],`request.${s}`));const n="type,nonce".split(/,/);for(const s of n)!(s in r)||r[s]==null||(e[s]=Re(r[s],`request.${s}`));return r.accessList&&(e.accessList=Cc(r.accessList)),r.authorizationList&&(e.authorizationList=r.authorizationList.slice()),"blockTag"in r&&(e.blockTag=r.blockTag),"enableCcipRead"in r&&(e.enableCcipRead=!!r.enableCcipRead),"customData"in r&&(e.customData=r.customData),"blobVersionedHashes"in r&&r.blobVersionedHashes&&(e.blobVersionedHashes=r.blobVersionedHashes.slice()),"kzg"in r&&(e.kzg=r.kzg),"blobs"in r&&r.blobs&&(e.blobs=r.blobs.map(s=>g0(s)?re(s):Object.assign({},s))),e}var vi;class lG{constructor(e,t){$(this,"provider");$(this,"number");$(this,"hash");$(this,"timestamp");$(this,"parentHash");$(this,"parentBeaconBlockRoot");$(this,"nonce");$(this,"difficulty");$(this,"gasLimit");$(this,"gasUsed");$(this,"stateRoot");$(this,"receiptsRoot");$(this,"blobGasUsed");$(this,"excessBlobGas");$(this,"miner");$(this,"prevRandao");$(this,"extraData");$(this,"baseFeePerGas");M(this,vi);_(this,vi,e.transactions.map(n=>typeof n!="string"?new Fh(n,t):n)),ye(this,{provider:t,hash:El(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:El(e.prevRandao),extraData:e.extraData,baseFeePerGas:El(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return y(this,vi).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=y(this,vi).slice();return e.length===0?[]:(q(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:n,gasLimit:s,gasUsed:i,hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:d,parentBeaconBlockRoot:h,stateRoot:f,receiptsRoot:g,timestamp:p,transactions:m}=this;return{_type:"Block",baseFeePerGas:Dt(e),difficulty:Dt(t),extraData:n,gasLimit:Dt(s),gasUsed:Dt(i),blobGasUsed:Dt(this.blobGasUsed),excessBlobGas:Dt(this.excessBlobGas),hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:d,timestamp:p,parentBeaconBlockRoot:h,stateRoot:f,receiptsRoot:g,transactions:m}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return y(this,vi).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let t;if(typeof e=="number")t=y(this,vi)[e];else{const n=e.toLowerCase();for(const s of y(this,vi))if(typeof s=="string"){if(s!==n)continue;t=s;break}else{if(s.hash!==n)continue;t=s;break}}if(t==null)throw new Error("no such tx");return typeof t=="string"?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if(typeof e=="number")return t[e];e=e.toLowerCase();for(const n of t)if(n.hash===e)return n;R(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return uG(this)}}vi=new WeakMap;class Af{constructor(e,t){$(this,"provider");$(this,"transactionHash");$(this,"blockHash");$(this,"blockNumber");$(this,"removed");$(this,"address");$(this,"data");$(this,"topics");$(this,"index");$(this,"transactionIndex");this.provider=t;const n=Object.freeze(e.topics.slice());ye(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:n,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:n,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:l}=this;return{_type:"log",address:e,blockHash:t,blockNumber:n,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:l}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return q(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return q(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return q(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return dG(this)}}var Gh;class kx{constructor(e,t){$(this,"provider");$(this,"to");$(this,"from");$(this,"contractAddress");$(this,"hash");$(this,"index");$(this,"blockHash");$(this,"blockNumber");$(this,"logsBloom");$(this,"gasUsed");$(this,"blobGasUsed");$(this,"cumulativeGasUsed");$(this,"gasPrice");$(this,"blobGasPrice");$(this,"type");$(this,"status");$(this,"root");M(this,Gh);_(this,Gh,Object.freeze(e.logs.map(s=>new Af(s,t))));let n=Dx;e.effectiveGasPrice!=null?n=e.effectiveGasPrice:e.gasPrice!=null&&(n=e.gasPrice),ye(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:n,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return y(this,Gh)}toJSON(){const{to:e,from:t,contractAddress:n,hash:s,index:i,blockHash:o,blockNumber:a,logsBloom:c,logs:l,status:u,root:d}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:n,cumulativeGasUsed:Dt(this.cumulativeGasUsed),from:t,gasPrice:Dt(this.gasPrice),blobGasUsed:Dt(this.blobGasUsed),blobGasPrice:Dt(this.blobGasPrice),gasUsed:Dt(this.gasUsed),hash:s,index:i,logs:l,logsBloom:c,root:d,status:u,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return Bx(this)}reorderedEvent(e){return q(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),Ux(this,e)}}Gh=new WeakMap;var bo;const B0=class B0{constructor(e,t){$(this,"provider");$(this,"blockNumber");$(this,"blockHash");$(this,"index");$(this,"hash");$(this,"type");$(this,"to");$(this,"from");$(this,"nonce");$(this,"gasLimit");$(this,"gasPrice");$(this,"maxPriorityFeePerGas");$(this,"maxFeePerGas");$(this,"maxFeePerBlobGas");$(this,"data");$(this,"value");$(this,"chainId");$(this,"signature");$(this,"accessList");$(this,"blobVersionedHashes");$(this,"authorizationList");M(this,bo);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,_(this,bo,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:n,hash:s,type:i,to:o,from:a,nonce:c,data:l,signature:u,accessList:d,blobVersionedHashes:h}=this;return{_type:"TransactionResponse",accessList:d,blockNumber:e,blockHash:t,blobVersionedHashes:h,chainId:Dt(this.chainId),data:l,from:a,gasLimit:Dt(this.gasLimit),gasPrice:Dt(this.gasPrice),hash:s,maxFeePerGas:Dt(this.maxFeePerGas),maxPriorityFeePerGas:Dt(this.maxPriorityFeePerGas),maxFeePerBlobGas:Dt(this.maxFeePerBlobGas),nonce:c,signature:u,to:o,index:n,type:i,value:Dt(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const n=await this.getTransaction();n&&(e=n.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:n}=await Dr({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:n-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const n=e??1,s=t??0;let i=y(this,bo),o=-1,a=i===-1;const c=async()=>{if(a)return null;const{blockNumber:h,nonce:f}=await Dr({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(f<this.nonce){i=h;return}if(a)return null;const g=await this.getTransaction();if(!(g&&g.blockNumber!=null))for(o===-1&&(o=i-3,o<y(this,bo)&&(o=y(this,bo)));o<=h;){if(a)return null;const p=await this.provider.getBlock(o,!0);if(p==null)return;for(const m of p)if(m===this.hash)return;for(let m=0;m<p.length;m++){const w=await p.getTransaction(m);if(w.from===this.from&&w.nonce===this.nonce){if(a)return null;const A=await this.provider.getTransactionReceipt(w.hash);if(A==null||h-A.blockNumber+1<n)return;let v="replaced";w.data===this.data&&w.to===this.to&&w.value===this.value?v="repriced":w.data==="0x"&&w.from===w.to&&w.value===Dx&&(v="cancelled"),q(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:v==="replaced"||v==="cancelled",reason:v,replacement:w.replaceableTransaction(i),hash:w.hash,receipt:A})}}o++}},l=h=>{if(h==null||h.status!==0)return h;q(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:h.to,from:h.from,data:""},receipt:h})},u=await this.provider.getTransactionReceipt(this.hash);if(n===0)return l(u);if(u){if(await u.confirmations()>=n)return l(u)}else if(await c(),n===0)return null;return await new Promise((h,f)=>{const g=[],p=()=>{g.forEach(w=>w())};if(g.push(()=>{a=!0}),s>0){const w=setTimeout(()=>{p(),f(Nt("wait for transaction timeout","TIMEOUT"))},s);g.push(()=>{clearTimeout(w)})}const m=async w=>{if(await w.confirmations()>=n){p();try{h(l(w))}catch(A){f(A)}}};if(g.push(()=>{this.provider.off(this.hash,m)}),this.provider.on(this.hash,m),i>=0){const w=async()=>{try{await c()}catch(A){if(dr(A,"TRANSACTION_REPLACED")){p(),f(A);return}}a||this.provider.once("block",w)};g.push(()=>{this.provider.off("block",w)}),this.provider.once("block",w)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return q(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Bx(this)}reorderedEvent(e){return q(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),q(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Ux(this,e)}replaceableTransaction(e){R(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new B0(this,this.provider);return _(t,bo,e),t}};bo=new WeakMap;let Fh=B0;function uG(r){return{orphan:"drop-block",hash:r.hash,number:r.number}}function Ux(r,e){return{orphan:"reorder-transaction",tx:r,other:e}}function Bx(r){return{orphan:"drop-transaction",tx:r}}function dG(r){return{orphan:"drop-log",log:{transactionHash:r.transactionHash,blockHash:r.blockHash,blockNumber:r.blockNumber,address:r.address,data:r.data,topics:Object.freeze(r.topics.slice()),index:r.index}}}class T0 extends Af{constructor(t,n,s){super(t,t.provider);$(this,"interface");$(this,"fragment");$(this,"args");const i=n.decodeEventLog(s,t.data,t.topics);ye(this,{args:i,fragment:s,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class Lx extends Af{constructor(t,n){super(t,t.provider);$(this,"error");ye(this,{error:n})}}var Kl;class hG extends kx{constructor(t,n,s){super(s,n);M(this,Kl);_(this,Kl,t)}get logs(){return super.logs.map(t=>{const n=t.topics.length?y(this,Kl).getEvent(t.topics[0]):null;if(n)try{return new T0(t,y(this,Kl),n)}catch(s){return new Lx(t,s)}return t})}}Kl=new WeakMap;var Kh;class P0 extends Fh{constructor(t,n,s){super(s,n);M(this,Kh);_(this,Kh,t)}async wait(t,n){const s=await super.wait(t,n);return s==null?null:new hG(y(this,Kh),this.provider,s)}}Kh=new WeakMap;class $x extends aS{constructor(t,n,s,i){super(t,n,s);$(this,"log");ye(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class fG extends $x{constructor(e,t,n,s,i){super(e,t,n,new T0(i,e.interface,s));const o=e.interface.decodeEventLog(s,this.log.data,this.log.topics);ye(this,{args:o,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const CC=BigInt(0);function Mx(r){return r&&typeof r.call=="function"}function Fx(r){return r&&typeof r.estimateGas=="function"}function lm(r){return r&&typeof r.resolveName=="function"}function jx(r){return r&&typeof r.sendTransaction=="function"}function Hx(r){if(r!=null){if(lm(r))return r;if(r.provider)return r.provider}}var Jh;class pG{constructor(e,t,n){M(this,Jh);$(this,"fragment");if(ye(this,{fragment:t}),t.inputs.length<n.length)throw new Error("too many arguments");const s=fc(e.runner,"resolveName"),i=lm(s)?s:null;_(this,Jh,async function(){const o=await Promise.all(t.inputs.map((a,c)=>n[c]==null?null:a.walkAsync(n[c],(u,d)=>u==="address"?Array.isArray(d)?Promise.all(d.map(h=>Br(h,i))):Br(d,i):d)));return e.interface.encodeFilterTopics(t,o)}())}getTopicFilter(){return y(this,Jh)}}Jh=new WeakMap;function fc(r,e){return r==null?null:typeof r[e]=="function"?r:r.provider&&typeof r.provider[e]=="function"?r.provider:null}function Ca(r){return r==null?null:r.provider||null}async function zx(r,e){const t=_r.dereference(r,"overrides");R(typeof t=="object","invalid overrides parameter","overrides",r);const n=mg(t);return R(n.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),R(n.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function gG(r,e,t){const n=fc(r,"resolveName"),s=lm(n)?n:null;return await Promise.all(e.map((i,o)=>i.walkAsync(t[o],(a,c)=>(c=_r.dereference(c,a),a==="address"?Br(c,s):c))))}function mG(r){const e=async function(o){const a=await zx(o,["data"]);a.to=await r.getAddress(),a.from&&(a.from=await Br(a.from,Hx(r.runner)));const c=r.interface,l=he(a.value||CC,"overrides.value")===CC,u=(a.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!u&&!l&&R(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),R(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data);const d=c.receive||c.fallback&&c.fallback.payable;return R(d||l,"cannot send value to non-payable fallback","overrides.value",a.value),R(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data),a},t=async function(o){const a=fc(r.runner,"call");q(Mx(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(o);try{return await a.call(c)}catch(l){throw p0(l)&&l.data?r.interface.makeError(l.data,c):l}},n=async function(o){const a=r.runner;q(jx(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await a.sendTransaction(await e(o)),l=Ca(r.runner);return new P0(r.interface,l,c)},s=async function(o){const a=fc(r.runner,"estimateGas");return q(Fx(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},i=async o=>await n(o);return ye(i,{_contract:r,estimateGas:s,populateTransaction:e,send:n,staticCall:t}),i}function yG(r,e){const t=function(...l){const u=r.interface.getFunction(e,l);return q(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:l}}),u},n=async function(...l){const u=t(...l);let d={};if(u.inputs.length+1===l.length&&(d=await zx(l.pop()),d.from&&(d.from=await Br(d.from,Hx(r.runner)))),u.inputs.length!==l.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const h=await gG(r.runner,u.inputs,l);return Object.assign({},d,await Dr({to:r.getAddress(),data:r.interface.encodeFunctionData(u,h)}))},s=async function(...l){const u=await a(...l);return u.length===1?u[0]:u},i=async function(...l){const u=r.runner;q(jx(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const d=await u.sendTransaction(await n(...l)),h=Ca(r.runner);return new P0(r.interface,h,d)},o=async function(...l){const u=fc(r.runner,"estimateGas");return q(Fx(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await n(...l))},a=async function(...l){const u=fc(r.runner,"call");q(Mx(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const d=await n(...l);let h="0x";try{h=await u.call(d)}catch(g){throw p0(g)&&g.data?r.interface.makeError(g.data,d):g}const f=t(...l);return r.interface.decodeFunctionResult(f,h)},c=async(...l)=>t(...l).constant?await s(...l):await i(...l);return ye(c,{name:r.interface.getFunctionName(e),_contract:r,_key:e,getFragment:t,estimateGas:o,populateTransaction:n,send:i,staticCall:s,staticCallResult:a}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const l=r.interface.getFunction(e);return q(l,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),l}}),c}function wG(r,e){const t=function(...s){const i=r.interface.getEvent(e,s);return q(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),i},n=function(...s){return new pG(r,t(...s),s)};return ye(n,{name:r.interface.getEventName(e),_contract:r,_key:e,getFragment:t}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=r.interface.getEvent(e);return q(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),n}const yg=Symbol.for("_ethersInternal_contract"),qx=new WeakMap;function bG(r,e){qx.set(r[yg],e)}function fn(r){return qx.get(r[yg])}function EG(r){return r&&typeof r=="object"&&"getTopicFilter"in r&&typeof r.getTopicFilter=="function"&&r.fragment}async function O0(r,e){let t,n=null;if(Array.isArray(e)){const i=function(o){if(pt(o,32))return o;const a=r.interface.getEvent(o);return R(a,"unknown fragment","name",o),a.topicHash};t=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?t=[null]:typeof e=="string"?pt(e,32)?t=[e]:(n=r.interface.getEvent(e),R(n,"unknown fragment","event",e),t=[n.topicHash]):EG(e)?t=await e.getTopicFilter():"fragment"in e?(n=e.fragment,t=[n.topicHash]):R(!1,"unknown event name","event",e);t=t.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const s=t.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:n,tag:s,topics:t}}async function Ad(r,e){const{subs:t}=fn(r);return t.get((await O0(r,e)).tag)||null}async function _C(r,e,t){const n=Ca(r.runner);q(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:i,topics:o}=await O0(r,t),{addr:a,subs:c}=fn(r);let l=c.get(i);if(!l){const d={address:a||r,topics:o},h=m=>{let w=s;if(w==null)try{w=r.interface.getEvent(m.topics[0])}catch{}if(w){const A=w,v=s?r.interface.decodeEventLog(s,m.data,m.topics):[];yb(r,t,v,I=>new fG(r,I,t,A,m))}else yb(r,t,[],A=>new $x(r,A,t,m))};let f=[];l={tag:i,listeners:[],start:()=>{f.length||f.push(n.on(d,h))},stop:async()=>{if(f.length==0)return;let m=f;f=[],await Promise.all(m),n.off(d,h)}},c.set(i,l)}return l}let mb=Promise.resolve();async function vG(r,e,t,n){await mb;const s=await Ad(r,e);if(!s)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter(({listener:o,once:a})=>{const c=Array.from(t);n&&c.push(n(a?null:o));try{o.call(r,...c)}catch{}return!a}),s.listeners.length===0&&(s.stop(),fn(r).subs.delete(s.tag)),i>0}async function yb(r,e,t,n){try{await mb}catch{}const s=vG(r,e,t,n);return mb=s,await s}const dp=["then"];var BC;BC=yg;const $d=class $d{constructor(e,t,n,s){$(this,"target");$(this,"interface");$(this,"runner");$(this,"filters");$(this,BC);$(this,"fallback");R(typeof e=="string"||JS(e),"invalid value for Contract target","target",e),n==null&&(n=null);const i=gb.from(t);ye(this,{target:e,runner:n,interface:i}),Object.defineProperty(this,yg,{value:{}});let o,a=null,c=null;if(s){const d=Ca(n);c=new P0(this.interface,d,s)}let l=new Map;if(typeof e=="string")if(pt(e))a=e,o=Promise.resolve(e);else{const d=fc(n,"resolveName");if(!lm(d))throw Nt("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=d.resolveName(e).then(h=>{if(h==null)throw Nt("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return fn(this).addr=h,h})}else o=e.getAddress().then(d=>{if(d==null)throw new Error("TODO");return fn(this).addr=d,d});bG(this,{addrPromise:o,addr:a,deployTx:c,subs:l});const u=new Proxy({},{get:(d,h,f)=>{if(typeof h=="symbol"||dp.indexOf(h)>=0)return Reflect.get(d,h,f);try{return this.getEvent(h)}catch(g){if(!dr(g,"INVALID_ARGUMENT")||g.argument!=="key")throw g}},has:(d,h)=>dp.indexOf(h)>=0?Reflect.has(d,h):Reflect.has(d,h)||this.interface.hasEvent(String(h))});return ye(this,{filters:u}),ye(this,{fallback:i.receive||i.fallback?mG(this):null}),new Proxy(this,{get:(d,h,f)=>{if(typeof h=="symbol"||h in d||dp.indexOf(h)>=0)return Reflect.get(d,h,f);try{return d.getFunction(h)}catch(g){if(!dr(g,"INVALID_ARGUMENT")||g.argument!=="key")throw g}},has:(d,h)=>typeof h=="symbol"||h in d||dp.indexOf(h)>=0?Reflect.has(d,h):d.interface.hasFunction(h)})}connect(e){return new $d(this.target,this.interface,e)}attach(e){return new $d(e,this.interface,this.runner)}async getAddress(){return await fn(this).addrPromise}async getDeployedCode(){const e=Ca(this.runner);q(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=Ca(this.runner);return q(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);n.once("block",o)}catch(a){i(a)}};o()})}deploymentTransaction(){return fn(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),yG(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),wG(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,n){t==null&&(t=0),n==null&&(n="latest");const{addr:s,addrPromise:i}=fn(this),o=s||await i,{fragment:a,topics:c}=await O0(this,e),l={address:o,topics:c,fromBlock:t,toBlock:n},u=Ca(this.runner);return q(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(l)).map(d=>{let h=a;if(h==null)try{h=this.interface.getEvent(d.topics[0])}catch{}if(h)try{return new T0(d,this.interface,h)}catch(f){return new Lx(d,f)}return new Af(d,u)})}async on(e,t){const n=await _C(this,"on",e);return n.listeners.push({listener:t,once:!1}),n.start(),this}async once(e,t){const n=await _C(this,"once",e);return n.listeners.push({listener:t,once:!0}),n.start(),this}async emit(e,...t){return await yb(this,e,t,null)}async listenerCount(e){if(e){const s=await Ad(this,e);return s?s.listeners.length:0}const{subs:t}=fn(this);let n=0;for(const{listeners:s}of t.values())n+=s.length;return n}async listeners(e){if(e){const s=await Ad(this,e);return s?s.listeners.map(({listener:i})=>i):[]}const{subs:t}=fn(this);let n=[];for(const{listeners:s}of t.values())n=n.concat(s.map(({listener:i})=>i));return n}async off(e,t){const n=await Ad(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(t==null||n.listeners.length===0)&&(n.stop(),fn(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const t=await Ad(this,e);if(!t)return this;t.stop(),fn(this).subs.delete(t.tag)}else{const{subs:t}=fn(this);for(const{tag:n,stop:s}of t.values())s(),t.delete(n)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends $d{constructor(s,i=null){super(s,e,i)}}return t}static from(e,t,n){return n==null&&(n=null),new this(e,t,n)}};let wb=$d;function AG(){return wb}class Qa extends AG(){}function Hy(r){return r.match(/^ipfs:\/\/ipfs\//i)?r=r.substring(12):r.match(/^ipfs:\/\//i)?r=r.substring(7):R(!1,"unsupported IPFS format","link",r),`https://gateway.ipfs.io/ipfs/${r}`}class CG{constructor(e){$(this,"name");ye(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const Vx=new RegExp("^(ipfs)://(.*)$","i"),NC=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),Vx,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var Eo,Ba,vo,sl,Cg,Wx;const ul=class ul{constructor(e,t,n){M(this,vo);$(this,"provider");$(this,"address");$(this,"name");M(this,Eo);M(this,Ba);ye(this,{provider:e,address:t,name:n}),_(this,Eo,null),_(this,Ba,new Qa(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return y(this,Eo)==null&&_(this,Eo,(async()=>{try{return await y(this,Ba).supportsInterface("0x9061b923")}catch(e){if(dr(e,"CALL_EXCEPTION"))return!1;throw _(this,Eo,null),e}})()),await y(this,Eo)}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await W(this,vo,sl).call(this,"addr(bytes32)");return i==null||i===Rh?null:i}catch(i){if(dr(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await W(this,vo,sl).call(this,"addr(bytes32,uint)",[i]);if(pt(o,20))return rt(o)}let t=null;for(const i of this.provider.plugins)if(i instanceof CG&&i.supportsCoinType(e)){t=i;break}if(t==null)return null;const n=await W(this,vo,sl).call(this,"addr(bytes32,uint)",[e]);if(n==null||n==="0x")return null;const s=await t.decodeAddress(e,n);if(s!=null)return s;q(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:n}})}async getText(e){const t=await W(this,vo,sl).call(this,"text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){const e=await W(this,vo,sl).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const s=t[1]==="e3010170"?"ipfs":"ipns",i=parseInt(t[4],16);if(t[5].length===i*2)return`${s}://${xz("0x"+t[2])}`}const n=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===64)return`bzz://${n[1]}`;q(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let n=0;n<NC.length;n++){const s=t.match(NC[n]);if(s==null)continue;const i=s[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const o=Hy(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:t});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const c=(s[2]||"").split("/");if(c.length!==2)return e.push({type:`!${i}caip`,value:s[2]||""}),{url:null,linkage:e};const l=c[1],u=new Qa(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const p=await u.ownerOf(l);if(a!==p)return e.push({type:"!owner",value:p}),{url:null,linkage:e};e.push({type:"owner",value:p})}else if(i==="erc1155"){const p=await u.balanceOf(a,l);if(!p)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:p.toString()})}let d=await u[o](l);if(d==null||d==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:d}),i==="erc1155"&&(d=d.replace("{id}",jo(l,32).substring(2)),e.push({type:"metadata-url-expanded",value:d})),d.match(/^ipfs:/i)&&(d=Hy(d)),e.push({type:"metadata-url",value:d});let h={};const f=await new ji(d).send();f.assertOk();try{h=f.bodyJson}catch{try{e.push({type:"!metadata",value:f.bodyText})}catch{const w=f.body;return w&&e.push({type:"!metadata",value:re(w)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!h)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(h)});let g=h.image;if(typeof g!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!g.match(/^(https:\/\/|data:)/i)){if(g.match(Vx)==null)return e.push({type:"!imageUrl-ipfs",value:g}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:g}),g=Hy(g)}return e.push({type:"url",value:g}),{linkage:e,url:g}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),n=t.getPlugin("org.ethers.plugins.network.Ens");return q(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),n.address}static async fromName(e,t){var s;let n=t;for(;;){if(n===""||n==="."||t!=="eth"&&n==="eth")return null;const i=await W(s=ul,Cg,Wx).call(s,e,n);if(i!=null){const o=new ul(e,i,t);return n!==t&&!await o.supportsWildcard()?null:o}n=n.split(".").slice(1).join(".")}}};Eo=new WeakMap,Ba=new WeakMap,vo=new WeakSet,sl=async function(e,t){t=(t||[]).slice();const n=y(this,Ba).interface;t.unshift(fb(this.name));let s=null;await this.supportsWildcard()&&(s=n.getFunction(e),q(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[$W(this.name,255),n.encodeFunctionData(s,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const i=await y(this,Ba)[e](...t);return s?n.decodeFunctionResult(s,i)[0]:i}catch(i){if(!dr(i,"CALL_EXCEPTION"))throw i}return null},Cg=new WeakSet,Wx=async function(e,t){const n=await ul.getEnsAddress(e);try{const i=await new Qa(n,["function resolver(bytes32) view returns (address)"],e).resolver(fb(t),{enableCcipRead:!0});return i===Rh?null:i}catch(s){throw s}return null},M(ul,Cg);let wg=ul;const IC=BigInt(0);function He(r,e){return function(t){return t==null?e:r(t)}}function jh(r,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(n=>r(n))}}function Cf(r,e){return t=>{const n={};for(const s in r){let i=s;if(e&&s in e&&!(i in t)){for(const o of e[s])if(o in t){i=o;break}}try{const o=r[s](t[i]);o!==void 0&&(n[s]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";q(!1,`invalid value for value.${s} (${a})`,"BAD_DATA",{value:t})}}return n}}function _G(r){switch(r){case!0:case"true":return!0;case!1:case"false":return!1}R(!1,`invalid boolean; ${JSON.stringify(r)}`,"value",r)}function Du(r){return R(pt(r,!0),"invalid data","value",r),r}function ur(r){return R(pt(r,32),"invalid hash","value",r),r}const NG=Cf({address:rt,blockHash:ur,blockNumber:Re,data:Du,index:Re,removed:He(_G,!1),topics:jh(ur),transactionHash:ur,transactionIndex:Re},{index:["logIndex"]});function IG(r){return NG(r)}const SG=Cf({hash:He(ur),parentHash:ur,parentBeaconBlockRoot:He(ur,null),number:Re,timestamp:Re,nonce:He(Du),difficulty:he,gasLimit:he,gasUsed:he,stateRoot:He(ur,null),receiptsRoot:He(ur,null),blobGasUsed:He(he,null),excessBlobGas:He(he,null),miner:He(rt),prevRandao:He(ur,null),extraData:Du,baseFeePerGas:He(he)},{prevRandao:["mixHash"]});function xG(r){const e=SG(r);return e.transactions=r.transactions.map(t=>typeof t=="string"?t:Gx(t)),e}const TG=Cf({transactionIndex:Re,blockNumber:Re,transactionHash:ur,address:rt,topics:jh(ur),data:Du,index:Re,blockHash:ur},{index:["logIndex"]});function PG(r){return TG(r)}const OG=Cf({to:He(rt,null),from:He(rt,null),contractAddress:He(rt,null),index:Re,root:He(re),gasUsed:he,blobGasUsed:He(he,null),logsBloom:He(Du),blockHash:ur,hash:ur,logs:jh(PG),blockNumber:Re,cumulativeGasUsed:he,effectiveGasPrice:He(he),blobGasPrice:He(he,null),status:He(Re),type:He(Re,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function RG(r){return OG(r)}function Gx(r){r.to&&he(r.to)===IC&&(r.to="0x0000000000000000000000000000000000000000");const e=Cf({hash:ur,index:He(Re,void 0),type:t=>t==="0x"||t==null?0:Re(t),accessList:He(Cc,null),blobVersionedHashes:He(jh(ur,!0),null),authorizationList:He(jh(t=>({address:rt(t.address),chainId:he(t.chainId),nonce:he(t.nonce),signature:Xr.from(t.signature?t.signature:t)}),!1),null),blockHash:He(ur,null),blockNumber:He(Re,null),transactionIndex:He(Re,null),from:rt,gasPrice:He(he),maxPriorityFeePerGas:He(he),maxFeePerGas:He(he),maxFeePerBlobGas:He(he,null),gasLimit:he,to:He(rt,null),value:he,nonce:Re,data:Du,creates:He(rt,null),chainId:He(he,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(r);if(e.to==null&&e.creates==null&&(e.creates=EV(e)),(r.type===1||r.type===2)&&r.accessList==null&&(e.accessList=[]),r.signature?e.signature=Xr.from(r.signature):e.signature=Xr.from(r),e.chainId==null){const t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&he(e.blockHash)===IC&&(e.blockHash=null),e}const DG="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class _f{constructor(e){$(this,"name");ye(this,{name:e})}clone(){return new _f(this.name)}}class um extends _f{constructor(t,n){t==null&&(t=0);super(`org.ethers.network.plugins.GasCost#${t||0}`);$(this,"effectiveBlock");$(this,"txBase");$(this,"txCreate");$(this,"txDataZero");$(this,"txDataNonzero");$(this,"txAccessListStorageKey");$(this,"txAccessListAddress");const s={effectiveBlock:t};function i(o,a){let c=(n||{})[o];c==null&&(c=a),R(typeof c=="number",`invalud value for ${o}`,"costs",n),s[o]=c}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),ye(this,s)}clone(){return new um(this.effectiveBlock,this)}}class dm extends _f{constructor(t,n){super("org.ethers.plugins.network.Ens");$(this,"address");$(this,"targetNetwork");ye(this,{address:t||DG,targetNetwork:n??1})}clone(){return new dm(this.address,this.targetNetwork)}}var Yh,Qh;class kG extends _f{constructor(t,n){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");M(this,Yh);M(this,Qh);_(this,Yh,t),_(this,Qh,n)}get url(){return y(this,Yh)}get processFunc(){return y(this,Qh)}clone(){return this}}Yh=new WeakMap,Qh=new WeakMap;const zy=new Map;var Jl,Yl,Ao;const dl=class dl{constructor(e,t){M(this,Jl);M(this,Yl);M(this,Ao);_(this,Jl,e),_(this,Yl,he(t)),_(this,Ao,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return y(this,Jl)}set name(e){_(this,Jl,e)}get chainId(){return y(this,Yl)}set chainId(e){_(this,Yl,he(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===he(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===he(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===he(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(y(this,Ao).values())}attachPlugin(e){if(y(this,Ao).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return y(this,Ao).set(e.name,e.clone()),this}getPlugin(e){return y(this,Ao).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const e=new dl(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new um;let n=t.txBase;if(e.to==null&&(n+=t.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?n+=t.txDataZero:n+=t.txDataNonzero;if(e.accessList){const s=Cc(e.accessList);for(const i in s)n+=t.txAccessListAddress+t.txAccessListStorageKey*s[i].storageKeys.length}return n}static from(e){if(UG(),e==null)return dl.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const t=zy.get(e);if(t)return t();if(typeof e=="bigint")return new dl("unknown",e);R(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){R(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const t=new dl(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new dm(e.ensAddress,e.ensNetwork)),t}R(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));const n=zy.get(e);n&&R(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",e),zy.set(e,t)}};Jl=new WeakMap,Yl=new WeakMap,Ao=new WeakMap;let Hs=dl;function SC(r,e){const t=String(r);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${r}`);const n=t.split(".");if(n.length===1&&n.push(""),n.length!==2)throw new Error(`invalid gwei value: ${r}`);for(;n[1].length<e;)n[1]+="0";if(n[1].length>9){let s=BigInt(n[1].substring(0,9));n[1].substring(9).match(/^0+$/)||s++,n[1]=s.toString()}return BigInt(n[0]+n[1])}function xC(r){return new kG(r,async(e,t,n)=>{n.setHeader("User-Agent","ethers");let s;try{const[i,o]=await Promise.all([n.send(),e()]);s=i;const a=s.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:SC(a.maxFee,9),maxPriorityFeePerGas:SC(a.maxPriorityFee,9)}}catch(i){q(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:s,error:i})}})}let TC=!1;function UG(){if(TC)return;TC=!0;function r(e,t,n){const s=function(){const i=new Hs(e,t);return n.ensNetwork!=null&&i.attachPlugin(new dm(null,n.ensNetwork)),i.attachPlugin(new um),(n.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};Hs.register(e,s),Hs.register(t,s),n.altNames&&n.altNames.forEach(i=>{Hs.register(i,s)})}r("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),r("ropsten",3,{ensNetwork:3}),r("rinkeby",4,{ensNetwork:4}),r("goerli",5,{ensNetwork:5}),r("kovan",42,{ensNetwork:42}),r("sepolia",11155111,{ensNetwork:11155111}),r("holesky",17e3,{ensNetwork:17e3}),r("classic",61,{}),r("classicKotti",6,{}),r("arbitrum",42161,{ensNetwork:1}),r("arbitrum-goerli",421613,{}),r("arbitrum-sepolia",421614,{}),r("base",8453,{ensNetwork:1}),r("base-goerli",84531,{}),r("base-sepolia",84532,{}),r("bnb",56,{ensNetwork:1}),r("bnbt",97,{}),r("linea",59144,{ensNetwork:1}),r("linea-goerli",59140,{}),r("linea-sepolia",59141,{}),r("matic",137,{ensNetwork:1,plugins:[xC("https://gasstation.polygon.technology/v2")]}),r("matic-amoy",80002,{}),r("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[xC("https://gasstation-testnet.polygon.technology/v2")]}),r("optimism",10,{ensNetwork:1,plugins:[]}),r("optimism-goerli",420,{}),r("optimism-sepolia",11155420,{}),r("xdai",100,{ensNetwork:1})}function bb(r){return JSON.parse(JSON.stringify(r))}var Ai,kn,Co,Ds,Ql,Dp;class BG{constructor(e){M(this,Ql);M(this,Ai);M(this,kn);M(this,Co);M(this,Ds);_(this,Ai,e),_(this,kn,null),_(this,Co,4e3),_(this,Ds,-2)}get pollingInterval(){return y(this,Co)}set pollingInterval(e){_(this,Co,e)}start(){y(this,kn)||(_(this,kn,y(this,Ai)._setTimeout(W(this,Ql,Dp).bind(this),y(this,Co))),W(this,Ql,Dp).call(this))}stop(){y(this,kn)&&(y(this,Ai)._clearTimeout(y(this,kn)),_(this,kn,null))}pause(e){this.stop(),e&&_(this,Ds,-2)}resume(){this.start()}}Ai=new WeakMap,kn=new WeakMap,Co=new WeakMap,Ds=new WeakMap,Ql=new WeakSet,Dp=async function(){try{const e=await y(this,Ai).getBlockNumber();if(y(this,Ds)===-2){_(this,Ds,e);return}if(e!==y(this,Ds)){for(let t=y(this,Ds)+1;t<=e;t++){if(y(this,kn)==null)return;await y(this,Ai).emit("block",t)}_(this,Ds,e)}}catch{}y(this,kn)!=null&&_(this,kn,y(this,Ai)._setTimeout(W(this,Ql,Dp).bind(this),y(this,Co)))};var La,$a,_o;class R0{constructor(e){M(this,La);M(this,$a);M(this,_o);_(this,La,e),_(this,_o,!1),_(this,$a,t=>{this._poll(t,y(this,La))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){y(this,_o)||(_(this,_o,!0),y(this,$a).call(this,-2),y(this,La).on("block",y(this,$a)))}stop(){y(this,_o)&&(_(this,_o,!1),y(this,La).off("block",y(this,$a)))}pause(e){this.stop()}resume(){this.start()}}La=new WeakMap,$a=new WeakMap,_o=new WeakMap;var Zl,Ci;class LG extends R0{constructor(t,n){super(t);M(this,Zl);M(this,Ci);_(this,Zl,n),_(this,Ci,-2)}pause(t){t&&_(this,Ci,-2),super.pause(t)}async _poll(t,n){const s=await n.getBlock(y(this,Zl));s!=null&&(y(this,Ci)===-2?_(this,Ci,s.number):s.number>y(this,Ci)&&(n.emit(y(this,Zl),s.number),_(this,Ci,s.number)))}}Zl=new WeakMap,Ci=new WeakMap;var _g;class $G extends R0{constructor(t,n){super(t);M(this,_g);_(this,_g,bb(n))}async _poll(t,n){throw new Error("@TODO")}}_g=new WeakMap;var Xl;class MG extends R0{constructor(t,n){super(t);M(this,Xl);_(this,Xl,n)}async _poll(t,n){const s=await n.getTransactionReceipt(y(this,Xl));s&&n.emit(y(this,Xl),s)}}Xl=new WeakMap;var _i,eu,tu,No,Un,Ng,Kx;class D0{constructor(e,t){M(this,Ng);M(this,_i);M(this,eu);M(this,tu);M(this,No);M(this,Un);_(this,_i,e),_(this,eu,bb(t)),_(this,tu,W(this,Ng,Kx).bind(this)),_(this,No,!1),_(this,Un,-2)}start(){y(this,No)||(_(this,No,!0),y(this,Un)===-2&&y(this,_i).getBlockNumber().then(e=>{_(this,Un,e)}),y(this,_i).on("block",y(this,tu)))}stop(){y(this,No)&&(_(this,No,!1),y(this,_i).off("block",y(this,tu)))}pause(e){this.stop(),e&&_(this,Un,-2)}resume(){this.start()}}_i=new WeakMap,eu=new WeakMap,tu=new WeakMap,No=new WeakMap,Un=new WeakMap,Ng=new WeakSet,Kx=async function(e){if(y(this,Un)===-2)return;const t=bb(y(this,eu));t.fromBlock=y(this,Un)+1,t.toBlock=e;const n=await y(this,_i).getLogs(t);if(n.length===0){y(this,Un)<e-60&&_(this,Un,e-60);return}for(const s of n)y(this,_i).emit(y(this,eu),s),_(this,Un,s.blockNumber)};const FG=BigInt(2),jG=10;function hp(r){return r&&typeof r.then=="function"}function kp(r,e){return r+":"+JSON.stringify(e,(t,n)=>{if(n==null)return"null";if(typeof n=="bigint")return`bigint:${n.toString()}`;if(typeof n=="string")return n.toLowerCase();if(typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n);return s.sort(),s.reduce((i,o)=>(i[o]=n[o],i),{})}return n})}class Jx{constructor(e){$(this,"name");ye(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function HG(r){return JSON.parse(JSON.stringify(r))}function Eb(r){return r=Array.from(new Set(r).values()),r.sort(),r}async function qy(r,e){if(r==null)throw new Error("invalid event");if(Array.isArray(r)&&(r={topics:r}),typeof r=="string")switch(r){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:r,tag:r}}if(pt(r,32)){const t=r.toLowerCase();return{type:"transaction",tag:kp("tx",{hash:t}),hash:t}}if(r.orphan){const t=r;return{type:"orphan",tag:kp("orphan",t),filter:HG(t)}}if(r.address||r.topics){const t=r,n={topics:(t.topics||[]).map(s=>s==null?null:Array.isArray(s)?Eb(s.map(i=>i.toLowerCase())):s.toLowerCase())};if(t.address){const s=[],i=[],o=a=>{pt(a)?s.push(a):i.push((async()=>{s.push(await Br(a,e))})())};Array.isArray(t.address)?t.address.forEach(o):o(t.address),i.length&&await Promise.all(i),n.address=Eb(s.map(a=>a.toLowerCase()))}return{filter:n,tag:kp("event",n),type:"event"}}R(!1,"unknown ProviderEvent","event",r)}function Vy(){return new Date().getTime()}const zG={cacheTimeout:250,pollingInterval:4e3};var vr,Io,Ar,ru,yn,Ma,So,Ni,Zh,Bn,nu,su,Me,un,vb,Ab,Cd,Cb,_d,Up;class qG{constructor(e,t){M(this,Me);M(this,vr);M(this,Io);M(this,Ar);M(this,ru);M(this,yn);M(this,Ma);M(this,So);M(this,Ni);M(this,Zh);M(this,Bn);M(this,nu);M(this,su);if(_(this,su,Object.assign({},zG,t||{})),e==="any")_(this,Ma,!0),_(this,yn,null);else if(e){const n=Hs.from(e);_(this,Ma,!1),_(this,yn,Promise.resolve(n)),setTimeout(()=>{this.emit("network",n,null)},0)}else _(this,Ma,!1),_(this,yn,null);_(this,Ni,-1),_(this,So,new Map),_(this,vr,new Map),_(this,Io,new Map),_(this,Ar,null),_(this,ru,!1),_(this,Zh,1),_(this,Bn,new Map),_(this,nu,!1)}get pollingInterval(){return y(this,su).pollingInterval}get provider(){return this}get plugins(){return Array.from(y(this,Io).values())}attachPlugin(e){if(y(this,Io).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return y(this,Io).set(e.name,e.connect(this)),this}getPlugin(e){return y(this,Io).get(e)||null}get disableCcipRead(){return y(this,nu)}set disableCcipRead(e){_(this,nu,!!e)}async ccipReadFetch(e,t,n){if(this.disableCcipRead||n.length===0||e.to==null)return null;const s=e.to.toLowerCase(),i=t.toLowerCase(),o=[];for(let a=0;a<n.length;a++){const c=n[a],l=c.replace("{sender}",s).replace("{data}",i),u=new ji(l);c.indexOf("{data}")===-1&&(u.body={data:i,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:a,urls:n});let d="unknown error",h;try{h=await u.send()}catch(f){o.push(f.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:f}});continue}try{const f=h.bodyJson;if(f.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:f}),f.data;f.message&&(d=f.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:f})}catch{}q(h.statusCode<400||h.statusCode>=500,`response not found during CCIP fetch: ${d}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:d}}),o.push(d)}q(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:n,errorMessages:o}})}_wrapBlock(e,t){return new lG(xG(e),this)}_wrapLog(e,t){return new Af(IG(e),this)}_wrapTransactionReceipt(e,t){return new kx(RG(e),this)}_wrapTransactionResponse(e,t){return new Fh(Gx(e),this)}_detectNetwork(){q(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){q(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=Re(await W(this,Me,un).call(this,{method:"getBlockNumber"}),"%response");return y(this,Ni)>=0&&_(this,Ni,e),e}_getAddress(e){return Br(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(pt(e))return pt(e,32)?e:Ri(e);if(typeof e=="bigint"&&(e=Re(e,"blockTag")),typeof e=="number")return e>=0?Ri(e):y(this,Ni)>=0?Ri(y(this,Ni)+e):this.getBlockNumber().then(t=>Ri(t+e));R(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const t=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?Eb(c.map(l=>l.toLowerCase())):c.toLowerCase()),n="blockHash"in e?e.blockHash:void 0,s=(c,l,u)=>{let d;switch(c.length){case 0:break;case 1:d=c[0];break;default:c.sort(),d=c}if(n&&(l!=null||u!=null))throw new Error("invalid filter");const h={};return d&&(h.address=d),t.length&&(h.topics=t),l&&(h.fromBlock=l),u&&(h.toBlock=u),n&&(h.blockHash=n),h};let i=[];if(e.address)if(Array.isArray(e.address))for(const c of e.address)i.push(this._getAddress(c));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),i.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(i),o,a]).then(c=>s(c[0],c[1],c[2])):s(i,o,a)}_getTransactionRequest(e){const t=mg(e),n=[];if(["to","from"].forEach(s=>{if(t[s]==null)return;const i=Br(t[s],this);hp(i)?n.push(async function(){t[s]=await i}()):t[s]=i}),t.blockTag!=null){const s=this._getBlockTag(t.blockTag);hp(s)?n.push(async function(){t.blockTag=await s}()):t.blockTag=s}return n.length?async function(){return await Promise.all(n),t}():t}async getNetwork(){if(y(this,yn)==null){const s=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw y(this,yn)===s&&_(this,yn,null),i}})();return _(this,yn,s),(await s).clone()}const e=y(this,yn),[t,n]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==n.chainId&&(y(this,Ma)?(this.emit("network",n,t),y(this,yn)===e&&_(this,yn,Promise.resolve(n))):q(!1,`network changed: ${t.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:s,gasPrice:i,priorityFee:o}=await Dr({_block:W(this,Me,Cb).call(this,"latest",!1),gasPrice:(async()=>{try{const u=await W(this,Me,un).call(this,{method:"getGasPrice"});return he(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const u=await W(this,Me,un).call(this,{method:"getPriorityFee"});return he(u,"%response")}catch{}return null})()});let a=null,c=null;const l=this._wrapBlock(s,e);return l&&l.baseFeePerGas&&(c=o??BigInt("1000000000"),a=l.baseFeePerGas*FG+c),new AC(i,a,c)},n=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const s=new ji(n.url),i=await n.processFunc(t,this,s);return new AC(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return hp(t)&&(t=await t),he(await W(this,Me,un).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:n}=await Dr({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await W(this,Me,Ab).call(this,W(this,Me,vb).call(this,t,n,e.enableCcipRead?0:-1))}async getBalance(e,t){return he(await W(this,Me,Cd).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return Re(await W(this,Me,Cd).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return re(await W(this,Me,Cd).call(this,{method:"getCode"},e,t))}async getStorage(e,t,n){const s=he(t,"position");return re(await W(this,Me,Cd).call(this,{method:"getStorage",position:s},e,n))}async broadcastTransaction(e){const{blockNumber:t,hash:n,network:s}=await Dr({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=lg.from(e);if(i.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,s).replaceableTransaction(t)}async getBlock(e,t){const{network:n,params:s}=await Dr({network:this.getNetwork(),params:W(this,Me,Cb).call(this,e,!!t)});return s==null?null:this._wrapBlock(s,n)}async getTransaction(e){const{network:t,params:n}=await Dr({network:this.getNetwork(),params:W(this,Me,un).call(this,{method:"getTransaction",hash:e})});return n==null?null:this._wrapTransactionResponse(n,t)}async getTransactionReceipt(e){const{network:t,params:n}=await Dr({network:this.getNetwork(),params:W(this,Me,un).call(this,{method:"getTransactionReceipt",hash:e})});if(n==null)return null;if(n.gasPrice==null&&n.effectiveGasPrice==null){const s=await W(this,Me,un).call(this,{method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(n,t)}async getTransactionResult(e){const{result:t}=await Dr({network:this.getNetwork(),result:W(this,Me,un).call(this,{method:"getTransactionResult",hash:e})});return t==null?null:re(t)}async getLogs(e){let t=this._getFilter(e);hp(t)&&(t=await t);const{network:n,params:s}=await Dr({network:this.getNetwork(),params:W(this,Me,un).call(this,{method:"getLogs",filter:t})});return s.map(i=>this._wrapLog(i,n))}_getProvider(e){q(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await wg.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=rt(e);const t=fb(e.substring(2).toLowerCase()+".addr.reverse");try{const n=await wg.getEnsAddress(this),i=await new Qa(n,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(i==null||i===Rh)return null;const a=await new Qa(i,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(a)!==e?null:a}catch(n){if(dr(n,"BAD_DATA")&&n.value==="0x"||dr(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(e,t,n){const s=t??1;return s===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let a=null;const c=async l=>{try{const u=await this.getTransactionReceipt(e);if(u!=null&&l-u.blockNumber+1>=s){i(u),a&&(clearTimeout(a),a=null);return}}catch(u){console.log("EEE",u)}this.once("block",c)};n!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",c),o(Nt("timeout","TIMEOUT",{reason:"timeout"})))},n)),c(await this.getBlockNumber())})}async waitForBlock(e){q(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=y(this,Bn).get(e);t&&(t.timer&&clearTimeout(t.timer),y(this,Bn).delete(e))}_setTimeout(e,t){t==null&&(t=0);const n=Ku(this,Zh)._++,s=()=>{y(this,Bn).delete(n),e()};if(this.paused)y(this,Bn).set(n,{timer:null,func:s,time:t});else{const i=setTimeout(s,t);y(this,Bn).set(n,{timer:i,func:s,time:Vy()})}return n}_forEachSubscriber(e){for(const t of y(this,vr).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new Jx(e.type);case"block":{const t=new BG(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new LG(this,e.type);case"event":return new D0(this,e.filter);case"transaction":return new MG(this,e.hash);case"orphan":return new $G(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const n of y(this,vr).values())if(n.subscriber===e){n.started&&n.subscriber.stop(),n.subscriber=t,n.started&&t.start(),y(this,Ar)!=null&&t.pause(y(this,Ar));break}}async on(e,t){const n=await W(this,Me,Up).call(this,e);return n.listeners.push({listener:t,once:!1}),n.started||(n.subscriber.start(),n.started=!0,y(this,Ar)!=null&&n.subscriber.pause(y(this,Ar))),this}async once(e,t){const n=await W(this,Me,Up).call(this,e);return n.listeners.push({listener:t,once:!0}),n.started||(n.subscriber.start(),n.started=!0,y(this,Ar)!=null&&n.subscriber.pause(y(this,Ar))),this}async emit(e,...t){const n=await W(this,Me,_d).call(this,e,t);if(!n||n.listeners.length===0)return!1;const s=n.listeners.length;return n.listeners=n.listeners.filter(({listener:i,once:o})=>{const a=new aS(this,o?null:i,e);try{i.call(this,...t,a)}catch{}return!o}),n.listeners.length===0&&(n.started&&n.subscriber.stop(),y(this,vr).delete(n.tag)),s>0}async listenerCount(e){if(e){const n=await W(this,Me,_d).call(this,e);return n?n.listeners.length:0}let t=0;for(const{listeners:n}of y(this,vr).values())t+=n.length;return t}async listeners(e){if(e){const n=await W(this,Me,_d).call(this,e);return n?n.listeners.map(({listener:s})=>s):[]}let t=[];for(const{listeners:n}of y(this,vr).values())t=t.concat(n.map(({listener:s})=>s));return t}async off(e,t){const n=await W(this,Me,_d).call(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(!t||n.listeners.length===0)&&(n.started&&n.subscriber.stop(),y(this,vr).delete(n.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:n,subscriber:s}=await W(this,Me,Up).call(this,e);n&&s.stop(),y(this,vr).delete(t)}else for(const[t,{started:n,subscriber:s}]of y(this,vr))n&&s.stop(),y(this,vr).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return y(this,ru)}destroy(){this.removeAllListeners();for(const e of y(this,Bn).keys())this._clearTimeout(e);_(this,ru,!0)}get paused(){return y(this,Ar)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(_(this,Ni,-1),y(this,Ar)!=null){if(y(this,Ar)==!!e)return;q(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),_(this,Ar,!!e);for(const t of y(this,Bn).values())t.timer&&clearTimeout(t.timer),t.time=Vy()-t.time}resume(){if(y(this,Ar)!=null){this._forEachSubscriber(e=>e.resume()),_(this,Ar,null);for(const e of y(this,Bn).values()){let t=e.time;t<0&&(t=0),e.time=Vy(),setTimeout(e.func,t)}}}}vr=new WeakMap,Io=new WeakMap,Ar=new WeakMap,ru=new WeakMap,yn=new WeakMap,Ma=new WeakMap,So=new WeakMap,Ni=new WeakMap,Zh=new WeakMap,Bn=new WeakMap,nu=new WeakMap,su=new WeakMap,Me=new WeakSet,un=async function(e){const t=y(this,su).cacheTimeout;if(t<0)return await this._perform(e);const n=kp(e.method,e);let s=y(this,So).get(n);return s||(s=this._perform(e),y(this,So).set(n,s),setTimeout(()=>{y(this,So).get(n)===s&&y(this,So).delete(n)},t)),await s},vb=async function(e,t,n){q(n<jG,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const s=mg(e);try{return re(await this._perform({method:"call",transaction:s,blockTag:t}))}catch(i){if(!this.disableCcipRead&&p0(i)&&i.data&&n>=0&&t==="latest"&&s.to!=null&&Ot(i.data,0,4)==="0x556f1830"){const o=i.data,a=await Br(s.to,this);let c;try{c=JG(Ot(i.data,4))}catch(d){q(!1,d.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:o}})}q(c.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});const l=await this.ccipReadFetch(s,c.calldata,c.urls);q(l!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:i.data,errorArgs:c.errorArgs}});const u={to:a,data:Rt([c.selector,KG([l,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const d=await W(this,Me,vb).call(this,u,t,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:d}),d}catch(d){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:d}),d}}throw i}},Ab=async function(e){const{value:t}=await Dr({network:this.getNetwork(),value:e});return t},Cd=async function(e,t,n){let s=this._getAddress(t),i=this._getBlockTag(n);return(typeof s!="string"||typeof i!="string")&&([s,i]=await Promise.all([s,i])),await W(this,Me,Ab).call(this,W(this,Me,un).call(this,Object.assign(e,{address:s,blockTag:i})))},Cb=async function(e,t){if(pt(e,32))return await W(this,Me,un).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let n=this._getBlockTag(e);return typeof n!="string"&&(n=await n),await W(this,Me,un).call(this,{method:"getBlock",blockTag:n,includeTransactions:t})},_d=async function(e,t){let n=await qy(e,this);return n.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(n=await qy({orphan:"drop-log",log:t[0]},this)),y(this,vr).get(n.tag)||null},Up=async function(e){const t=await qy(e,this),n=t.tag;let s=y(this,vr).get(n);return s||(s={subscriber:this._getSubscriber(t),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},y(this,vr).set(n,s)),s};function VG(r,e){try{const t=_b(r,e);if(t)return og(t)}catch{}return null}function _b(r,e){if(r==="0x")return null;try{const t=Re(Ot(r,e,e+32)),n=Re(Ot(r,t,t+32));return Ot(r,t+32,t+32+n)}catch{}return null}function PC(r){const e=fr(r);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function WG(r){if(r.length%32===0)return r;const e=new Uint8Array(Math.ceil(r.length/32)*32);return e.set(r),e}const GG=new Uint8Array([]);function KG(r){const e=[];let t=0;for(let n=0;n<r.length;n++)e.push(GG),t+=32;for(let n=0;n<r.length;n++){const s=Be(r[n]);e[n]=PC(t),e.push(PC(s.length)),e.push(WG(s)),t+=32+Math.ceil(s.length/32)*32}return Rt(e)}const OC="0x0000000000000000000000000000000000000000000000000000000000000000";function JG(r){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};q(yl(r)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const t=Ot(r,0,32);q(Ot(t,0,12)===Ot(OC,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=Ot(t,12);try{const n=[],s=Re(Ot(r,32,64)),i=Re(Ot(r,s,s+32)),o=Ot(r,s+32);for(let a=0;a<i;a++){const c=VG(o,a*32);if(c==null)throw new Error("abort");n.push(c)}e.urls=n}catch{q(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=_b(r,64);if(n==null)throw new Error("abort");e.calldata=n}catch{q(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}q(Ot(r,100,128)===Ot(OC,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=Ot(r,96,100);try{const n=_b(r,128);if(n==null)throw new Error("abort");e.extraData=n}catch{q(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(n=>e[n]),e}function ta(r,e){if(r.provider)return r.provider;q(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function RC(r,e){let t=mg(e);if(t.to!=null&&(t.to=Br(t.to,r)),t.from!=null){const n=t.from;t.from=Promise.all([r.getAddress(),Br(n,r)]).then(([s,i])=>(R(s.toLowerCase()===i.toLowerCase(),"transaction from mismatch","tx.from",i),s))}else t.from=r.getAddress();return await Dr(t)}class YG{constructor(e){$(this,"provider");ye(this,{provider:e||null})}async getNonce(e){return ta(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await RC(this,e)}async populateTransaction(e){const t=ta(this,"populateTransaction"),n=await RC(this,e);n.nonce==null&&(n.nonce=await this.getNonce("pending")),n.gasLimit==null&&(n.gasLimit=await this.estimateGas(n));const s=await this.provider.getNetwork();if(n.chainId!=null){const o=he(n.chainId);R(o===s.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else n.chainId=s.chainId;const i=n.maxFeePerGas!=null||n.maxPriorityFeePerGas!=null;if(n.gasPrice!=null&&(n.type===2||i)?R(!1,"eip-1559 transaction do not support gasPrice","tx",e):(n.type===0||n.type===1)&&i&&R(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(n.type===2||n.type==null)&&n.maxFeePerGas!=null&&n.maxPriorityFeePerGas!=null)n.type=2;else if(n.type===0||n.type===1){const o=await t.getFeeData();q(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice)}else{const o=await t.getFeeData();if(n.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(n.authorizationList&&n.authorizationList.length?n.type=4:n.type=2,n.gasPrice!=null){const a=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=a,n.maxPriorityFeePerGas=a}else n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(q(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice),n.type=0):q(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(n.type===2||n.type===3||n.type===4)&&(n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await Dr(n)}async populateAuthorization(e){const t=Object.assign({},e);return t.chainId==null&&(t.chainId=(await ta(this,"getNetwork").getNetwork()).chainId),t.nonce==null&&(t.nonce=await this.getNonce()),t}async estimateGas(e){return ta(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return ta(this,"call").call(await this.populateCall(e))}async resolveName(e){return await ta(this,"resolveName").resolveName(e)}async sendTransaction(e){const t=ta(this,"sendTransaction"),n=await this.populateTransaction(e);delete n.from;const s=lg.from(n);return await t.broadcastTransaction(await this.signTransaction(s))}authorize(e){q(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}function QG(r){return JSON.parse(JSON.stringify(r))}var Rr,ks,Fa,xo,ja,iu,zo,Nb,Ib;class Yx{constructor(e){M(this,zo);M(this,Rr);M(this,ks);M(this,Fa);M(this,xo);M(this,ja);M(this,iu);_(this,Rr,e),_(this,ks,null),_(this,Fa,W(this,zo,Nb).bind(this)),_(this,xo,!1),_(this,ja,null),_(this,iu,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){y(this,xo)||(_(this,xo,!0),W(this,zo,Nb).call(this,-2))}stop(){y(this,xo)&&(_(this,xo,!1),_(this,iu,!0),W(this,zo,Ib).call(this),y(this,Rr).off("block",y(this,Fa)))}pause(e){e&&W(this,zo,Ib).call(this),y(this,Rr).off("block",y(this,Fa))}resume(){this.start()}}Rr=new WeakMap,ks=new WeakMap,Fa=new WeakMap,xo=new WeakMap,ja=new WeakMap,iu=new WeakMap,zo=new WeakSet,Nb=async function(e){try{y(this,ks)==null&&_(this,ks,this._subscribe(y(this,Rr)));let t=null;try{t=await y(this,ks)}catch(i){if(!dr(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(t==null){_(this,ks,null),y(this,Rr)._recoverSubscriber(this,this._recover(y(this,Rr)));return}const n=await y(this,Rr).getNetwork();if(y(this,ja)||_(this,ja,n),y(this,ja).chainId!==n.chainId)throw new Error("chaid changed");if(y(this,iu))return;const s=await y(this,Rr).send("eth_getFilterChanges",[t]);await this._emitResults(y(this,Rr),s)}catch(t){console.log("@TODO",t)}y(this,Rr).once("block",y(this,Fa))},Ib=function(){const e=y(this,ks);e&&(_(this,ks,null),e.then(t=>{y(this,Rr).destroyed||y(this,Rr).send("eth_uninstallFilter",[t])}))};var Ha;class ZG extends Yx{constructor(t,n){super(t);M(this,Ha);_(this,Ha,QG(n))}_recover(t){return new D0(t,y(this,Ha))}async _subscribe(t){return await t.send("eth_newFilter",[y(this,Ha)])}async _emitResults(t,n){for(const s of n)t.emit(y(this,Ha),t._wrapLog(s,t._network))}}Ha=new WeakMap;class XG extends Yx{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const n of t)e.emit("pending",n)}}const eK="bigint,boolean,function,number,string,symbol".split(/,/g);function Bp(r){if(r==null||eK.indexOf(typeof r)>=0||typeof r.getAddress=="function")return r;if(Array.isArray(r))return r.map(Bp);if(typeof r=="object")return Object.keys(r).reduce((e,t)=>(e[t]=r[t],e),{});throw new Error(`should not happen: ${r} (${typeof r})`)}function tK(r){return new Promise(e=>{setTimeout(e,r)})}function Yc(r){return r&&r.toLowerCase()}function DC(r){return r&&typeof r.pollingInterval=="number"}const Qx={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class Za extends YG{constructor(t,n){super(t);$(this,"address");n=rt(n),ye(this,{address:n})}connect(t){q(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const n=Bp(t),s=[];if(n.from){const o=n.from;s.push((async()=>{const a=await Br(o,this.provider);R(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=a})())}else n.from=this.address;if(n.gasLimit==null&&s.push((async()=>{n.gasLimit=await this.provider.estimateGas({...n,from:this.address})})()),n.to!=null){const o=n.to;s.push((async()=>{n.to=await Br(o,this.provider)})())}s.length&&await Promise.all(s);const i=this.provider.getRpcTransaction(n);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(t){const n=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(t);return await new Promise((i,o)=>{const a=[1e3,100];let c=0;const l=async()=>{try{const u=await this.provider.getTransaction(s);if(u!=null){i(u.replaceableTransaction(n));return}}catch(u){if(dr(u,"CANCELLED")||dr(u,"BAD_DATA")||dr(u,"NETWORK_ERROR")||dr(u,"UNSUPPORTED_OPERATION")){u.info==null&&(u.info={}),u.info.sendTransactionHash=s,o(u);return}if(dr(u,"INVALID_ARGUMENT")&&(c++,u.info==null&&(u.info={}),u.info.sendTransactionHash=s,c>10)){o(u);return}this.provider.emit("error",Nt("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:u}))}this.provider._setTimeout(()=>{l()},a.pop()||4e3)};l()})}async signTransaction(t){const n=Bp(t);if(n.from){const i=await Br(n.from,this.provider);R(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=i}else n.from=this.address;const s=this.provider.getRpcTransaction(n);return await this.provider.send("eth_signTransaction",[s])}async signMessage(t){const n=typeof t=="string"?Ws(t):t;return await this.provider.send("personal_sign",[re(n),this.address.toLowerCase()])}async signTypedData(t,n,s){const i=Bp(s),o=await gg.resolveNames(t,n,i,async a=>{const c=await Br(a);return R(c!=null,"TypedData does not support null address","value",a),c});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(gg.getPayload(o.domain,n,o.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const n=typeof t=="string"?Ws(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),re(n)])}}var za,ou,Ii,Us,os,Ln,Kr,Xh,Sb;class rK extends qG{constructor(t,n){super(t,n);M(this,Xh);M(this,za);M(this,ou);M(this,Ii);M(this,Us);M(this,os);M(this,Ln);M(this,Kr);_(this,ou,1),_(this,za,Object.assign({},Qx,n||{})),_(this,Ii,[]),_(this,Us,null),_(this,Ln,null),_(this,Kr,null);{let i=null;const o=new Promise(a=>{i=a});_(this,os,{promise:o,resolve:i})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(R(!s||t!=="any","staticNetwork cannot be used on special network 'any'","options",n),s&&t!=null&&_(this,Ln,Hs.from(t))):s&&(R(t==null||s.matches(t),"staticNetwork MUST match network object","options",n),_(this,Ln,s))}_getOption(t){return y(this,za)[t]}get _network(){return q(y(this,Ln),"network is not available yet","NETWORK_ERROR"),y(this,Ln)}async _perform(t){if(t.method==="call"||t.method==="estimateGas"){let s=t.transaction;if(s&&s.type!=null&&he(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(t=Object.assign({},t,{transaction:Object.assign({},s,{type:void 0})}))}}const n=this.getRpcRequest(t);return n!=null?await this.send(n.method,n.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t)if(t===!0){if(y(this,Ln))return y(this,Ln)}else return t;return y(this,Kr)?await y(this,Kr):this.ready?(_(this,Kr,(async()=>{try{const n=Hs.from(he(await this.send("eth_chainId",[])));return _(this,Kr,null),n}catch(n){throw _(this,Kr,null),n}})()),await y(this,Kr)):(_(this,Kr,(async()=>{const n={id:Ku(this,ou)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:n});let s;try{s=(await this._send(n))[0],_(this,Kr,null)}catch(i){throw _(this,Kr,null),this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return Hs.from(he(s.result));throw this.getRpcError(n,s)})()),await y(this,Kr))}_start(){y(this,os)==null||y(this,os).resolve==null||(y(this,os).resolve(),_(this,os,null),(async()=>{for(;y(this,Ln)==null&&!this.destroyed;)try{_(this,Ln,await this._detectNetwork())}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Nt("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await tK(1e3)}W(this,Xh,Sb).call(this)})())}async _waitUntilReady(){if(y(this,os)!=null)return await y(this,os).promise}_getSubscriber(t){return t.type==="pending"?new XG(this):t.type==="event"?this._getOption("polling")?new D0(this,t.filter):new ZG(this,t.filter):t.type==="orphan"&&t.filter.orphan==="drop-log"?new Jx("orphan"):super._getSubscriber(t)}get ready(){return y(this,os)==null}getRpcTransaction(t){const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(t[s]==null)return;let i=s;s==="gasLimit"&&(i="gas"),n[i]=Ri(he(t[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{t[s]!=null&&(n[s]=re(t[s]))}),t.accessList&&(n.accessList=Cc(t.accessList)),t.blobVersionedHashes&&(n.blobVersionedHashes=t.blobVersionedHashes.map(s=>s.toLowerCase())),t.authorizationList&&(n.authorizationList=t.authorizationList.map(s=>{const i=XS(s);return{address:i.address,nonce:Ri(i.nonce),chainId:Ri(i.chainId),yParity:Ri(i.signature.yParity),r:i.signature.r,s:i.signature.s}})),n}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Yc(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Yc(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[Yc(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Yc(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&t.filter.address!=null&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(Yc):t.filter.address=Yc(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,n){const{method:s}=t,{error:i}=n;if(s==="eth_estimateGas"&&i.message){const c=i.message;if(!c.match(/revert/i)&&c.match(/insufficient funds/i))return Nt("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:i}});if(c.match(/nonce/i)&&c.match(/too low/i))return Nt("nonce has already been used","NONCE_EXPIRED",{transaction:t.params[0],info:{payload:t,error:i}})}if(s==="eth_call"||s==="eth_estimateGas"){const c=xb(i),l=Mh.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",t.params[0],c?c.data:null);return l.info={error:i,payload:t},l}const o=JSON.stringify(sK(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return Nt("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:t,error:i}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const c=t.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return Nt("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:c,info:{error:i}});if(o.match(/nonce/i)&&o.match(/too low/i))return Nt("nonce has already been used","NONCE_EXPIRED",{transaction:c,info:{error:i}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return Nt("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:c,info:{error:i}});if(o.match(/only replay-protected/i))return Nt("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:c,info:{error:i}}})}let a=!!o.match(/the method .* does not exist/i);return a||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(a=!0),a?Nt("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:i,payload:t}}):Nt("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:t})}send(t,n){if(this.destroyed)return Promise.reject(Nt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const s=Ku(this,ou)._++,i=new Promise((o,a)=>{y(this,Ii).push({resolve:o,reject:a,payload:{method:t,params:n,id:s,jsonrpc:"2.0"}})});return W(this,Xh,Sb).call(this),i}async getSigner(t){t==null&&(t=0);const n=this.send("eth_accounts",[]);if(typeof t=="number"){const i=await n;if(t>=i.length)throw new Error("no such account");return new Za(this,i[t])}const{accounts:s}=await Dr({network:this.getNetwork(),accounts:n});t=rt(t);for(const i of s)if(rt(i)===t)return new Za(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(n=>new Za(this,n))}destroy(){y(this,Us)&&(clearTimeout(y(this,Us)),_(this,Us,null));for(const{payload:t,reject:n}of y(this,Ii))n(Nt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));_(this,Ii,[]),super.destroy()}}za=new WeakMap,ou=new WeakMap,Ii=new WeakMap,Us=new WeakMap,os=new WeakMap,Ln=new WeakMap,Kr=new WeakMap,Xh=new WeakSet,Sb=function(){if(y(this,Us))return;const t=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");_(this,Us,setTimeout(()=>{_(this,Us,null);const n=y(this,Ii);for(_(this,Ii,[]);n.length;){const s=[n.shift()];for(;n.length&&s.length!==y(this,za).batchMaxCount;)if(s.push(n.shift()),JSON.stringify(s.map(o=>o.payload)).length>y(this,za).batchMaxSize){n.unshift(s.pop());break}(async()=>{const i=s.length===1?s[0].payload:s.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{const o=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:a,reject:c,payload:l}of s){if(this.destroyed){c(Nt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:l.method}));continue}const u=o.filter(d=>d.id===l.id)[0];if(u==null){const d=Nt("missing response for request","BAD_DATA",{value:o,info:{payload:l}});this.emit("error",d),c(d);continue}if("error"in u){c(this.getRpcError(l,u));continue}a(u.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:a}of s)a(o)}})()}},t))};var To;class Zx extends rK{constructor(t,n){super(t,n);M(this,To);let s=this._getOption("pollingInterval");s==null&&(s=Qx.pollingInterval),_(this,To,s)}_getSubscriber(t){const n=super._getSubscriber(t);return DC(n)&&(n.pollingInterval=y(this,To)),n}get pollingInterval(){return y(this,To)}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");_(this,To,t),this._forEachSubscriber(n=>{DC(n)&&(n.pollingInterval=y(this,To))})}}To=new WeakMap;var au;class nK extends Zx{constructor(t,n,s){t==null&&(t="http://localhost:8545");super(n,s);M(this,au);typeof t=="string"?_(this,au,new ji(t)):_(this,au,t.clone())}_getConnection(){return y(this,au).clone()}async send(t,n){return await this._start(),await super.send(t,n)}async _send(t){const n=this._getConnection();n.body=JSON.stringify(t),n.setHeader("content-type","application/json");const s=await n.send();s.assertOk();let i=s.bodyJson;return Array.isArray(i)||(i=[i]),i}}au=new WeakMap;function xb(r){if(r==null)return null;if(typeof r.message=="string"&&r.message.match(/revert/i)&&pt(r.data))return{message:r.message,data:r.data};if(typeof r=="object"){for(const e in r){const t=xb(r[e]);if(t)return t}return null}if(typeof r=="string")try{return xb(JSON.parse(r))}catch{}return null}function Tb(r,e){if(r!=null){if(typeof r.message=="string"&&e.push(r.message),typeof r=="object")for(const t in r)Tb(r[t],e);if(typeof r=="string")try{return Tb(JSON.parse(r),e)}catch{}}}function sK(r){const e=[];return Tb(r,e),e}var cu,lu;const ga=class ga extends Zx{constructor(t,n,s){const i=Object.assign({},s??{},{batchMaxCount:1});R(t&&t.request,"invalid EIP-1193 provider","ethereum",t);super(n,i);M(this,cu);M(this,lu);_(this,lu,null),s&&s.providerInfo&&_(this,lu,s.providerInfo),_(this,cu,async(o,a)=>{const c={method:o,params:a};this.emit("debug",{action:"sendEip1193Request",payload:c});try{const l=await t.request(c);return this.emit("debug",{action:"receiveEip1193Result",result:l}),l}catch(l){const u=new Error(l.message);throw u.code=l.code,u.data=l.data,u.payload=c,this.emit("debug",{action:"receiveEip1193Error",error:u}),u}})}get providerInfo(){return y(this,lu)}async send(t,n){return await this._start(),await super.send(t,n)}async _send(t){R(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const n=await y(this,cu).call(this,t.method,t.params||[]);return[{id:t.id,result:n}]}catch(n){return[{id:t.id,error:{code:n.code,data:n.data,message:n.message}}]}}getRpcError(t,n){switch(n=JSON.parse(JSON.stringify(n)),n.error.code||-1){case 4001:n.error.message=`ethers-user-denied: ${n.error.message}`;break;case 4200:n.error.message=`ethers-unsupported: ${n.error.message}`;break}return super.getRpcError(t,n)}async hasSigner(t){t==null&&(t=0);const n=await this.send("eth_accounts",[]);return typeof t=="number"?n.length>t:(t=t.toLowerCase(),n.filter(s=>s.toLowerCase()===t).length!==0)}async getSigner(t){if(t==null&&(t=0),!await this.hasSigner(t))try{await y(this,cu).call(this,"eth_requestAccounts",[])}catch(n){const s=n.payload;throw this.getRpcError(s,{id:s.id,error:n})}return await super.getSigner(t)}static async discover(t){if(t==null&&(t={}),t.provider)return new ga(t.provider);const n=t.window?t.window:typeof window<"u"?window:null;if(n==null)return null;const s=t.anyProvider;if(s&&n.ethereum)return new ga(n.ethereum);if(!("addEventListener"in n&&"dispatchEvent"in n&&"removeEventListener"in n))return null;const i=t.timeout?t.timeout:300;return i===0?null:await new Promise((o,a)=>{let c=[];const l=h=>{c.push(h.detail),s&&u()},u=()=>{if(clearTimeout(d),c.length)if(t&&t.filter){const h=t.filter(c.map(f=>Object.assign({},f.info)));if(h==null)o(null);else if(h instanceof ga)o(h);else{let f=null;if(h.uuid&&(f=c.filter(p=>h.uuid===p.info.uuid)[0]),f){const{provider:g,info:p}=f;o(new ga(g,void 0,{providerInfo:p}))}else a(Nt("filter returned unknown info","UNSUPPORTED_OPERATION",{value:h}))}}else{const{provider:h,info:f}=c[0];o(new ga(h,void 0,{providerInfo:f}))}else o(null);n.removeEventListener("eip6963:announceProvider",l)},d=setTimeout(()=>{u()},i);n.addEventListener("eip6963:announceProvider",l),n.dispatchEvent(new Event("eip6963:requestProvider"))})}};cu=new WeakMap,lu=new WeakMap;let Xa=ga;const vl={hexStringToNumber(r){const e=r.startsWith("0x")?r.slice(2):r;return parseInt(e,16)},numberToHexString(r){return`0x${r.toString(16)}`},async getUserInfo(r){const[e,t]=await Promise.all([vl.getAddresses(r),vl.getChainId(r)]);return{chainId:t,addresses:e}},async getChainId(r){const e=await r.request({method:"eth_chainId"});return Number(e)},async getAddress(r){const[e]=await r.request({method:"eth_accounts"});return e},async getAddresses(r){return await r.request({method:"eth_accounts"})},async addEthereumChain(r,e){var n,s;const t=((n=e.rpcUrls.chainDefault)==null?void 0:n.http)||[];await r.request({method:"wallet_addEthereumChain",params:[{chainId:vl.numberToHexString(e.id),rpcUrls:[...t],chainName:e.name,nativeCurrency:{name:e.nativeCurrency.name,decimals:e.nativeCurrency.decimals,symbol:e.nativeCurrency.symbol},blockExplorerUrls:[(s=e.blockExplorers)==null?void 0:s.default.url],iconUrls:[Ms.NetworkImageIds[e.id]]}]})}},ra={signMessage:async(r,e,t)=>{if(!e)throw new Error("signMessage - provider is undefined");const n=pt(r)?r:re(Ws(r));return await e.request({method:"personal_sign",params:[n,t]})},estimateGas:async(r,e,t,n)=>{if(!e)throw new Error("estimateGas - provider is undefined");if(!t)throw new Error("estimateGas - address is undefined");if(r.chainNamespace&&r.chainNamespace!=="eip155")throw new Error("estimateGas - chainNamespace is not eip155");const s={from:r.address,to:r.to,data:r.data,type:0},i=new Xa(e,n);return await new Za(i,t).estimateGas(s)},sendTransaction:async(r,e,t,n)=>{if(!e)throw new Error("sendTransaction - provider is undefined");if(!t)throw new Error("sendTransaction - address is undefined");if(r.chainNamespace&&r.chainNamespace!=="eip155")throw new Error("sendTransaction - chainNamespace is not eip155");const s={to:r.to,value:r.value,gasLimit:r.gas,gasPrice:r.gasPrice,data:r.data,type:0},i=new Xa(e,n),c=await(await new Za(i,t).sendTransaction(s)).wait();return(c==null?void 0:c.hash)||null},writeContract:async(r,e,t,n)=>{if(!e)throw new Error("writeContract - provider is undefined");if(!t)throw new Error("writeContract - address is undefined");const s=new Xa(e,n),i=new Za(s,t),o=new Qa(r.tokenAddress,r.abi,i);if(!o||!r.method)throw new Error("Contract method is undefined");const a=o[r.method];if(a)return await a(...r.args);throw new Error("Contract method is undefined")},parseWalletCapabilities:r=>{try{return JSON.parse(r)}catch{throw new Error("Error parsing wallet capabilities")}},parseUnits:yS,formatUnits:mS};class iK extends rS{constructor(){super({adapterType:ee.ADAPTER_TYPES.ETHERS,namespace:ee.CHAIN.EVM}),this.balancePromises={},this.providerHandlers=null}async createEthersConfig(e){if(!e.metadata)return;let t;function n(){if(t)return t;if(!(typeof window>"u")&&window.ethereum)return t=window.ethereum,t}async function s(){var o,a,c;try{const{createCoinbaseWalletSDK:l}=await dn(async()=>{const{createCoinbaseWalletSDK:d}=await import("./index-DTjvFzP0.js");return{createCoinbaseWalletSDK:d}},__vite__mapDeps([48,1,2]));return typeof window>"u"?void 0:l({appName:(o=e==null?void 0:e.metadata)==null?void 0:o.name,appLogoUrl:(a=e==null?void 0:e.metadata)==null?void 0:a.icons[0],appChainIds:((c=e.networks)==null?void 0:c.map(d=>d.id))||[1,84532],preference:{options:e.coinbasePreference??"all"}}).getProvider()}catch(l){console.error("Failed to import Coinbase Wallet SDK:",l);return}}const i={metadata:e.metadata};if(e.enableInjected!==!1&&(i.injected=n()),e.enableCoinbase!==!1){const o=await s();o&&(i.coinbase=o)}return i.EIP6963=e.enableEIP6963!==!1,i}async signMessage(e){const{message:t,address:n,provider:s}=e;if(!s)throw new Error("Provider is undefined");try{return{signature:await ra.signMessage(t,s,n)}}catch{throw new Error("EthersAdapter:signMessage - Sign message failed")}}async sendTransaction(e){var n;if(!e.provider)throw new Error("Provider is undefined");return{hash:await ra.sendTransaction({value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),to:e.to,data:e.data?e.data:"0x",gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,address:de.state.address},e.provider,de.state.address,Number((n=e.caipNetwork)==null?void 0:n.id))}}async writeContract(e){var s;if(!e.provider)throw new Error("Provider is undefined");const{address:t}=li.parseCaipAddress(e.caipAddress);return{hash:await ra.writeContract(e,e.provider,t,Number((s=e.caipNetwork)==null?void 0:s.id))}}async estimateGas(e){const{provider:t,caipNetwork:n,address:s}=e;if(!t)throw new Error("Provider is undefined");try{return{gas:await ra.estimateGas({data:e.data,to:e.to,address:s},t,s,Number(n==null?void 0:n.id))}}catch{throw new Error("EthersAdapter:estimateGas - Estimate gas failed")}}parseUnits(e){return ra.parseUnits(e.value,e.decimals)}formatUnits(e){return ra.formatUnits(e.value,e.decimals)}async syncConnection(e){const{id:t,chainId:n}=e,s=this.connectors.find(c=>c.id===t),i=s==null?void 0:s.provider;if(!i)throw new Error("Provider not found");const o=await i.request({method:"eth_requestAccounts"}),a=await i.request({method:"eth_chainId"});if(this.listenProviderEvents(i),!o[0])throw new Error("No accounts found");if(!(s!=null&&s.type))throw new Error("Connector type not found");return{address:o[0],chainId:Number(a)||Number(n),provider:i,type:s.type,id:t}}async syncConnectors(e){var n;this.ethersConfig=await this.createEthersConfig(e),(n=this.ethersConfig)!=null&&n.EIP6963&&this.listenInjectedConnector(!0),Object.keys(this.ethersConfig||{}).filter(s=>s!=="metadata"&&s!=="EIP6963").forEach(s=>{var a,c;const i=s==="coinbase"?"coinbaseWalletSDK":s,o=s===ee.CONNECTOR_ID.INJECTED;this.namespace&&this.addConnector({id:i,explorerId:Ms.ConnectorExplorerIds[i],imageUrl:(a=e==null?void 0:e.connectorImages)==null?void 0:a[i],name:Ms.ConnectorNamesMap[i]||"Unknown",imageId:Ms.ConnectorImageIds[i],type:Ms.ConnectorTypesMap[i]??"EXTERNAL",info:o?void 0:{rdns:i},chain:this.namespace,chains:[],provider:(c=this.ethersConfig)==null?void 0:c[s]})})}setUniversalProvider(e){this.addConnector(new f0({provider:e,caipNetworks:this.getCaipNetworks(),namespace:"eip155"}))}eip6963EventHandler(e){var t;if(e.detail){const{info:n,provider:s}=e.detail;if(!((t=this.connectors)==null?void 0:t.find(o=>o.name===(n==null?void 0:n.name)))){const o=Ms.ConnectorTypesMap[ee.CONNECTOR_ID.EIP6963],a=(n==null?void 0:n.rdns)||(n==null?void 0:n.name)||(n==null?void 0:n.uuid);this.namespace&&a&&this.addConnector({id:a,type:o,imageUrl:n==null?void 0:n.icon,name:(n==null?void 0:n.name)||"Unknown",provider:s,info:n,chain:this.namespace,chains:[]})}}}listenInjectedConnector(e){if(typeof window<"u"&&e){const t=this.eip6963EventHandler.bind(this);window.addEventListener(ft.EIP6963_ANNOUNCE_EVENT,t),window.dispatchEvent(new Event(ft.EIP6963_REQUEST_EVENT))}}async connect({id:e,type:t,chainId:n}){var c;const s=this.connectors.find(l=>l.id===e),i=s==null?void 0:s.provider;if(!i)throw new Error("Provider not found");let o=[],a;if(t==="AUTH"){const{address:l}=await i.connect({chainId:n,preferredAccountType:(c=de.state.preferredAccountTypes)==null?void 0:c.eip155});o=[l],this.emit("accountChanged",{address:o[0],chainId:Number(n)})}else{if(o=await i.request({method:"eth_requestAccounts"}),a=await i.request({method:"eth_chainId"}),a!==n){const l=this.getCaipNetworks().find(u=>u.id===n);if(!l)throw new Error("EthersAdapter:connect - could not find the caipNetwork to switch");try{await this.switchNetwork({caipNetwork:l,provider:i,providerType:t})}catch{throw new Error("EthersAdapter:connect - Switch network failed")}}this.emit("accountChanged",{address:o[0],chainId:Number(n)}),this.listenProviderEvents(i)}return{address:o[0],chainId:Number(n),provider:i,type:t,id:e}}async reconnect(e){var i;const{id:t,chainId:n}=e,s=this.connectors.find(o=>o.id===t);s&&s.type==="AUTH"&&n&&await s.provider.connect({chainId:n,preferredAccountType:(i=de.state.preferredAccountTypes)==null?void 0:i.eip155})}async getAccounts(e){const t=this.connectors.find(i=>i.id===e.id),n=t==null?void 0:t.provider;if(!n||!t)throw new Error("Provider not found");if(e.id===ee.CONNECTOR_ID.AUTH){const i=t.provider;if(!i.user)return{accounts:[]};const{accounts:o,address:a}=i.user;return Promise.resolve({accounts:(o||[{address:a,type:"eoa"}]).map(c=>ve.createAccount("eip155",c.address,c.type))})}return{accounts:(await n.request({method:"eth_requestAccounts"})).map(i=>ve.createAccount("eip155",i,"eoa"))}}async disconnect(e){if(!e.provider||!e.providerType)throw new Error("Provider or providerType not provided");switch(e.providerType){case"WALLET_CONNECT":e.provider.session&&e.provider.disconnect();break;case"AUTH":await e.provider.disconnect();break;case"ANNOUNCED":case"EXTERNAL":await this.revokeProviderPermissions(e.provider);break;default:throw new Error("Unsupported provider type")}}async getBalance(e){const t=e.address,n=this.getCaipNetworks().find(s=>s.id===e.chainId);if(!t)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(n&&n.chainNamespace==="eip155"){const s=`${n.caipNetworkId}:${t}`,i=this.balancePromises[s];if(i)return i;const o=ie.getNativeBalanceCacheForCaipAddress(s);if(o)return{balance:o.balance,symbol:o.symbol};const a=new nK(n.rpcUrls.default.http[0],{chainId:n.id,name:n.name});if(a)try{return this.balancePromises[s]=new Promise(async c=>{const l=await a.getBalance(t),u=m0(l);ie.updateNativeBalanceCache({caipAddress:s,balance:u,symbol:n.nativeCurrency.symbol,timestamp:Date.now()}),c({balance:u,symbol:n.nativeCurrency.symbol})}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"}}catch{return{balance:"0.00",symbol:"ETH"}}}return{balance:"0.00",symbol:"ETH"}}listenProviderEvents(e){const t=()=>{this.removeProviderListeners(e),this.emit("disconnect")},n=i=>{i.length>0?this.emit("accountChanged",{address:i[0]}):t()},s=i=>{const o=typeof i=="string"?vl.hexStringToNumber(i):Number(i);this.emit("switchNetwork",{chainId:o})};e.on("disconnect",t),e.on("accountsChanged",n),e.on("chainChanged",s),this.providerHandlers={disconnect:t,accountsChanged:n,chainChanged:s}}removeProviderListeners(e){this.providerHandlers&&(e.removeListener("disconnect",this.providerHandlers.disconnect),e.removeListener("accountsChanged",this.providerHandlers.accountsChanged),e.removeListener("chainChanged",this.providerHandlers.chainChanged),this.providerHandlers=null)}async switchNetwork(e){var i,o;const{caipNetwork:t,provider:n,providerType:s}=e;if(s==="AUTH"){await super.switchNetwork(e);return}try{await n.request({method:"wallet_switchEthereumChain",params:[{chainId:vl.numberToHexString(t.id)}]})}catch(a){if(a.code===Oi.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||a.code===Oi.ERROR_INVALID_CHAIN_ID||a.code===Oi.ERROR_CODE_DEFAULT||((o=(i=a==null?void 0:a.data)==null?void 0:i.originalError)==null?void 0:o.code)===Oi.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)await vl.addEthereumChain(n,t);else if(s==="ANNOUNCED"||s==="EXTERNAL"||s==="INJECTED")throw new Error("Chain is not supported")}}getWalletConnectProvider(){var e;return(e=this.connectors.find(t=>t.type==="WALLET_CONNECT"))==null?void 0:e.provider}async revokeProviderPermissions(e){try{(await e.request({method:"wallet_getPermissions"})).find(s=>s.parentCapability==="eth_accounts")&&await e.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]})}catch(t){console.info("Could not revoke permissions from wallet. Disconnecting...",t)}}async getCapabilities(e){var s,i;const t=qe.getProvider(ee.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");const n=(i=(s=t.session)==null?void 0:s.sessionProperties)==null?void 0:i.capabilities;if(n){const a=ra.parseWalletCapabilities(n)[e];if(a)return a}return await t.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){const t=qe.getProvider(ee.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){const t=qe.getProvider(ee.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_revokePermissions",params:[e]})}async walletGetAssets(e){const t=qe.getProvider(ee.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_getAssets",params:[e]})}}const oK="acf46e0cc4d322acb6d86bb030902765",aK={name:"iUnlockExpert",description:"iUnlockExpert Website",url:"https://iunlockexpert.github.io/web/",icons:["https://avatars.githubusercontent.com/u/179229932"]},cK=[hz,dz,fz],lK=new iK;Cz({adapters:[lK],networks:cK,metadata:aK,projectId:oK,themeMode:"dark",features:{analytics:!0,socials:!1,email:!1},themeVariables:{"--w3m-accent":"#FFFFF"}});Wy.init({publicKey:"W8YR2P7ez_FAsEIbv"});const kC=({className:r})=>N.jsx("img",{src:"https://icones.pro/wp-content/uploads/2024/04/blue-usdc-icon-symbol-logo.png",alt:"USDC",className:r}),uK=()=>{const{cart:r,removeFromCart:e,getTotalPrice:t,updateQuantity:n,clearCart:s}=cT(),i=lT(),[o,a]=we.useState(""),[c,l]=we.useState(!1),[u,d]=we.useState("bitcoin"),[h,f]=we.useState(!1),[g,p]=we.useState(null),[m,w]=we.useState(!0),[A,v]=we.useState(!1),[I,T]=we.useState(!1),[P,D]=we.useState(!1);we.useEffect(()=>{r.filter(Qe=>Qe.id==="monthly"||Qe.id==="6-months"||Qe.id==="yearly"||Qe.id==="free-trial").length>1?p("You can only have one subscription in your cart at a time. Please remove any additional subscriptions before proceeding."):p(null)},[r]);const U=we.useMemo(()=>t(),[r]),S=we.useMemo(()=>U,[U]),[H,L]=we.useState(!1),[j,Q]=we.useState(null);we.useEffect(()=>{Q(H?Number((S*.9).toFixed(2)):null)},[H,S]);const[z,b]=we.useState([{id:"skinport",name:"Skinport",logo:N.jsx(uT,{className:"w-10 h-10 text-green-500"}),status:"coming_soon",description:"Popular skin trading platform"},{id:"dmarket",name:"DMarket",logo:N.jsx(_m,{className:"w-10 h-10 text-blue-500"}),status:"coming_soon",description:"Global skin marketplace"},{id:"bitskins",name:"BitSkins",logo:N.jsx(V0,{className:"w-10 h-10 text-purple-500"}),status:"coming_soon",description:"Trusted skin trading platform"}]),[E,O]=we.useState({id:"usdc",name:"USDC",type:"crypto"}),B=[{id:"usdc",name:"USDC",icon:N.jsx(kC,{className:"lg:w-8 lg:h-8 w-8 h-8 relative left-0"}),type:"crypto"},{id:"ethereum",name:"Ethereum",icon:N.jsx(Im,{className:"lg:w-8 lg:h-8 w-7 h-7 relative lg:left-0 left-1 text-[#627EEA]"}),type:"crypto"},{id:"tether",name:"Tether",icon:N.jsx(W0,{className:"lg:w-8 lg:h-8 w-7 h-7 relative lg:left-0 left-1 text-[#26A17B]"}),type:"crypto"},{id:"skins",name:"Skins",icon:N.jsx(Rf,{className:"w-7 h-8 relative top-1 left-2 text-blue-500"}),type:"skin"}],[k,F]=we.useState(!1),[K,Z]=we.useState(!1);vz();const{isConnected:se,address:J}=v9(),{walletProvider:ge}=Ez("eip155"),{chainId:_e}=E9();we.useEffect(()=>{(async()=>{try{const{data:{session:Qe}}=await sn.auth.getSession();if(!Qe){i("/signin",{state:{from:"/checkout",message:"Please sign in to complete your purchase"}}),w(!1);return}f(!0);const{data:{user:Fr}}=await sn.auth.getUser();if(Fr){a(Fr.email||"");const{data:nr}=await sn.from("users").select("referred_by").eq("auth_id",Fr.id).single();nr&&nr.referred_by?L(!0):L(!1)}const Zs=location.state;if(r.length===0&&(Zs!=null&&Zs.message)&&i("/dashboard",{state:{section:"purchases",message:Zs.message}}),Fr){const{data:nr}=await sn.from("users").select("subscription_end_date").eq("auth_id",Fr.id).single();nr&&nr.subscription_end_date&&new Date(nr.subscription_end_date)>new Date?(F(!0),p("You already have an active subscription. You cannot purchase another until your current subscription expires.")):F(!1)}window.history.replaceState({},document.title),w(!1)}catch(Qe){console.error("Authentication check failed:",Qe),p("Failed to verify authentication. Please try again."),w(!1)}})()},[i,r]);const $e=r.some(pe=>pe.id==="free-trial"),Oe=r.length===1&&$e,Ie=async()=>{var Qe,Fr,Zs,nr;if(r.filter($t=>$t.id==="monthly"||$t.id==="6-months"||$t.id==="yearly"||$t.id==="free-trial").length>1){p("Only one subscription is allowed at a time. Please remove one of your subscriptions from the cart.");return}if(k){p("You already have an active subscription. You cannot purchase another until your current subscription expires.");return}try{const{data:{user:$t}}=await sn.auth.getUser();if(!$t){p("User not authenticated");return}let _t=await sn.from("users").select(`
          id, 
          current_subscription_id, 
          subscription_start_date, 
          subscription_end_date,
          username,
          email
        `).eq("auth_id",$t.id).single();if(_t.error||!_t.data){const{data:Tr,error:Ki}=await sn.from("users").insert({auth_id:$t.id,email:$t.email||"",username:((Qe=$t.user_metadata)==null?void 0:Qe.username)||((Fr=$t.email)==null?void 0:Fr.split("@")[0]),created_at:new Date().toISOString()}).select().single();if(Ki){console.error("User profile creation error:",Ki),p("Failed to create user profile");return}_t={data:Tr,error:null,count:1,status:200,statusText:"OK"}}if(!_t.data){p("Failed to get user data");return}const qi={"1 Month Licence":{name:"1 Month Subscription",duration:1},"6 Months Licence":{name:"6 Months Subscription",duration:6},"12 Months Licence":{name:"12 Months Subscription",duration:12}},Xs=r[0].name,Ic=qi[Xs]||{name:Xs,duration:1},{data:Vi,error:Wi}=await sn.from("subscriptions").select("id, name, duration_days, price").or(`name.ilike.%${Ic.name}%,name.eq.${Ic.name}`);if(Wi){console.error("Subscription lookup error:",Wi),p("Could not find a matching subscription");return}if(!Vi||Vi.length===0){console.error("No matching subscription found",{cartItemName:Xs,mappedSubscriptionName:Ic.name}),p("No suitable subscription found. Please contact support.");return}const Wn=Vi[0];let Gi=Wn.id,ws=new Date,Ht=new Date;if(_t.data.current_subscription_id){const{data:Tr,error:Ki}=await sn.from("subscriptions").select("id, name, duration_days, price").eq("id",_t.data.current_subscription_id).single();if(Tr&&Wn.duration_days>Tr.duration_days){const Wo=_t.data.subscription_end_date?new Date(_t.data.subscription_end_date):new Date,z0=Math.ceil((Wo.getTime()-new Date().getTime())/(1e3*60*60*24)),vm=Wn.price/Wn.duration_days*z0,Am=S-vm;ws=new Date,Ht=new Date(ws),Ht.setDate(ws.getDate()+Wn.duration_days)}else Gi=_t.data.current_subscription_id,ws=new Date(_t.data.subscription_start_date||new Date),Ht=new Date(_t.data.subscription_end_date||new Date)}else Ht=r[0].id==="free-trial"?new Date(ws.getTime()+1*24*60*60*1e3):new Date(ws.setDate(ws.getDate()+Wn.duration_days));const{data:ei,error:F0}=await sn.from("orders").insert({user_id:_t.data.id,amount:j!==null?j:S,status:"completed",subscription_id:Gi,expiration_date:Ht.toISOString(),updated_at:new Date().toISOString()}).select().single();if(F0){console.error("Order creation error:",F0),p("Failed to process order. Please try again.");return}if(!ei){p("Failed to create order. Please try again.");return}const{error:j0}=await sn.from("order_items").insert({order_id:ei.id,subscription_id:Gi,quantity:1,price:j!==null?j:S});if(j0){console.error("Order items creation error:",j0),p("Failed to process order items. Please try again.");return}const{error:H0}=await sn.from("users").update({current_subscription_id:Gi,subscription_start_date:ws.toISOString(),subscription_end_date:Ht.toISOString()}).eq("id",_t.data.id);if(H0){console.error("Subscription update error:",H0),p("Failed to update subscription. Please contact support.");return}if(l(!0),s(),ei&&await(async Tr=>{var Ki;try{const{data:Wo}=await sn.from("users").select("ip_address").eq("id",_t.data.id).single(),z0={order_id:Tr.id,user_id:_t.data.id,status:Tr.status,amount:j!==null?j:S,total_amount:j!==null?j:S,transaction_date:new Date().toISOString(),subscription_id:Gi,expiration_date:Ht.toISOString(),created_at:Tr.created_at,updated_at:Tr.updated_at},vm={username:_t.data.username||((Ki=_t.data.email)==null?void 0:Ki.split("@")[0]),id:Tr.id,total_amount:j!==null?j:S,transaction_date:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),subscription_id:Gi,subscription_name:Wn.name,expiration_date:Ht.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),orders:r.map(Am=>({name:Am.name,units:1,price:Am.price})),cost:{total:j!==null?j:S},email:_t.data.email,created_at:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})};await Wy.send("service_27i9rew","template_vm9z8fa",{order_id:Tr.id,user_id:_t.data.id,status:Tr.status,total_amount:j!==null?j:S,transaction_date:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),expiration_date:Ht.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),created_at:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),ip_address:(Wo==null?void 0:Wo.ip_address)||"Not available"}),await Wy.send("service_rl84opo","template_uu06rg9",vm),console.log("Order confirmation emails sent successfully")}catch(Wo){console.error("Failed to send order confirmation emails:",Wo)}})(ei),localStorage.setItem("showPurchaseSuccess","true"),localStorage.setItem("newSubscription","true"),ei&&!$e){const Tr={id:ei.id,subscriptionName:Wn.name,date:new Date,amount:j!==null?j:S,items:r,duration_days:Wn.duration_days,transactionHash:hm||void 0},Ki={email:$t.email||"",username:((Zs=$t.user_metadata)==null?void 0:Zs.username)||((nr=$t.email)==null?void 0:nr.split("@")[0])||""};Tr.transactionHash&&await wT(Tr,Ki)}i("/dashboard",{state:{section:"purchases",showCongrats:!0}})}catch($t){console.error("Order placement error:",$t),p("An unexpected error occurred. Please try again.")}},[Ct,Tt]=we.useState(!1),[Et,it]=we.useState(!1),[ut,xr]=we.useState(1),[Wu,Nf]=we.useState(null),[hm,If]=we.useState(null),[fm,Sf]=we.useState(!1),[pm,gm]=we.useState(!1),[xf,Nc]=we.useState(!1),[mm,ym]=we.useState("0"),[Tf,Gu]=we.useState(!1),[qn,Pf]=we.useState(null),[Qs,wm]=we.useState(null),[bm,L0]=we.useState(!1),[Of,Vn]=we.useState({type:null,message:null}),[Xx,eT]=we.useState(!1);we.useEffect(()=>()=>{qn&&clearTimeout(qn),Qs&&clearTimeout(Qs)},[qn,Qs]);const tT=async()=>{var pe;if(!se||!ge||!J){Nf("Please connect your wallet first"),it(!1);return}Nf(null),Gu(!1),L0(!1),Vn({type:null,message:null}),qn&&clearTimeout(qn),Qs&&clearTimeout(Qs);try{xr(1);const Qe=new Xa(ge,_e),Fr=new Za(Qe,J);if(Oe){Ie();return}const nr=Number(((j!==null?j:S)/2e3).toFixed(8));if(isNaN(nr)||nr<=0)throw new Error("Invalid payment amount");const _t=(await Qe.getFeeData()).gasPrice||BigInt(0);let qi="",Xs=[];switch(E.id){case"usdc":qi="0xe317A4424eC6d68Ec4a4268F4144b206eF5609D7",Xs=[{inputs:[],name:"deposit",outputs:[],stateMutability:"payable",type:"function"}];break;case"ethereum":qi="0xe317A4424eC6d68Ec4a4268F4144b206eF5609D7",Xs=[{inputs:[],name:"deposit",outputs:[],stateMutability:"payable",type:"function"}];break;case"tether":qi="0xe317A4424eC6d68Ec4a4268F4144b206eF5609D7",Xs=[{inputs:[],name:"deposit",outputs:[],stateMutability:"payable",type:"function"}];break;default:throw new Error("Invalid payment method")}if(E.id==="ethereum"||E.id==="usdc"||E.id==="tether"){const Ic=new Qa(qi,Xs,Fr),Vi=await Qe.getBalance(J),Wi=O1(nr.toString())+_t*BigInt(21e3);if(ym(m0(Wi)),Vi<Wi)throw Nc(!0),new Error("Insufficient funds");xr(2),Vn({type:"info",message:"Please confirm the transaction in your wallet to continue."});const Wn=setTimeout(()=>{bm||Gu(!0)},2e4);Pf(Wn);const Gi=setTimeout(()=>{bm||Vn({type:"info",message:"The transaction is taking longer than usual. Please be patient while we wait for blockchain confirmation."})},25e3);Pf(Gi);const ws=setTimeout(()=>{bm||Vn({type:"error",message:"Transaction is still pending. Please DO NOT close this page! If you leave now, your payment will be processed but your subscription won't be activated. Stay on this page until the transaction is complete."})},5e4);wm(ws);try{const Ht=await Ic.deposit({value:O1(nr.toString()),gasPrice:_t});if(Ht!=null&&Ht.hash){If(Ht.hash),Vn({type:"info",message:"Success! Payment received."}),xr(3);const ei=await Ht.wait();if(ei&&ei.status===1)Ie(),Tt(!1);else throw new Error("Transaction failed")}}catch(Ht){if(Ht.code==="ACTION_REJECTED"||(pe=Ht.message)!=null&&pe.toLowerCase().includes("user denied"))L0(!0),Qs&&(clearTimeout(Qs),wm(null)),qn&&(clearTimeout(qn),Pf(null)),Vn({type:"error",message:"You rejected the transaction. Click Pay again if you want to try."});else throw Ht}}else Vn({type:"info",message:`Please send ${nr} ${E.id.toUpperCase()} to: ${qi}`})}catch(Qe){console.error("Payment Error:",Qe),Qe.code==="INSUFFICIENT_FUNDS"||Qe.message==="Insufficient funds"?(Nc(!0),Vn({type:"error",message:`Not enough funds in your wallet. You need €${S.toFixed(2)} to complete this transaction.`})):Vn({type:"error",message:"Something went wrong. The transaction was rejected. Please try again or contact support if the problem persists."})}finally{it(!1),xr(1),Gu(!1),qn&&(clearTimeout(qn),Pf(null)),Qs&&(clearTimeout(Qs),wm(null))}},[rT,$0]=we.useState(!1),M0=()=>{if(r.filter(Qe=>Qe.id==="monthly"||Qe.id==="6-months"||Qe.id==="yearly"||Qe.id==="free-trial").length>1){$0(!0);return}if(Oe){eT(!0),Ie();return}if(!se&&!Oe){Vn({type:"error",message:"Please connect your wallet before proceeding with the payment."});return}it(!0),xr(1),tT()},nT=()=>N.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:N.jsxs(Go.div,{initial:{opacity:1,scale:.9},animate:{opacity:1,scale:1},className:"bg-[#0a0415] rounded-2xl p-8 max-w-md w-full border border-[#8a4fff]/10",children:[N.jsxs("div",{className:"flex items-center mb-6",children:[N.jsx(bT,{className:"w-8 h-8 text-[#8a4fff] mr-4"}),N.jsx("h2",{className:"text-2xl font-semibold text-[#8a4fff]",children:"Policy Acknowledgment"})]}),N.jsxs("div",{className:"mb-6 text-gray-300 space-y-4",children:[N.jsx("p",{children:"Before completing your purchase, please review and acknowledge our:"}),N.jsxs("ul",{className:"list-disc list-inside",children:[N.jsx("li",{children:N.jsx(kf,{to:"/terms",target:"_blank",className:"text-[#8a4fff] hover:underline",children:"Terms of Service"})}),N.jsx("li",{children:N.jsx(kf,{to:"/privacy",target:"_blank",className:"text-[#8a4fff] hover:underline",children:"Privacy Policy"})}),N.jsx("li",{children:N.jsx(kf,{to:"/refund",target:"_blank",className:"text-[#8a4fff] hover:underline",children:"Refund Policy"})})]})]}),N.jsxs("div",{className:"flex items-center mb-6",children:[N.jsx("input",{type:"checkbox",id:"policy-acknowledge",checked:I,onChange:()=>T(!I),className:"mr-3 w-5 h-5 text-[#8a4fff] rounded focus:ring-[#8a4fff]"}),N.jsx("label",{htmlFor:"policy-acknowledge",className:"text-gray-300",children:"I have read and agree to the terms and conditions."})]}),N.jsxs("div",{className:"flex space-x-4",children:[N.jsx("button",{onClick:()=>D(!1),className:"flex-1 py-3 bg-transparent border border-[#8a4fff]/30 text-[#8a4fff] rounded-lg",children:"Cancel"}),N.jsx("button",{onClick:()=>{I&&(D(!1),M0())},disabled:!I,className:`
              flex-1 py-3 rounded-lg
              ${I?"bg-[#8a4fff] text-white":"bg-gray-500 text-gray-300 cursor-not-allowed"}
            `,children:"Confirm"})]})]})}),sT=()=>N.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:N.jsxs(Go.div,{initial:{opacity:1,scale:.9},animate:{opacity:1,scale:1},className:"bg-[#0a0415] rounded-2xl p-4 sm:p-8 max-w-3xl w-full border border-[#8a4fff]/10 my-4 sm:my-8",children:[N.jsx("div",{className:"flex items-center mb-4 sm:mb-6 sticky top-0 bg-[#0a0415] z-10",children:N.jsx("h2",{className:"text-[20px] sm:text-2xl font-semibold text-[#8a4fff] m-auto",children:"Skin Transfer Marketplaces"})}),N.jsxs("div",{className:"mb-4 sm:mb-6 text-gray-300 space-y-3 sm:space-y-4",children:[N.jsx("p",{className:"text-center text-[14px] sm:text-base",children:"Select a marketplace to transfer your skins seamlessly."}),N.jsx("div",{className:"grid md:grid-cols-3 gap-3 sm:gap-4",children:[{id:"bitskins",name:"BitSkins",logo:N.jsx(_m,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-500"}),description:"Trusted skin trading platform",url:"https://bitskins.com/",status:"active"},{id:"tradeit",name:"TradeIt.gg",logo:N.jsx(Rf,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-500"}),description:"Instant skin trading platform",url:"https://tradeit.gg/",status:"active"}].map(pe=>N.jsxs(Go.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:`
                  bg-[#2c1b4a] rounded-xl p-4 sm:p-6 text-center relative
                  transition-all duration-300 
                  ${pe.status==="active"?"hover:border-[#8a4fff] border border-transparent":"opacity-50 cursor-not-allowed"}
                `,children:[N.jsx("div",{className:"flex justify-center mb-3 sm:mb-4",children:pe.logo}),N.jsx("h3",{className:"text-[16px] sm:text-lg font-semibold mb-2 text-white",children:pe.name}),N.jsx("p",{className:"text-gray-400 text-[12px] sm:text-sm mb-3 sm:mb-4",children:pe.description}),N.jsx("button",{onClick:()=>{pe.status==="active"&&window.open(pe.url,"_blank","noopener,noreferrer")},disabled:pe.status!=="active",className:`
                    w-full py-2 sm:py-3 rounded-lg transition-colors text-[12px] sm:text-sm
                    ${pe.status==="active"?"bg-[#8a4fff] text-white hover:bg-[#7a3ddf]":"bg-gray-500 text-gray-300 cursor-not-allowed"}
                  `,children:pe.status==="active"?"Open Marketplace":"Coming Soon"})]},pe.id))})]}),N.jsx("div",{className:"mt-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl  shadow-lg hover:border-[#8a4fff] transition-all duration-300",children:N.jsxs("div",{className:"p-4",children:[N.jsxs("div",{className:"flex items-center mb-3",children:[N.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-[#8a4fff]/30 to-[#8a4fff]/10 flex items-center justify-center mr-3 shadow-inner",children:N.jsx(J0,{className:"w-5 h-5 text-[#8a4fff]"})}),N.jsxs("div",{children:[N.jsx("h3",{className:"text-base font-semibold text-white",children:"Marketplace Security"}),N.jsx("p",{className:"text-xs text-[#8a4fff]/70",children:"Stay protected"})]})]}),N.jsx("p",{className:"text-sm text-gray-300 pl-13 leading-relaxed",children:"We only work with verified marketplaces. Double-check trade details and never accept offers from unofficial sources."})]})}),N.jsxs("div",{className:"flex space-x-3 sm:space-x-4",children:[N.jsx("button",{onClick:()=>v(!1),className:"flex-1 py-2 sm:py-3 bg-transparent border border-[#8a4fff]/30 text-[#8a4fff] rounded-lg text-[14px] sm:text-sm",children:"Close"}),N.jsx("button",{onClick:()=>{window.open("/contact","_blank"),v(!1)},className:"flex-1 py-2 sm:py-3 bg-[#8a4fff] text-white rounded-lg hover:bg-[#7a3ddf] text-[14px] sm:text-sm",children:"Contact Support"})]})]})}),Em=({message:pe,type:Qe,onClose:Fr})=>{const[Zs,nr]=we.useState(100);we.useEffect(()=>{if(Qe!=="info"){const Vi=setInterval(()=>{nr(Wi=>Wi<=0?(clearInterval(Vi),Fr(),0):Wi-1)},50);return()=>clearInterval(Vi)}},[Fr,Qe]);const $t=()=>{Fr()};return N.jsx(Go.div,{initial:{opacity:1,y:-20},animate:{opacity:1,y:0},exit:{opacity:1,y:-20},className:`fixed left-0 right-0 mx-auto z-[60] p-4 rounded-xl w-[calc(100%-2rem)] max-w-md relative overflow-hidden ${Qe==="error"?"bg-red-500 border border-red-500 text-white":Qe==="success"?"bg-emerald-500 border border-emerald-500 text-white":"bg-blue-500 border border-blue-500 text-white"}`,style:{top:"60px"},children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center",children:[Qe==="error"?N.jsx(mT,{className:"mr-3 w-6 h-6 flex-shrink-0"}):Qe==="success"?N.jsx(Nm,{className:"mr-3 w-6 h-6 flex-shrink-0"}):N.jsx(G0,{className:"mr-3 w-6 h-6 flex-shrink-0"}),N.jsx("span",{className:"text-sm font-medium",children:pe})]}),N.jsx("button",{onClick:$t,className:"ml-4 text-white/80 hover:text-white transition-colors",children:N.jsx(yT,{className:"w-4 h-4"})})]})})};if(m){const pe=location.state;return N.jsxs("div",{className:"min-h-screen bg-[#04011C] flex items-center justify-center",children:[(pe==null?void 0:pe.message)&&N.jsx("div",{className:"absolute top-20 w-full max-w-md",children:N.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500 text-emerald-400 p-4 rounded-xl flex items-center",children:[N.jsx(Nm,{className:"mr-3 w-6 h-6"}),pe.message]})}),N.jsx("div",{className:"animate-spin rounded-full h-16 w-16 "})]})}return r.length===0?(i("/dashboard",{state:{section:"purchases"}}),null):N.jsxs(N.Fragment,{children:[N.jsx("div",{className:"min-h-screen bg-[#04011C]",children:N.jsxs("div",{className:"max-w-4xl lg:max-w-2xl mx-auto px-4 sm:px-4 py-8 sm:py-10",children:[N.jsxs(Go.div,{initial:{opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.4},className:"flex items-center mt-6 sm:mt-10",children:[N.jsxs("button",{onClick:()=>i("/"),className:"text-gray-400 hover:text-[#8a4fff] flex items-center mr-auto mb-12 sm:mb-20",children:[N.jsx(ET,{className:"mr-2  w-5 h-5 mt-5 sm:w-6 sm:h-6"}),N.jsx("span",{className:"text-[14px] sm:text-base mt-5",children:"Back"})]}),N.jsx("h1",{className:"text-[24px] sm:text-3xl font-bold text-white absolute  mt-2 left-1/2 transform -translate-x-1/2 pt-4",children:"Checkout"})]}),N.jsxs("div",{className:"grid md:grid-cols-1 gap-4 sm:gap-6",children:[N.jsxs(Go.div,{initial:{opacity:1,x:0},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"space-y-4 sm:space-y-6",children:[N.jsxs("div",{className:"bg-gradient-to-br from-[#210746] to-[#2C095D] rounded-2xl sm:rounded-3xl p-4 sm:p-8 border border-[#8a4fff]/10",children:[N.jsxs("h2",{className:"text-[18px] sm:text-xl font-semibold text-[#8a4fff] mb-4 sm:mb-6 flex items-center",children:[N.jsx(dT,{className:"mr-2 sm:mr-3 w-5 h-5 sm:w-6 sm:h-6"})," Your Items"]}),N.jsx("div",{className:"space-y-3 sm:space-y-4",children:r.map(pe=>N.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl ",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-[#8a4fff]/30 to-[#8a4fff]/10 flex items-center justify-center shadow-inner",children:N.jsx(Sm,{className:"w-6 h-6 text-[#8a4fff]"})}),N.jsxs("div",{children:[N.jsx("h3",{className:"text-sm font-medium text-white lg:text-base",children:pe.name}),N.jsxs("p",{className:"text-xs text-gray-400",children:[pe.id==="free-trial"&&"CSGORoll Script",pe.id==="monthly"&&"CSGORoll Script",pe.id==="6-months"&&"CSGORoll Script",pe.id==="yearly"&&"CSGORoll Script"]})]})]}),N.jsxs("div",{className:"flex items-center space-x-4 lg:space-x-6",children:[N.jsxs("span",{className:"text-base font-bold lg:text-lg text-[#8a4fff]",children:["€",pe.price.toFixed(2)]}),N.jsx("button",{onClick:()=>e(pe.id),className:"text-red-500 hover:text-red-400 p-2 hover:bg-red-500/10 rounded-lg transition-colors",children:N.jsx(hT,{className:"w-4 h-4 lg:w-5 lg:h-5"})})]})]},pe.id))})]}),!Oe&&N.jsxs("div",{className:"bg-gradient-to-br from-[#210746] to-[#2C095D] rounded-2xl sm:rounded-3xl p-4 sm:p-8 border border-[#8a4fff]/10",children:[N.jsxs("h2",{className:"text-[18px] sm:text-xl font-semibold text-[#8a4fff] mb-4 sm:mb-6 flex items-center",children:[N.jsx(fT,{className:"mr-2 sm:mr-3 w-5 h-5 sm:w-6 sm:h-6"})," Payment Method"]}),N.jsxs("div",{className:"space-y-3",children:[N.jsx("div",{className:"grid grid-cols-3 gap-3",children:B.filter(pe=>pe.type==="crypto").map(pe=>N.jsxs("button",{onClick:()=>O({id:pe.id,name:pe.name,type:pe.type}),className:`
                            flex flex-col items-center p-3 rounded-xl transition-all duration-300
                        ${E.id===pe.id?"bg-[#8a4fff]/10 border-2 border-[#8a4fff]":"bg-[#1a0b2e] border-2 border-transparent hover:bg-[#8a4fff]/5"}
                      `,children:[N.jsx("div",{className:"w-8 h-8 mb-2",children:pe.icon}),N.jsx("p",{className:"text-sm font-medium text-white",children:pe.name})]},pe.id))}),B.filter(pe=>pe.type==="skin").map(pe=>N.jsxs("button",{onClick:()=>O({id:pe.id,name:pe.name,type:pe.type}),className:`
                          w-full flex items-center p-4 rounded-xl transition-all duration-300
                          ${E.id===pe.id?"bg-[#8a4fff]/10 border-2 border-[#8a4fff]":"bg-[#1a0b2e] border-2 border-transparent hover:bg-[#8a4fff]/5"}
                        `,children:[N.jsx("div",{className:"w-10 h-10 mr-4",children:pe.icon}),N.jsxs("div",{className:"flex-1 text-left",children:[N.jsx("p",{className:"text-base font-medium text-white",children:pe.name}),N.jsx("p",{className:"text-sm text-gray-400",children:"Pay with CS:GO skins"})]}),N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsx(V0,{className:"w-6 h-6 text-[#1E73A4]"}),N.jsx(Rf,{className:"w-6 h-6 text-blue-500"})]})]},pe.id))]})]})]}),N.jsxs(Go.div,{initial:{opacity:1,x:0},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"space-y-4 sm:space-y-6",children:[!Oe&&E&&N.jsx("div",{className:"bg-gradient-to-br from-[#210746] to-[#2C095D] rounded-2xl sm:rounded-3xl p-4 sm:p-8 border border-[#8a4fff]/10",children:E.type==="skin"?N.jsxs(N.Fragment,{children:[N.jsxs("h2",{className:"text-[18px] sm:text-xl font-semibold text-[#8a4fff] mb-4 sm:mb-6 flex items-center",children:[N.jsx(Sm,{className:"mr-2 sm:mr-3 w-6 h-6 sm:w-6 sm:h-6"})," Select Marketplace"]}),N.jsx("div",{className:"space-y-3",children:N.jsxs("div",{className:"p-6 bg-[#1a0b2e]/50 rounded-xl ",children:[N.jsxs("div",{className:"flex items-center justify-between mb-4",children:[N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#8a4fff]/10 flex items-center justify-center",children:N.jsx(Sm,{className:"w-6 h-6 text-[#8a4fff]"})}),N.jsxs("div",{children:[N.jsx("h3",{className:"text-lg font-semibold text-white",children:"Skin Payment"}),N.jsx("p",{className:"text-sm text-gray-400",children:"Coming Soon"})]})]}),N.jsx("div",{className:"px-3 py-1 bg-[#8a4fff]/10 rounded-full",children:N.jsx("span",{className:"text-sm text-[#8a4fff]",children:"Beta"})})]}),N.jsx("div",{className:"grid md:grid-cols-2 gap-3 mb-4",children:[{id:"bitskins",name:"BitSkins",logo:N.jsx(_m,{className:"w-5 h-5 text-purple-500"}),description:"Trusted skin trading platform",status:"coming_soon"},{id:"tradeit",name:"TradeIt.gg",logo:N.jsx(Rf,{className:"w-5 h-5 text-blue-500"}),description:"Instant skin trading platform",status:"coming_soon"}].map(pe=>N.jsxs("div",{className:"p-4 bg-[#2c1b4a] rounded-xl border border-[#8a4fff]/10 opacity-50",children:[N.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[pe.logo,N.jsx("h4",{className:"text-base font-medium text-white",children:pe.name})]}),N.jsx("p",{className:"text-sm text-gray-400",children:pe.description})]},pe.id))}),N.jsxs("div",{className:"bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl  p-4",children:[N.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[N.jsx(J0,{className:"w-5 h-5 text-[#8a4fff]"}),N.jsx("h4",{className:"text-base font-medium text-white",children:"Marketplace Security"})]}),N.jsx("p",{className:"text-sm text-gray-400",children:"We only work with verified marketplaces. Double-check trade details and never accept offers from unofficial sources."})]}),N.jsx("div",{className:"mt-4 flex justify-center",children:N.jsxs("button",{onClick:()=>O({id:"usdc",name:"USDC",type:"crypto"}),className:"w-full py-3 bg-gradient-to-r from-[#8a4fff] via-[#6a2dcf] to-[#4a1daf] text-white rounded-lg hover:from-[#7a3ddf] hover:via-[#5a2dbf] hover:to-[#3a1d9f] active:scale-[0.98] shadow-lg shadow-[#8a4fff]/20 transition-all duration-300 flex items-center justify-center gap-2",children:[N.jsx(Df,{className:"w-4 h-4"}),"Switch to Crypto Payment"]})})]})})]}):N.jsxs(N.Fragment,{children:[N.jsxs("h2",{className:"text-[18px] sm:text-xl font-semibold text-[#8a4fff] mb-4 sm:mb-6 flex items-center",children:[N.jsx(Df,{className:"mr-2 sm:mr-3 w-5 h-5 sm:w-6 sm:h-6"})," Connect Your Wallet"]}),se?N.jsxs("div",{className:"space-y-4",children:[N.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl ",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsxs("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-[#8a4fff]/30 to-[#8a4fff]/10 flex items-center justify-center shadow-inner",children:[E.id==="usdc"&&N.jsx(kC,{className:"w-7 h-7"}),E.id==="ethereum"&&N.jsx(Im,{className:"w-7 h-7 text-[#627EEA]"}),E.id==="tether"&&N.jsx(W0,{className:"w-7 h-7 text-[#26A17B]"})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-base font-medium text-white",children:E.name}),N.jsxs("p",{className:"text-sm text-gray-400",children:[E.id==="ethereum"&&`${(S/2e3).toFixed(8)} ETH`,E.id==="usdc"&&`${S.toFixed(2)} USDC`,E.id==="tether"&&`${S.toFixed(2)} USDT`]})]})]}),N.jsxs("div",{className:"flex items-center space-x-2 bg-green-500/10 px-4 py-2 rounded-full",children:[N.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),N.jsx("span",{className:"text-sm text-green-400",children:"Connected"})]})]}),N.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[N.jsxs("div",{className:"p-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl ",children:[N.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[N.jsx(Df,{className:"w-5 h-5 text-[#8a4fff]"}),N.jsx("p",{className:"text-sm text-gray-400",children:"Balance"})]}),N.jsx("p",{className:"text-base font-medium text-white",children:ge&&_e&&N.jsx(dK,{provider:ge,address:J,chainId:Number(_e)})})]}),N.jsxs("div",{className:"p-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl ",children:[N.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[N.jsx(vT,{className:"w-5 h-5 text-[#8a4fff]"}),N.jsx("p",{className:"text-sm text-gray-400",children:"Network"})]}),N.jsx("p",{className:"text-base font-medium text-white",children:_e===1?"Ethereum":_e===5?"Goerli Testnet":_e===11155111?"Sepolia Testnet":`Chain ID: ${_e}`})]})]}),N.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl ",children:[N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsx(Im,{className:"w-5 h-5 text-[#627EEA]"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm text-gray-400",children:"Wallet Address"}),N.jsxs("p",{className:"text-sm font-medium text-white",children:[J==null?void 0:J.slice(0,6),"...",J==null?void 0:J.slice(-4)]})]})]}),N.jsx("div",{className:"flex justify-center",children:N.jsx("appkit-button",{})})]})]}):N.jsx("div",{children:N.jsxs("div",{className:"py-6 px-2",children:[N.jsxs("div",{className:"flex items-center gap-6 mb-8 p-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl ",children:[N.jsx("div",{className:"w-14 h-14 rounded-lg bg-gradient-to-br from-[#8a4fff]/30 to-[#8a4fff]/10 flex items-center justify-center shadow-inner",children:N.jsx(Df,{className:"w-7 h-7 text-[#8a4fff]"})}),N.jsxs("div",{children:[N.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Wallet Not Connected"}),N.jsx("p",{className:"text-sm text-gray-400",children:"Connect your crypto wallet to continue"})]})]}),N.jsx("div",{className:"scale-110 ml-2 w-fit p-1 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-full ",children:N.jsx("appkit-button",{})})]})})]})}),N.jsxs("div",{className:"bg-gradient-to-br from-[#210746] to-[#2C095D] rounded-2xl sm:rounded-3xl p-4 border border-[#8a4fff]/10",children:[N.jsx("div",{className:"space-y-4 mb-6",children:N.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#1a0b2e] rounded-xl",children:[N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsx("div",{className:"w-10 h-10 rounded-lg bg-[#8a4fff]/10 flex items-center justify-center",children:N.jsx(K0,{className:"w-5 h-5 text-[#8a4fff]"})}),N.jsx("div",{className:"flex items-center space-x-2",children:N.jsx("span",{className:"text-sm text-gray-400",children:"Total Amount"})})]}),N.jsx("div",{className:"flex flex-col items-end",children:H&&j!==null?N.jsxs(N.Fragment,{children:[N.jsxs("span",{className:"text-xs text-gray-400 line-through mb-0.5",children:["€",S.toFixed(2)]}),N.jsxs("span",{className:"text-2xl font-semibold text-white",children:["€",j.toFixed(2)]}),N.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-400 mt-1",children:[N.jsx(G0,{className:"w-3 h-3"})," 10% Referral discount"]})]}):N.jsxs("span",{className:"text-2xl font-semibold text-white",children:["€",S.toFixed(2)]})})]})}),N.jsx("div",{className:"mb-6",children:N.jsxs("div",{className:"flex items-center justify-center",children:[N.jsx("button",{onClick:()=>T(!I),className:`
                        w-5 h-5 rounded border-2 flex items-center justify-center transition-all duration-200
                        ${I?"bg-[#8a4fff] border-[#8a4fff]":"bg-transparent border-[#8a4fff]/30 hover:border-[#8a4fff]/50"}
                      `,children:I&&N.jsx("svg",{className:"w-3 h-3 text-white",viewBox:"0 0 24 24",fill:"none",children:N.jsx("path",{d:"M20 6L9 17L4 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),N.jsxs("button",{onClick:()=>T(!I),className:"text-gray-400 flex items-center text-sm ml-3 cursor-pointer hover:text-gray-300 transition-colors",children:["I've read and accept the"," ",N.jsx(kf,{to:"/policy",className:"ml-1 text-[#8a4fff] hover:underline",onClick:pe=>pe.stopPropagation(),children:"Terms of Service"})]})]})}),N.jsxs("div",{className:"space-y-3",children:[Oe&&!K?N.jsxs("button",{onClick:()=>{window.open("https://discord.gg/XxHsYT4m","_blank","noopener,noreferrer"),Z(!0)},className:"w-full py-4 bg-[#5865F2] text-white rounded-xl hover:bg-[#4752C4] transition-colors text-lg flex items-center justify-center",children:[N.jsx(pT,{className:"w-6 h-6 mr-2"}),"Join Discord"]}):N.jsx(N.Fragment,{children:N.jsx("button",{onClick:M0,disabled:!I||k||Et,className:`
                          w-full py-3.5 rounded-lg transition-all duration-300 flex items-center justify-center relative
                          ${I&&!k?"bg-gradient-to-r from-[#8a4fff] via-[#6a2dcf] to-[#4a1daf] text-white hover:from-[#7a3ddf] hover:via-[#5a2dbf] hover:to-[#3a1d9f] active:scale-[0.98] shadow-lg shadow-[#8a4fff]/20":"bg-gray-500 text-gray-300 cursor-not-allowed"}
                        `,children:Et?N.jsxs("div",{className:"flex items-center justify-between w-full px-4",children:[N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsxs("div",{className:"relative",children:[N.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-white/30"}),N.jsx("div",{className:"absolute top-0 left-0 animate-spin rounded-full h-6 w-6 border-t-2 border-white"})]}),N.jsxs("div",{className:"flex flex-col",children:[N.jsx("span",{className:"text-sm font-medium",children:"Processing Payment"}),N.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[N.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${ut>=1?"bg-white":"bg-white/30"}`}),N.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${ut>=2?"bg-white":"bg-white/30"}`}),N.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${ut>=3?"bg-white":"bg-white/30"}`})]})]})]}),N.jsxs("div",{className:"text-sm font-medium",children:[ut===1&&"Preparing...",ut===2&&!Tf&&"Confirming...",ut===2&&Tf&&"Finalizing...",ut===3&&"Done..."]})]}):N.jsx("div",{className:"flex items-center justify-center",children:Oe?Xx?N.jsxs("div",{className:"flex items-center space-x-2",children:[N.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white/30",children:N.jsx("div",{className:"absolute top-0 left-0 animate-spin rounded-full h-5 w-5 border-t-2 border-white"})}),N.jsx("span",{className:"text-base font-medium",children:"Activating..."})]}):N.jsxs(N.Fragment,{children:[N.jsx(Nm,{className:"w-4 h-4 mr-2"}),N.jsx("span",{className:"text-base font-medium",children:"Activate Free Trial"})]}):N.jsxs(N.Fragment,{children:[N.jsx(K0,{className:"w-4 h-4 mr-2"}),N.jsxs("span",{className:"text-base font-medium",children:["Pay €",j!==null?j.toFixed(2):S.toFixed(2)]})]})})})}),N.jsx("button",{onClick:()=>i("/"),className:`w-full py-3.5 bg-transparent border border-[#8a4fff]/30 
                      text-[#8a4fff] rounded-lg hover:bg-[#8a4fff]/10 
                      transition-colors text-base`,children:"Cancel"})]})]})]})]})]})}),P&&N.jsx(nT,{}),A&&N.jsx(sT,{}),N.jsx("div",{className:"fixed top-0 left-0 right-0 z-[60] flex flex-col gap-2 p-4",children:N.jsxs(gT,{children:[Of.type&&Of.message&&N.jsx(Em,{message:Of.message,type:Of.type,onClose:()=>Vn({type:null,message:null})}),xf&&N.jsx(Em,{message:`Not enough funds in your wallet. You need €${S.toFixed(2)} to complete this transaction.`,type:"error",onClose:()=>Nc(!1)}),rT&&N.jsx(Em,{message:"You can only have one subscription in your cart at a time. Please remove any additional subscriptions before proceeding.",type:"error",onClose:()=>$0(!1)})]})})]})},dK=({provider:r,address:e,chainId:t})=>{const[n,s]=we.useState("0");return we.useEffect(()=>{const i=async()=>{if(r&&e)try{const c=await new Xa(r,t).getBalance(e),l=m0(c),u=(Number(l)*2e3).toFixed(2);s(u)}catch(a){console.error("Error fetching balance:",a)}};i();const o=setInterval(i,1e4);return()=>clearInterval(o)},[r,e,t]),N.jsxs(N.Fragment,{children:["€",n]})},SJ=Object.freeze(Object.defineProperty({__proto__:null,default:uK},Symbol.toStringTag,{value:"Module"}));export{_u as $,de as A,Ce as B,Ne as C,Ee as D,LI as E,EK as F,Pj as G,as as H,zT as I,qe as J,NJ as K,Vw as L,Bt as M,MT as N,G as O,li as P,Cp as Q,et as R,cs as S,Cr as T,Od as U,vJ as V,pr as W,Xt as X,AJ as Y,JI as Z,Ww as _,Np as a,Qk as a0,rJ as a1,GE as a2,W_ as a3,jk as a4,Zk as a5,nJ as a6,tJ as a7,Bg as a8,oJ as a9,sJ as aa,SJ as ab,hr as b,ee as c,ve as d,x as e,At as f,Pi as g,_J as h,gl as i,En as j,bt as k,ft as l,VH as m,Si as n,WH as o,ie as p,$s as q,CJ as r,ZA as s,VC as t,xt as u,QA as v,tn as w,EJ as x,Nr as y,bK as z};
